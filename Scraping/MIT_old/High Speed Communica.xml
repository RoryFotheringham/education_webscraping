<doc>
  <source>MIT</source>
  <date>28/01/2023</date>
  <course>
    <course_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/</course_url>
    <course_title>High Speed Communication Circuits and Systems</course_title>
    <course_tags>
      <list>Engineering </list>
      <list>Computer Science </list>
      <list>Electrical Engineering </list>
    </course_tags>
  </course>
  <lectures>
    <lecture>
      <lecture_title>High Speed Frequency Dividers</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec14/</lecture_pdf_url>
      <lectureno>14</lectureno>
      <slides>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 14
High Speed Frequency Dividers
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>M.H. Perrott MIT OCW
Speed Limitations of Divide-by-2 Circuit
&#131;Maximum speed limited only by propagation delay 
(delay1, delay2)  of latches and setup time of 
latches (Ts)
LATCH 1
DQ
Qclk
INOUTLATCH 2
DQ
Qclk
INOUT
IN
OUTTINdelay2delay1
D Register</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
Explanation of Wang Topology Operation (Part 1)
&#131;Left latch-Current driven into latch and output voltage responds 
similar to Razavi architecture
&#131;Right latch-Different than Razavi architecture in that latch output 
voltage is notdischarged due to presence of extra NMOSIN
&#934;1 &#934;3
&#934;2 &#934;4IN
&#934;2 &#934;4
&#934;3 &#934;1
IN IN</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Left latch-Current is directed into cross-coupled pair
&#131;Latch output voltage retained
&#131;Right latch-Current is directed into differential amp
&#131;Latch output voltage follows input from left latch 
Load
Load
&#934;1 &#934;3
&#934;2 &#934;4
IN INLoad
Load
&#934;2 &#934;4
&#934;3 &#934;1
IN INExplanation of SCL Topology Operation (Part 2)</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
A More Modular Design
&#131;Perform control qualification by synchronizing within 
each stage before passing to previous one-Compare to previous slide in which all outputs required 
for qualification of first 2/3 stage
&#131;See Vaucher et. al., &#8220;A Family of Low-Power Truly Modular Programmable Dividers &#8230;&#8221;, JSSC, July 2000IN OUT
mod in mod out2/3
CONIN OUT
mod in mod out2/3
CONIN OUT
mod in mod out2/3
CON Vdd
CON 0 CON 1 CON 2IN OUT
IN
A
B
OUT8 + CON0*20 + CON1*21 + CON2*22AB</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
Jitter in Synchronous Designs
&#131;Transition time of register output is set by the clock, 
not the incoming data input-Synchronous circuits have jitter performance 
corresponding to their clock-Jitter does not accumulate as signal travels through 
synchronous stagesIn XY OutRegister
DQ
Qclk
CLK</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
Control Qualifier Design (Classical Approach)
&#131;Must align CON signal to first &#8220;2/3&#8221; divider stage-CON signal is based on logi c clocked by divider output
&#131;There will be skew between &#8220;2/3&#8221; divider timing and CON
&#131;Classical approach cleverly utilizes outputs from each 
section to &#8220;gate&#8221; the CON signal to &#8220;2/3&#8221; divider2 2/3
CONIN OUT
2AB
IN
A
B
OUT
CON*CON *
CONControl
Qualifier</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Explanation of SCL Topology Operation (Part 1)
&#131;Left latch-Current directed into differential amp portion of latch
&#131;Latch output follows input from right latch
&#131;Right latch-Current directed into cross-c oupled pair portion of latch
&#131;Latch output is held
Load
Load
&#934;1 &#934;3
&#934;2 &#934;4
IN INLoad
Load
&#934;2 &#934;4
&#934;3 &#934;1
IN IN</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>M.H. Perrott MIT OCW
Speed Limitations of Gated Divide-by-2/3 Circuit
&#131;Maximum speed limited by latch plus gating logic
&#131;Gated divide-by-2/3 fundamentally slower than divide-by-2
A
OUTLATCH 1
DQ
Qclk
INOUTLATCH 2
DQ
Qclk
INOUT
INGATING
LOGICCONA
TIN
CONdelay1delay2delay3
Register
</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Divide-by-2 Using Wang Topology
&#131;Claims to be faster than Razavi topology-Chief difference is addition of NMOS clock devices and 
different scaling of upper PMOS devices
&#131;See HongMo Wang, &#8220;A 1.8 V 3 mW 16.8 GHz Frequency 
Divider in 0.25 &#181;m CMOS&#8221;, ISSCC 2000, pp 196-197IN
&#934;1 &#934;3
&#934;2 &#934;4IN
&#934;2 &#934;4
&#934;3 &#934;1
IN IN&#934;1
&#934;3
&#934;2
&#934;4IN
IN</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Differential to Full Swing Converter
&#131;Use an opamp style circuit to translate differential 
input voltage to a single-ended output
&#131;Use an inverter to amplify the single-ended output to 
full swing levelOutVinVinVdd
0Inverter
Threshold
Voltage
Y</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
Dual Modulus Prescalers
&#131;Dual modulus design supports two divide values-In this case, divide-by-8 or 9 according to CON signal
&#131;One cycle resolution achieved with front-end &#8220;2/3&#8221; divider2 2/3
Control
QualifierCONIN OUT2AB
IN
A
B
OUT
CON*8 + CON CyclesCON*
CON</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
Jitter in Asynchronous Designs
&#131;Each logic stage adds jitter to its output-Jitter accumulates as it passes through more and more 
gatesIn XY Out</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Advantages and Disadvantages of Razavi Topology
&#131;Advantages-Fast &#8211; no stacked PMOS, signal goes through only two 
gates per cycle
&#131;Disadvantages-Static power-Full swing, differential input clock signal required
&#131;Note:  quarter period duty cycle can be turned into fifty 
percent duty cycle with OR gates after the divider-See my thesis at http: //www-mtl.mit.edu/~perrottIN
&#934;1 &#934;3
&#934;2 &#934;4IN
&#934;2 &#934;4
&#934;3 &#934;1&#934;1
&#934;3
&#934;2
&#934;4IN
IN</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Issue:  Architecture Very Sensitive to DC Offset
&#131;Opamp style circuit has very high DC gain from Vinto 
node Y
&#131;DC offset will cause signal to rise above or fall below 
inverter threshold-Output signal rails rather than pulsingOutVinVinVdd
0Inverter
Threshold
Voltage
Y</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Use Resistor Feedback to Reduce DC Gain
&#131;Idea:  create transresistance amplifier rather than voltage 
amplifier out of inverter by using feedback resistor-Presents a low impedance to node Y-Current from opamp style circuit is shunted through resistor-DC offset at input shifts out put waveform slightly, but not 
node Y (to first order)
&#131;Circuit is robust against DC offset!OutVinVinVdd
0Inverter
Threshold
Voltage
YRfVdd
0</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
Creating Higher Divide Values (Synchronous Approach)
&#131;Cascades toggle registers and logic to perform division-Advantage:  low jitter (explained shortly)-Problems:  high power (all regi sters run at high frequency), 
high loading on clock (IN signal drives all registers)TQ
Qclk
INOUT
TQ
QclkTQ
Qclk1 A B
IN
OUTA
BRegister Register Register
DQ
QclkRegisterToggle Register
T
clkQ
Q</text>
        </slide>
        <slide>
          <slideno>45</slideno>
          <text>M.H. Perrott MIT OCW
Example Architecture for a Phase-Shifted Divider
&#131;Phase shifting in first divide-by-4/5/6/7 stage to 
achieve high speed
&#131;Remaining stages correspond to gated divide-by-2/3 cells
&#131;For details, see my thesis -http://www-mtl.mit.edu/~perrott/&#934;1
&#934;2
&#934;3
&#934;4&#934;1
&#934;2
&#934;3
&#934;4Divide-by-2 Divide-by-2
IN OUT
INININ ININ
OUTOUT
OUT
OUT4-to-1 MUX
Phase Select
LogicPH_SEL
PH_SEL
CLK QUALRemaining Divider Stages
Qualification Signals
CON* CON* CONControl
Qualifier</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
OutVinVinVdd
0YVsgVdd
0Impact of Nonlinear Feedback When Output is Low
&#131;Corresponds to case where current flows out of node Y-NMOS device is shut off-PMOS device acts like source follower
&#131;Output is approximately set to Vgs of PMOS feedback 
device away from inverter threshold voltage-Inverter input is set to a value th at yields that output voltage
&#131;High DC gain of inverter insures it is close to inverter threshold</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
Multi-Modulus Prescalers
&#131;Cascaded 2/3 sections achieves a range of 2nto 2n+1-1-Above example is 8/ L/15 divider
&#131;Asynchronous design allows high speed and low 
power operation to be achieved-Only negative is jitter accumulation2/3 2/3IN OUT AB
2/3CON0 CON1 CON2
IN
A
B
OUT8 + CON0*20 + CON1*21 + CON2*22</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Divide-by-2 Using SCL Latches
&#131;Fastest structure uses resistors for load&#934;1
&#934;3
&#934;2
&#934;4IN
IN
Load
Load
&#934;1 &#934;3
&#934;2 &#934;4
IN INLoad
Load
&#934;2 &#934;4
&#934;3 &#934;1
IN IN</text>
        </slide>
        <slide>
          <slideno>43</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Divide-by-4/5 in Multi-Modulus Prescaler
&#131;Issue &#8211; gaps are created in divide value range-Divide-by-4/5 lowers swallowi ng resolution of following 
stage
2/3 4/5IN OUT AB
2/3CON0 CON1 CON2
IN
A
B
OUTCON0*20 + CON1*22 + CON2*2316 +</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Same process repeats on the right side-The left side maintains it s voltages due to presence of 
NMOS deviceIN
&#934;1 &#934;3
&#934;2 &#934;4IN
&#934;2 &#934;4
&#934;3 &#934;1
IN INExplanation of Wang Topology Operation (Part 2)</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
IN
&#934;1 &#934;3
&#934;2 &#934;4IN
&#934;2 &#934;4
&#934;3 &#934;1Explanation of Razavi Divider Operation (Part 2)
&#131;Right latch:-Clock drives current from PM OS devices of a given latch 
onto the NMOS cross-coupled pair-Latch output voltage rises asy mmetrically according to 
voltage setting on gates of outside NMOS devices
&#131;Left latch:-Outside NMOS devices disc harge the latch output 
voltage as the left latch output voltage rises</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>Can We Go Even Faster?</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
Divide-by-2 Circuit (Johnson Counter)
&#131;Achieves frequency division by clocking two latches 
(i.e., a register) in negative feedback
&#131;Latches may be implemented in various ways 
according to speed/power requirementsLATCH 1
DQ
Qclk
INOUTLATCH 2
DQ
Qclk
INOUT
IN
OUTTINRegister</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
Divide-by-2 Using Razavi&#8217;s Topology
&#131;Faster topology than TSPC approach
&#131;See B. Rezavi et. al., &#8220;Design of High Speed, Low Power 
Frequency Dividers and Phase-Locked Loops in Deep 
Submicron CMOS&#8221;, JSSC, Feb 1995, pp 101-109IN
&#934;1 &#934;3
&#934;2 &#934;4IN
&#934;2 &#934;4
&#934;3 &#934;1&#934;1
&#934;3
&#934;2
&#934;4IN
IN</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Variable Frequency Division
&#131;Classical design partitions variable divider into two sections-Asynchronous section (called a prescaler) is fast
&#131;Often supports a limited range of divide values-Synchronous section has no jitte r accumulation and a wide 
range of divide values-Control logic coordinates sections  to produce a wide range of 
divide valuesIN OUT Asynchronous
DividerSynchronous
Divider
Control LogicPrescaler
Divide Value (N)</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Nonlinear Feedback When Output is High
&#131;Corresponds to case where current flows into node Y-NMOS device acts like source follower-PMOS device is shut off
&#131;Output is approximately set to Vgsof NMOS feedback 
device away from inverter threshold voltage-Inverter input is set to a value th at yields that output voltage
&#131;High DC gain of inverter insures it is close to inverter thresholdOutVinVinVdd
0Y
VgsVdd
0</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Same process repeats on left side-Voltage polarity is now flippedLoad
Load
&#934;1 &#934;3
&#934;2 &#934;4
IN INLoad
Load
&#934;2 &#934;4
&#934;3 &#934;1
IN INExplanation of SCL Topology Operation (Part 3)</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
High Speed, Low Power Asynchronous Dividers
&#131;Highest speed achieved with differential SCL registers-Static power consumption not an issue for high speed 
sections, but wasteful in low speed sections
&#131;Lower power achieved by using full swing logic for low 
speed sectionsB C OUT
IN
CA
B2 2 2BDifferential to
Full Swing
ConverterFull Swing
TSPC registers
(to save power)Differential
SCL registers
(for high speed)
2BA
AIN
IN
OUT</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>M.H. Perrott MIT OCW
Implementation Challenges to Phase Shifting
&#131;Avoiding glitches-By assumption of sine wave characteristics
&#131;Craninckx et. al., &#8220;A 1.75 GHz/3 V Dual-Modulus Divide-
by-128/129 Prescaler &#8230;&#8221;, JSSC, July 1996-By make-before-break switching
&#131;My thesis:  http://www-mtl.mit.edu/~perrott/-Through re-timed multiplexor
&#131;Krishnapura et. al, &#8220;A 5.3 GH z Programmable Divider for 
HiPerLan in 0.25 &#181;m CMOS&#8221;, JSSC, July 2000
&#131;Avoiding jitter due to mismatch in phases-Through calibration
&#131;Park et. al., &#8220;A 1.8-GHz Self-Calibrated Phase-Locked Loop with Precise I/Q Matching&#8221;, JSSC, May 2001</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Creating Higher Divide Values (Asynchronous Approach)
&#131;Higher division achieved by simply cascading          
divide-by-2 stages
&#131;Advantages over synchronous approach-Lower power:  each stage r uns at a lower frequency, 
allowing power to be correspondingly reduced-Less loading of input:  IN signal only drives first stage
&#131;Disadvantage:  jitter is largerIN A B OUT
IN
OUTA
B2 2 2</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
Implementation of Latch and And Gate in 2/3 Section
&#131;Combine AND gate and latch for faster speed and lower 
power dissipation
&#131;Note that all primitives in 2/3 Section on previous slide 
consist of this combination or just a straight latchCLK CLKRL RL
A
B BAQ Q
LATCH
DQ
Qclk
CLKBAQ</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Advantages and Disadvantages of SCL Topology
&#131;Advantages-Very fast &#8211; no PMOS at all, signal goes through only two 
gates per cycle-Smaller input swing for in put clock than previous 
approaches
&#131;Much easier to satisfy at high frequencies
&#131;Disadvantages-Static power-Differential signals required-Large area compared to previous approaches-Biasing sources required
&#131;Note:  additional speedup can be obtained by adding 
using inductor peaking as described for amplifiers in 
Lecture 6</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
Alternate Implementation of Inverter Feedback
&#131;Nonlinear feedback using MOS devices can be used 
in place of resistor-Smaller area than resistor implementation
&#131;Analysis done by examining impact of feedback when output is high or lowOutVinVinVdd
0YVdd
0</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
High Speed Frequency Dividers in Wireless Systems
&#131;Design Issues:  high speed, low powerZin
Zo LNA To FilterFrom Antenna
and Bandpass
FilterPC board
trace
Package
Interface
LO signalMixer
RF in IF out
Frequency
SynthesizerReference
FrequencyVCO
PFDCharge
Pumpout(t) e(t) v(t)
NLoop
Filter
DividerVCOref(t)
div(t)v(t) out(t) ref(t)</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Divide-by-2/3 Design (Classical Approach)
&#131;Normal mode of operation:   CON*= 0 &#8658;Y = 0-Register B acts as divide-by-2 circuit
&#131;Divide-by-3 operation:  CON*= 1 &#8658;Y = 1-Reg B remains high for an extra cycle
&#131;Causes Y to be set back to 0 &#8658;Reg B toggles again
&#131;CON*must be set back to 0 before Reg B toggles to 
prevent extra pulses from being swallowedD Q
Q
CON *OUTReg A Reg B
D Q
Q INY
2/3</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
Advantages and Disadvantages of Wang Topology
IN
&#934;1 &#934;3
&#934;2 &#934;4IN
&#934;2 &#934;4
&#934;3 &#934;1
IN IN&#934;1
&#934;3
&#934;2
&#934;4IN
IN
&#131;Advantages-Fast &#8211; no stacked PMOS, signal goes through only two 
gates per cycle
&#131;Disadvantages-Static power-Full swing, differential input clock signal required</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
Implementation of 2/3 Sections in Modular Approach 
&#131;Approach has similar complexity to classical design-Consists of two registers with accompanying logic gates
&#131;Cleverly utilizes &#8220;gating&#8221; register to pass synchronized 
control qualifying signal to the previous stageLATCH
DQ
Qclk
INLATCH
DQ
Qclk
LATCH
D Q
QclkLATCH
D QQ
clkOUT
mod inmod out2/3 Circuits
CON *
CONControl
Qualifier
Circuits</text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>M.H. Perrott MIT OCW
Further Reduction of MUX Operating Frequency
&#131;Leverage the fact that divide-by-2 circuit has 4 phases-Create divide-by-4/5 by cascading twodivide-by-2 circuits
&#131;Note that single cycle puls e swallowing still achieved-Mux operates at one four th the input frequency!
IN
IN/2
OUT
OUT OUTIN
OUT INOUT
CON(4 PHASE)DIVIDE-BY-2
ININDIVIDE-BY-2
ININ OUT
OUTMUX
LOGIC
OUT
OUTIN/2
IN/2
4 cycles 5 cycles&#934;1
&#934;2
&#934;3
&#934;4&#934;1
&#934;2
&#934;3
&#934;4
&#934;1
&#934;2
&#934;3
&#934;4
&#934;1 &#934;2</text>
        </slide>
        <slide>
          <slideno>44</slideno>
          <text>M.H. Perrott MIT OCW
Method to &#8220;Fill In&#8221; Divide Value Range
&#131;Allow divide-by-4/5 to swallow more than one input 
cycle per OUT period-Divide-by-4/5 changed to Divide-by-4/5/6/7
&#131;Note:  at least two divide -by-2/3 sections must follow
IN2/3 4/5 2/3IN A B OUT
A
B
OUT
AT LEAST 3 CYCLES
NEEDED AT NODE A4/5/6/7</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>M.H. Perrott MIT OCW
Divide-by-2/3 Using Phase Shifting
&#131;Achieves speed of divide-by-2 circuits!-MUX logic runs at half  the input clock speedLATCH
DQ
Qclk
INOUTLATCH
DQ
Qclk
INOUT
OUT OUTOUTINMUX
LOGIC
CON
CON
/K46A
/K46B
/K46A
/K46B
/K46B /K46ADIVIDE-BY-2</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
Explanation of Razavi Divider Operation (Part 1)
&#131;Left latch:-Clock drives current from PM OS devices of a given latch 
onto the NMOS cross-coupled pair-Latch output voltage rises asy mmetrically according to 
voltage setting on gates of outside NMOS devices
&#131;Right latch:-Outside NMOS devices disc harge the latch output 
voltage as the left latch output voltage risesIN
&#934;1 &#934;3
&#934;2 &#934;4IN
&#934;2 &#934;4
&#934;3 &#934;1</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
IN
&#934;1 &#934;3
&#934;2 &#934;4IN
&#934;2 &#934;4
&#934;3 &#934;1Explanation of Razavi Divider Operation (Part 3)
&#131;Process starts over again with current being driven 
into left latch-Voltage polarity at the output of the latch has now 
flipped</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
Divide-by-2 Using a TSPC register
&#131;Advantages-Reasonably fast, compact size-No static power dissipation, differential clock not required
&#131;Disadvantages-Slowed down by stacked PMOS, signals goes through 
three gates per cycle-Requires full swing input clock signalOUT
IN
INOUT</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Noise Figure, Impact of Amplifier Nonlinearities</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec8/</lecture_pdf_url>
      <lectureno>8</lectureno>
      <slides>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
Observations
&#131;If you need to power match to a resistive load, you 
must pay a 3 dB penalty in Noise Figure-A transformer does not alleviate this issue
&#131;What value does a transformer provide?-Almost-true answer: maximizes voltage gain given the 
power match constraint, thereby reducing effect of noise of following amplifiers
-Accurate answer: we need to  wait until we talk about 
cascaded noise factor calculationsenRs
enRL
RLRS
Vx
1:N=Source
Rin=Rs Rout=RLVnout=          VxRL
Rs
RL
Rs</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
Input Referred Noise Model
ioutRsenRs
vinLinear,Time Invariant
 Circuit
(Noiseless) Zinvx
ZLinout
ZoutEquivalent output
referred current noise
(assumed to be independent
of Zout and ZL) 
ioutLinear,Time Invariant
 Circuit
(Noiseless) Zinvx inYs is iin
en
inYs isCan remove the signal source
since Noise Factor can be
expressed as the ratio of total 
output noise to input noiseiin,sc=iout
&#946;en</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
Relationship between IIP3, c1and c3
&#131;Intersection point
&#131;Solve for A (gives Aiip3)
&#131;Note that A corresponds to the peak value of the two 
cosine waves coming into the amplifier input node (Vx)-Would like to instead like to ex press IIP3 in terms of powerA1-dB1 dB
20log(A)20log(Afund)
Aiip3Third-order
IM termFirst-order
output c3A3 3
4== c1A
</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
IIP3 Expressed in Terms of Power at Source
&#131;IIP3 referenced to                     
Vx(peak voltage)
&#131;IIP3 referenced to Vx
(rms voltage)w1 0 w2Wvin(w)Equal Amplitude
Sine Waves
Amplifier
vinRs
Zin=RsVout
Vbias2A
Vx
Vout=co+c1Vx+c2Vx+c3Vx23Note:
vx(w) =vin(w)
2
&#131;Power across Zin= Rs
&#131;Note: Power from vin
</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
Nonlinearities in Amplifiers
&#131;We can generally break up an amplifier into the 
cascade of a memoryless nonlinearity and an input 
and/or output transfer function
&#131;Impact of nonlinearities with sine wave input-Causes harmonic distortion (i.e., creation of harmonics)
&#131;Impact of nonlinearities with several sine wave inputs-Causes harmonic distortion for each input AND  
intermodulation productsM1RL
Vout
CLId
VinVddMemoryless
Nonlinearity
1+sRLCLVinLowpass
Filter
Vout Id -RL</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
Intermodulation Products
&#131;Second-order intermodulation (IM2) products
&#131;Third-order intermodulation (IM3) products
-These are the troublesome ones for narrowband 
systems 
</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Example:  Noise Factor Calculation for RC Load
&#131;Total output noise
&#131;Total output noise due to source
&#131;Noise FactorvinRs
CLSource
voutenRsRsSource
vnoutCL RLenRL
RL
</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Use Filtering to Remove Undesired Interference
&#131;Ineffective for IM3 term that falls in the desired signal 
frequency bandMemoryless
Nonlinearity
xy
w1 0 w2WX(w)Desired
Narrowband
SignalInterferers
0 w1
2w2+w1w2 2w2
2w1-w2 2w1+w2 2w2-w1w1+w2w2-w1 2w1 3w2 3w1WY(w)Corruption of desired signal
0 w1
2w2+w1w2 2w2
2w1-w2 2w1+w2 2w2-w1w1+w2w2-w1 2w1 3w2 3w1WZ(w)Corruption of desired signalBandpass
Filterz</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Optimizing For Noise Figure versus Power Transfer
&#131;One cannot generally achieve minimum noise figure if 
maximum power transfer is desiredGsBs
GoptBoptExample source
admittance for maximum
power transferCircles of constant
Noise Factor
(Fmin at the center)ioutLinear,Time Invariant
 Circuit
(Noiseless) Zinvx inGs is iinen
BsSignal
Source noise produced
by source conductanceSource
susceptanceSource
conductance
Bmax
Gmax</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
Alternative Noise Factor Expression
&#131;From previous slide
&#131;Calculation of Noise FactorioutRsenRs
vinLinear,Time Invariant
 Circuit
(Noiseless) Zinvx
ZLinout
ZoutEquivalent output
referred current noise
(assumed to be independent
of Zout and ZL) 
</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
&#131;In general, enand inwill be correlated
-Ycis called the correlation admittanceCalculation of Noise Factor
&#131;By inspection of above figure
en
inYs is iin,sc=iout
&#946;
</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
VsRS
RL Vx
1:NSource
Rin=
N21RL Rout=N2RsVout=NVx
enRs
enRL
RLRS
Vx
1:NSource
Rin=
N21RL Rout=N2RsVnout=NVxExample:  Resistive Load with Source Transformer
&#131;For maximum power transfer (as derived in Lecture 3)
</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Comparison of Noise Figure and Power Match
&#131;To achieve minimum Noise Factor
&#131;To achieve maximum power transfer
vinRs
RLSource
voutenRs
enRLRs
RLSource
vnout</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
Noise Factor and Noise Figure (From Lec 7)
&#131;Definitions
&#131;Calculation of SNRinand SNRout
ioutRsenRs
vinLinear,Time Invariant
 Circuit
(Noiseless) Zinvx
ZLinout
ZoutEquivalent output
referred current noise
(assumed to be independent
of Zout and ZL) 
</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Frequency Domain View of Harmonic Distortion
&#131;Harmonics cause &#8220;noise&#8221;-Their impact depends highly on application
&#131;LNA &#8211; typically not of consequence
&#131;Power amp &#8211; can degrade spectral mask
&#131;Audio amp &#8211; depends on your listening preference!
&#131;Gain for fundamental component depends on input 
amplitude!Memoryless
Nonlinearity
xywA
0 wc1A +
0 2w 3w3c3A3
4Afund =</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Corruption of Narrowband Signals by Interferers
&#131;Wireless receivers must select a desired signal that is 
accompanied by interferers that are often much larger-LNA nonlinearity causes the creation of harmonic and 
intermodulation products-Must remove interference and its products to retrieve desired signalMemoryless
Nonlinearity
xy
w1 0 w2WX(w)Desired
Narrowband
SignalInterferers
0 w1
2w2+w1w2 2w2
2w1-w2 2w1+w2 2w2-w1w1+w2w2-w1 2w1 3w2 3w1WY(w)Corruption of desired signal</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
Harmonic Products with An Input of Two Sine Waves
&#131;DC and fundamental components
&#131;Second and third harmonic terms
&#131;Similar result as having an input with one sine wave-But, we haven&#8217;t yet considered cross terms!
</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
Optimal Noise Factor for MOS Transistor Amp (Cont.)
&#131;Optimal admittance consists of a resistor and 
inductor (wrong frequency behavior &#8211; broadband 
match fundamentally difficult)
-If there is zero correlation, inductor value should be set 
to resonate with Cgsat frequency of operation
&#131;Minimum noise figure
-Exact if one defines wt= gm/Cgs
</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Optimal Source Admittance for Minimum Noise Factor
&#131;After much algebra (see Appendix L of Gonzalez book 
for derivation), we can derive
-Contours of constant noise factor are circles centered 
about (Gopt,Bopt) in the admittance plane-They are also circles on a Smith Chart (see pp 299-302 
of Gonzalez for de rivation and examples)
&#131;How does (Gopt,Bopt) compare to admittance achieving 
maximum power transfer?
</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Take the derivative with respect to source admittance 
and set to zero (to find minimum F), which yields
&#131;Plug these values into expression above to obtainOptimal Source Admittance for Minimum Noise Factor
&#131;Express admittances as the sum of conductance, G, and susceptance, B
</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Noise Factor with Transformer Set for Max Power Transfer
&#131;Total output noise
&#131;Total output noise due to sourceenRs
enRL
RLRS
Vx
1:N=Source
Rin=Rs Rout=RLVnout=          VxRL
Rs
RL
Rs
&#131;Noise Factor
</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Two Tone Test
&#131;Input the sum of two equal amplitude sine waves into 
the amplifier (assume Zinof amplifier = Rsof source)
&#131;On a spectrum analyzer, measure first order and third order terms as A is varied (A must remain small)
-First order term will increase linearly-Third order IM term will increase as the cube of Aw1 0 w2Wvin(w)Equal Amplitude
Sine Waves
0 w1
2w2+w1w2 2w2
2w1-w2 2w1+w2 2w2-w1w1+w2w2-w1 2w1 3w2 3w1WVout(w)first-order output
third-order IM termAmplifier
vinRs
Zin=RsVout
Vbias2AVx
Vout=co+c1Vx+c2Vx+c3Vx23Note:
vx(w) =vin(w)
2</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
Input-Referred Noise Figure Expression
&#131;We know that
&#131;Let&#8217;s express the above in terms of input short circuit 
current
en
inYs is iin,sc=iout
&#946;
</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
Characterization of Intermodulation
&#131;Magnitude of third order products is set by c3and 
input signal amplitude (for small A)
&#131;Magnitude of first order term is set by c1and A (for 
small A)
&#131;Relative impact of intermodulation products can be 
calculated once we know A and the ratio of c3to c1-Problem:  it&#8217;s often hard  to extract the polynomial 
coefficients through direct DC measurements
&#131;Need an indirect way to measure the ratio of c3to c1
</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 8
Noise Figure, Impact of Amplifier Nonlinearities
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
Analysis of Amplifier Nonlinearities
&#131;Focus on memoryless nonlinearity block-The impact of filtering can be added later
&#131;Model nonlinearity as a Taylor series expansion up to 
its third order term (assumes small signal variation)
-For harmonic distortion, consider
-For intermodulation, consider
Memoryless
Nonlinearity
xy
</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Example:  Noise Factor Calculation for Capacitor Load
&#131;Total output noise
&#131;Total output noise due to source
&#131;Noise FactorvinRs
CLSource
voutenRsRsSource
vnoutCL
</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Differential Amplifiers on Nonlinearity
&#131;Assume vxis approximately incremental groundM1 M2
2IbiasvidI1 I2
2-vid
2
vxMemoryless
Nonlinearity
vid Idiff = I2-I1 
&#131;Second order term removed and IIP3 increased!</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Example:  Noise Factor Calculation for Resistor Load
&#131;Total output noise
&#131;Total output noise due to source
&#131;Noise Factor
vinRs
RLSource
voutenRs
enRLRs
RLSource
vnout</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
IIP3 as a Benchmark Specification
&#131;Since IIP3 is a convenient parameter to describe the level 
of third order nonlinearity in an amplifier, it is often 
quoted as a benchmark spec
&#131;Measurement of IIP3 on a discrete amplifier would be 
done using the two-tone method described earlier-This is rarely done on integr ated amplifiers due to poor 
access to the key nodes-Instead, for a radio receiver fo r instance, one would simply 
put in interferers and see how the receiver does
&#131;Note: performance in the presence of interferers is not just a 
function of the amplifier nonlinearity
&#131;Calculation of IIP3 is most easily done using a simulator 
such as Hspice or Spectre-Two-tone method is not necessary &#8211; simply curve fit to a 
third order polynomial-Note:  two-tone can be done in CppSim</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
Noise Factor Expressed in Terms of Admittances
&#131;We can replace voltage and current noise currents 
with impedances and admittances 
iuYcen
Ys is iin,sc=iout
&#946;
</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
Example:  Noise Factor with Zero Source Resistance
&#131;Total output noise
&#131;Total output noise due to source
&#131;Noise Factor
vinRL
CLSource
voutenRLRL
vnoutCL
</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
Recall Noise Factor Comparison Plot From Lecture 7
1 2 3 4 5 6 7 8 9 10012345678
QNoise Factor Scaling CoefficientNoise Factor Scaling Coefficient Versus Q for 0.18 &#181; NMOS Device
c = -j0
c = -j0.55
c = -j1c = -j1
c = -j0.55c = -j0
Minimum across
all values of Q andAchievable values as
a function of Q under
the constraint that
LgCgs1= w o
LgCgs1Note: curves
meet if we 
approximate
Q2+1    Q2</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
Input-Referred Third Order Intercept Point (IIP3) 
&#131;Plot the results of the two-tone test over a range of A 
(where A remains small) on a log scale (i.e., dB)-Extrapolate the results to find the intersection of the 
first and third order terms
-IIP3 defined as the in put power at which the 
extrapolated lines intersect (higher value is better)
&#131;Note that IIP3 is a small signal parameter based on extrapolation, in contrast to the 1-dB compression pointA1-dB1 dB
20log(A)20log(Afund)
Aiip3Third-order
IM termFirst-order
output c3A3 3
4== c1A</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
Optimal Noise Factor for MOS Transistor Amp
&#131;Consider the common source MOS amp (no 
degeneration) considered in Lecture 7-In Tom Lee&#8217;s book (pp. 272- 276), the noise impedances 
are derived as
-The optimal source admittanc e values to minimize noise 
factor are therefore
</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Harmonic Distortion
&#131;Substitute x(t) into polynomial expression
Fundamental Harmonics
&#131;Notice that each harmonic  term, cos(nwt), has an 
amplitude that grows in proportion to An
-Very small for small A, very large for large A</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Memoryless
Nonlinearity
xywA
0 wc1A +
0 2w 3w3c3A3
4Afund =1 dB Compression Point
&#131;Definition:  input signal level 
such that the small-signal 
gain drops by 1 dB-Input signal level is high!A1-dB1 dB
20log(A)20log(Afund)
&#131;Typically calculated from simulation or measurement 
rather than analytically-Analytical model must include many more terms in Taylor 
series to be accurate in this context</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Basics of Wireless Communication</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec19/</lecture_pdf_url>
      <lectureno>19</lectureno>
      <slides>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Noise on Constellation Diagram
&#131;Sampled data values no longer land in exact same 
location across all sample instants
&#131;Decision boundaries remain fixed
&#131;Significant noise causes bit errors to be madeDecision
Boundaries IQ
Decision
Boundaries00 01 11 10
00
01
11
10</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Raised-Cosine Filter Satisfies Nyquist Condition
&#131;In time-p(kTd) = 0 for all k not equal to 0
&#131;In frequency-Fourier transform of p(kTd) is flat-Alternatively: Addition of shifted P(f) centered about k/Td
leads to flat Fourier tr ansform (as shown above)tp(t)
0T d -TdP(f)
0 1/Td -1/T dfNyquist Condition
Observed in FrequencyNyquist Condition
Observed in Time</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>M.H. Perrott MIT OCW
Frequency Domain View of CDMA
&#131;CDMA transmitters broaden data spectra by encoding it 
onto chip sequences
&#131;CDMA receiver correlates with desired transmitter code-Spectra of desired channel r everts to its original width-Spectra of undesired channel remains broad
&#131;Can be &#8220;mostly&#8221; filtered out by lowpassr(t)Sy1(f)
f1/Tc 0Tc
Sx(f)
f1/Tc 0TcTd
1/TdSx1(f)
f0Td
1/Td
Sy2(f)
f1/Tc 0TcSx2(f)
f0Td
1/Tdy1(t) x1(t)
PN1(t)Transmitter 1
y2(t) x2(t)
PN2(t)Transmitter 2y(t)PN1(t)
LowpassSx1(f)</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Frequency-Division Multiple Access (FDMA)
&#131;Place users into different frequency channels
&#131;Two different methods of dealing with transmit/receive of 
a given user-Frequency-division duplexing-Time-division duplexingfChannel
1Channel
2Channel
N</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
Frequency Domain View of AM Transmitter
&#131;Baseband signal is assumed to have a nonzero DC 
component in above diagram-Causes impulse to appear at DC in baseband signal-Transmitter output has an impu lse at the carrier frequency
&#131;For coherent detection, does not provide key information 
about information in baseband signal, and therefore is a waste of power2cos(2 &#960;fot)y(t)Transmitter Output
x(t)
f-fo fo 011fX(f)
0avg(x(t))
f-fo fo 0Y(f)</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
Receiver Filter:  ISI Versus Noise Performance
&#131;Conflicting requirements for receiver lowpass-Low bandwidth desirable to remove receiver noise and 
to reject high frequency components of mixer output-High bandwidth desirable to minimize ISI at receiver 
output2cos(2 &#960;f1t)
2sin(2 &#960;f1t)Lowpassir(t)
Lowpass
qr(t)it(t)
qt(t)2cos(2 &#960;f1t)
2sin(2 &#960;f1t)Baseband
Inputf
fIt(t)
Qt(t)Ir(t)
Qr(t)Receiver
OutputRaised-Cosine
Filter</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
Simplified View
&#131;For discussion to follow, assume that -Transmitter and receiver phases are aligned-Lowpass filters in receiver are ideal-Transmit and receive I/Q sign als are the same except for 
scale factor
&#131;In reality-RF channel adds distortion, causes fading-Signal processing in baseband DSP used to correct 
problemsf
0Receiver Output
2cos(2 &#960;f1t)
2sin(2 &#960;f1t)Lowpassir(t)
Lowpass
qr(t)it(t)
qt(t)It(f)
Qt(f)
f
01
1f
0Ir(f)
Qr(f)
f
022
2cos(2 &#960;f1t)
2sin(2 &#960;f1t)Baseband Input</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
Amplitude Modulation (Transmitter)
&#131;Vary the amplitude of a sine wave at carrier frequency fo
according to a baseband modulation signal
&#131;DC component of baseband modulation signal 
influences transmit signal and receiver possibilities-DC value greater than signal amplitude shown above
&#131;Allows simple envelope detector for receiver
&#131;Creates spurious tone at ca rrier frequency (wasted power)2cos(2 &#960;fot)y(t)Transmitter Output
x(t)0</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
Constellation Diagram
&#131;We can view I/Q values at sample instants on a two-
dimensional coordinate system
&#131;Decision boundaries mark up regions corresponding 
to different data values
&#131;Gray coding used to minimize number of bit errors that occur if wrong decisi on is made due to noiseDecision
Boundaries IQ
Decision
Boundaries00 01 11 10
00
01
11
10</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 19
Basics of Wireless Communication
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
Channel Partitioning Using (Nearly) &#8220;Orthogonal Coding&#8221;
&#131;Consider two correlation cases-Two independent random Bernoulli sequences
&#131;Result is a random Bernoulli sequence-Same Bernoulli sequence
&#131;Result is 1 or -1, depending on relative polarityy(t) x(t)
c(t)1
-1
1
-1
1
-1y(t) x(t)
c(t)1
-1
1
-1
1
-1
y(t) x(t)
c(t)1
-1
1
-1
1
-1y(t) x(t)
c(t)1
-1
1
-1
1
-1A
-AB
-BB
BBBUncorrelated Signals Correlated Signals</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>Constant Envelope Modulation</text>
        </slide>
        <slide>
          <slideno>48</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Phase Modulation on the Output Spectrum
&#131;Spectrum of output is distorted compared to S&#934;mod(f)
&#131;Spurs converted to phase noise&#934;mod(t)&#934;tn(t)Phase/Frequency
modulation Signal
fPhase
Noise
foSout(f)
Overall
phase noise
&#934;out2cos(2 &#960;fot+&#934;out(t))out(t)
f
0S&#934;mod(f)Spurious
Noise
&#934;mod(t)&#934;tn(t)Phase/Frequency
modulation Signal
ffoSout(f)
Overall
phase noise
&#934;out2cos(2 &#960;fot+&#934;out(t))out(t)
f
0S&#934;mod(f)</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Choosing an Appropriate Transmit Filter
&#131;Transmit filter, p(t), convolved with data symbols that are 
viewed as impulses-Example so far:  p(t) is a square pulse
&#131;Output spectrum of transmitter corresponds to square of transmit filter (assuming data has white spectrum)
-Want good spectral efficiency (i.e. narrow spectrum)t tTd
t
|P(f)|2
fdata(t) p(t) x(t)
1/TdSdata(f)
f0 0*
f1/Td 0Sx(f)Td</text>
        </slide>
        <slide>
          <slideno>43</slideno>
          <text>M.H. Perrott MIT OCW
Example Constellation Diagram for Phase Modulation
&#131;I/Q signals must always combine such that amplitude 
remains constant-Limits constellation points to a circle in I/Q plane-Draw decision boundaries about different phase regionsDecision
BoundariesIQ
Decision
Boundaries000
001
011
110111100
101
010</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Having Zero DC Value for Baseband Signal
&#131;Impulse in DC portion of baseband signal is now gone-Transmitter output now is now free from having an 
impulse at the carrier frequency (for ideal 
implementation)2cos(2 &#960;fot)y(t)Transmitter Output
x(t)
f-fo fo 011fX(f)
0avg(x(t))
    =0
f-fo fo 0Y(f)</text>
        </slide>
        <slide>
          <slideno>45</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Recall unmodulated VCO model
&#131;Relationship between sine wave output and instantaneous 
phase
&#131;Impact of modulation-Same as examined with VCO/PLL modeling, but now we 
consider &#934;out(t) as sum of modulation and noise componentsModeling The Impact of VCO Phase Modulation
&#934;mod(t)&#934;tn(t)Phase/Frequency
modulation Signal
fPhase
Noise
foSout(f)
Overall
phase noise
&#934;out2cos(2 &#960;fot+&#934;out(t))out(t)
f
0S&#934;mod(f)Spurious
Noise
</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Quadrature Modulation
&#131;Takes advantage of coherent receiver&#8217;s sensitivity to 
phase alignment with transmitter local oscillator-We essentially have two orthogonal transmission 
channels (I and Q) available to us-Transmit two independent baseband signals (I and Q) onto two sine waves in quadrature at transmitterTransmitter Outputf-fo fo 011
f
0
f
-f1f1
0j
-j2cos(2 &#960;f2t)
2sin(2 &#960;f2t)y(t)it(t)
qt(t)It(f)
Qt(f)
f
0f-fo fo 0111
1
f-fofo
0j
-jYi(f)
Yq(f)</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
2cos(2 &#960;fot)y(t)Transmitter Output
x(t)
f-fo fo 011fX(f)
0
f-fo fo 0Y(f)
2cos(2 &#960;fot)z(t)Lowpassr(t)Receiver Output
y(t)
f-fo fo 011f
-fo fo 0Z(f)
2fo -2foLowpassFrequency Domain View of AM Receiver (Coherent)</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
Highest Spectral Efficiency with Brick-wall Lowpass
&#131;Use a sinc function for transmit filter-Corresponds to ideal lowpass in frequency domain
&#131;Issues-Nonrealizable in practice-Sampling offset causes significant intersymbol interferencet tTd
t
|P(f)|2
fdata(t) p(t) x(t)
1/(2T d)Sdata(f)
f0 0*
f1/(2T d) 0Sx(f)Td0-Td</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
Frequency-Division Duplexing
&#131;Separate frequency channels into transmit and receive 
bands
&#131;Allows simultaneous transmission and reception-Isolation of receiver from tran smitter achieved with duplexer-Cannot communicate directly between users, only between 
handsets and base station
&#131;Advantage: isolates users
&#131;Disadvantage:  deplexer has high insertion loss (i.e. 
attenuates signals passing through it)Transmitter RX TX
fDuplexer Antenna
RXTX
ReceiverTransmit
BandReceive
Band</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
Spectral Efficiency With Raised-Cosine Filter 
&#131;More efficient than when p(t) is a square pulse
&#131;Less efficient than brick-wall lowpass-But implementation is much more practical
&#131;Note:  Raised-cosine P(f) often &#8220;split&#8221; between 
transmitter and receivert
tTd
t
|P(f)|2
fdata(t) p(t) x(t)
1/(2T d)Sdata(f)
f0 0*
f1/(2T d) 0Sx(f)Td0-Td</text>
        </slide>
        <slide>
          <slideno>49</slideno>
          <text>M.H. Perrott MIT OCW
I/Q Model for Phase Modulation
&#131;Applying trigonometric identity
&#131;Can view as I/Q modulation-I/Q components are coupled and related nonlinearly to 
&#934;mod(t)
f
0S&#934;mod(f)
cos(2 &#960;f2t)
sin(2 &#960;f2t)y(t)
-fo fo 0cos(&#934;mod(t))
sin(&#934;mod(t))f
0Sa(f)
Sy(f)it(t)
qt(t)
f
0Sb(f)
f&#934;mod(t)</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>Multiple Access Techniques</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>M.H. Perrott MIT OCW
Frequency Domain View of Chip Vs Data Sequences
&#131;Data and chip sequences operate on different time scales-Associated spectra have different width and heightt tTc
tdata(t) p(t) x(t)
Sdata(f)
f
0*1
-1Tc1
-11
Sx(f) |P(f)|2
f1/Tc 0TcTd
1/Tdf1/Tc 0TcTd
1/Tdt tTd
tdata(t) p(t) x(t)
*1
-11
-11
Td</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
Code-Division Multiple Access (CDMA) 
&#131;Assign a unique code sequence to each transmitter
&#131;Data values are encoded in transmitter output stream by 
varying the polarity of the transmitter code sequence-Each pulse in data sequence has period Td
&#131;Individual pulses repr esent binary data values-Each pulse in code sequence has period Tc
&#131;Individual pulses are called &#8220;chips&#8221;y1(t) x1(t)
PN1(t)
y2(t) x2(t)
PN2(t)y(t)Separate
TransmittersTransmit Signals
Combine
in FreespaceTd
Tc</text>
        </slide>
        <slide>
          <slideno>47</slideno>
          <text>M.H. Perrott MIT OCW
Relationship Between Output and Phase Spectra
&#131;Approximation from previous slide
&#131;Autocorrelation (assume modulation signal 
independent of noise)
&#131;Output spectral density (Fourier transform of autocorrelation)
-Where * represents convolution and
</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Analog Modulation
&#131;I/Q signals take on a cont inuous range of values (as 
viewed in the time domain)
&#131;Used for AM/FM radios, television (non-HDTV), and 
the first cell phones
&#131;Newer systems typically employ digital modulation 
insteadReceiver Output
2cos(2 &#960;f1t)
2sin(2 &#960;f1t)Lowpassir(t)
Lowpass
qr(t)it(t)
qt(t)2cos(2 &#960;f1t)
2sin(2 &#960;f1t)t
tt
tBaseband Input</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
Accompanying Receiver (Coherent Detection)
&#131;Works regardless of DC value of baseband signal
&#131;Requires receiver local oscillator to be accurately 
aligned in phase and frequency to carrier sine wave2cos(2 &#960;fot)y(t)
2cos(2 &#960;fot)z(t)Lowpassr(t)Transmitter Output
Receiver Outputx(t)
y(t)0</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>M.H. Perrott MIT OCW
Receiver Selects Desired Transmitter Through Its Code
&#131;Receiver correlates its input with desired transmitter code-Data from desired transmitter restored-Data from other transmi tter(s) remains randomizedy1(t) x1(t)
PN1(t)
y2(t) x2(t)
PN2(t)
x(t) y(t)Separate
TransmittersTransmit Signals
Combine
in Freespace
Receiver
(Desired Channel = 1)PN1(t)
Lowpassr(t)</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
Derive Nyquist Condition for Avoiding ISI (Step 1)
&#131;Consider multiplying p(t) by impulse train with period Td-Resulting signal must be a single impulse in order to 
avoid ISI (same argument as in previous slide)tp(t)
tTddata(t)
Td
*tx(t)
Td
tp(t)
tTdimpulse train
Td
tp(kTd)
Td</text>
        </slide>
        <slide>
          <slideno>44</slideno>
          <text>M.H. Perrott MIT OCW
Transitioning Between Constellation Points
&#131;Constant-envelope requirement forces transitions to 
allows occur along circle that  constellation points sit on-I/Q filtering cannot be done independently!-Significantly impacts output spectrumDecision
BoundariesIQ
Decision
Boundaries000
001
011
110111100
101
010</text>
        </slide>
        <slide>
          <slideno>46</slideno>
          <text>M.H. Perrott MIT OCW
Relationship Between Sine Wave Output and its Phase
&#131;Key relationship (note we have dropped the factor of 2)
&#131;Using a familiar trigonometric identity
&#131;Approximation given | &#934;tn(t)| &lt;&lt; 1
</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
Time-Division Duplexing
&#131;Use any desired frequency channel for transmitter and 
receiver
&#131;Send transmit and receive signals at different times
&#131;Allows communication directly between users (not necessarily desirable)
&#131;Advantage:  switch has low insertion loss relative to 
duplexer
&#131;Disadvantage:  receiver more sensitive to transmitted signals from other usersTransmitterSwitch Antenna
RXTX
Receiver
switch
control</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Phase Misalignment in Receiver Local Oscillator
&#131;Worst case is when receiver LO and carrier frequency 
are phase shifted 90 degrees with respect to each other-Desired baseband signal is not recovered2cos(2 &#960;fot)y(t)
z(t)Lowpassr(t)Transmitter Output
Receiver Outputx(t)
y(t)0
2sin(2 &#960;fot)</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>M.H. Perrott MIT OCW
The Issue of Power Efficiency
&#131;Power amp dominates power consumption for many wireless 
systems-Linear power amps more power consuming than nonlinear ones
&#131;Constant-envelope modulation allows nonlinear power amp-Lower power consumption possibleBaseband to RF
ModulationPower Amp
Transmitter
OutputBaseband
Input
Variable-Envelope Modulation Constant-Envelope Modulation</text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>M.H. Perrott MIT OCW
Simplified Implementation for Constant-Envelope
&#131;Constant-envelope modulati on limited to phase and 
frequency modulation methods
&#131;Can achieve both phase and fr equency modulation with 
ideal VCO-Use as model for analysis purposes-Note: phase modulation nearly im possible with practical VCOBaseband to RF Modulation Power Amp
Transmitter
OutputBaseband
Input
Constant-Envelope ModulationTransmit
Filter</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
The Issue of Multiple Access
&#131;Want to allow communicatio n between many different 
users
&#131;Freespace spectrum is a shared resource-Must be partitioned between users
&#131;Can partition in either time, frequency, or through 
&#8220;orthogonal coding&#8221; (or nearly orthogonal coding) of 
data signals</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Digital Modulation
&#131;I/Q signals take on discrete values at discrete time 
instants corresponding to digital data-Receiver samples I/Q channels 
&#131;Uses decision boundaries to ev aluate value of data at 
each time instant
&#131;I/Q signals may be binary or multi-bit-Multi-bit shown aboveReceiver Output
2cos(2 &#960;f1t)
2sin(2 &#960;f1t)Lowpassir(t)
Lowpass
qr(t)it(t)
qt(t)2cos(2 &#960;f1t)
2sin(2 &#960;f1t)t
ttBaseband Input
tDecision
Boundaries Sample
Times</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
Impact of 90 Degree Phase Misalignment
&#131;I and Q channels are swapped at receiver if its LO 
signal is 90 degrees out of phase with transmitter-However, no information is lost!-Can use baseband signal pr ocessing to extract I/Q 
signals despite phase offset  between transmitter and 
receiverTransmitter Outputf-fo fo 011
f
0Receiver Output
f
-f1f1
0j
-j2cos(2 &#960;f1t)2sin(2 &#960;f1t) y(t)ir(t)
qr(t)2cos(2 &#960;f2t)
2sin(2 &#960;f2t)y(t)it(t)
qt(t)It(f)
Qt(f)
f
0f-fo fo 0111
1
f-fofo
0j
-jYi(f)
Yq(f)
f-fo fo 011f
-f1f1
0j
-j
f
0Ir(f)
Qr(f)
f
022</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Derive Nyquist Condition for Avoiding ISI (Step 2)
&#131;In frequency domain, the Fourier transform of sampled 
p(t) must be flat to avoid ISI-We see this in two ways for above example
&#131;Fourier transform of an impulse is flat
&#131;Convolution of P(f) with impu lse train in frequency is flat *
tp(t)
tTdimpulse train
Td
tp(kTd)
TdfP(f)
fimpulse train
f1/Td
1/Td1/Td
0F{p(kTd)}</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
Requirement for Transmit Filter to Avoid ISI
&#131;Time samples of transmit filter (spaced Tdapart) must 
be nonzero at only one sample time instant-Sinc function satisfies this criterion if we have no offset 
in the sample times
&#131;Intersymbol interference (ISI) occurs otherwise
&#131;Example:  look at result of convolving p(t) with 4 
impulses-With zero sampling offset, x(kTd) correspond to 
associated impulse areastp(t)
tTddata(t)
Td
*tx(t)
Td</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Split Raised-Cosine Filter Between Transmitter/Receiver
&#131;We know that passing data through raised-cosine 
filter does not cause additional ISI to be produced-Implement P(f) as cascade of two filters corresponding 
to square root of P(f)
&#131;Place one in transmitter, the other in receiver
&#131;Use additional lowpass filte ring in receiver to further 
reduce high frequency noise and mixer productsf
2cos(2 &#960;f1t)
2sin(2 &#960;f1t)ir(t)
qr(t)it(t)
qt(t)2cos(2 &#960;f1t)
2sin(2 &#960;f1t)Baseband
Inputf
fIt(t)
Qt(t)Ir(t)
Qr(t)f
f fReceiver
OutputRaised-Cosine
FilterRaised-Cosine
FilterAdditional
Lowpass
Filtering
</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
Transition Behavior Between Constellation Points
&#131;Constellation diagrams provide us with a snapshot of I/Q 
signals at sample instants
&#131;Transition behavior between sample points depends on 
modulation scheme and transmit filterDecision
Boundaries IQ
Decision
Boundaries00 01 11 10
00
01
11
10</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
Accompanying Receiver
&#131;Demodulate using two sine waves in quadrature at 
receiver-Must align receiver LO signals  in frequency and phase to 
transmitter LO signals
&#131;Proper alignment allows I and Q signals to be recovered as 
shownTransmitter Outputf-fo fo 011
f
0Receiver Output
f
-f1f1
0j
-j2cos(2 &#960;f1t)
2sin(2 &#960;f1t)y(t)Lowpassir(t)
Lowpass
qr(t)2cos(2 &#960;f2t)
2sin(2 &#960;f2t)y(t)it(t)
qt(t)It(f)
Qt(f)
f
0f-fo fo 0111
1
f-fofo
0j
-jYi(f)
Yq(f)f-fo fo 011
f
-f1f1
0j
-jf
0Ir(f)
Qr(f)
f
022</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Advantages of Digital Modulation
&#131;Allows information to be &#8220;packetized&#8221;-Can compress information in time and efficiently send 
as packets through network-In contrast, analog modulation requires &#8220;circuit-
switched&#8221; connections that are continuously available
&#131;Inefficient use of radio channel if there is &#8220;dead time&#8221; in information flow
&#131;Allows error correction to be achieved-Less sensitivity to radio channel imperfections
&#131;Enables compression of information-More efficient use of channel
&#131;Supports a wide variety of information content-Voice, text and email m essages, video can all be 
represented as digital bit streams</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
A More Practical Transmit Filter
&#131;Transition band in frequency set by &#8220;rolloff&#8221; factor, &#945;
&#131;Rolloff factor = 0:  P(f) becomes a brick-wall filter
&#131;Rolloff factor = 1:  P(f) looks nearly like a triangle
&#131;Rolloff factor = 0.5:  shown above 
tp(t)
0T d -TdP(f)
0 1/Td -1/T df2Td1+&#945;
2Td1-&#945;&#131;Raised-cosine filter is quite popular in many applications</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text></text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Zero DC Value
&#131;Envelope of modulated sine wave no longer 
corresponds directly to the baseband signal-Envelope instead follows th e absolute value of the 
baseband waveform-Envelope detector can no longer be used for receiver
&#131;The good news:  less transmit power required for same transmitter SNR (compared to nonzero DC value)2cos(2 &#960;fot)y(t)Transmitter Output
x(t)0</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Impact of 90 Degree Phase Misalignment
2cos(2 &#960;fot)y(t)Transmitter Output
x(t)
f-fo fo 011fX(f)
0
f-fo fo 0Y(f)
2sin(2 &#960;fot)z(t)Lowpassr(t)Receiver Output
 = 0
y(t)f
-fo fo0Z(f)
2fo
-2foLowpass
f
-f1f1
0j
-j</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Noise in Voltage Controlled Oscillators</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec12/</lecture_pdf_url>
      <lectureno>12</lectureno>
      <slides>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Separation into Amplitude and Phase Noise
&#131;Equipartition theorem (see Tom Lee, p 534) states that 
noise impact splits evenly between amplitude and phase 
for Vsigbeing a sine wave-Amplitude variations suppressed by feedback in oscillatorIdeal Tank
Lp CpNoise Due to Active
Negative Resistance
Vout inRn inRpNoise from TankZtank
A AVsig vout
t tVout
tAmplitude
Noise
Phase
Noise
</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
Parameterize Phase Impulse Response in Terms of ISF
h&#934;(t,&#964;)iin(t)&#934; out(t)
&#964;ot t&#964;oVout(t)
t
Vout(t)
t
Vout(t)
t
Vout(t)
t
Vout(t)
tt2iin(t)
t
t3iin(t)
tt0iin(t)
t
t1iin(t)
t
t4iin(t)
t&#915;(2&#960;fot)
tqmax
TT
qmax
qmaxqmax
qmax&#8710;&#934;
&#8710;&#934;
&#8710;&#934;
&#8710;&#934;&#8710;&#934;=0
</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
Measurement of Spurious Noise in dBc
&#131;Definition of dBc
-We are assuming double sided spectra, so integrate over 
positive and negative frequencies to get power
&#131;Either single or double-sided spectra can be used in practice
&#131;For this case
Sout(f)
f-fo fodBc1
fspur21dspur
fspur2</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Phase Noise of A Practical Oscillator
&#131;Phase noise drops at -20 dB/decade over a wide 
frequency range, but deviates from this at:-Low frequencies &#8211; slope increases (often -30 dB/decade)-High frequencies &#8211; slope flatte ns out (oscillator tank does 
not filter all noise sources)
&#131;Frequency breakpoints and magnitude scaling are not readily predicted by the analysis approach taken so farL(&#8710;f)
log(&#8710;f)-20 dB/decade-30 dB/decade
&#8710;f1/f3 fo
2Q2FkT
Psig10log( (</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Equivalent Model for Noise Calculations
Resonator
Lp Rp Cp = -RpActive Negative
Resistance
-Gm1Zres Zactive
Vout inRn inRp
Compensated Resonator with Noise from Tank
Lp Rp Cp = -RpNoise Due to Active
Negative Resistance
-Gm1Vout inRn inRp
Ideal Tank
Lp CpNoise Due to Active
Negative Resistance
Vout inRn inRpNoise from TankZtank</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
A Convenient Parameterization of LC Tank Impedance
&#131;Actual tank has loss that is modeled with Rp-Define Q according to actual tank
&#131;Parameterize ideal tank impedance in terms of Q of 
actual tankLp CpZtank
</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>M.H. Perrott MIT OCW
f
-foSX(f)
0in2
fo 2fo -2fo 3fo -3fo2&#8710;f
in(t)
2cos(2 &#960;fot + &#952;1)
2cos(2(2 &#960;fo)t + &#952;2)
2cos(3(2 &#960;)fot + &#952;n)1
qmaxA
B
C
D1
qmax2
1
f
-fo fo1((
f
-foSA(f)
0f oin2
2&#8710;f1
qmax2((
f
-foSB(f)
0f oin2
2&#8710;f1
qmax2(( 2
f
-foSC(f)
0f oin2
2&#8710;f1
qmax2(( 2
f
-foSD(f)
0f oin2
2&#8710;f1
qmax2(( 22X 2
1
f
2fo -2fo11
f
0
1
f
-3fo1
3fois the single-sided
noise spectral density Note thatin2
&#8710;f
in(t)of1/f noiseThe Impact of 1/f Noise in Input Current (Part 1)</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Illustration of Time-Varying Impact of Noise on Phase
&#131;High impact on phase when impul se occurs close to the zero 
crossing of the VCO output
&#131;Low impact on phase when impulse occurs at peak of outputVout(t)
t
Vout(t)
t
Vout(t)
t
Vout(t)
t
Vout(t)
tt2iin(t)
t
t3iin(t)
tt0iin(t)
t
t1iin(t)
t
t4iin(t)
tqmaxT
qmax
qmaxqmax
qmax&#8710;&#934;
&#8710;&#934;
&#8710;&#934;
&#8710;&#934;&#8710;&#934;=0</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Output Phase Noise in 1/f3region
&#131;From the previous slide
&#131;Assume that input current has 1/f noise with corner 
frequency f1/f
&#131;Corresponding output phase noise
</text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Oscillator Waveform on 1/f3Phase Noise
&#131;Key Fourier series coefficient of ISF for 1/f3noise is co-If DC value of ISF is zero, cois also zero
&#131;For symmetric oscillator output waveform-DC value of ISF is zero &#8211; no upconversion of flicker noise!  
(i.e. output phase noise does not have 1/f3region)
&#131;For asymmetric oscillator output waveform-DC value of ISF is nonze ro &#8211; flicker noise has impactVout(t)
t
t&#915;(2&#960;fot)ISF for Symmetric Waveform ISF for Asymmetric Waveform
Vout(t)
t
t&#915;(2&#960;fot)</text>
        </slide>
        <slide>
          <slideno>43</slideno>
          <text>M.H. Perrott MIT OCW
Issue &#8211; We Have Ignored Modulation of Current Noise
&#131;In practice, transistor generated noise is modulated by 
the varying bias conditions of its associated transistor-As transistor goes from saturat ion to triode to cutoff, its 
associated noise changes dramatically
&#131;Can we include this issue in the LTV framework?Lp1 Rp1 Cp1
M1
IbiasM2
VsVout VoutLp2 Rp2 Cp2
A A
inM1 inM2
M3inM3 VbiasinRp2 inRp1
Tank generated
noiseTank generated
noise
Transistor generated
noiseTransistor generated
noise</text>
        </slide>
        <slide>
          <slideno>46</slideno>
          <text>M.H. Perrott MIT OCW
Colpitts Oscillator Provides Optimal Placement of &#945;
&#131;Current is injected into tank at bottom portion of VCO 
swing-Current noise accompanying current has minimal 
impact on VCO output phaseI1(t)
C1
IbiasM1Vbias
C2L
t&#945;(2&#960;fot)T = 1/fo
0Vout(t)Vout(t)
t
t&#915;(2&#960;fot)I1(t)</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Calculate Impedance Across Ideal LC Tank Circuit
&#131;Calculate input impedance about resonance
= 0 negligible
Lp CpZtank
</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
Phase Noise Calculation for White Noise Input (Part 2)
A
B
C
Df
-foSA(f)
0 foin2
2&#8710;f1
qmax2((
f
-foSB(f)
0f oin2
2&#8710;f1
qmax2(( 2
f
-foSC(f)
0f oin2
2&#8710;f1
qmax2(( 2
f
-foSD(f)
0f oin2
2&#8710;f1
qmax2(( 22 1
j2&#960;f&#934;out(t)
2cos(2 &#960;fot+&#934;out(t))out(t)ISF Fourier
Series Coefficients IntegratorPhase to
Output Voltage
c1
2
c3
2c2
2co
2
</text>
        </slide>
        <slide>
          <slideno>53</slideno>
          <text>M.H. Perrott MIT OCW
Use Inductor to Increase Impedance at Node Vs
&#131;Voltage at node Vsis a 
rectified version of 
oscillator output-Fundamental component 
is at twice the oscillation frequency
&#131;Place inductor between Vs
and current source-Choose value to resonate with C
fand parasitic 
source capacitance at frequency 2f
o
&#131;Impedance of tank not 
degraded by M1and M2-Q preserved!Lp1 Rp1 Cp1
M1 M2
VsVout Vout A
Ibias
M3VbiasinM3Lf
CfT = 1/f oHigh impedance
at frequency 2f o</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Intrinsic Phase Noise in Oscillators
&#131;Noise sources in oscillators are put in two categories-Noise due to tank loss-Noise due to active negative resistance
&#131;We want to determine how these noise sources 
influence the phase noise of the oscillatorZres
Active
Negative
Resistance
GeneratorResonatorZactive
Resonator
Lp Rp CpVout
= -RpActive Negative
Resistance
-Gm1Zres Zactive
Vout inRn inRp</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
Fill in Expressions 
&#131;Noise from tank is due to resistor Rp
&#131;Ztank(&#8710;f) found previously
&#131;Output noise spectral density expression (single-sided)Ideal Tank
Lp CpNoise Due to Active
Negative Resistance
Vout inRn inRpNoise from TankZtank
</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
The Actual Situation is Much More Complicated
&#131;Impact of tank generated noise easy to assess
&#131;Impact of transistor generated noise is complicated-Noise from M1and M2is modulated on and off-Noise from M3is modulated before influencing Vout-Transistors have 1/f noise
&#131;Also, transistors can degrade Q of tankLp1 Rp1 Cp1
M1
IbiasM2
VsVout VoutLp2 Rp2 Cp2
A A
inM1 inM2
M3inM3 VbiasinRp2 inRp1
Tank generated
noiseTank generated
noise
Transistor generated
noiseTransistor generated
noise</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
Output Spectrum with Phase Noise
&#131;Suppose input noise to VCO (vn(t)) is bandlimited, 
non-periodic noise with spectrum Svn(f)-In practice, derive phase spectrum as
&#131;Resulting output spectrum
S&#934;out(f) Ssin(f)
f-fo fof *
S&#934;out(f)Sout(f)
f-fo fo1
1
dBc/Hz</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Measurement of Phase Noise in dBc/Hz
&#131;Definition of L(f)
-Units are dBc/Hz
&#131;For this case
-Valid when &#934;out(t) is small in deviation (i.e., when carrier 
is not modulated, as currently assumed)
S&#934;out(f)Sout(f)
f-fo fo1
dBc/Hz</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of 1/f3Corner Frequency
L(&#8710;f)
log(&#8710;f)-20 dB/decade-30 dB/decade
&#8710;f1/f3 fo
2Q2FkT
Psig10log( ((A)
(B)
(B)(A)
(A) =(B)at:</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
Spectral Density of Phase Signal
&#131;From the previous slide
&#131;Substitute in for SA(f), SB(f), etc.
&#131;Resulting expression
</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
Example:  Active Noise Same as Tank Noise
&#131;Noise factor for oscillator in this case is
&#131;Resulting phase noise
Resonator
Lp Rp Cp = -RpActive Negative
Resistance
-Gm1Vout inRn inRp
L(&#8710;f)
log(&#8710;f)-20 dB/decade
</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Define Impulse Sensitivity Function (ISF) &#8211;&#915;(2&#960;fot)
&#131;ISF constructed by calculating phase deviations as 
impulse position is varied-Observe that it is periodic wi th same period as VCO outputVout(t)
t
Vout(t)
t
Vout(t)
t
Vout(t)
t
Vout(t)
tt2iin(t)
t
t3iin(t)
tt0iin(t)
t
t1iin(t)
t
t4iin(t)
t&#915;(2&#960;fot)
tqmax
TT
qmax
qmaxqmax
qmax&#8710;&#934;
&#8710;&#934;
&#8710;&#934;
&#8710;&#934;&#8710;&#934;=0</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 12
Noise in Voltage Controlled Oscillators
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>M.H. Perrott MIT OCW
The Impact of 1/f Noise in Input Current (Part 2)
A
B
C
D1
j2&#960;f&#934;out(t)
2cos(2 &#960;fot+&#934;out(t))out(t)ISF Fourier
Series Coefficients IntegratorPhase to
Output Voltage
c1
2
c3
2c2
2co
2f
-foSA(f)
0f oin2
2&#8710;f1
qmax2((
f
-foSB(f)
0f oin2
2&#8710;f1
qmax2(( 2
f
-foSC(f)
0f oin2
2&#8710;f1
qmax2(( 2
f
-foSD(f)
0f oin2
2&#8710;f1
qmax2(( 22
</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Examples of ISF for Different VCO Output Waveforms
&#131;ISF (i.e., &#915;) is approximately proportional to derivative 
of VCO output waveform-Its magnitude indicates where VCO waveform is most 
sensitive to noise current in to tank with respect to 
creating phase noise
&#131;ISF is periodic
&#131;In practice, derive it from simulation of the VCOVout(t)
t
t&#915;(2&#960;fot)Vout(t)
t
t&#915;(2&#960;fot)Example 1 Example 2</text>
        </slide>
        <slide>
          <slideno>45</slideno>
          <text>M.H. Perrott MIT OCW
Placement of Current Modulation for Best Phase Noise
&#131;Phase noise expression (ignoring 1/f noise)
&#131;Minimum phase noise achieved by minimizing sum of 
square of Fourier series coefficients (i.e. rms value of &#915;eff)t&#945;(2&#960;fot)T = 1/fo
0
&#915;(2&#960;fot)t&#945;(2&#960;fot)T = 1/fo
0
&#915;(2&#960;fot)
t tBest Placement of Current
Modulation for Phase NoiseWorst Placement of Current
Modulation for Phase Noise
</text>
        </slide>
        <slide>
          <slideno>48</slideno>
          <text>M.H. Perrott MIT OCW
Alternate Approach for Negative Resistance Oscillator
&#131;Recall Leeson&#8217;s formula
-Key question:  how do you determine F( &#8710;f)?Lp1 Rp1 Cp1
M1 M2
VsVout VoutLp2 Rp2 Cp2
A A
Ibias
M3Vbias
</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
Overall Noise Output Spectral Density
&#131;Assume noise from active negative resistance element 
and tank are uncorrelated
-Note that the above expression represents total noise that 
impacts both amplitude and phase of oscillator outputIdeal Tank
Lp CpNoise Due to Active
Negative Resistance
Vout inRn inRpNoise from TankZtank
</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Output Spectral Density
&#131;Calculate autocorrelation
&#131;Take Fourier transform to get spectrum
-Note that * symbol corresponds to convolution
&#131;In general, phase spectral density can be placed into 
one of two categories-Phase noise &#8211; &#934;out(t) is non-periodic-Spurious noise - &#934;out(t) is periodic
</text>
        </slide>
        <slide>
          <slideno>44</slideno>
          <text>M.H. Perrott MIT OCW
Inclusion of Current Noise Modulation
&#131;Recall
&#131;By inspection of figure
&#131;We therefore apply previous framework with ISF as
t&#945;(2&#960;fot)T = 1/fo
0h&#934;(t,&#964;)iin(t)&#934; out(t) in(t)
&#945;(2&#960;fot)</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
VCO Model for Noise Analysis
&#131;We will focus on phase noise (and its associated jitter)-Model as phase signal in output sine waveformvin(t) vc(t)vn(t)PLL dynamics
set VCO
carrier frequency
(assume noiseless
for now)fPhase
Noise
fotJitter Time-domain view
Frequency-domain viewout(t)
Sout(f)
Extrinsic
noise
Intrinsic
noise
2&#960;Kv
s&#934;out&#934;vn(t)
2cos(2 &#960;fot+&#934;out(t))out(t)
Note:  Kvunits are Hz/V</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
Modeling of Phase and Amplitude Perturbations
&#131;Characterize impact of curre nt noise on amplitude and 
phase through their associated impulse responses-Phase deviations are accumulated-Amplitude deviations are suppressedIdeal Tank
Lp Cp Vout iin
h&#934;(t,&#964;)iin(t)
&#964;oiin(t)
t t&#964;oAVout
tAmplitude
Noise
Phase
Noise
hA(t,&#964;)iin(t) A(t)
&#964;oiin(t)
t tA(t)
&#964;oAmplitudePhase
&#934;out(t)&#934;out(t)</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
Block Diagram of LTV Phase Noise Expression
&#131;Noise from current source is mixed down from different 
frequency bands and scaled according to ISF coefficientsin(t)
2cos( 2&#960;fot + &#952;1)
2cos(2( 2&#960;fo)t + &#952;2)
2cos(n 2&#960;fot + &#952;n)1
j2&#960;f&#934;out(t)
2cos(2 &#960;fot+&#934;out(t))out(t)1
qmaxISF Fourier
Series Coefficients
2IntegratorPhase to
Output VoltageInput Current
Normalization
c1
2
cn
2c2
2co
2</text>
        </slide>
        <slide>
          <slideno>49</slideno>
          <text>M.H. Perrott MIT OCW
F(&#8710;f) Has Been Determined for This Topology
&#131;Rael et. al. have come up with a closed form 
expression for F( &#8710;f) for the above topology
&#131;In the region where phase noise falls at -20 dB/dec:Lp1 Rp1 Cp1
M1 M2
VsVout VoutLp2 Rp2 Cp2
A A
Ibias
M3Vbias
</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>M.H. Perrott MIT OCW
Output Phase Noise
&#131;We now know
&#131;Resulting phase noiseS&#934;out(f)
fS&#934;out(f)Sout(f)
f-fo fo1
dBc/Hz
&#8710;f00
</text>
        </slide>
        <slide>
          <slideno>50</slideno>
          <text>M.H. Perrott MIT OCW
References to Rael Work
&#131;Phase noise analysis-J.J. Rael and A.A. Abidi, &#8220;P hysical Processes of Phase 
Noise in Differential LC Oscillators&#8221;, Custom Integrated 
Circuits Conference, 2000, pp 569-572
&#131;Implementation-Emad Hegazi et. al., &#8220;A Filter ing Technique to Lower LC 
Oscillator Phase Noise&#8221;, JSSC, Dec 2001, pp 1921-1930</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Single-Sided Version
&#131;Definition of L(f) remains the same
-Units are dBc/Hz
&#131;For this case
-So, we can work with either one-sided or two-sided 
spectral densities since L(f) is set by ratio of noise 
density to carrier power
S&#934;out(f)Sout(f)
ffo1
dBc/Hz</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
A More Sophisticated Analysis Method
&#131;Our concern is what happ ens when noise current 
produces a voltage across the tank-Such voltage deviations give rise to both amplitude and 
phase noise-Amplitude noise is suppressed  through feedback (or by 
amplitude limiting in following buffer stages)
&#131;Our main concern is phase noise
&#131;We argued that impact of noise divides equally 
between amplitude and phase for sine wave outputs-What happens when we have a non-sine wave output?Ideal Tank
Lp Cp Vout iinAVout
tAmplitude
Noise
Phase
Noise</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
VCO Noise in Wireless Systems
&#131;VCO noise has a negative impact on system performance-Receiver &#8211; lower sensitivity,  poorer blocking performance-Transmitter &#8211; increased spectral emissions (output spectrum 
must meet a mask requirement)
&#131;Noise is characterized in frequency domainZin
Zo LNA To FilterFrom Antenna
and Bandpass
FilterPC board
trace
Package
Interface
LO signalMixer
RF in IF out
Frequency
SynthesizerReference
FrequencyVCO
fPhase
Noise
fo</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
VCO Noise in High Speed Data Links
&#131;VCO noise also has a negative impact on data links-Receiver &#8211; increases bit error rate (BER)-Transmitter &#8211; increases jitter on data stream (transmitter 
must have jitter below a specified level)
&#131;Noise is characterized in the time domainZin
Zo AmpFrom Broadband
TransmitterPC board
trace
Package
InterfaceIn Clock and
Data 
RecoveryData
Clk
Loop
FilterPhase
DetectorData Out
Data In Clk Out
VCOJitter</text>
        </slide>
        <slide>
          <slideno>47</slideno>
          <text>M.H. Perrott MIT OCW
Summary of LTV Phase Noise Analysis Method
&#131;Step 1:  calculate the impul se sensitivity function of 
each oscillator noise source using a simulator
&#131;Step 2:  calculate the noise current modulation 
waveform for each oscillator noise source using a 
simulator
&#131;Step 3:  combine above results to obtain &#915;eff(2&#960;fot) for 
each oscillator noise source
&#131;Step 4:  calculate Fourier series coefficients for each 
&#915;eff(2&#960;fot)
&#131;Step 5:  calculate spectral density of each oscillator 
noise source (before modulation)
&#131;Step 6:  calculate overall output phase noise using the results from Step 4 and 5 and the phase noise 
expressions derived in this lecture (or the book)</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Parameterize Noise Output Spectral Density
&#131;From previous slide
&#131;F(&#8710;f) is defined asIdeal Tank
Lp CpNoise Due to Active
Negative Resistance
Vout inRn inRpNoise from TankZtank
F(&#8710;f)
</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
Output Spectrum with Spurious Noise
&#131;Suppose input noise to VCO is
&#131;Resulting output spectrum
S&#934;out(f) Ssin(f)
Sout(f)f-fo fof
f-fo fofspur -fspur21
*dspur
fspur
dBc1
12
fspur21dspur
fspur2</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
Output Phase Noise Spectrum (Leeson&#8217;s Formula)
&#131;All power calculations are refe renced to the tank loss 
resistance, Rp
Ideal Tank
Lp CpNoise Due to Active
Negative Resistance
Vout inRn inRpNoise from TankZtank
fL(&#8710;f)
foCarrier impulse
area normalized to
a value of one
&#8710;fOutput Spectrum
SVsig(f)</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Noise Current is Time-Varying
&#131;If we vary the time at which the current impulse is 
injected, its impact on phase and amplitude changes-Need a time-varying modelIdeal Tank
Lp Cp Vout iin
h&#934;(t,&#964;)iin(t)
&#964;ot&#964;1t&#964;o&#964;1AVout
tAmplitude
Noise
Phase
Noise
hA(t,&#964;)iin(t) A(t)
&#964;ot&#964;1t&#964;o&#964;1AmplitudePhase iin(t)
iin(t) A(t)&#934;out(t)&#934;out(t)</text>
        </slide>
        <slide>
          <slideno>51</slideno>
          <text>M.H. Perrott MIT OCW
Designing for Minimum Phase Noise
&#131;To achieve minimum phase noise, we&#8217;d like to 
minimize F( &#8710;f)
&#131;The above formulation provid es insight of how to do 
this-Key observation: (C)is often quite significantLp1 Rp1 Cp1
M1 M2
VsVout Vout A
Ibias
M3Vbias
(C) (B) (A)
(A) Noise from tank resistance
(B) Noise from M1and M2
(C) Noise from M3</text>
        </slide>
        <slide>
          <slideno>56</slideno>
          <text>M.H. Perrott MIT OCW
Current-Limited Versus Voltage-Limited Regimes
&#131;Current-limited regime:  amplitude given by
&#131;Voltage-limited regime:  amplitude saturatedLp1 Rp1 Cp1
M1 M2
VsVout Vout A
Ibias(B)
&#131;Oscillation amplitude, A, 
cannot be increased above 
supply imposed limits
&#131;If Ibiasis increased above the 
point that A saturates, then 
(B)increases
Best phase noise achieved at boundary between these regimes!</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
Noise Sources Impacting VCO
&#131;Extrinsic noise-Noise from other circuits (including PLL)
&#131;Intrinsic noise-Noise due to the VCO circuitryvin(t) vc(t)vn(t)PLL dynamics
set VCO
carrier frequency
(assume noiseless
for now)fPhase
Noise
fotJitter Time-domain view
Frequency-domain viewout(t)
Sout(f)
Extrinsic
noise
out(t)Intrinsic
noise</text>
        </slide>
        <slide>
          <slideno>52</slideno>
          <text>M.H. Perrott MIT OCW
Elimination of Component (C)in F(&#8710;f)
&#131;Capacitor Cfshunts 
noise from M3away from 
tank-Component (C)is 
eliminated!
&#131;Issue &#8211; impedance at 
node Vsis very low-Causes M1and M2to 
present a low 
impedance to tank during portions of the VCO cycle
&#131;Q of tank is degradedLp1 Rp1 Cp1
M1 M2
VsVout Vout A
Ibias
M3VbiasinM3Cf</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
Phase Noise Analysis Using LTV Framework
&#131;Computation of phase deviation for an arbitrary noise 
current input
&#131;Analysis simplified if we describe ISF in terms of its Fourier series (note: c
ohere is different than book)h&#934;(t,&#964;) in(t) &#934;out(t)
</text>
        </slide>
        <slide>
          <slideno>54</slideno>
          <text>M.H. Perrott MIT OCW
Designing for Minimum Phase Noise &#8211; Next Part
&#131;Let&#8217;s now focus on component (B)-Depends on bias current and oscillation amplitude
(C) (B) (A)
(A) Noise from tank resistance
(B) Noise from M1and M2
(C) Noise from M3Lp1 Rp1 Cp1
M1 M2
VsVout Vout A
Ibias
M3VbiasinM3Lf
CfT = 1/f oHigh impedance
at frequency 2f o</text>
        </slide>
        <slide>
          <slideno>57</slideno>
          <text>M.H. Perrott MIT OCW
Final Comments
&#131;Hajimiri method useful as a numerical procedure to 
determine phase noise-Provides insights into 1/ f noise upconversion and 
impact of noise current modulation
&#131;Rael method useful for CMOS negative-resistance 
topology-Closed form solution of phase noise!-Provides a great deal of design insight
&#131;Another numerical method-Spectre RF from Cadence now does a reasonable job of 
estimating phase noise for many oscillators
&#131;Useful for verifying design ideas and calculations</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Phase Noise of A Practical Oscillator
&#131;Leeson proposed an ad hoc modification of the phase 
noise expression to capture the above noise profile
-Note:  he assumed that F( &#8710;f) was constant over frequencyL(&#8710;f)
log(&#8710;f)-20 dB/decade-30 dB/decade
&#8710;f1/f3 fo
2Q2FkT
Psig10log( (
</text>
        </slide>
        <slide>
          <slideno>55</slideno>
          <text>M.H. Perrott MIT OCW
Minimization of Component (B)in F(&#8710;f)
&#131;So, it would seem that Ibiashas no effect!-Not true &#8211; want to maximize A (i.e. Psig) to get best phase 
noise, as seen by:Lp1 Rp1 Cp1
M1 M2
VsVout Vout A
Ibias(B)
&#131;Recall from Lecture 11
</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
Phase Noise Calculation for White Noise Input (Part 1)
f
-foSX(f)
0in2
fo 2fo -2fo 3fo -3fo2&#8710;f
in(t)
2cos(2 &#960;fot + &#952;1)
2cos(2(2 &#960;fo)t + &#952;2)
2cos(3(2 &#960;)fot + &#952;n)1
qmaxA
B
C
D1
qmax2
1
f
-fo fo1((
f
-foSA(f)
0 foin2
2&#8710;f1
qmax2((
f
-foSB(f)
0f oin2
2&#8710;f1
qmax2(( 2
f
-foSC(f)
0f oin2
2&#8710;f1
qmax2(( 2
f
-foSD(f)
0f oin2
2&#8710;f1
qmax2(( 22X 2
1
f
2fo -2fo11
f
0
1
f
-3fo1
3fois the single-sided
noise spectral density Note thatin2
&#8710;f
in(t)of</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
Simplified Relationship Between &#934;outand Output
&#131;Using a familiar trigonometric identity
&#131;Given that the phase noise is small
vin(t) vc(t)vn(t)PLL dynamics
set VCO
carrier frequency
(assume noiseless
for now)Extrinsic
noise
Intrinsic
noise
2&#960;Kv
s&#934;out&#934;vn(t)
2cos(2 &#960;fot+&#934;out(t))out(t)</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Voltage Controlled Oscillators</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec11/</lecture_pdf_url>
      <lectureno>11</lectureno>
      <slides>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Oscillator Swing as a Function of Ibias
&#131;By symmetry, assume I1(t) is a square wave-We are interested in determining fundamental component
&#131;(DC and harmonics filtered by tank)
-Fundamental component is
-Resulting oscillator amplitude
f
T1t
T TW=T/2
Ibias/2Ibias/2I1(t)
Ibias&#960;1
3&#960;1|I1(f)|
IbiasIbias
Ibias
W1</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Leveraging Amplifier Nonlinearity as Feedback
&#131;As input amplitude is increased-Effective gain from input to fundamental of output drops-Amplitude feedback occurs!  (GmRp= 1 in steady-state)0 woW
0 wo 2wo 3woWZ(jw)-Gm
-1 0 VoutVx Ix
|Vx(w)|
|Ix(w)|A
GmAAGmA
Gm
AGmRp=1</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Analysis of Negative Resistance Oscillator (Step 1)
&#131;Derive a parallel RLC network that includes the loss of 
the tank inductor and capacitor-Typically, such loss is domina ted by series resistance in 
the inductorLp1 Rp1 Cp1
M1
IbiasM2
VsVout VoutLp2 Rp2 Cp2
Narrowband
parallel RLC
model for tankM1L2
C2
IbiasL1
M2 C1
VsVout VoutRL2 RL1
RC1 RC2</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Different GmValues
&#131;Root locus plot allows us to view closed loop pole 
locations as a function of open loop poles/zero and 
open loop gain (GmRp)-As gain (GmRp) increases, closed loop poles move into 
right half S-planeOpen Loop
Resonator
Poles and Zero
Locus of
Closed Loop
Pole LocationsIncreasing GmRpjw
&#963;S-plane</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
VCO Design for Wireless Systems
&#131;Design Issues-Tuning Range &#8211; need to cover all frequency channels-Noise &#8211; impacts receiver blocking and sensitivity performance-Power &#8211; want low power dissipation-Isolation &#8211; want to minimize noise pathways into VCO-Sensitivity to process/temp variations &#8211; need to make it 
manufacturable in high volumeZin
Zo LNA To FilterFrom Antenna
and Bandpass
FilterPC board
trace
Package
Interface
LO signalMixer
RF in IF out
Frequency
SynthesizerReference
FrequencyVCO</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
Further Info on Ring Oscillators
&#131;Due to their relatively poor phase noise performance, 
ring oscillators are rarely used in RF systems-They are used quite often in  high speed data links, 
though
&#131;We will focus on LC oscillators in this lecture
&#131;Some useful info on CMOS ring oscillators-Maneatis et. al., &#8220;Preci se Delay Generation Using 
Coupled Oscillators&#8221;, JSSC, Dec 1993 (look at pp 127-
128 for delay cell description)-Todd  Weigandt&#8217;s PhD thesis &#8211;http://kabuki.eecs.berkeley.edu/~weigandt/</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>M.H. Perrott MIT OCW
Model for Voltage to Frequency Mapping of VCO
&#131;Model VCO in a small signal manner by looking at 
deviations in frequency about the bias point-Assume linear relationship between input voltage and 
output frequency
M1L2
IbiasL1
M2
VsVout Vout
Cvar Cvar 
Vcont
VbiasVinT=1/FvcoVCO frequency versus V cont
slope=K v
VbiasVcontFvco
Foutfo
Vin</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
Hartley Oscillator
&#131;Same as Colpitts, but uses a tapped inductor rather 
than series capacitors to implement the transformer 
portion of the circuit-Not popular for IC implementations due to the fact that 
capacitors are easier to realize than inductorsL1
IbiasM1Vout
VbiasL2
V1
CbigC</text>
        </slide>
        <slide>
          <slideno>46</slideno>
          <text>M.H. Perrott MIT OCW
Injection Locking
&#131;Noise close in 
frequency to 
VCO resonant frequency can 
cause VCO 
frequency to 
shift when its 
amplitude becomes high 
enoughVCO
VoutVnoise
Vin
woW|Vout(w)|
woW|Vnoise(w)|
&#8710;w &#8710;w -&#8710;w
woW|Vout(w)|
woW|Vnoise(w)|
&#8710;w &#8710;w -&#8710;w
woW|Vout(w)|
woW|Vnoise(w)|
&#8710;w &#8710;w -&#8710;w
woW|Vout(w)|
woW|Vnoise(w)|
&#8710;w &#8710;w -&#8710;w</text>
        </slide>
        <slide>
          <slideno>45</slideno>
          <text>M.H. Perrott MIT OCW
Supply Pulling and Pushing
&#131;Supply voltage has an impact on the VCO frequency-Voltage across varactor will vary, thereby causing a 
shift in its capacitance-Voltage across transistor drain junctions will vary, 
thereby causing a shift in its depletion capacitance
&#131;This problem is addressed by building a supply 
regulator specifically for the VCOM1L2
IbiasL1
M2
VsVout Vout
Cvar Cvar L
C1
IbiasM1Vout
Vbias
V1
Cvar Vcont
Vcont</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>M.H. Perrott MIT OCW
Frequency Domain Model of VCO
&#131;Take Laplace Transform of phase relationship
-Note that Kvis in units of Hz/V
Frequency Domain
VCO Model
M1L2
IbiasL1
M2
VsVout Vout
Cvar Cvar 
Vcont
VbiasVinT=1/Fvco
2&#960;Kv
svin &#934;out</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Oscillator Swing
&#131;Design tank components to achieve high Q-Resulting Rpvalue is as large as possible
&#131;Choose bias current (Ibias) for large swing (without going 
far into saturation)-We&#8217;ll estimate swing as a function of Ibiasin next slide
&#131;Choose transistor size to achieve adequately large gm1-Usually twice as large as 1/Rp1to guarantee startup Lp1 Rp1 Cp1
M1
IbiasM2VsVout VoutLp2 Rp2 Cp2
I2(t) I1(t) A A</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
VCO Design For High Speed Data Links
&#131;Design Issues-Same as wireless,  but:
&#131;Required noise performance is often less stringent
&#131;Tuning range is often narrowerZin
Zo AmpFrom Broadband
TransmitterPC board
trace
Package
InterfaceIn Clock and
Data 
RecoveryData
Clk
Loop
FilterPhase
DetectorData Out
Data In Clk Out
VCO</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Colpitts Oscillator
&#131;Carryover from discrete designs in which single-ended 
approaches were preferred for simplicity-Achieves negative resistance with only one transistor-Differential structure can also be implemented
&#131;Good phase noise can be achieved, but not apparent there is an advantage of this design over negative resistance design for CMOS applicationsL
C1
IbiasM1Vout
Vbias
C2V1</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>M.H. Perrott MIT OCW
Voltage Controlled Oscillators (VCO&#8217;s)
&#131;Include a tuning element to ad just oscillation frequency-Typically use a variable capacitor (varactor)
&#131;Varactor incorporated by replacing fixed capacitance-Note that much fixed capacitance cannot be removed 
(transistor junctions, interconnect, etc.)
&#131;Fixed cap lowers fr equency tuning rangeM1L2
IbiasL1
M2
VsVout Vout
Cvar Cvar L
C1
IbiasM1Vout
Vbias
V1
Cvar Vcont
Vcont</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
Example 1:  Ring Oscillator
&#131;Gain is set to 1 by saturating 
characteristic of inverters
&#131;Phase equals 360 degrees at frequency of oscillationAB C&#8710;t (or &#8710;&#934;)
A
B
CA
A
T
-Assume N stages each with phase shift &#8710;&#934;
-Alternately, N stages with delay &#8710;t
</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Setting Gmtoo High
&#131;Closed loop poles end up in the right half S-plane-Unstable response occurs
&#131;Waveform blows up!Open Loop
Resonator
Poles and ZeroGmRp &gt; 1
Locus of
Closed Loop
Pole LocationsClosed Loop Step Responsejw
&#963;S-plane</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Variations on a Theme
&#131;Biasing can come from top or bottom
&#131;Can use either NMOS, PMOS, or both for transconductor-Use of both NMOS and PMOS for coupled pair would appear to 
achieve better phase noise at a given power dissipation
&#131;See Hajimiri et. al, &#8220;Design Iss ues in CMOS Differential LC 
Oscillators&#8221;, JSSC, May 1999 and Feb, 2000 (pp 286-287) M1L2
C2
IbiasL1
M2 C1
VsVout Vout
M1L2
C2Ibias
L1
M2 C1Vout Vout
M1Ld
C2M2 C1Vout VoutM4 M3IbiasBottom-biased NMOS Top-biased NMOS Top-biased NMOS and PMOS</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>M.H. Perrott MIT OCW
Other Types of Resonators
&#131;Quartz crystal-Very high Q, and very accurate and stable resonant 
frequency
&#131;Confined to low frequencies (&lt; 200 MHz)
&#131;Non-integrated-Used to create low noise, accu rate, &#8220;reference&#8221; oscillators
&#131;SAW devices-High frequency, but poor accu racy (for resonant frequency)
&#131;MEMS devices-Cantilever beams &#8211; promise hi gh Q, but non-tunable and 
haven&#8217;t made it to the GHz ra nge, yet, for resonant frequency-FBAR &#8211; Q &gt; 1000, but non-tunable and poor accuracy-Other devices are on the way!</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
Barkhausen&#8217;s Criteria for Oscillation
&#131;Closed loop transfer function
&#131;Self-sustaining oscillation at 
frequency woifH(jw)x = 0 y e
e(t)
y(t)Barkhausen Criteria
H(jw o) = 1Asin(w ot)
Asin(w ot)
-Amounts to two conditions:
&#131;Gain = 1 at frequency wo
&#131;Phase = n360 degrees (n = 0,1,2,&#8230;) at frequency wo</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Setting Gmtoo low
&#131;Closed loop poles end up in the left half S-plane-Underdamped response occurs
&#131;Oscillation dies outOpen Loop
Resonator
Poles and ZeroGmRp &lt; 1
Locus of
Closed Loop
Pole LocationsClosed Loop Step Responsejw
&#963;S-plane</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
One-Port Modeling Requires Parallel RLC Network              
&#131;Since VCO operates over a very narrow band of 
frequencies, we can always do series to parallel 
transformations to achieve a parallel network for 
analysis
-Warning &#8211; in practice, RLC networks can have 
secondary (or more) resonant frequencies, which cause undesirable behavior
&#131;Equivalent parallel network masks this problem in hand 
analysis
&#131;Simulation will reveal the problemLp Rp CpLs
RsLCs
RsC</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 11
Voltage Controlled Oscillators
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>47</slideno>
          <text>M.H. Perrott MIT OCW
Example of Injection Locking
&#131;For homodyne systems, VCO frequency can be very 
close to that of interferers
-Injection locking can happen if inadequate isolation 
from mixer RF input to LO port
&#131;Follow VCO with a buffer stage with high reverse isolation to alleviate this problemwint 0 woWRF in(w)Desired
Narrowband
SignalInterferer
RF in
LO signalLNA Mixer
LO frequency
Vin</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
Clapp Oscillator
&#131;Same as Colpitts except that inductor portion of tank 
is isolated from the drain of the device-Allows inductor voltage to achieve a larger amplitude 
without exceeded the max allo wable voltage at the drain
&#131;Good for achieving lower phase noiseC1
IbiasM1Vout
Vbias
C2V1L
1/GmC3LLlarge</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Leveraging Amplifier Nonlinearity as Feedback
&#131;Practical transconductance amplifiers have saturating 
characteristics-Harmonics created, but filtered out by resonator-Our interest is in the rela tionship between the input and 
the fundamental of the output0 woW
0 wo 2wo 3woWZ(jw)-Gm
-1 0 VoutVx Ix
|Vx(w)|
|Ix(w)|A
GmA</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
L1
IbiasM1Vout
VbiasL2
M1vout
v1
Nvoutid1Rp
1/Gm
N2
N=L2
L1+L2vout
-GmNvoutRp||1/Gm
N2
-1/Gm
NvoutRp||1/Gm
N2L1+L2C CL1+L2
CL1+L2V1
CbigCSimplified Model of Hartley Oscillator
&#131;Similar to Colpitts, again be wary of 
parasitic resonances</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>M.H. Perrott MIT OCW
Model for Voltage to Phase Mapping of VCO
1/Fvco= &#945;
1/Fvco= &#945;+&#949;out(t)
out(t)&#131;Intuition of integral relati onship between frequency and 
phase&#131;Phase is more convenient than frequency for analysis-The two are related through an integral relationship
</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
A Closer Look At Resonator-Based Oscillator
&#131;For parallel resonator at resonance-Looks like resistor (i.e., purely real) at resonance
&#131;Phase condition is satisfied
&#131;Magnitude condition achieved by setting GmRp= 1wo 10w owo
10|Z(jw)|
Z(jw)90o
-90o0
0oZ(jw) Gm 0 VoutRp
w</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
Analysis of Negative Resistance Oscillator (Step 2)
&#131;Split oscillator circuit into ha lf circuits to simplify analysis-Leverages the fact that we can approximate Vsas being 
incremental ground (this is not quite true, but close enough)
&#131;Recognize that we have a diode connected device with a 
negative transconductance value-Replace with negative resistor
&#131;Note: Gmis large signal transconductance valueM1Vout-1Lp1 Rp1 Cp1
VoutLp1 Rp1 Cp1
-Gm11Lp1 Rp1 Cp1
M1
IbiasM2
VsVout Vout</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
Example 2:  Resonator-Based Oscillator
&#131;Barkhausen Criteria for oscillation at frequency wo:
-Assuming Gmis purely real, Z(jwo) must also be purely realZ(jw)
Lp Rp CpVout
GmVx-1
Vx
Z(jw) -Gm -1 0 VoutVx
</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
Simplified Model of Colpitts
C1
IbiasM1Vout
Vbias
C2V1M1vout
v1C1||C2
Nvoutid1RpL
1/Gm1/Gm
N2
N=C1
C1+C2C1C2
C1+C2C1||C2 =vout
-GmNvoutRp||1/Gm
N2
-1/Gm
NvoutRp||1/Gm
N2L C1||C2 L
C1||C2 LInclude
loss in tank
&#131;Purpose of cap transformer-Reduces loading on tank-Reduces swing at source node 
(important for bipolar version)
&#131;Transformer ratio set to achieve best noise performance</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
Analysis of Cap Transformer used in Colpitts
&#131;Voltage drop across RLis reduced by capacitive 
voltage divider-Assume that impedances of caps are less than RLat 
resonant frequency of ta nk (simplifies analysis)
&#131;Ratio of V1to Voutset by caps and not RL
&#131;Power conservation leads to transformer relationship 
shownL
C2C1
RLV1 Vout
RL1:NRin=
N21RL
V1=NVoutL C1||C2 VoutLVoutC1||C2
N21RL
N =C1
C1+C2C1C2
C1+C2C1||C2 =</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
Design of Negative Resistance Oscillator
&#131;Design tank components to achieve high Q-Resulting Rpvalue is as large as possible
&#131;Choose bias current (Ibias) for large swing (without going 
far into saturation)-We&#8217;ll estimate swing as a function of Ibiasshortly
&#131;Choose transistor size to achieve adequately large gm1-Usually twice as large as 1/Rp1to guarantee startup VoutLp1 Rp1 Cp1
-Gm11Lp1 Rp1 Cp1
M1
IbiasM2
VsVout VoutLp2 Rp2 Cp2
Gm1
AGm1Rp1=1gm1A A</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
One-Port View of Resonator-Based Oscillators
&#131;Convenient for intuitive analysis
&#131;Here we seek to cancel out loss in tank with a 
negative resistance element-To achieve sustained oscillation, we must have Zres
Active
Negative
Resistance
GeneratorResonatorZactive
Resonator
Lp Rp CpVout
= -RpActive Negative
Resistance
-Gm1Zres Zactive
Vout
</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Oscillator Swing as a Function of Ibias
&#131;I1(t) consists of pulses whose shape and width are a 
function of the transistor behavior and transformer ratio -Approximate as narrow square  wave pulses with width W
-Fundamental component is
-Resulting oscillator amplitude
t
T TW
f
T1IbiasI1(t)
average = Ibias|I1(f)|
Ibias
W1
</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
Integrated Resonator Structures
&#131;Integrated transformer-Leverages self and mutual in ductance for resonance to 
achieve higher Q-See Straayer et. al., &#8220;A low- noise transformer-based 1.7 
GHz CMOS VCO&#8221;, ISSCC 2002, pp 286-287
ABL2B
L1A
Cpar1
k CD
CDCpar2</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Amplitude Feedback Loop
&#131;One thought is to detect oscillator amplitude, and 
then adjust Gmso that it equals a desired value-By using feedback, we can precisely achieve GmRp= 1
&#131;Issues-Complex, requires power, and adds noiseAdjustment
of GmOscillator
Peak
Detector
Desired
Peak ValueOutput</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
C1
IbiasM1Vout
Vbias
C2V1M1vout
v1C1||C2
Nvoutid1RpL
1/Gm1/Gm
N2
N=C1
C1+C2C1C2
C1+C2C1||C2 =vout
-GmNvoutRp||1/Gm
N2
-1/Gm
NvoutRp||1/Gm
N2C3Cp Lp Cp+C1||C2 Lp
Cp+C1||C2 LpLLlargeSimplified Model of Clapp Oscillator
&#131;Looks similar to Colpitts model-Be careful of parasitic resonances!</text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>M.H. Perrott MIT OCW
Varactor Implementation &#8211; Diode Version
&#131;Consists of a reverse biased diode junction-Variable capacitor formed by depletion capacitance-Capacitance drops as roughly the square root of the 
bias voltage
&#131;Advantage &#8211; can be fully integrated in CMOS
&#131;Disadvantages &#8211; low Q (often &lt; 20), and low tuning 
range ( &#177;20%)
P+N+
P- substrateDepletion
RegionV-V+
N- n-well V-V+
V+-V-Cvar</text>
        </slide>
        <slide>
          <slideno>44</slideno>
          <text>M.H. Perrott MIT OCW
A Method To Increase Q of MOS Varactor
&#131;High Q metal caps are switched in to provide coarse 
tuning
&#131;Low Q MOS varactor used to obtain fine tuning
&#131;See Hegazi et. al., &#8220;A Filtering Technique to Lower LC 
Oscillator Phase Noise&#8221;, JSSC, Dec 2001, pp 1921-1930LSB
VcontrolW/L
W/LC
2W/L2C
4W/L4C
MSBto VCO
000
001010
011
100101
110
111
Coarse Control Fine ControlCoarse
ControlCvar
Vcontrol
Fine ControlOverall Capacitance</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
Integrated Resonator Structures
&#131;Inductor and capacitor tank-Lateral caps have high Q (&gt; 50)-Spiral inductors have moderate Q (5 to 10), but 
completely integrated and have tight tolerance (&lt; &#177;10%)-Bondwire inductors have high Q (&gt; 40), but not as &#8220;integrated&#8221; and have poor tolerance (&gt; &#177;20%)
-Note:  see Lecture 4 for more info on these
BA
C1A
BLmA
BBALateral Capacitor Spiral Inductor Bondwire Inductor
diepackage</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
Quarter Wave Resonator
&#131;Impedance calculation (from Lecture 4)
-Looks like parallel LC tank!
&#131;Benefit &#8211; very high Q can be achieved with fancy 
dielectric
&#131;Negative &#8211; relatively large area (external implementation in the past), but getting sma ller with higher frequencies!x
zyZL
0 Lz&#955;0/4
Z(&#955;0/4)
</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
Setting GmTo Just the Right Value
&#131;Closed loop poles end up on jw axis-Oscillation maintained
&#131;Issue &#8211; GmRpneeds to exactly equal 1-How do we achieve this in practice?Open Loop
Resonator
Poles and ZeroGmRp = 1
Locus of
Closed Loop
Pole LocationsClosed Loop Step Responsejw
&#963;S-plane</text>
        </slide>
        <slide>
          <slideno>43</slideno>
          <text>M.H. Perrott MIT OCW
A Recently Popular Approach &#8211; The MOS Varactor
&#131;Consists of a MOS transistor (NMOS or PMOS) with 
drain and source connected together-Abrupt shift in capacitance as inversion channel forms
&#131;Advantage &#8211; easily integrated in CMOS
&#131;Disadvantage &#8211; Q is relatively low in the transition 
region-Note that large signal is ap plied to varactor &#8211; transition 
region will be swept across each VCO cycle
N+N+
P-
Depletion
RegionV-V+
VTV+-V-CdepCoxCvar
W/L
V-V+</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Design of Colpitts Oscillator
A
I1(t)
C1
IbiasM1Vout
Vbias
C2V1L
1/Gm
Gm1
ANGm1Req=1gm1-1/Gm
NvoutReq= C1||C2 L Rp||1/Gm
N2
&#131;Design tank for high Q
&#131;Choose bias current (Ibias) for large swing (without going 
far into saturation)
&#131;Choose transformer ratio for best noise-Rule of thumb: choose N = 1/5 according to Tom Lee
&#131;Choose transistor size to achieve adequately large gm1</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
Example &#8211; Negative Resistance Oscillator
&#131;This type of oscillator st ructure is quite popular in 
current CMOS implementations-Advantages
&#131;Simple topology
&#131;Differential implementation ( good for feeding differential 
circuits)
&#131;Good phase noise performance can be achievedM1L2
C2
IbiasL1
M2 C1
VsVout VoutRL2 RL1
RC1 RC2M1L2
C2
IbiasL1
M2 C1
VsVout VoutInclude loss
in inductors and
capacitors</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
Popular VCO Structures
Vout
VinCRp L -RampVCO Amp
Vout
VinLC oscillator
Ring oscillator
-1
&#131;LC Oscillator:  low phase noise, large area
&#131;Ring Oscillator:  easy to integrate, higher phase noise</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Noise Modeling in Amplifiers</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec7/</lecture_pdf_url>
      <lectureno>7</lectureno>
      <slides>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
Relationship Between Variance and Spectral Density
&#131;Two-sided spectrum
-Since spectrum is symmetric
&#131;One-sided spectrum defined over positive frequencies-Magnitude defined as twice that of its corresponding  
two-sided spectrum
&#131;In the next few lectures, we assume a one-sided 
spectrum for all noise analysisSx(f)
f
0A
f1f2 -f2-f1Sx(f)
f
02A
f1f2Two-Sided Spectrum One-Sided Spectrum
</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Drain Noise &#8211; 1/f  (Assume Device in Saturation)
ind
f4kT&#947;gdo2
&#8710;f
drain
1/f noise
drain thermal noise
1/f noise
corner frequency&#131;Traps at channel/oxide interface 
randomly capture/release carriers
-Parameterized by Kfand n
&#131;Provided by fab (note n &#8776;1)
&#131;Currently: Kfof PMOS &lt;&lt; Kfof 
NMOS due to buried channelSDG VGS
VD&gt;&#8710;Vind
-To minimize: want large area (high WL)
</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Determine Vgsto find ioutin terms of itest
&#131;After much algebra:Calculation of &#951;
vgs gmvgs CgsitestD
SG
ZgsZg
Zdegiout
v1
</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Substitute in for Zgsw
Gate noise contribution
&#131;Gate noise contribution is a function of Q!-Rises monotonically with Q&#131;Key noise expression derived earlier
The Impact of Gate Noise with Zs= Rs+sLg(Cont.)
</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Remove Model Components for Simplicity
RSRGRDRD
Rgpar
-gmbvsvgs
vsro gmvgs
ID
CsbCgsCgd Cdb
ind ingengpar
gg1RGenG
RdegenD
endeg
VinVout
</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Example:  Output Current Noise with Zs= Rs, Zdeg= 0
&#131;Step 1:  Determine key noise parameters-For 0.18 &#181;CMOS, we will assume the following
&#131;Step 2:  calculate &#951;and Zgsw
vgs gmvgs Cgs indgZgsRsensSource
Viniout
</text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>M.H. Perrott MIT OCW
Achieving Minimum Noise Factor
&#131;For common source amplifier without degeneration-Minimum noise factor can only be achieved at 
resonance if gate noise is uncorrelated to drain noise 
(i.e., if c = 0) &#8211; we&#8217;ll see this next lecture-We typically must operate s lightly away from resonance 
in practice to achieve mini mum noise factor since c will 
be nonzero
&#131;How do we determine the optimum source impedance 
to minimize noise figure in classical analysis?-Next lecture!</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Induced Gate Noise (Assume Device in Saturation)
ing
f4kT&#948;gdo2
&#8710;f
5
&#945;ftslope =
20 dB/decadeSDG VGS
VD&gt;&#8710;Vingindg
&#131;Fluctuating channel potential 
couples capacitively into the gate 
terminal, causing a noise gate 
current
-&#948;is gate noise coefficient
&#131;Typically assumed to be 2 &#947;-Correlated to drain noise!
</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Output Current Noise Variance (Power)
&#131;To find noise variance:Iout
GD
Svgs gmvgs Cgs indgD
SG
ZgsZg
Zdegiout
ZgZdeg
</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Determine crossover point for Q value
-Critical Q value for crossover  is primarily set by processAt What Value of Q Does Gate Noise Exceed Drain Noise?
=1indg
f4kT&#947;gdo2
&#8710;f
gate noise contributiondrain thermal noiseNarrowband
amplifier
frequency range
wo/2&#960;Q2
</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Noise Factor calculation:
&#131;From previous analysisCalculate Noise Factor (Part 2)
</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Parameterized Expression for Output Noise Variance
&#131;Key equation from last slide
&#131;Solve for noise ratio
&#131;Define parameters Zgswand &#967;d
</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>M.H. Perrott MIT OCW
Minimum Noise Factor
&#131;We see that the noise factor will be minimized for 
some value of Q-Could solve analytically by differentiating with respect 
to Q and solving for peak value (i.e. where deriv. = 0)
&#131;In Tom Lee&#8217;s book (pp 272-277), the minimum noise 
factor for the MOS common source amplifier (i.e. no 
degeneration) is found to be:
&#131;How do these compare?
Noise Factor scaling coefficientNoise Factor scaling coefficient
</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
Drain-Source Conductance:  gdo
&#131;gdois defined as channel resistance with Vds=0-Transistor in triode, so that 
-Equals gmfor long channel devices
&#131;Key parameters for 0.18 &#181;NMOS devices
</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
Variance (i.e., Power) Calc. for Output Current Noise
&#131;Noise variance calculation
&#131;Define correlation coefficient c between ingand ind
</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
Plot of gmand gd&#959;versus Vgsfor 0.18&#181;NMOS Device
0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 200.511.522.533.54
Gate Voltage Vgs (Volts)Transconductance (milliAmps/Volts)Transconductances gm and gdo versus Gate Voltage Vgs
 gm (simulated in Hspice)gd0=&#181;nCoxW/L(V gs-VT)
&#131;For Vgsbias voltages around 1.2 V: 
M1Id
Vgs
W
L=1.8&#181;
0.18&#181;</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
Noise in CMOS Transistors (Assumed in Saturation)
&#131;Modeling of noise in transistors must include several noise 
sources-Drain noise
&#131;Thermal and 1/f &#8211; influenced by transistor size and bias-Gate noise
&#131;Induced from channel &#8211; influenced by transistor size and bias
&#131;Caused by routing resistance to  gate (including resistance of 
polysilicon gate)
&#131;Can be made negligible with pr oper layout such as fingering of 
devicesID
GD
SDrain Noise (Thermal and 1/f)
Gate Noise (Induced and Routing Parasitic)Transistor Noise Sources</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
Drain Noise &#8211; Thermal  (Assume Device in Saturation) 
&#131;Thermally agitated carriers in the 
channel cause a randomly varying 
current
-&#947;is called excess noise factor 
&#131;= 2/3 in long channel
&#131;= 2 to 3 (or higher!) in short 
channel NMOS (less in PMOS)-gdowill be discussed shortly ind
f4kT&#947;gdo2
&#8710;fSDG VGS
VD&gt;&#8710;Vind
</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
Noise In Inductors and Capacitors
&#131;Ideal capacitors and inductors have no noise!
&#131;In practice, however, they will have parasitic resistance-Induces noise-Parameterized by adding resistances in parallel/series 
with inductor/capacitor
&#131;Include parasitic resistor noise sourcesL C</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
The Impact of Gate Noise with Zs= Rs+sLg
&#131;Step 1:  Determine key noise parameters-For 0.18 &#181;CMOS, again assume the following
&#131;Step 2:  Note that &#951;=1 , calculate Zgsw
vgs gmvgs Cgs indgZgsRsensSource
Viniout
Lg
</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 7
Noise Modeling in Amplifiers
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Apply Thevenin Techniques to Simplify Noise Analysis
&#131;Assumption:  noise independent of load resistor on drainvgs gmvgs Cgs indingD
SG
ZgsZg
Zdegiout
vgs gmvgs Cgs indgD
SG
ZgsZg
Zdegiout</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Narrowband Amplifier Noise Requirements
&#131;Here we focus on a narrowband of operation-Don&#8217;t care about noise outside that band since it will be 
filtered out
&#131;Gate noise is a significant issue here-Using reactive elements in the source dramatically 
impacts the influence of gate noise
&#131;Specification usually given in terms of Noise Figureindg
f
1
2&#960;RsCgs4kT&#947;gdo2
&#8710;f
drain
1/f noise
drain thermal noise
1/f noise
corner frequencyNarrowband
amplifier
frequency rangegate noise contribution
with purely resistive 
source impedance</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
The Impact of Filtering on Spectral Density
&#131;For the random signal passing through a linear, 
time-invariant system with transfer function H(f)
-We see that if x(t) is amplified by gain A, we have Sy(f)
f
0AB
H(f)x(t) y(t)|H(f)|2
f
0B
f
0ASx(f)
</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
vgs gmvgs Cgs indingD
SG
ZgsZg
Zdegiout
vgs gmvgs Cgs indgD
SG
ZgsZg
ZdegioutCalculation of Equivalent Output Noise for Each Case
</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
Key Noise Sources for Noise Analysis
&#131;Transistor drain noise
Thermal noise 1/f noise&#131;Transistor gate noiseRSRGRDRD
vgs
vsgmvgs
IDCgsind ingRGenG
RdegenD
endeg
VinVout</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
&#131;SNR (assume constant spectra, ignore noise from Rs):
&#131;For small Q such that gate noise &lt; drain noise-SNRoutimproves dramatically as Q is increased
&#131;For large Q such that gate noise &gt; drain noise-SNRoutimproves very little as Q is increasedImpact of Q on SNR (Ignoring RsNoise)
indg
f4kT&#947;gdo2
&#8710;f
gate noise contributiondrain thermal noiseNarrowband
amplifier
frequency range
wo/2&#960;Q2signal spectrum Q2
</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of the Signal Spectrum at the Output
&#131;First calculate relationship between vinand iout
&#131;At resonance:
&#131;Spectral density of signal at ou tput at resonant frequency
vgs gmvgs Cgs indgZgsRsensSource
Viniout
Lg</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
-For w &lt;&lt; 1/(RsCgs):
-For w &gt;&gt; 1/(RsCgs):Calculation of Output Current Noise (continued)
&#131;Step 3:  Plug values into the previously derived expression 
Gate noise contributionDrain Noise Multiplying Factor
Gate noise contribution
</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
Noise in Resistors
&#131;Can be described in terms of either voltage or current
&#131;k is Boltzmann&#8217;s constant
&#131;T is temperature (in Kelvins)-Usually assume room temperature of 27 degrees CelsiusR R
enR in
</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Evaluate ZgswAt Resonance
&#131;Set Lgsuch that it resonates with Cgsat the center 
frequency (wo) of the narrow band of interest
&#131;Calculate Zgswat frequency wo
vgs gmvgs Cgs indgZgsRsensSource
Viniout
Lg</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Modify denominator using expressions for Q and wt
&#131;Resulting expression for noise factor:
-Noise factor primarily depends on Q, wo/wt, and process specsCalculate Noise Factor (Part 3)
Noise Factor scaling coefficient
</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>M.H. Perrott MIT OCW
&#131;First calculate SNRout(must include Rsnoise for this)-Rsnoise calculation (same as for Vin)
-SNRout:
&#131;Then calculate SNRin:Calculate Noise Factor (Part 1)
vgs gmvgs Cgs indgZgsRsensSource
Viniout
Lg</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>M.H. Perrott MIT OCW
Plot of Minimum Noise Factor and Noise Factor Vs. Q
1 2 3 4 5 6 7 8 9 10012345678
QNoise Factor Scaling CoefficientNoise Factor Scaling Coefficient Versus Q for 0.18 &#181; NMOS Device
c = -j0
c = -j0.55
c = -j1c = -j1
c = -j0.55c = -j0
Minimum across
all values of Q andAchievable values as
a function of Q under
the constraint that
LgCgs1= w o
LgCgs1Note: curves
meet if we 
approximate
Q2+1    Q2</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Plot of gmand gd&#959;versus Idensfor 0.18&#181;NMOS Device
0 100 200 300 400 500 600 70000.511.522.533.54
Current Density (microAmps/micron)Transconductance (milliAmps/Volts)Transconductances gm and gdo versus Current Density
 gm (simulated in Hspice)gd0=&#181;nCoxW/L(V gs-VT)M1Id
Vgs
W
L=1.8&#181;
0.18&#181;</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Zgs
&#131;Write KCL equations
&#131;After much algebra:
vgs gmvgs CgsD
SG
ZgsZg
Zdegiout
vtestitest
v1</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Broadband Amplifier Design Considerations for Noise
&#131;Drain thermal noise is the chief issue of concern 
when designing amplifiers with &gt; 1 GHz bandwidth-1/f noise corner is usually less than 1 MHz-Gate noise contribution onl y has influence at high 
frequencies (such noise will likely be filtered out)
&#131;Noise performance specification is usually given in terms of input referred voltage noiseindg
f
1
2&#960;RsCgs4kT&#947;gdo2
&#8710;f
drain
1/f noisegate noise contribution
with purely resistive 
source impedance
drain thermal noise
1/f noise
corner frequency</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
Notation for Mean, Variance, and Correlation
&#131;Consider random variables x and y with probability 
density functions fx(x) and fy(y) and joint probability 
function fxy(x,y)-Expected value (mean) of x is
&#131;Note: we will often abuse notation and den ote                 
as a random variable (i.e., noise) rather than its mean-The variance of x (assuming it has zero mean) is
-A useful statistic is
&#131;If the above is zero, x and y are said to be uncorrelated
</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
Noise Factor and Noise Figure
&#131;Definitions
&#131;Calculation of SNRinand SNRout
ioutRsenRs
vinLinear,Time Invariant
 Circuit
(Noiseless) Zinvx
ZLinout
ZoutEquivalent output
referred current noise
(assumed to be independent
of Zout and ZL) 
</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
Useful References on MOSFET Noise
&#131;Thermal Noise-B. Wang et. al., &#8220;MOSFET Thermal Noise Modeling for 
Analog Integrated Circ uits&#8221;, JSSC, July 1994  
&#131;Gate Noise-Jung-Suk Goo, &#8220;High Freque ncy Noise in CMOS Low 
Noise Amplifiers&#8221;, PhD Thesi s, Stanford University,  
August 2001
&#131;http://www-tcad.stanford.edu /tcad/pubs/theses/goo.pdf-Jung-Suk Goo et. al., &#8220;The Equivalence of van der Ziel and BSIM4 Models in Modeling the Induced Gate Noise of MOSFETS&#8221;,  IEDM 2000, 35.2.1-35.2.4 
-Todd Sepke, &#8220;Investigation of  Noise Sources in Scaled 
CMOS Field-Effect Transistors&#8221; , MS Thesis, MIT, June 2002
&#131;http://www-mtl.mit.edu/resear ch/sodini/sodinitheses.html</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
Plot of Drain Noise Multiplying Factor (0.18&#181;NMOS)
&#131;Conclusion: gate noise has little effect on common 
source amp when source impedance is purely resistive!0.750.80.850.90.951
1/100 1/10 1 10 100
Normalized Frequency --- f/(2 &#960;RsCgs) (Hz)Drain Noise Multiplying Factor Versus Frequency for 0.18 &#181; NMOS DeviceDrain Noise Gain Factor
f &gt;&gt; 1/(2&#960;RsCgs)f &lt;&lt; 1/(2&#960;RsCgs)</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Small Signal Model for Noise Calculations
Iout
GD
Svgs gmvgs Cgs indgD
SG
ZgsZg
Zdegiout
ZgZdeg
</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Noise Sources in a CMOS Amplifier
RSRGRDRD
Rgpar
-gmbvsvgs
vsro gmvgs
ID
CsbCgsCgd Cdb
ind ingengpar
gg1RGenG
RdegenD
endeg
VinVout</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Design and Simulation of Synthesizers</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec18/</lecture_pdf_url>
      <lectureno>18</lectureno>
      <slides>
        <slide>
          <slideno>60</slideno>
          <text>M.H. Perrott MIT OCW
Implementation of Primitives &#8211; Logic Gates
&#131;Relevant timing information contained in the input 
that causes the output to transition-Determine which input causes  the transition, then pass 
its transition value to the outputa[n]n
b[n]n
na
bout
out[n]</text>
        </slide>
        <slide>
          <slideno>63</slideno>
          <text>M.H. Perrott MIT OCW
out(t) v(t)
div(t)
N[m]DividerVCO
N[m]
cyclesN[m-1]
cycles
div(t)out(t)&#131;Time step of simulation 
typically set by VCO output
&#131;Small time steps means long 
simulation runs
&#131;Divider output often 100 times lower in frequencySample Rate Set by Highest Frequency Signal
Can we sample according to divider output?</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Resulting Step Responses and Pole/Zero Diagrams
&#131;Impact of variations on the loop dynamics can be 
visualized instantly and taken into account at early 
stage of design</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Design with Parasitic Pole
&#214;K, fpand  Qpare adjusted to obtain the same dominant 
pole locations&#131;Include a parasitic pol e at nominal value fp&#63281;= 1.2MHz
</text>
        </slide>
        <slide>
          <slideno>57</slideno>
          <text>M.H. Perrott MIT OCW
Implementation Overview
&#131;Compute transition values in VCO block
&#131;Pass transition information in Divider block
&#131;Compute transition values for PFD output
&#131;Compute Filter outputPFDCharge
Pump
Nsd[n]out[n] e[n]
&#931;&#8722;&#8710;
Modulatorv[n]
N[n]Loop
Filter
DividerVCOref[n]
div[n]</text>
        </slide>
        <slide>
          <slideno>58</slideno>
          <text>M.H. Perrott MIT OCW
Computation of PFD Output
&#131;Goal:  compute transition information in terms of 
primitive blocks (registers, XOR gates, etc.)-Allows straightforward implementation in simulator-Accommodates a rich variety of PFD structures ref[n]
n
ndiv[n]e[n]
n
SRD
QQ
D
QQD
QQ
D
QQ</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
Review of Classical Design Approach
Given the desired closed-loop bandwidth, order, and 
system type: 
1. Choose an appropriate topology for H(f)
&#131;Depends on order, type
2. Choose pole/zero values for H(f) as appropriate for the 
required bandwidth
3. Adjust the open-loop gain to achieve the required 
bandwidth while maintaining stability
&#131;Plot gain and phase bode plots of A(f)
&#131;Use phase (or gain) margin criterion to infer 
stability</text>
        </slide>
        <slide>
          <slideno>59</slideno>
          <text>M.H. Perrott MIT OCW
Implementation of Primitives - Registers
&#131;Relevant timing information is contained in the clock 
signal-Transfer transition informat ion from the clock to the 
register output-Complement output using a sign changeD
QQ
clk[n]n
out[n]n
nclkout
out
out[n]</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
Background Information</text>
        </slide>
        <slide>
          <slideno>51</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Transition Values
&#131;Model VCO based on its phasev[n]
VCOout[n]
&#960;&#934;vco(t)
t&#949;k
out[n]n</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Closed Loop Design Approach: Overview
&#131;G(f) completely describes the closed loop dynamics-Design of this function is the ultimate goal
&#131;Instead of indirectly designing G(f) using plots of A(f), 
solve for G(f) directly as a function of specification 
parameters
&#131;Solve for A(f) that will achieve desired G(f) 
&#131;Account for the impact of parasitic poles/zerosPerformance
Specifications
{type, fo, ...}|A(f)|
\A(f)
{K, fzA, fpA, ...}G(f)
{fz , fp , ...}A(f)
1+A(f)G(f) =Open Loop
Design
Approach
Closed Loop Design ApproachClosed Loop Design ApproachG(f)
1-1-G(f)A(f) ) =</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Follows active implementation guidelines from a few 
slides agoVoutC1C2
R1 R2
Iin
VrefDACIdac
VoutC1C2
C3 R1 R2
Iin
Vref
Vout
Iin-R2
1+s(R1+R2)C2+s2R1R2C1C2=Vout
Iin-1
s(C1+C2)=1+sR2C3
1+sC||(R1(1+C1/C3)+R2)+s2R1R2C1C||
where C||= C2C3/(C2+C3)Type I, Order 3 Type II, Order 3Active Topologies To Realize a Third Order PLL </text>
        </slide>
        <slide>
          <slideno>72</slideno>
          <text>M.H. Perrott MIT OCW
Simulated Synthesizer Noise Performance
L(f) (dBc/Hz)-60
-70-80-90
-100
-110
-120-130-140
-150Simulated Spectrum:  1/T
s = 20*(reference frequency)
100 kHz 25 kHz 1 MHz 10 MHz 25 MHzMeasured NoiseSimulated Noise
&#131;Simulated results compare quite well to measured!
&#131;Simulation time:  5 million time steps in 80 seconds</text>
        </slide>
        <slide>
          <slideno>48</slideno>
          <text>M.H. Perrott MIT OCW
Proposed Approach: View as Series of Pulses
&#131;Area of each pulse set by edge locations
&#131;Key observations:-Pulses look like impulses to loop filter-Impulses are parameterized by their area and time offsete(t)
t
Loop Filterh(t)
v(t)
e(t)e(t)
t
t1
01
0&#949; Ts Ts/2
area =  &#949; area = T s/2
e[n]
n
Loop FilterTsv[n]h[n] = T s  h(Tsn)</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
Integer-N Frequency Synthesizer
&#131;VCO                 produces high frequency sine wave
&#131;Divider            divides down VCO frequency
&#131;PFD                 compares phase of ref and div
&#131;Loop filter       extracts phase error information
Poor frequency resolutionPFDCharge
Pumpout(t) e(t) v(t)
NLoop
Filter
DividerVCOref(t)
div(t)Fout = N  Fref Fref</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>M.H. Perrott MIT OCW
&#931;&#8722;&#8710;Fractional-N Frequency Synthesis
&#131;Dither using a &#931;&#8722;&#8710;modulator
&#131;Quantization noise is shaped to high frequenciesPFDCharge
Pump
Nsd[m]out(t) e(t)
&#931;&#8722;&#8710;
Modulatorv(t)
N[m]Loop
Filter
DividerVCOref(t)
div(t)
MM+1Fout = M.F  F ref
f&#931;&#8722;&#8710;
Quantization
NoiseFref</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>M.H. Perrott MIT OCW
Problem 2:  Classical Simulators Are Inaccurate
&#131;PFD output is not bandlimited-PFD output must be simulated in discrete-time
&#131;Phase error is inaccurately simulated
&#131;Non-periodic dithering of divider complicates mattersPFDCharge
Pump
Nsd[m]out(t) e(t)
&#931;&#8722;&#8710;
Modulatorv(t)
N[m]Loop
Filter
DividerVCOref(t)
div(t)
MM+1</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
&#931;&#8722;&#8710;Fractional-N Frequency Synthesizer
PFDCharge
Pump
Nsd[m]ref(t) out(t) e(t)
div(t)
&#931;&#8722;&#8710;
Modulatorv(t)
N[m]Loop
Filter
DividerVCO&#131;Focus on this architecture  since it is essentially a 
&#8220;super set&#8221; of other synthesizers, including integer-N 
and fractional-N-If we can design and simulate this structure, we can also 
do so for classical integer-N designs</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
Use PLL Design Assistant to Calculate Parameters
</text>
        </slide>
        <slide>
          <slideno>62</slideno>
          <text>M.H. Perrott MIT OCW
Can we speed the 
simulation up further?</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
Definition of Type
&#131;Type I: one integrator in PLL open loop transfer 
function-VCO adds on integrator-Loop filter, H(f), has no integrators
&#131;Type II:  two integrators in PLL open loop transfer function
-Loop filter, H(f), has one integrator
N&#934;ref(t) &#934;out(t)
&#934;div(t)e(t) v(t)
H(f)Kv
jf&#945;
2&#960;
1Loop FilterPFDVCO
DividerTristate:  &#945;=1
XOR-based:  &#945;=2</text>
        </slide>
        <slide>
          <slideno>65</slideno>
          <text>M.H. Perrott MIT OCW
Combine VCO and Divider Blocks
PFDCharge
Pump
Nsd[n]e[n]
&#931;&#8722;&#8710;
Modulatorv[n]
N[n]Loop
Filter
DividerVCOref[n]
div[n]2&#960;N[m]&#934;vco(t)
t
&#934;[k]
&#934;[k-1]
div(t)
div[n] n&#949;k&#949;kN&#960;
Transient simulations run 2 orders of magnitude faster!&#131;Compute divider output using 
first order interpolation of VCO 
phase</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
Definition of Bandwidth, Order, and Shape for G(f)
&#131;Bandwidth &#8211; fo-Defined in asymptotic manner as shown
&#131;Order &#8211; n-Defined according to the roll off characteristic of G(f)
&#131;Shape-Defined according to standard filter design 
methodologies
&#131;Butterworth, Bessel, Chebyshev, etc.fof
rolloff =
-20n 
dB/decade G(f)
(dB)0</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
Calculated Versus Simulated Phase Noise Spectrum
1041801601401201008060Simulated Phase Noise of SD Freq. Synth.
Frequency Offset from Carrier (Hz)L(f) (dBc/Hz)
105106107108With parasitic pole at 1.2 MHz:
1041801601401201008060Output Phase Noise of Synthesizer
Frequency Offset (Hz)L(f) (dBc/Hz)SD Noise     
Detector NoiseVCO Noise     
Total Noise   
105106107108Simulated Noise
RMS jitter = 14.057ps</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Synthesizer Noise
&#131;Noise must be low to 
meet transmit mask 
requirement &#131;Noise must be low to meet 
receiver SNR and blocking 
requirements Channel
SelectDigital
BasebandD/A
Channel
SelectDigital
BasebandA/DRF Out RF InWireless Transmitter Wireless Receiver
Frequency
SynthesizerFrequency
Synthesizer
Transmitter
ChannelfSynthesizer
Noise
Receiver
ChannelfSynthesizer
Noise</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 18
Design and Simulation of Frequency Synthesizers
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Closed Loop Design Approach:  Implementation
&#131;Download PLL Design Assistant Software at   
http://www-mtl.mit.edu/resear ch/perrottgroup/tools.html
&#131;Read accompanying manual
&#131;Algorithm described by C.Y. Lau et. al. in &#8220;Fractional-N Frequency Synthesizer Design at the Transfer Function 
Level Using a Direct Closed Loop Realization 
Algorithm&#8221;, Design Automation Conference, 2003</text>
        </slide>
        <slide>
          <slideno>61</slideno>
          <text>M.H. Perrott MIT OCW
Issue:  Must Observe Protocol When Adding Noise
&#131;Divider and PFD blocks operate on a strict protocol for 
their incoming signals-Values other than 1 or -1 are interpreted as edges-Example:  inputting noise at  divider input breaks protocol!
&#131;Add noise only at places where signal is &#8220;analog&#8221;-PFD, charge pump, and loop filter outputs are finePFDCharge
Pump
Nsd[n]out[n] e[n]
&#931;&#8722;&#8710;
Modulatorv[n]
N[n]Loop
Filter
DividerVCOref[n]
div[n]
Noise</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
What Do We Want From a Simulator?
&#131;Accurate estimation of synthesizer performance-Noise spectral density-Dynamic behavior
&#131;Fast computation to allow use in IC design flow
&#131;Simple to use-C++, Verilog, Matlab</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Problem with Passive Loop Filter Implementations
&#131;Large voltage swing required at charge pump output-Must support full range of VCO input
&#131;Non-ideal behavior of inductors (for third order G(f) 
implementations)-Hard to realize large inductor values-Self resonance of inductor reduces high frequency 
attenuationCp
L1L1
Alternative:  active loop filter implementation</text>
        </slide>
        <slide>
          <slideno>66</slideno>
          <text>M.H. Perrott MIT OCW
Does it really work?</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>M.H. Perrott MIT OCW
Other Noise Sources
&#131;Charge pump noise
&#131;VCO noisePFDCharge
Pump
Nsd[m]out(t) e(t)
&#931;&#8722;&#8710;
Modulatorv(t)
N[m]Loop
Filter
DividerVCOref(t)
div(t)
MM+1M.F
f&#931;&#8722;&#8710;
Quantization
NoisefCharge
Pump
Noise
fVCO
Noise-20 dB/dec</text>
        </slide>
        <slide>
          <slideno>49</slideno>
          <text>M.H. Perrott MIT OCW
Proposed Method
&#131;Set e[n] samples according to pulse areas-Leads to very accurate results
&#131;Mathematical analysis given in paper-Fast computatione(t)
t
Loop Filterh(t)
v(t)
e(t)e(t)
t
t
e[n]
n1
0101
0&#949; Ts Ts/2
area =  &#949; area = T s/2
&#949;/Ts 1/2e[n]
n
Loop FilterTsv[n]h[n] = T s  h(Tsn)</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>M.H. Perrott MIT OCW
Problem 1:  Classical Simulators are Slow
&#131;High output frequency       High sample rate 
&#131;Long time constants          Long time span for transients
Large number of simulation time steps requiredPFDCharge
Pump
Nsd[m]out(t) e(t)
&#931;&#8722;&#8710;
Modulatorv(t)
N[m]Loop
Filter
DividerVCOref(t)
div(t)10-100 kHz
MM+11-10 GHz</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
Resulting Step Response and Pole/Zero Diagram
</text>
        </slide>
        <slide>
          <slideno>43</slideno>
          <text>M.H. Perrott MIT OCW
Alternative:  Event Driven Simulation
&#131;Set simulation time samples at PFD edges-Sample rate can be lowered to edge rate!PFDe(t) ref(t)
Sample Period Non-constante(t)
t
e[n]
n
TkTk+1
(Smedt et al, CICC &#8217;98,
Demir et al, CICC &#8217;94,
Hinz et al, Circuits and Systems &#8217;00)</text>
        </slide>
        <slide>
          <slideno>46</slideno>
          <text>M.H. Perrott MIT OCW
Proposed Approach: Use Constant Time Step
&#131;Straightforward CT to DT tran sformation of filter blocks-Use bilinear transform or impulse invariance methods
&#131;Overall computation framework is fast and simple-Simulator can be based on Verilog, Matlab, C++ e(t)
t
Loop Filterh(t)
v(t)
e(t)
t1
0
e[n]
n
Loop FilterTsv[n]h[n] = T s  h(Tsn)Ts</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
Guidelines for Active Loop Filter Design
&#131;Use topologies with unity 
gain feedback in the 
opamp-Minimizes influence of 
opamp noise
Vnoise,in
VrefVoutR1 R2
2
Set nominal
voltage to Vref VoutLevel
Shift
ElementUse current
to achieve
level shift&#131;Perform level shifting in 
feedback of opamp-Fixes voltage at charge 
pump output
&#131;Prevent fast edges from directly reaching opamp inputs-Will otherwise cause opamp to be driven into nonlinear region of operation</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
Calculated Versus Simulated Phase Noise Spectrum
Simulated Phase Noise of SD Freq. Synth.
104
Frequency Offset (Hz)1051061071081801601401201008060L(f) (dBc/Hz)Without parasitic pole:
1801601401201008060Output Phase Noise of SynthesizerL(f) (dBc/Hz) 
 
 SD Noise    
Detector NoiseVCO Noise    Total Noise  
Simulated Noise
104
Frequency Offset (Hz)105106107108
RMS jitter = 13.791ps</text>
        </slide>
        <slide>
          <slideno>64</slideno>
          <text>M.H. Perrott MIT OCW
Divider Output Can Be Computed from VCO Phase
Key Idea:  Model VCO and Divider using Phasev(t)
VCOKv
s&#934;vco(t)out(t) v(t)
div(t)
N[m]Dividerdiv(t)
DividerVCO
2&#960;N[m]
N[m]
cyclesN[m-1]
cycles2&#960;N[m-1]&#934;vco(t)
t
div(t) div(t)out(t)
(Van Halen et al,  Circuits and Systems &#8217;96)</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Example Design
&#131;Type II, 3rdorder, Butterworth, fo= 300kHz, fz/fo= 0.125-No parasitic poles
&#131;Required loop filter transfer  function can be found from 
table: </text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Conclusion
&#131;New closed loop design approach facilitates: -Accurate control of closed loop dynamics
&#131;Bandwidth, Order, Shape, Type -Straightforward design of higher order PLL&#8217;s-Direct assessment of impact of parasitic poles/zeros
&#131;Techniques implemented in a GUI-based CAD tool
&#131;Beginners can quickly come up to speed in designing 
PLL&#8217;s
&#131;Experienced designers can quickly evaluate the 
performance of different PLL configurations</text>
        </slide>
        <slide>
          <slideno>56</slideno>
          <text>M.H. Perrott MIT OCW
Implementation Overview
&#131;Compute transition values in VCO block
&#131;Pass transition information in Divider block
&#131;Compute transition values for PFD output
&#131;Compute Filter outputPFDCharge
Pump
Nsd[n]out[n] e[n]
&#931;&#8722;&#8710;
Modulatorv[n]
N[n]Loop
Filter
DividerVCOref[n]
div[n]</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Active Topologies To Realize a Second Order PLL 
&#131;Follows guidelines from previous slide
&#131;Charge pump output is terminat ed directly with a high 
Q capacitor-Smooths fast edges from charge pump before they 
reach the opamp input(s) VoutR2
R1DAC
IinIdac
C1
VrefVout
C1C3C2
R1IinIin
VrefVref
Vout
IinR1
1+sR1C1=Vout
Iin1+sR1(C1+C2+C3)=
sC2(1+sR1C1)Type I, Order 2 Type II, Order 2</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Noise under Open Loop Parameter Variations
&#131;Impact of open loop parameter variations on phase 
noise and jitter can be visualized immediatelySD Noise     
Detector NoiseVCO Noise     
Total Noise   Output Phase Noise of Synthesizer
1801601401201008060L(f) (dBc/Hz)
104
Frequency Offset (Hz)105106107108
RMS jitter = 11.678ps (min), 18.211ps (max)</text>
        </slide>
        <slide>
          <slideno>54</slideno>
          <text>M.H. Perrott MIT OCW
Implementation Overview
&#131;Compute transition values in VCO block
&#131;Pass transition information in Divider blockPFDCharge
Pump
Nsd[n]out[n] e[n]
&#931;&#8722;&#8710;
Modulatorv[n]
N[n]Loop
Filter
DividerVCOref[n]
div[n]</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Passive Topologies to Realize a Second Order PLL
&#131;DAC is used for Type I implementation to coarsely 
tune VCO-Allows full range of VCO to be achievedVout
C1 R1IinDACIdacVout
C1
C2R1Iin
Vout
IinR1
1+sR1C1=Vout
Iin1
s(C1+C2)=1+sR1C2
1+sR1C||Type I, Order 2 Type II, Order 2</text>
        </slide>
        <slide>
          <slideno>52</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Transition Values
&#131;Determine output transition time according to phasev[n]
VCOout[n]
&#960;&#934;vco(t)
t&#934;[k]
&#934;[k-1]
out(t)&#949;k
&#960;
out[n]n</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
First Order, Type I: Frequency and Step Responses
0 dBClosed Loop Frequency Response
FrequencyABC
 01Closed Loop Step Response
Time2
ABC</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Passive Topologies to Realize a Third Order PLL
&#131;Inductor is necessary to create a complex pole pair-Must be implemented off-chip due to its large valueVout
C1 R1L1IinDACIdac
Vout
C1
C2R1L1Iin
Vout
IinR1
1+sR1C1+s2L1C1=
where C||= C1C2/(C1+C2)Vout
Iin1
s(C1+C2)=1+sR1C2
1+sR1C||+s2L1C||Type I, Order 3 Type II, Order 3</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>Simulation of Frequency Synthesizers</text>
        </slide>
        <slide>
          <slideno>45</slideno>
          <text>M.H. Perrott MIT OCW
Is there a better way?</text>
        </slide>
        <slide>
          <slideno>67</slideno>
          <text>M.H. Perrott MIT OCW
The CppSim Simulator
&#131;Blocks are implemented with C/C++ code-High computation speed-Complex block descriptions
&#131;Users enter designs in graphical form using Cadence 
schematic capture-System analysis and transi stor level analysis in the 
same CAD framework
&#131;Resulting signals are viewed in Matlab-Powerful post-processing and viewing capability
Simulation package available on Athena
and freely downloadable at
http://www-mtl.mit.edu/~perrott</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Open Loop Parameter Variations
&#131;Open loop parameter variations can be directly entered 
into tool</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
Frequency-domain Model
&#934;div[k]&#934;ref[k] KV
jfv(t) &#934;out(t)
H(f)
1
Nnom
2&#960;z-1
z=ej2&#960;fT 1 - z-1 n[k]T1
&#934;d[k]T
2&#960;e(t)PFD
DividerLoop
Filter C.P. VCO
&#945;Tristate: &#945;=1
XOR: &#945;=2
Icp
See Perrott et. al. JSSC , 
Aug. 2002 for details
&#131;Closed loop dynamics parameterized by</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
Outline
&#131;Closed-Loop Design of Frequency Synthesizers-Introduction-Background on Classical Open Loop Design Approach-Closed Loop Design Approach-Example and Verification-Conclusion
&#131;Fast and Accurate Simulation of Frequency Synthesizers-Introduction-Difficulties of Traditional Approaches-Proposed Method-Example and Verification-Conclusion</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
Loop Filter Transfer Function Vs Type and Order of G(f)
&#131;Practical PLL implementations limited to above-Prohibitive analog complexity for higher order, type
&#131;Open loop gain, K, will be  calculated by algorithm-Loop filter gain related to open loop gain as shown above KLP
1+s/wp
KLP
1+s/(wpQp)+(s/wp)2KLPKLP1+s/wz
s
KLP1+s/wz
s(1+s/wp)
KLP(1+s/wz)
s(1+s/(wpQp)+(s/wp)2)Type I Type II
Order 1
Order 2
Order 3
where KLP = Nnom
KvIcp&#945;K
Calculated from softwareH(s) Topology For Different Type and Orders of G(f) </text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>M.H. Perrott MIT OCW
Problems with Current 
Simulators</text>
        </slide>
        <slide>
          <slideno>71</slideno>
          <text>M.H. Perrott MIT OCW
Measured  Synthesizer Noise Performance
Measured
VCO Noise
(open loop)(closed loop)Measured Overall
Synthesizer Noise
Noise Floor of
Measurement
System</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Synthesizer Dynamic Behavior
&#131;Settling time must be fast to support channel hopping 
requirements Channel
SelectDigital
BasebandD/A
Channel
SelectDigital
BasebandA/DRF Out RF InWireless Transmitter Wireless Receiver
Frequency
SynthesizerFrequency
Synthesizer
Transmitter
Channelf
Receiver
Channelf</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Constrained for applications which require precise 
filter response
&#131;Complicated once parasitic poles are taken into 
account
&#131;Poor control over filter shape
&#131;Inadequate for systems with third order rolloff-Phase margin criterion based on second order systems
Closed loop design approach: 
Directly design G(f) by sp ecifying dominant pole and 
zero locations on the s-plane (pole-zero diagram)Limitations of Open Loop Design Approach</text>
        </slide>
        <slide>
          <slideno>47</slideno>
          <text>M.H. Perrott MIT OCW
Problem: Quantization Noise at PFD Output
&#131;Edge locations of PFD output are quantized-Resolution set by time step:  T s
&#131;Reduction of T sleads to long simulation timese(t)
t
Loop Filterh(t)
v(t)
e(t)
t1
0&#949; Ts Ts/2
e[n]
n
Loop FilterTsv[n]h[n] = T s  h(Tsn)</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
Fractional-N Frequency Synthesis
&#131;Divide value is dithered between integer values
&#131;Fractional divide values can be realized!
Very high frequency resolutionPFDCharge
Pump
Nsd[m]out(t) e(t)
Dithering
Modulatorv(t)
N[m]Loop
Filter
DividerVCOref(t)
div(t)
MM+1Fout = M.F  Fref
M.FFref</text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>M.H. Perrott MIT OCW
Example:  Classical Constant-Time Step Method
&#131;Directly sample the PFD output according to the 
simulation sample period-Simple, fast, readily implemented in Matlab, Verilog, C++
&#131;Issue &#8211; quantization noise is introduced-This noise overwhelms the PLL noise sources we are 
trying to simulatePFDe(t) ref(t)e(t)
t
e[n]
n
Sample Period = T s (Johns and Martin,
Analog Integrated Circuit Design)</text>
        </slide>
        <slide>
          <slideno>44</slideno>
          <text>M.H. Perrott MIT OCW
Issue:  Simulation of Filter Blocks is Complicated
&#131;Filtering computation must deal with non-constant 
time step-Closed-form calculation is tedious-Iterative computation is time-consuming
&#131;Complicates Verilog, Matlab, or C++ implementationSample Period Non-constante(t)e(t)
t
e[n]
n
TkTk+1t
Loop Filterh(t)
v(t)</text>
        </slide>
        <slide>
          <slideno>70</slideno>
          <text>M.H. Perrott MIT OCW
Noise Sources Included in Simulation
&#131;Dominant noise sources in synthesizer-Quantization noise of &#931;&#8722;&#8710;  (produced by &#931;&#8722;&#8710;block)-Charge pump noise (calculated from Hspice)-VCO noise (input-referred &#8211; calculated from measurement)PFDref(t)
div(t)Loop
Filterv(t)1.85e-25
A2/Hz3.25e-16
V2/Hz
1.2e-24
A2/Hz1.5 &#181;A1.5 &#181;A
f&#931;&#8722;&#8710;
Quantization
NoiseCharge
Pump
NoiseVCO
Noise
(Input-referred)</text>
        </slide>
        <slide>
          <slideno>55</slideno>
          <text>M.H. Perrott MIT OCW
Implementation Overview
&#131;Compute transition values in VCO block
&#131;Pass transition information in Divider block
&#131;Compute transition values for PFD outputPFDCharge
Pump
Nsd[n]out[n] e[n]
&#931;&#8722;&#8710;
Modulatorv[n]
N[n]Loop
Filter
DividerVCOref[n]
div[n]</text>
        </slide>
        <slide>
          <slideno>53</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Transition Values
&#131;Use first order interpolation to determine transition valuev[n]
VCOout[n]
&#960;&#934;vco(t)
t &#949;k&#934;[k]-&#934;[k-1]&#960;-&#934;[k-1]=&#934;[k]
&#934;[k-1]
out(t)
out[n]n&#949;k
&#960;
2 -1out[n]
&#949;kn</text>
        </slide>
        <slide>
          <slideno>68</slideno>
          <text>M.H. Perrott MIT OCW
Experimental Prototype to Verify Approach
1.8 - 1.9 GHz
0.6&#181;CMOS ICDigital&#931;&#8722;&#8710;
ModulatorPFD Out20 MHz
64 Modulus
DividerLoop
Filter
2
Frequency
Select
Perrott et al
JSSC, Dec 97</text>
        </slide>
        <slide>
          <slideno>50</slideno>
          <text>M.H. Perrott MIT OCW
Implementation Overview
&#131;Compute transition values in VCO blockPFDCharge
Pump
Nsd[n]out[n] e[n]
&#931;&#8722;&#8710;
Modulatorv[n]
N[n]Loop
Filter
DividerVCOref[n]
div[n]
(Assume VCO output
is a square-wave
for this discussion)</text>
        </slide>
        <slide>
          <slideno>69</slideno>
          <text>M.H. Perrott MIT OCW
Simulation Results - Dynamic Behavior
&#131;Simulation time:  260 thousand time steps in 5 seconds 
on a 650 MHz Pentium III Laptop (custom C++ simulator)Nsd  (Input to &#931;&#8722;&#8710; Modulator)
0 100 200 300 400 500 600 700Synthesizer Output Frequency (MHz)Frequency (MHz)
Time (Micro Seconds)97
9695949392
91
1940
192019001880186018401820Divide Value</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Noise Estimation
&#131;Phase noise plots can be easily obtained-Jitter calculated by integrating over frequency 
range
</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
Example: First Order, Type I with Parasitic Poles
-90o
-315o-165o
-180o
-240o20log| A(f)|
ffp3
\A(f)Open loop
gain
increased
0 dB
PM = 51o for B
PM = -12o for CPM = 72o for ANon-dominant
polesDominant
pole pair
ABC
BAABC
CEvaluation of
Phase MarginClosed Loop Pole
Locations of G(f)
fpfp2
Re(s)Im(s)
0</text>
        </slide>
        <slide>
          <slideno>73</slideno>
          <text>M.H. Perrott MIT OCW
Conclusion
&#131;Phase locked loop circuits can be quickly and 
accurately simulated-Accuracy achieved with ar ea conservation principle-Fast computation by combining VCO and Divider blocks
&#131;A variety of simulation frameworks can be used-C++, Matlab, Verilog-Circuit primitives are supported
Noise and dynamic performance of fractional-N 
frequency synthesizers can be investigated at system level</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>High Speed Digital Logic</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec13/</lecture_pdf_url>
      <lectureno>13</lectureno>
      <slides>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
Dynamic Model of NOR Gate
&#131;To match worst case delaysAA
BB
Y
Rn RnRp
Rp
CLAA
BB
YRp=&#945;
&#181;pWp
Rn=&#945;
&#181;nWn
</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>M.H. Perrott MIT OCW
Technique 2 to Eliminate PUN - DCVSL
&#131;Differential Cascade Voltage Swing Logic (DCVSL)-Employs differential logic structure-Faster speed than complementary CMOS-No static power dissipation-Great for interface between power supply domains
&#131;Issues-Slower than Pseudo-NMOS (PMOS gates load output)-More power than complementary CMOSOut
PDN1 InMp2
PDN2 InMp1
Out</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
Complementary CMOS Logic
&#131;Composed of pull-up and pull-down networks that are 
duals of each other-Each network composed of NAND (series connection) 
and/or NOR (parallel connection) functions
&#131;Advantage-No static power (except leakage)OutPUN
PDNIn
In</text>
        </slide>
        <slide>
          <slideno>52</slideno>
          <text>M.H. Perrott MIT OCW
True Single Phase Clocked (TSPC) Latches
&#131;Allow register implementations with only one clock!-Latches made transparent at different portions of clock 
cycle by using appropriate latch &#8220;flavor&#8221; &#8211; n or p
&#131;n latches are transparent only when &#934;is 1
&#131;p latches are transparent only when &#934;is 0
&#131;Benefits:  simplified clock distribution, high speed&#934;IN OUT
&#934;&#934;
IN OUT&#934;Doubled n-C2MOS latch Doubled p-C2MOS latch
&#934;
&#934;LATCH
DQOUT IN</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Voltage and Sizing On Drive Current
&#131;Voltage supply-Drive current increases with higher drive voltage
&#131;Width-Current scales proportionally
&#131;Length-Current scales inversely proport ional for square-law device
&#131;No dependence for purely velocity saturated device
Square Law Device Velocity Saturated Device</text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>M.H. Perrott MIT OCW
The Pros and Cons of Dynamic Logic
&#131;Benefits-High speed (but lower speed than Pseudo-NMOS due to 
precharge time requirement)-No static power, non-ratioed, and low number of transistors
&#131;Issues-High design complexity &#8211; cascading requires care-Large clock load, minimum clock speed due to leakageOut
PDN InMp
Me&#934;&#934;
&#934;&#934;
A BY
PDNExample: 2 input NOR gate</text>
        </slide>
        <slide>
          <slideno>44</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Reduced Swing with Same Drive Current
&#131;Propagation time reduced!
&#131;How do we reduce the swing AND achieve high drive 
current to capacitance ratio?50%
50%tpHLtpLHt
tVoutVin
Vdd
0
Vdd
0</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Modeling Propagation Delays with Resistance
&#131;We can visualize impact of relative transistor sizing 
between NMOS and PMOS by using switched resistances 
to represent their current drive-Choose &#945;parameter to match propagation times of actual 
circuit (assume &#945;has same value for NMOS and PMOS)-We see that increasing mobility  or width reduces resistance
&#131;Intuitively illustrates impact of these parameters on drive 
current 
&#131;To match propagation delays, set Rp= RnRp=
CtotVoutVin
Vin&#945;
&#181;pWp
Rn=&#945;
&#181;nWn
</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Length Normalized Drain Current &#8211; 0.18&#181;NMOS Device
&#131;Product is relatively constant &#8211; square law behavior for L 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5 0.5500.511.5
Transistor Length (microns)Id*(transistor length)/0.18 &#181;m   (mA)NMOS Drain Current (Multiplied by Normalized
Transistor Length) Versus Transistor Length
Vgs = 1.8 V
Vgs = 1.5 V
Vgs = 1.2 V
Vgs = 1.0 V
Vgs = 0.8 VM1Id
Vgs
W
L=1.8&#181;
lengthlength
0.18 &#181;</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Dynamic Model of NAND Gate
&#131;To match worst case propagation delays
A
A
BBY
RnRnRp Rp
CLRp=&#945;
&#181;pWp
Rn=&#945;
&#181;nWnA
AB
BY
</text>
        </slide>
        <slide>
          <slideno>54</slideno>
          <text>M.H. Perrott MIT OCW
A Simplified Approach to TSPC Registers
&#131;Clever implementation of TSPC approach can be 
achieved with reduced transistor count
&#131;For more info on TSPC approach, see-J. Yuan and C. Svensson, &#8220;New Single-Clock CMOS 
Latches and Flipflops with Improved Speed and Power 
Savings&#8221;, JSSC, Jan 1997, pp 62-69&#934;OUT
&#934;&#934;
&#934;IN
&#934;&#934;&#934;&#934;
IN OUTPositive-edge triggered Negative-edge triggered</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
Length Normalized Drain Current &#8211; 0.18&#181;PMOS Device
00.20.40.6
0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5 0.55
Transistor Length (microns)Id*(transistor length)/0.18 &#181;m   (mA)PMOS Drain Current (Multiplied by Normalized
Transistor Length) Versus Transistor Length
Vgs = -1.8 V
Vgs = -1.5 V
Vgs = -1.2 V
Vgs = -1.0 V
Vgs = -0.8 VVgsW
L=1.8&#181;
length
M1
Idlength
0.18 &#181;
&#131;Product is relatively constant &#8211; square law behavior for L </text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
Setting of Transistor Width for High Speed
&#131;Intrinsic performance of device not influenced by W-Current/capacitance ratio (considering only device 
capacitance) is constant wi th changing W (to first order)
&#131;Within circuit, speed is improved by increasing W when 
Cfixedis significant with respect to device capacitance-W should be chosen such that device capacitance equals 
or exceeds fixed wiring capacitance Cfixed
Ctot = Cdb1+Cdb2 + Cgs3+Cgs4 + K(Cov3+Cov4) + CfixedVinVout
Ctot = WnCndevices  + WpCpdevices  + CfixedWn
LWp
L
Wn
LWp
L</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>M.H. Perrott MIT OCW
Technique 3 to Eliminate PUN (or PDN): Dynamic Logic
&#131;Use a clock, &#934;, to gate the load and PDN network-&#934;= 0
&#131;Precharge the output node
&#131;Shut off current to PDN-&#934;= 1
&#131;Turn off the precharge device
&#131;Send current to PDN so that it &#8220;evaluates&#8221; inputsOut
PDN InMp
Me&#934;&#934;
&#934;&#934;
A BY
PDNExample: 2 input NOR gate</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
Modeling Dynamic Performance of NAND Gate
&#131;Assume NMOS devices are same size and PMOS 
devices are same size
&#131;Modeling of parallel devi ces (in PUN above) is 
straightforward-Simply represent with parallel switched resistors
&#131;Modeling of series devices (in PDN above) is not 
immediately obvious-We need to do further investigationA
AB
BY</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Let&#8217;s Do A Test
&#131;In Hspice, simulate the output current of an NMOS 
transistor with a given Vgsbias-Vary the length of the transistor-Scale the current by the length
&#131;For square law device
-Product independent of length
&#131;For velocity saturated device (extreme case)
-Product increases with length
</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
High Speed Digital Design in High Speed Data Links
&#131;Primary application areas-Phase detector within CDR-High speed A/D&#8217;s and D/ A&#8217;s in future systems
&#131;Design Issues-Same as wireless,  but dealing with non-periodic signalsZin
Zo AmpFrom Broadband
TransmitterPC board
trace
Package
InterfaceIn Clock and
Data 
RecoveryData
Clk
Loop
FilterPhase
DetectorData Out
Data In Clk Out
VCO</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
Key Issue for High Speed &#8211; Fast Rise and Fall Times
&#131;For digital circuit, propagation delays primarily set by 
rise and fall times-Rise and fall times set by slew rate
&#131;Slew rate: ratio of driving current to load capacitance-Faster speed obtained with higher slew rates-Key performance metric:  current drive/capacitance
&#131;Compare with analog:  transconductance/capacitanceInmosCtotM2
M1VinVoutSlope = Inmos
Ctot
CtotM2
M1VinVoutIpmosSlope = Ipmos
Ctot</text>
        </slide>
        <slide>
          <slideno>46</slideno>
          <text>M.H. Perrott MIT OCW
Logic Realization Using Differential SCL
&#131;Employs differential signaling (no Vref)-More robust and higher noise margin than singled-ended 
version
&#131;Ordering of signals yields AND/NAND versus OR/NORANAND AND
BLoad
Load
B
A AOR NOR
BLoad
Load
B
A2 input AND/NAND 2 input OR/NOR</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
Dynamic Model for Pseudo-NMOS
&#131;Arbitrarily choose NMOS width to be 1-Set PMOS width to be 1/2 acc ording to rule of thumb on 
previous slide
&#131;Note that negative edge transition at output is 5 times 
faster than the positive  edge transition at outputBCY
CLAW1
0.51=
W11=W11=W11=A: Cin= 1.0C&#945;
B: Cin= 1.0C&#945;
C: Cin= 1.0C&#945;
BCY
A
</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>Note: much of the material to follow can be found in
J. Rabaey, &#8220;Digital Integrated Circuits: A Design 
Perspective&#8221;, Prentice Hall, 1996</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Equivalent Transistor Model of Stacked Transistors
&#131;Drive current is created only when both devices are on-We can hook gates together without loss of generality-Resulting configuration is eq uivalent (at least to first 
order) to a single devi ce with twice the length
&#131;Issue &#8211; if device velocity saturated, what&#8217;s the impact?
Square Law Device Velocity Saturated Device (extreme)Ctot
VinVoutSlope = Inmos
Ctot
W
LW
LInmos
CtotVinVoutSlope = Inmos
Ctot
W
2LInmos</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>M.H. Perrott MIT OCW
Comparison of Complementary CMOS vs Pseudo-NMOS
&#131;For same negative transition propagation delay-Pseudo-NMOS has nearly 1/10 the input capacitance
&#131;In practice, may want to scale up the pseudo-NMOS 
sizes to get faster positive transition propagation delayBCY
CLA BB
CC
Y
CLAACompementary CMOS NOR Pseudo-NMOS NOR
W1
0.51=
W11=W11=W11=W11=W11=W11=W1
7.51=
W1
7.51=
W1
7.51=A: Cin= 1.0C&#945;
B: Cin= 1.0C&#945;
C: Cin= 1.0C&#945;A: Cin= 8.5C&#945;
B: Cin= 8.5C&#945;
C: Cin= 8.5C&#945;</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
The CMOS Inverter As An Amplifier (From Lecture 5)
&#131;Small signal assumption allows linearized modeling
&#131;Key metric for speed:  gain-bandwidth product (= ft)-Strive for high transconductance to capacitance ratio ( = ft )-Increase speed by lowering gain (use low valued resistors)-Minimize capacitance for given  level of transconductance
&#131;How does digital design differ?Cfixed
Ctot = Cdb1+Cdb2 + Cgs3+Cgs4 + K(Cov3+Cov4) + CRf /2 + CfixedM2
M1M4
M3
Miller multiplication factorVbiasvin
(+Cov1+Cov2)vout Rf
1vout
vin
f(gm1+gm2)(ro1||ro2)
(gm1+gm2)Rf
2&#960;CtotRf1 gm1+gm2
2&#960;Ctotslope = -20 dB/dec</text>
        </slide>
        <slide>
          <slideno>59</slideno>
          <text>M.H. Perrott MIT OCW
Design of Differential SCL Latch with Resistor Loads
&#131;Step 1:  Design follower ampl ifier to have gain of 1.75 to 
2 using simulated gmtechnique from Lecture 5
&#131;Step 2:  For simplicity, size cross-coupled devices the 
same as computed above (or make them slightly smaller)
&#131;Step 3:  Choose clock transistors roughly 20% larger in 
width (they will be in triode, and have lower drive)IN INOUT OUT
&#934; &#934;
IbiasRL RL</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
Analytical Device Modeling in Velocity Saturation (Lec 5)
&#131;If L small (as in modern devices), than velocity 
saturation will impact us for even moderate values 
of Vgs-VT
-Current increases linearly with Vgs-VT-Current no longer depends on L!
&#131;Note:  above is extreme case of velocity saturation!-In practice, modern devices operate somewhere 
between square law and extreme velocity saturation
</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Another Example:  NOR Gate
AA
BB
Y
&#131;Boolean function
-PDN performs NAND operation
-PUN is dual of PDN
</text>
        </slide>
        <slide>
          <slideno>55</slideno>
          <text>M.H. Perrott MIT OCW
Embedding of Logic within Latches
&#131;We can often increase the speed of a logic function 
fed into a latch through embedding-Latch slowed down by extra transistors, but logic/latch 
combination is faster th an direct cascade of the 
functions
&#131;Method can be applied to both static and dynamic 
approaches-Dynamic approach shown above&#934;&#934;
&#934;INOUT
PDN &#934;
&#934;LATCH
DQOUTLogic Function
(NAND,NOR, etc.)IN</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Examine Device Current in Saturation (from Lec 5)
&#131;We classically assume that MOS current is calculated as
&#131;Which is really
-Vdsat,lcorresponds to the saturation voltage at a given 
length, which we often refer to as &#8710;V
&#131;It may be shown that
-If Vgs-VTapproaches LEsatin value, then the top equation is 
no longer valid
&#131;We say that the device is in velocity saturation
</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Comparing the Dynamic Performance of Gates (Step 1)
&#131;NOR-Normalize performance by setting NMOS widths to 1-PMOS widths set to 5 to match propagation delayA
A
BBY
CL
AA
BB
Y
CL
W11=W11=W1
51=
W1
51=NOR NAND</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Voltage and Sizing on Capacitance
&#131;Voltage supply (and voltage swing)-Has no impact on capacitance (to first order)
&#131;Sizing of NMOS and PMOS devices 
&#131;Input capacitance proportional to product of width and 
length of transistor
&#131;Junction and overlap capacitance proportional to W 
Cfixed
Ctot = Cdb1+Cdb2 + Cgs3+Cgs4 + K(Cov3+Cov4) + CfixedVinVout
Wn
LWp
L
Wn
LWp
L
</text>
        </slide>
        <slide>
          <slideno>56</slideno>
          <text>M.H. Perrott MIT OCW
Highest Speed Achieved with Differential SCL Latch
&#131;Employs positive feedback for memory-Realized with cross-coupled NMOS differential pair
&#131;Method of operation-Follow mode:  current directed through differential 
amplifier that passes input signal-Hold mode:   current shifted to cross-coupled pairLoad
Load
IN INOUT OUT
&#934; &#934;QLATCH
S
RQ IN
INOUT
OUT
&#934; &#934;&#934; &#934;</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Relative Sizing of NMOS and PMOS Devices
&#131;Comparison of NMOS and PMOS current driveInmosCtotVinVoutSlope = Inmos
Ctot
CtotVinVoutIpmosSlope = Ipmos
Ctot
Wn
LWp
L
Wn
LWp
L
Square Law Device Velocity Saturated Device
NMOS
PMOS
Primary difference &#8211; mobility values ( &#181;nversus &#181;p)
&#131;Capacitance relationships the same for NMOS and PMOS</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
Comparing the Dynamic Performance of Gates (Step 2)
A
A
BBY
CL
AA
BB
Y
CL
W1
21=W1
21=W1
2.51=W1
2.51=
W11=W11=W1
51=
W1
51=NOR NAND
&#131;NOR-Normalize performance by setting NMOS widths to 1-PMOS widths set to 5 to match NMOS propagation delay
&#131;NAND-Match NOR by setting NMOS widths to 2-PMOS widths set to 2.5 to match NMOS propagation delay</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
Useful References for Velocity Saturation
&#131;For a physics approach-See Lundstrom et.al., &#8220;Essential Physics of Carrier 
Transport in Nanoscale MOSFETS&#8221;, IEEE Transactions on Electron Devices, Jan 2002
&#131;For an engineering model-See Toh et. al., &#8220;An Engineering Model for Short-Channel MOS Devices&#8221;, JSSC, Aug 1988, pp 950-958
&#131;In this class-We will simply do a quick experimental hack job at assessing its impact</text>
        </slide>
        <slide>
          <slideno>49</slideno>
          <text>M.H. Perrott MIT OCW
Edge-triggered Registers
&#131;Achieved by cascading two latches that are 
transparent out of phase from one another
&#131;Two general classes of latches-Static &#8211; employ positive feedback
&#131;Robust-Dynamic &#8211; store charge on parasitic capacitance
&#131;Smaller, lower power in most cases
&#131;Negative:  must be refreshed (due to leakage currents)&#934;
&#934;LATCH
DQ
&#934;LATCH
DQ OUT
&#934;INMASTER SLAVE
&#934;
&#934;QLATCH
S
RQ
&#934;QLATCH
S
RQ OUT
&#934;OUTIN
INMASTER SLAVESingle-Ended Register Differential Register</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
Issue &#8211; Stacked PMOS Transistors Lower Performance
&#131;Why is NOR performance worse than the NAND?-PMOS create dominant portion of capacitive load-Stacked PMOS require even larger devices
&#131;Can we eliminate the impact of the PMOS devices on 
input capacitance (i.e. eliminate the PUN)?-Could achieve higher speed!A
A
BBY
CL
AA
BB
Y
CL
W1
21=W1
21=
W11=W11=W1
51=
W1
51=NOR NAND
A: Cin= 6C&#945;
B: Cin= 6C&#945;A: Cin= 4.5C&#945;
B: Cin= 4.5C&#945;PUN
W1
2.51=W1
2.51=</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
Relative Sizing to Match Propagation Delays
&#131;Equate drive currents to get same slope when charging 
and discharging load capacitance-Assume minimum L for NMOS and PMOS for high speed-Choose W values to accommodate difference between 
NMOS and PMOS mobility values
&#131;Size PMOS devices 2.5 times larger than NMOS!InmosCtotVinVoutSlope = Inmos
Ctot
CtotVinVoutIpmosSlope = Ipmos
Ctot
Wn
LWp
L
Wn
LWp
L
</text>
        </slide>
        <slide>
          <slideno>57</slideno>
          <text>M.H. Perrott MIT OCW
Design of Differential SCL Latch with Resistor Loads
&#131;Step 1:  Design follower ampl ifier to have gain of 1.75 to 
2 using simulated gmtechnique from Lecture 5IN INOUT OUT
&#934; &#934;
IbiasIbiasRL RL</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Designing For High Speed
&#131;Want the highest ratio of drive current to load 
capacitance
&#131;Increased supply voltage
&#131;Increased transistor width
&#131;Increased transistor lengthDrive current Capacitance
Drive current Capacitance
Drive current Capacitance
Want high voltage supply and sm all length to achieve high speedor</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
Designing for High Speed
&#131;Design parameters-Voltage supply (and voltage swing)-Scaling of NMOS and PMOS devices
&#131;Relative to each other
&#131;In an absolute sense-Circuit architecture (impacts drive current/capacitance ratio)
&#131;Key focus point:  how is drive current and capacitance 
influenced by these parameters?-Focus on voltage and sizing issues firstInmosCtotM2
M1VinVoutSlope = Inmos
Ctot
CtotM2
M1VinVoutIpmosSlope = Ipmos
Ctot</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
Investigate Velocity Saturation Issue for 0.18&#181;Device
0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 200.20.40.60.811.21.4
Vgs (Volts)Id (milliAmps)Id versus Vgs
&#131;Linear curve for Idversus Vgs-Velocity saturation is indeed an issue-How does this impact digital design?M1Id
Vgs
W
L=1.8&#181;
0.18 &#181;</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
Back to Dynamic Modeling of Stacked Transistors
&#131;Since we can assume approximately square law 
behavior with respect to impact of L for 0.18 micron CMOS
&#131;Model with two switched resistors in series-Represents the fact that we have half the drive currentCtot
VinVoutSlope = Inmos
Ctot
W
LW
LInmos
CtotVinVoutSlope = Inmos
Ctot
W
2LInmos
</text>
        </slide>
        <slide>
          <slideno>58</slideno>
          <text>M.H. Perrott MIT OCW
Design of Differential SCL Latch with Resistor Loads
&#131;Step 1:  Design follower ampl ifier to have gain of 1.75 to 
2 using simulated gmtechnique from Lecture 5
&#131;Step 2:  For simplicity, size cross-coupled devices the 
same as computed above (or make them slightly smaller)IN INOUT OUT
&#934; &#934;
IbiasRL RL
Ibias</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
Example:   NAND Gate
&#131;Boolean function
-PDN performs NAND operation
-PUN is dual of PDNA
AB
BY
</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Voltage and Sizing on Drive Current
&#131;Rigorous analysis is difficult-Transistor goes through different regions of 
operation as load capacitan ce is charged (i.e., cutoff, 
triode, saturation)-Transistor physics is changing over time
&#131;Velocity saturation is becoming an important issue
&#131;We need a simple approach for intuition-Assume device is in saturat ion the entire time load 
capacitor is being chargedInmosCtotM2
M1VinVoutSlope = Inmos
Ctot
CtotM2
M1VinVoutIpmosSlope = Ipmos
Ctot</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>M.H. Perrott MIT OCW
The Issue of Static Power Dissipation
&#131;Ratio of dynamic power to static power depends on 
transition activity of output-For low transition activity, static power is dominant
&#131;Could potentially turn off PMOS during quite times?-For high transition activity, static and dynamic power may 
be similar in value
&#131;Pseudo-NMOS can save power due to reduced capacitive loadingStatic power &gt;&gt; Dynamic Power
Static power       Dynamic Power
BCY
AIstatic
CLIdynamicY
t
Y
t</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>M.H. Perrott MIT OCW
Sizing PDN Transistors for High Speed
&#131;Diffusion capacitance exists on intermediate nodes-Different effective cap lo ad for each PDN transistor
&#131;Example: transistor C must discharge CL, Cp2, Cp1-Transistor drive compromised by the floating nodes
&#131;Example: transistor A has reduced drive for Vn2&gt; 0
&#131;Design tips for highest speed-Increase the width of devices farthest from output (trans. C)-Place signals that transition last  closest to output (trans. A)B
CY
A
CL
Cp2
Cp1PUN/Load
n1n2</text>
        </slide>
        <slide>
          <slideno>48</slideno>
          <text>Registers</text>
        </slide>
        <slide>
          <slideno>53</slideno>
          <text>M.H. Perrott MIT OCW
Example TSPC Registers
&#131;Positive edge-triggered version
&#934;IN
&#934;&#934;OUT
&#934;MASTER SLAVE
&#934;IN
&#934;&#934;
OUT&#934;MASTER SLAVE&#131;Negative edge-triggered version</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
High Speed Digital Design in Wireless Systems
&#131;Primary application areas-Divider within frequency synthesizer-High speed A/D&#8217;s and D/A&#8217;s in future wireless systems
&#131;Design Issues-Speed &#8211; want it to be fast-Power &#8211; want low power dissipation-Noise &#8211; need to be careful of how it impacts analog circuitsZin
Zo LNA To FilterFrom Antenna
and Bandpass
FilterPC board
trace
Package
Interface
LO signalMixer
RF in IF out
Frequency
SynthesizerReference
FrequencyVCO</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 13
High Speed Digital Circuits
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
Technique 1 to Eliminate PUN:  Pseudo-NMOS
&#131;Benefit-Substantial reduction in inpu t capacitance &#8211; faster speed!
&#131;Negatives-Static power consumption-Asymmetric propagation delays (falling edge faster)-Output logic levels set by ra tio of NMOS to PMOS width
&#131;Rule of thumb:  Set Rp/Rnto 4 (or more)
&#131;Alternate rule of thumb:  Set Wp= Wn/2PDN InMp
BCY
AVoutExample: 3 input NOR gate</text>
        </slide>
        <slide>
          <slideno>45</slideno>
          <text>M.H. Perrott MIT OCW
Technique 4 to Eliminate PUN:  Source-Coupled Logic
&#131;Single-ended version &#8211; Vrefset by bias network
&#131;High speed achieved through-Small signal swings-Leveraging of a fast amplifier structure
&#131;Load can be implemented in a variety of ways-Resistor:  highest speed, but large area-Diode connected PMOS (or NMOS ):  slower, but small area-PMOS in triode region:  high speed, but complicated biasingVinVrefVoutVoutLoadLoad
VrefOR NOR
ABLoadLoadExample: 2 input OR/NOR gate Basic building block: differential pair</text>
        </slide>
        <slide>
          <slideno>50</slideno>
          <text>M.H. Perrott MIT OCW
Static Latches
&#131;Classical case employs cross-coupled NAND/NOR 
gates to achieve positive feedback
&#131;Above example uses cross-coupled inverters for positive feedback
&#131;Set, reset, and clock transistors designed to have 
enough drive to overpower cross-coupled inverters
&#131;Relatively small number of transistors
&#131;Robust&#934;&#934;Q Q
SRQLATCH
S
RQ IN
INOUT
OUT
&#934;&#934;</text>
        </slide>
        <slide>
          <slideno>51</slideno>
          <text>M.H. Perrott MIT OCW
Dynamic Latches
&#131;Leverage CMOS technology-High quality switches with small leakage available-Can switch in and store charge on parasitic 
capacitances quite reliability
&#131;Achieves faster speed than full swing logic with fewer 
transistors
&#131;Issues:  higher sensitivity to noise, minimum refresh rate required due to charge leakage&#934;&#934;
IN OUT&#934;
&#934; &#934;
&#934;LATCH
DQ
&#934;LATCH
DQ OUT
&#934;INMASTER SLAVE</text>
        </slide>
        <slide>
          <slideno>43</slideno>
          <text>M.H. Perrott MIT OCW
Increasing Speed By Reducing Voltage Swing
&#131;The propagation delay is de fined as time between input 
and output crossing at 50% amplitude
&#131;We found that increased voltage is beneficial for speed-Increased Vgsleads to increased drive current to 
capacitance ratio
&#131;What if we could keep high drive current to 
capacitance ratio AND reduce the swing?50%
50%tpHLtpLHt
tVoutVin
Vdd
0
Vdd
0</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
The CMOS Inverter as a Digital Circuit
&#131;Large signal variation prevents linearized modeling-We must examine nonlinear behavior of devices
&#131;Key metric for speed:  propagation delay-What device parameters influence this?-What are the tradeoffs?Cfixed
Ctot = Cdb1+Cdb2 + Cgs3+Cgs4 + K(Cov3+Cov4) + CfixedM2
M1M4
M3
Miller multiplication factorVin
(+Cov1+Cov2)Vout
50%
50%tpHL tpLHt
tVoutVin</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
Comparing the Dynamic Performance of Gates (Step 3)
&#131;Compare the input device capacitance of each gate-Proportional to width of devi ces connected to a given input-Define C&#945;as a capacitance scaling factor
&#131;Includes impact of Cox, L, etc.
&#131;We see that the NAND gate is faster than the NOR gate-Ratio of current drive to capacitance is higherA
A
BBY
CL
AA
BB
Y
CL
W1
21=W1
21=W1
2.51=W1
2.51=
W11=W11=W1
51=
W1
51=NOR NAND
A: Cin= 6C&#945;
B: Cin= 6C&#945;A: Cin= 4.5C&#945;
B: Cin= 4.5C&#945;</text>
        </slide>
        <slide>
          <slideno>47</slideno>
          <text>M.H. Perrott MIT OCW
Comparison of Differential SCL to Full Swing Logic
&#131;Advantages-Much faster speed (&gt; 2X with resistor loads)-Quieter on supplies (good when analog parts nearby)
&#131;Disadvantages-Static current, need for biasing networks-Logic implementation more clumsyANAND AND
BLoad
Load
B
A AOR NOR
BLoad
Load
B
A2 input AND/NAND 2 input OR/NOR</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Guest Lecture by Richard Schreier, Analog Devices: Lowpass and Bandpass Delta-Sigma Modulation</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/guest5/</lecture_pdf_url>
      <lectureno>26</lectureno>
      <slides>
        <slide>
          <slideno>36</slideno>
          <text>37BP&#8710;&#931; Perspective #2
It is just the result of an
&#8220;N-Path Transformation&#8221;
&#8226;  (a &#8220;pseudo 2-path transformation&#8221;)
applied to  yields
&#8226; This transformation can be applied to any
system that processes DT signals, including SC&#64257;lters, digital &#64257;lters, &#8710;&#931; modulators and even
mismatch-shaping logic
By replacing the state storage elements (registers),
or by interleaving two copies of the original systemand negating alternate inputs and outputszz
2&#8211;&#8594;
Hz() 1z1&#8211;&#8211;= H'z() 1z2&#8211;+=</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>212. Advanced &#8710;&#931;</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>1MITOPENCOURSEWARE
MASSACUSETTS INSTITUTE OF TECHNOLOGY
6.976
High-Speed Communication Circuits and Systems
Lecture 29
Lowpass and Bandpass Delta-Sigma Modulation
Richard Schreier
Copyright &#169; 2003 Richard SchreierANALOG
DEVICES</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>41Example Spectrum
8th-Order fs/8 Bandpass Modulator
0 0.1 0.2 0.3 0.4 0.5-140-120-100-80-60-40-200dBFS/NBW
Normalized Frequency (1 &#8594;fs) SQNR = 100 dB
@ OSR = 64
NBW = 1.8x10&#8211;4fs</text>
        </slide>
        <slide>
          <slideno>47</slideno>
          <text>48Eliminating the Input gm
The output of the mixer is available in
current form, so &#8230;IF1
LO2LNAMixer
IDACgmRemainder
of ADC</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>18CTMOD1 Spectra
spec1
-100-500
spec2
-100-500
05101520253035404550
freq, x1e6 Hertzu = 1/32
-6dB peakdB dB
u = FS sine-wave</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>22A Single-Loop &#8710;&#931; Modulator
&#8226; The zeros in H come from the poles in L1E
L1L0 YVU
, where
Inverse Relations:
L1 = 1 &#8211; 1/H, L0 = G/HYL0UL1V+=
VY E+=VG U H E +=
H1
1L1&#8211;---------------= &amp;GL0H=</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>31Mismatch-Shaping
&#8226; Shapes mismatch-induced noise by ensuring
that each element in a unit-element DAC isdriven by a shaped sequence
Two popular forms of mismatch-shaping are
element-rotation  and element-swapping .
116
8
116
8
116
8
Time Time TimeSwapping Rotation Thermometer</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>26Multi-Bit Quantization
Toolbox Conventions
&#8226; Single-bit quantizer output interpreted as &#177;1
instead of 0,1.
Quantizer step size, &#8710;, is 2; input range is [-1,+1].
&#8226; Convention for multi-bit quantization is:
&#8710;= 2; # of Q. levels is nlev =M+1, from &#8211; M to +M;
no-overload range (| e|&#8804;1) is &#8211; nlev to +nlev.yv
eyv
eyv
eM = 1
1
-123
-21
-1
-3M = 2 M = 3
mid-tread quantizer;
v: even integersmid-rise quantizer;
v: odd integers</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>35A Bandpass &#8710;&#931; ADC
&#8226; Like a lowpass &#8710;&#931; ADC, a bandpass &#8710;&#931; ADC
converts its analog input into a bit-stream
The output bit-stream is essentially equal to the
input in the band of interest.
&#8226; A digital &#64257;lter removes out-of-band noise and
mixes the signal to baseband
digitalBandpass
Filter/
DecimatorBandpass
&#8710;&#931;
Modulatoruv complex
output
fs2&#8260;shaped
fBbaseband
signal
fs2&#8260;&#8211; fs2&#8260;signal
fs2&#8260;&#8211;analog1 bit @fs
2xn @fBw
noiseinput</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>4CTMOD1: A 1st-Order
Continuous-Time &#8710;&#931; Modulator
&#8226; The input signal, U, is converted into a sequence
of bits, V &#8712; (0,1).
CKURC
0,IVY</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>8CTMOD1 Model
&#8226; Normalize R=1 &#8486;, C=1F, I=1A, Fs=1Hz
Full-scale range is [0,1]V.
&#8226; Assume comparator and DAC are delay-free
DACuc v
vc&#8747;ycy</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>27SQNR Limits for 3-bit Modulators
N = 4N = 3 N = 2
N = 1N = 6
N = 5N = 7N = 8
OSRPeak SQNR (dB)
4 8 16 32 64 128 256 512 10240 20 40 60 80100120140</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>25SQNR Limits for Binary
Modulators
OSRPeak SQNR (dB)N = 4N = 3
N = 2
N = 1N = 6
N = 5N = 7N = 8
4816326412825651210240 20 40 60 80100120140</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>29Multi-Bit Quantization
Pros and Cons
&#8226; Multi-bit quantization overcomes stability-
induced restrictions on the NTF
Dramatic improvements are possible!
&#8226; Multi-bit quantization loses the inherent linearity
property of a binary DAC
DAC levels are not evenly spaced and so cannot be
joined with a straight line.
DAC errors are effectively added to the input, and
thus are not shaped.
Can be overcome with calibration, digital correction
or mismatch-shaping.</text>
        </slide>
        <slide>
          <slideno>49</slideno>
          <text>50Merge ADC with Mixer!
LC tank effectively adds gain, without adding
noise, adding distortion or consuming powerLO2
V-I CONVERTER
IDAC
LNAIF1No noise!
No distortion!
No power!</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>16CTMOD1 NTF and STF
&#8226; The NTF is the same as MOD1:
&#8226; MOD1&#8217;s STF is 1, so the overall STF is just the TF
of the pre&#64257;lter:NTF z() 1z1&#8211;&#8211;=z-plane:
STF s() est&#8211;gpt()td
0&#8734;&#8747;=
est&#8211;td
01&#8747;=1es&#8211;&#8211;()
s----------------------=
1z1&#8211;&#8211;()
s----------------------,  where z = es=s-plane:
2&#960;4&#960;</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>6Non-ideal Effects in CTMOD1
&#8226; Component shifts
R&#8594; R+&#8710;R or I&#8594; I+&#8710;I merely changes full-scale.
C&#8594; C+&#8710;C scales the output of the integrator,
but does not affect the comparator&#8217;s decisions.
&#8226; Op-amp offset, input bias current,
DAC imbalance
All translate into a DC offset, which is unimportant in
many communications applications.
&#8226; Comparator offset &amp; hysteresis
Overcome by integrator.
&#8226; Finite op-amp gain
Creates &#8220;dead-bands.&#8221;</text>
        </slide>
        <slide>
          <slideno>50</slideno>
          <text>51Noise Analysis
&#8226; Noise in the ADC backend is attenuated by gm
times the tank impedance
In this work, gm&#8776; 10 mA/VVingmVinvnvn
Zvn
gmZ
LNA/Mixer TankZ&#8211; + &#8211; +</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>23A 5th-Order Lowpass NTF
Zeros optimized for OSR=32
&#8226; Pole/Zero diagram:
OSR = 32;
H = synthesizeNTF(5,OSR,1);...
-1 0 1-101
Zeros spread across
the band-of-interest to
minimize the rms valueof the NTF.optimization
&#64258;ag
Poles such that ||H|| = 1.5.</text>
        </slide>
        <slide>
          <slideno>46</slideno>
          <text>47Eliminating the AAF with a
Continuous-Time BP &#931;&#8710; ADC
Anti-alias &#64257;ltering is inherent
But still need a low-noise, linear V-I convertergm FLASHIDAC
IDACIF2 gm</text>
        </slide>
        <slide>
          <slideno>63</slideno>
          <text>64SNR vs. Input Power
-110 -90 -70 -50 -30 -10020406080100SNR (dB)
FS range: &#8211;30 to &#8211;18 dBmOSR = 48OSR =900
Pin (dBm) fIF1 = 273 MHz
 fCLK = 32 MHz
DR = 90dB</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>24Example: 5th-Order Modulator
Normalized Frequency (1 &#8594;fs)0 0.5-120-100 -80 -60 -40 -20 0dBFS0  50 100-101
Time (sample number)
NBW = 1.8x10&#8211;4fs(8K-Point FFT)</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>31.&#8710;&#931; Basics</text>
        </slide>
        <slide>
          <slideno>45</slideno>
          <text>46Traditional Implementation
Numerous high-dynamic range blocks
Noise and power budgets are very tightLarge VGA range neededBP ADCIF1
LO2LNAMIXER
VGA AAFIF2</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>5Properties of CTMOD1
DC Inputs
&#8226; Integrator ensures that input current is exactly
balanced by the (average) feedback current
&#8220;In&#64257;nite resolution&#8221;
&#8226; Signals which alias to DC are rejected
&#8220;Inherent anti-aliasing&#8221;</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>15CTMOD1 Equivalent
&#8226; CTMOD1 is the same as a discrete-time &#64257;rst-
order modulator (MOD1) preceded by a sinc&#64257;lter!uc v
z-1y
td
01&#8747;uMOD1
z-1</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>17Frequency Responses
0123-50-40-30-20-10010
Frequency (Hz)dBNTF
STF
Inherent
Anti-AliasingQ. Noise
Notch</text>
        </slide>
        <slide>
          <slideno>58</slideno>
          <text>59ADC in More Detail
&#8226; Can save power under small-signal conditions
by reducing IDAC&#8217;s full-scale
By a factor of 4, in this ADCIF1
LNAfCLK = 9-36 MHz
MixerIDACRC SC
DEMExternal
LC Tank
Full-Scale Adjust10-300ElementsTunable
MHzFlash
LO2OSR = 48 to 960</text>
        </slide>
        <slide>
          <slideno>43</slideno>
          <text>44A Dual-Conversion
Superheterodyne Receiver
&#8226; A bandpass ADC &#64257;ts naturally into this
narrowband system
Perfect I/Q, high dynamic range. Low power?RFLNA ADC
1st IF Sample RateLO1DSP
CK
2nd IFLO2
50-2000 MHz 10-300 MHz 2-4 MHz 10-750 kspsAGC</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>11CTMOD1 @ 10% 1&#8217;s density
l(r)
l(ck)
v(u)
-101
-v(yn)
-2-101
l(v)
0.1.2.3.4.5.6.7.8.91
time, x1e-6 Seconds</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>2Outline
1&#8710;&#931; Basics
1st-Order Modulator
2 Advanced &#8710;&#931;
High-Order &#8710;&#931; Modulators
Multi-bit and Multi-Stage Modulation
3 Bandpass &#8710;&#931; Modulation
4 Example Bandpass ADC</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>30Digital Correction
&#8226; Lookup table contains the digital equivalent of
each DAC level
In practice, the look-up table only needs to store the
differences between the actual and ideal DAC levels.
&#8226; Thus vdig =vdac, so DAC errors are now shaped
by the loop!DACuv
vdac&#8747;Look-up
Tablevdig</text>
        </slide>
        <slide>
          <slideno>56</slideno>
          <text>57Third Resonator?
&#8226; Active-RC: Q&#8776; 10&#8658; Need 4th resonator
&#8226; Switched-Cap: Q is high &amp; drift is low;
&lt;1 mA for 300 nV/  i.r.n.Flash+&#8211;
+&#8211;?
Hz</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>28Theoretical SNR Limits
for Multi-Bit Modulators
10010120406080100120
N= 3
N= 2N= 4N= 5N= 6N= 7N= 8SNR (dB) @ OSR = 8
with 1 LSB (peak) input
Total RMS Noise Power (LSBs)H&#8734;2=H&#8734;8=
H&#8734;4=H&#8734;16=H&#8734;32=
H&#8734;is the max. gain of the NTF
over all frequencies.</text>
        </slide>
        <slide>
          <slideno>65</slideno>
          <text>66Performance Summary
Bandwidth 5 - 375 kHz
Input Frequency 10-300 MHz
Clock Frequency 9 - 36 MHz
Full-Scale Range 12 dB
Die Area 5 mm2
@fIF= 73MHz, BW = 333kHz, fCLK= 32MHz, VDD = 3V:
Dynamic Range 90dB
Current Consumption 16.5 mA
Noise Figure @ min FS 9 dB
IIP3 0dBm</text>
        </slide>
        <slide>
          <slideno>48</slideno>
          <text>49Merge ADC with Mixer!
&#8226; Eliminates redundant I-V &amp; V-I conversion
&#8226; Gives mixer and IDAC more headroomLO2
V-I CONVERTER
IDACTO/FROM
ADC
BACKENDMIXER
LNAIF1ADC input is
a current!No DC drop!ADC</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>10CTMOD1 @ 5% 1&#8217;s density
l(r)
l(ck)
v(u)
-101
-v(yn)
-2-101
l(v)
0.1.2.3.4.5.6.7.8.9 1
time, x1e-6 Seconds</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>12CTMOD1 @ 51% 1&#8217;s density
l(r)
l(ck)
v(u)
-101
-v(yn)
-101
l(v)
0.1.2.3.4.5.6.7.8.91
time, x1e-6 Seconds</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>14Analysis of CTMOD1
ycn() ycn1&#8211;() uc&#964;() vc&#964;()&#8211;() d&#964;
n1&#8211;n&#8747;+ =
1) Sample yc at integer time and identify y(n) =yc(n).
vc&#964;()d&#964;
n1&#8211;n&#8747;vn 1&#8211;()= 2) Observe that
yn() yn 1&#8211;() un() vn 1&#8211;()&#8211;+ =3) De&#64257;ne
THENun() uc&#964;()d&#964;
n1&#8211;n&#8747;=From the diagram:
Also, from the diagram
vn() Qyn()()=</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>33&#8710;&#931; Toolbox Summary
http://www.mathworks.com/matlabcentral/fileexchange/
Click onControl Systems, then delsig
NTF(andSTF)avail-
able.Specify OSR,
lowpass/bandpass,
no. of Q. levels.
synthesizeNTF
realizeNTF
predictSNR,ABCD: state-space
description of the
modulator.scaleABCD
Parameters for a spe-
ci&#64257;c topology.stuffABCD
mapABCD
Time-domain simula-
tion and SNR mea-
surements.simulateDSM,calculateTF
simulateSNRfindPIS,
find2dPIS
Convex positive
invariant set.Also designLCBP
designHBF
simulateESL &#8230;</text>
        </slide>
        <slide>
          <slideno>54</slideno>
          <text>55Remainder of ADC?
&#8226; Add resonator stages until the quantization
noise of the &#64258;ash is low enough
IDACFlashADC
Backend</text>
        </slide>
        <slide>
          <slideno>62</slideno>
          <text>63In-Band Spectrum (OSR=900)
-10 -5 0 5 10-120-100-80-60-40-200
Frequency Offset (kHz)dBFS/NBWSFDR = 106dBSNR = 92 dB  fIF1 = 73 MHz
 fCLK = 36 MHz
NBW = 15Hz-125 dBc/Hz
@ 1 kHz offset</text>
        </slide>
        <slide>
          <slideno>52</slideno>
          <text>53Z vs. Frequency
&#8226;Q= 20 reduces Zeff by about 4 dB0.8 0.9 1 1.1 1.2
f/f0Z
0.07 f01K2K5K10KIdeal
Zeff = 7KQ = 20
Zeff = 4.4K</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>42Bandpass Modulator Structure
&#8226; The loop &#64257;lter consists of a cascade of
resonators
The resonance frequencies determine the poles of
the loop &#64257;lter and hence the zeros of the NTF.
&#8226; Multibit and multistage variants are also
possibleQ
Quantizer
Loop FilterResonator Resonatoru
v</text>
        </slide>
        <slide>
          <slideno>60</slideno>
          <text>61Measured STF &amp; NTF
Frequency (MHz)dBFS/NBW
0 4 8 12 16&#8211;100&#8211;80&#8211;60&#8211;40&#8211;200
NBW = 5.9 kHzSTF
NTF (scaled)
fCLK = 32 MHzMeasured
STF
Measured
PSDf0 =fCLK/8</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>39A 6th-Order Bandpass NTF
&#8226; Pole/Zero diagram:
OSR = 64;
f0 = 1/6;H=synthesizeNTF(6,OSR,1,[],f0);...
-1 0 1-101</text>
        </slide>
        <slide>
          <slideno>44</slideno>
          <text>45System Partitioning
&#8226; Goal: a general-purpose, high-performance,
low-power back-endFront End
LO1 CK LO2Back End Custom
DSP
N</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>19Properties of MOD1
&#8226; Single-bit quantization yields &#8220;inherent linearity.&#8221;
The DAC de&#64257;nes two points and two points can
always be joined with a line. (Not so simple incontinuous-time.)
&#8226;
MOD1 is stable for inputs all the way up to full-scale.The quantizer in MOD1 does not &#8220;overload.&#8221;
&#8226; Assuming the quantization error is white with
power , the in-band noise power is
. ~12-bit performance at OSR=256.
Doubling OSR reduces noise power by a factor of 8.
&#8220;1.5 bits increase in SNR per octave increase inOSR&#8221;0u1&#8804;&#8804; y1&#8804;&#8658;
&#963;e2
N02&#960;2&#963;e2
3O S R()3------------------------ - &#8773;</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>40Example Waveform
8th-Order fs/8 Bandpass Modulator
0 50 100&#8211;101
Time (sample number)uv</text>
        </slide>
        <slide>
          <slideno>53</slideno>
          <text>54Tuning the LC Tank
&#8226;&#8710;f0/f0 = 2%&#8658;3 dB reduction in Zeff
Inductor accuracy is 10%, so tuning is required
Off-chip
Negative- gmCap. arraytankMake an oscillator:</text>
        </slide>
        <slide>
          <slideno>59</slideno>
          <text>60Noise vs. Full-Scale
-30 dBm -18 dBm051015
LNA/Mixer
Full-ScaleInput-Referred Noise
Total(dB relative to a 300 &#8486; resistor)
RC
IDA
C ThermalIDA
C Mismatc
h
Quantization
SC
50mVpp 200 mVpp</text>
        </slide>
        <slide>
          <slideno>64</slideno>
          <text>65Architectural Highlights
Merging a mixer with a continuous-time
bandpass ADC containing an LC tank yields a&#64258;exible, high-performance, low-power receiverbackend.
Performing a component-count/performance/
power trade-off in each resonator section resultsin a multi-bit, hybrid continuous-time/discrete-time architecture.
A variable full-scale saves power and reduces
noise.</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>7Non-ideal Effects (cont&#8217;d)
&#8226; DAC jitter
Adds &#8220;noise.&#8221;
&#8226; Resistor nonlinearity (e.g. due to self-heating)
Introduces distortion.
&#8226; DAC nonlinearity
Introduces distortion and intermodulation of shaped
quantization noise.
&#8226; Capacitor nonlinearity
Irrelevant.
&#8226; Op-amp nonlinearity
Same effects as DAC nonlinearity, but less severe.</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>36BP&#8710;&#931; Perspective #1
It is just Filtering and Feedback
&#8226; Putting the poles of the loop &#64257;lter at &#969;0
forces H to have zeros at &#969;0
&#8226; Example system diagram:
DACLots of gain at &#969;0
&#969;02
s2&#969;02+-------------------</text>
        </slide>
        <slide>
          <slideno>66</slideno>
          <text>67Bandpass &#8710;&#931; ADCs
BandwidthDynamic Range (dB)
406080100120
10kHz 10 0MHz 1 MHz
 Schreier 2002 Veldhoven 2003Jantzi/Ferguson
 Hairapetian 1996
 Norman Tabatabaei 2000
Henkel Salo 2002
 Salo 2002 Ueno 2002
 1996
20021994
RaghavanBulzachelli
19972003</text>
        </slide>
        <slide>
          <slideno>67</slideno>
          <text>68Summary
&#8226;&#8710;&#931; is fun
All kinds of exotic behavior: limit-cycles, dead-bands
sub-harmonic locking and even chaotic dynamics!
&#8226;&#8710;&#931; is a rich &#64257;eld
ADCs and DACs; Single-bit and Multi-bit; Single-
stage and Multi-stage; Lowpass and Bandpass;Discrete-time and Continuous-time&#8230;
&#8226; A bandpass &#8710;&#931; ADC converts an IF signal into
digital form and can do so with high dynamicrange and low power consumption
With wideband or tunable modulators, conversion of
RF to digital may soon be feasible.
ADC = &#8220;Antenna to Digital Converter&#8221;</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>343. Bandpass &#8710;&#931;</text>
        </slide>
        <slide>
          <slideno>55</slideno>
          <text>56Second Resonator?
&#8226; LC: Needs more external components plus
associated pins
&#8226; Active-RC: 2 mA for 50nV/ input-referred noise&#8226; Switched-Cap: est. &gt;10mA for same noise
IDACFlashADC
Backend
Hz</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>32Multi-Stage Modulation
2nd-order
modulator
2nd-order
modulator4(1 - z -1)2mod = mod2;
ABCD = mod.ABCD;[v1 x] = simulateDSM(input,ABCD);v2 = simulateDSM(x(2,:)/4,ABCD);v = filter([0 2 -1],1,v1) + ...
4*filter([1 -2 1],1,v2);v1
v2vu
x2
G =z -1,z -1(2 - z -1)
0.25
10-310-210-1-120-100-80-60-40-200dBFS
NBW=1.8E-4H = (1 -z -1)2SQNR = 56 dBOSR=32
v1
v
SQNR = 81 dB
Composite NTF is 4 H2</text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>434. Design Example</text>
        </slide>
        <slide>
          <slideno>51</slideno>
          <text>52Zeff
&#8226; Near resonance, | ZL| = |ZC|
|ZL,C|&#8776; 300&#8486; in this design
&#8226; At resonance, | Z|&#8776;Q &#8226; |ZL,C|
About 6k &#8486; forQ = 20&#8658;gmZ&#8776;60.
&#8226; More generally, the effective tank impedance is
found by integrating the input-referred noiseover the band of interest:
vn
gmZ&#969;()--------------------&#63725;&#63736;&#63723;&#63734;2
&#969;d&#8747;vn
gm-------&#63725;&#63736;&#63723;&#63734;2
Y&#969;()2&#969;d&#8747;vn
gmZeff------------------&#63725;&#63736;&#63723;&#63734;2
==
Zeff&#8658; Yrms()1&#8211;=</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>20MOD1 Properties (cont&#8217;d)
&#8226; DC input u =  results in period- b behavior.
The spectrum of the error is not white! Spectrum
consists of a &#64257;nite set of harmonics of .
&#8226; Irrational DC inputs result in aperiodic behavior.
Nonetheless, the spectrum of the error is stilldiscrete!Spectrum consists of an in&#64257;nite number of toneswith frequencies that are irrational fractions of .
&#8226; Finite op-amp gain shifts NTF zero inside the
unit circle and allows a range of u values to
produce the same limit cycle.
Worst case is around ;
yields &#8220;dead bands.&#8221;
&#8226; The behavior of MOD1 is erratic.a
b---
fsb&#8260;
fs
u011
2---,, etc. =</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>38BP&#8710;&#931; Perspective #3
It is something New and Valuable
&#8226;B P&#8710;&#931; offers a way to make a &#8220;tuned&#8221; ADC
Possibly the only way.
Ideally-suited to narrowband systems, i.e. radios.
&#8226;B P&#8710;&#931; keeps the signal away from 1/f noise as
well as low-frequency distortion products
Like regular narrowband bandpass systems,
second-harmonic distortion is not problematic.
z-1z-1z-1-1ORH(z)
H(z)1,1,-1,-1 1,1,-1,-1</text>
        </slide>
        <slide>
          <slideno>57</slideno>
          <text>58Complete ADC
&#8226; Eliminates high-power VGA &amp; AAF
2/3 of the total power used by LNA, Mixer &amp; IDAC
&#8226; Uses cts-time and discrete-time elements, plus
multi-bit quantization and mismatch-shapingLNA/
IDACLC RC SC9-Level
Flash
IF1Data
out
Mixer LO2
2 mA 3 mA 1 mA 1 mADEM
9m A</text>
        </slide>
        <slide>
          <slideno>61</slideno>
          <text>62In-Band Spectrum (OSR=48)
-150 -100 -50 0 50 100 150-140-120-100-80-60-40-200
Frequency Offset (kHz)dBFS/NBW
NBW = 200HzBW = 270kHzSFDR = 103dBSNR = 81 dB  fIF1 = 103 MHz
 fCLK = 26 MHz</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>13CTMOD1 @1/ &#960; 1&#8217;s density
l(r)
l(ck)
v(u)
-101
-v(yn)
-2-101
l(v)
0.1.2.3.4.5.6.7.8.91
time, x1e-6 Seconds7
22------1
3---</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>9Waveforms/Timing
012345 67891 0ttyc
Comparator
Threshold
vcu = 0.2
-1
v(0) v(1) v(2) v(3)v(4) V1
5---=01
01</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Performance Measures of Wireless Communication</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec20/</lecture_pdf_url>
      <lectureno>20</lectureno>
      <slides>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
Define &#8220;Available Power Gain&#8221;
&#131;Available power gain for stage 1 defined as
-Available power at output
-Available source powerAvailable power at output (matched load)
Available source power (matched load)RL=Rout1 Av1vin1Rout1
Rin1Rs
vsGain Stage 1
vin1 Rin1=RsRs
vsSource
vin1Available Source Power Available Power at Output
Source
Ap1= </text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>M.H. Perrott MIT OCW
Cascaded IIP3 Calculation with Narrowband Stages
&#131;Note that &#945;1and &#946;1correspond to the loaded voltage 
gain values for Stage 1 and 2, respectivelyMemoryless
Nonlinearity
xyMemoryless
Nonlinearity
zBandpass
Filtering Action
of AmplifierMemoryless
Nonlinearity
rBandpass
Filtering Action
of Amplifier
Stage 1 Stage 2 Stage 3&#945;1, &#945;2, &#945;3 &#946;1, &#946;2, &#946;3 &#947;1, &#947;2, &#947;3
</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>M.H. Perrott MIT OCW
Alternate Expression for Overall IIP3
&#131;Worst case IIP3 estimate &#8211; take absolute values of terms
&#131;Square and invert the above expression
&#131;Express formulation in terms of IIP3 of stage 1 and stage 2Memoryless
Nonlinearity
xyMemoryless
Nonlinearity
z
Stage 1 Stage 2
</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Modulation Scheme on SNR/BER
&#131;Lowering the number of constellation points increases 
dminfor a fixed input signal amplitude-SNR is increased (given a fixed noise variance)-Bit error is reduced
&#131;Actual situation is more complicated when coding is usedPeak
AmplitudeAverage
Amplitude
IQ
Probability Density
Function for Noise
(I-Component)
Probability Density
Function for Noise
(Q-Component)dmin
dmin</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Final Expressions for Cascaded Noise Factor Calculation
&#131;Overall Noise Factor (general expression)
&#131;Overall Noise Factor when all input and output 
impedances equal Rs:RsensSource
VsStage 1
Rin1 Rout1VoutRLNote: noise of R L
not included in
Noise Factor calculation
Unloaded
voltage gain
= Av1NF1Stage 2
Rin2 Rout2Unloaded
voltage gain
= Av2NF2Stage k
Rink RoutkUnloaded
voltage gain
= AvkNFk
</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
A Key IIP3 Expression
&#131;By inspection of the right figure
&#131;Combining the above expressions:f
0&#8710;P
2f3-f42f3-f4IM3
product
f3f4
PIIP3POIP3
&#8710;P
x
PinFundamental
Power
IM3 Product
PowerFundamental
1
3
Input Power (dBm)Output Power (dBm)
</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Step 1:  Create an Equivalent Noise Voltage Source
in2en2
Rin2 Av1vin1Rout1
Rin1Rs
vs vin1
in2en2
Rin2 Av1vin1Rout1
Rin1Rs
vs vin1
en2+Rout1in2
Rin2 Av1vin1Rout1
Rin1Rs
vs vin1</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
&#8220;Level Diagram&#8221; for Gain, NF Calculation
Stage Gain (dB)
Voltage (loaded)
Power
Cumulative
Voltage Gain (dB)
Stage NF (dB)
Cumulative
NF (dB)AB C D E F G
-2.5 14.5 10.5 25.5 22.5-2.5 17 -4 15 -3
-2.5 17 -4 5 -31515
37.5
2.5 1.5 4 13 3 9
6.7 4.2 17.9 13.9 12 9LNAImage Reject
FilterChannel
FilterensSource (Antenna)
VsAmpBand Select
Filter
IF outLO
50 &#8486;
50 &#8486;Ap1 = -2.5 dB
Av2_l = 17 dB
NF2 = 1.5 dBAp3 = -4 dB
Av4_l = 15 dB
NF4 = 13 dBAp4_l = 5 dBAp5 = -3 dB
NF6 = 9 dBAB C D E F G
Av6_l = 15 dB</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
View SNR Issue with Constellation Diagram
&#131;Noise causes sampled I/Q values to vary about their 
nominal values
&#131;Bit errors are created when sampled I/Q values cross decision boundariesDecision
Boundaries
Decision
Boundaries00 01 11 10
00
01
11
10IQ</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
Key Parameters for SNR/BER Analysis
&#131;Bit error rate (BER) is a function of-Variance of noise-Distance between constellation points (dmin)
&#131;Larger dminwith a fixed noise variance leads to higher 
SNR and a lower bit error rateDecision
Boundaries
Decision
Boundaries00 01 11 10
00
01
11
10IQ
Probability Density
Function for Noise
(I-Component)
Probability Density
Function for Noise
(Q-Component) dmindmin</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>M.H. Perrott MIT OCW
A Closer Look at Impact of Second Order Nonlinearity
&#131;Influence of &#945;2of Stage 1 produces tones that are at 
frequencies far away from two tone input
Memoryless
Nonlinearity
xy
w1 0 w2WX(w)Two tone test
0 w1
2w2+w1w2 2w2
2w1-w2 2w1+w2 2w2-w1w1+w2w2-w1 2w1 3w2 3w1WY(w)Memoryless
Nonlinearity
z
w1w2
2w1-w22w2-w1WZ(w)&#945;2, &#945;3&#945;3 &#945;3 &#945;2&#945;1, &#945;2, &#945;3 &#946;1, &#946;2, &#946;3</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Example: Impact of Cascading Passive Filter with LNA
VoutRLRsensSource
VsNote: noise of R L
not included in
Noise Factor calculation
Passive
FilterLNA
Insertion Loss
= 2 dBNoise Figure
= 1.5 dB
&#131;Noise Factor calculation
&#131;Noise Figure</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Input Referral of Noise to First Stage
&#131;WhereRsens
Vs in1en1
Vin1Stage 1
(Noiseless)
Vout1
Rin1 Rout1Vin2 Vout2
Rin2 Rout2RL Stage 2
NoiseStage 2
(Noiseless)
Unloaded
voltage gain
= Av1Unloaded
voltage gain
= Av2en2+Rout1in2
&#945;1RsensSource
Vs in1en1
Vin1Stage 1
(Noiseless)
Vout1
Rin1 Rout1in2en2
Vin2 Vout2
Rin2 Rout2RLInput-referred
Noise for Stage 1Input-referred
Noise for Stage 2Note: noise of R L
not included in
Noise Factor calculation
Stage 2
(Noiseless)
Unloaded
voltage gain
= Av1Unloaded
voltage gain
= Av2
</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Alternate View of Previous Constellation
&#131;Common modulation method is to transmit 
independent binary signals on I and Q channels
&#131;The above constellation has the same dminas the one 
on the previous slide-Obtains the same SNR/BER performance given that the 
noise on I/Q channels is symmetricPeak
AmplitudeAverage
Amplitude
IQ
Probability Density
Function for Noise
(-45 Degree Component)
Probability Density
Function for Noise
(+45 Degree Component)dmin
dmin</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
Noise Factor Calculation
Rsens
Vs in1en1
Stage 2
Noiseen2+Rout1in2
&#945;1RsensSource
Vs in1en1
Vin1Stage 1
(Noiseless)
Vout1
Rin1 Rout1in2en2
Vin2 Vout2
Rin2 Rout2RLInput-referred
Noise for Stage 1Input-referred
Noise for Stage 2Note: noise of R L
not included in
Noise Factor calculation
Stage 2
(Noiseless)
Unloaded
voltage gain
= Av1Unloaded
voltage gain
= Av2
isc
</text>
        </slide>
        <slide>
          <slideno>43</slideno>
          <text>M.H. Perrott MIT OCW
Example:  IIP3 Calculation for RF Receiver
&#131;Ports A, B, C, and D are conjugate-matched for an 
impedance of 50 Ohms-IIP3 of LNA and mixer are specified for source 
impedances of 50 Ohms
&#131;Ports E and F and conjugate-matched for an 
impedance of 500 Ohms-IIP3 of rightmost amplifie r is specified for a source 
impedance of 500 OhmsLNAImage Reject
FilterChannel
FilterensSource (Antenna)
VsAmpBand Select
Filter
IF outLO
50 &#8486;
50 &#8486;Ap1 = -2.5 dB
Av2_l = 17 dB
IP32 = 11 dBmAp3 = -4 dB
Av4_l = 15 dB
IP34 = 8 dBmAp5 = -3 dB
IP36 = 800 mV rmsAB C D E F G
Av6_l = 15 dBIP31 = very large IP3 3 = very large IP3 5 = very large30 dB rejection
of interfers</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
Methodology for Cascaded NF Calculation
&#131;Perform Noise Figure calculations from right to left
&#131;Calculation of cumulative Noise Factor at node k
-If source and load impedances are equal
&#131;True for all blocks except mixer aboveLNAImage Reject
FilterChannel
FilterensSource (Antenna)
VsAmpBand Select
Filter
IF outLO
50 &#8486;
50 &#8486;Ap1 = -2.5 dB
Av2_l = 17 dB
NF2 = 1.5 dBAp3 = -4 dB
Av4_l = 15 dB
NF4 = 13 dBAp4_l = 5 dBAp5 = -3 dB
NF6 = 9 dBAB C D E F G
Av6_l = 15 dB
</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Spurious Free Dynamic Range (SFDR)
&#131;Key expressions:-Minimum Pin(dBm) set by SNRminand noise floor
&#131;Where F is the input referred noise floor of the receiver
-Max Pin(dBm) occurs when IM3 products = noise floor
&#131;Dynamic range:  subtract min from max Pin(in dB)
</text>
        </slide>
        <slide>
          <slideno>46</slideno>
          <text>M.H. Perrott MIT OCW
&#8220;Level Diagram&#8221; for Gain, IIP3 Calculations
Stage Gain (dB)
Voltage (loaded)
Power
Cumulative
Voltage Gain (dB)
Stage IIP3
Cumulative IIP3
Voltage (mV rms)AB C D E F G
-2.5 14.5 10.5 25.5 22.5-2.5 17 -4 15 -3
-2.5 17 -4 5 -31515
37.5
Very large 11 Very large 8 Very large 1.07 
164.4 123.3 883.4 557.4 25.3e3 800LNAImage Reject
FilterChannel
FilterensSource (Antenna)
VsAmpBand Select
Filter
IF outLO
50 &#8486;
50 &#8486;Ap1 = -2.5 dB
Av2_l = 17 dB
IP32 = 11 dBmAp3 = -4 dB
Av4_l = 15 dB
IP34 = 8 dBmAp5 = -3 dB
IP36 = 800 mV rmsAB C D E F G
Av6_l = 15 dBIP31 = very large IP3 3 = very large IP3 5 = very large
Voltage (mV rms)Power (dBm)
Very large 793.4 Very large 561.7 Very large 80030 dB rejection
of interfers
-2.67 -5.17 11.93 7.93 91 1.07 Power (dBm)IP32 = 793.4 mV rms IP34 = 561.7 mV rms</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Overall IIP3 for Cascaded Stages
&#131;Assume nonlinearity of each stage characterized as
&#131;Multiply nonlinearity expressions and focus on first 
and third order terms
&#131;Resulting IIP3 expressionMemoryless
Nonlinearity
xyMemoryless
Nonlinearity
z
</text>
        </slide>
        <slide>
          <slideno>44</slideno>
          <text>M.H. Perrott MIT OCW
Key Formulas for IIP3 Calculation
&#131;Perform IIP3 calculations from right to left
&#131;Calculation of cumulative IIP3 at node k                  
(IIP3 in units of rms voltage)
-Conversion from rms voltage to dBm
LNAImage Reject
FilterChannel
FilterensSource (Antenna)
VsAmpBand Select
Filter
IF outLO
50 &#8486;
50 &#8486;Ap1 = -2.5 dB
Av2_l = 17 dB
IP32 = 11 dBmAp3 = -4 dB
Av4_l = 15 dB
IP34 = 8 dBmAp5 = -3 dB
IP36 = 800 mV rmsAB C D E F G
Av6_l = 15 dBIP31 = very large IP3 3 = very large IP3 5 = very large30 dB rejection
of interfers</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Cumulative Noise Factor Calculations
LNAImage Reject
FilterChannel
FilterensSource (Antenna)
VsAmpBand Select
Filter
IF outLO
50 &#8486;
50 &#8486;Ap1 = -2.5 dB
Av2_l = 17 dB
NF2 = 1.5 dBAp3 = -4 dB
Av4_l = 15 dB
NF4 = 13 dBAp4_l = 5 dBAp5 = -3 dB
NF6 = 9 dBAB C D E F G
Av6_l = 15 dB
</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Having Narrowband Amplification
&#131;Removal of outside frequencies dramatically 
simplifies overall IIP3 calculation
Memoryless
Nonlinearity
xy
w1 0 w2WX(w)Two tone test
w1w2
2w1-w22w2-w1WY(w)Memoryless
Nonlinearity
zBandpass
Filtering Action
of Amplifier
w1w2
2w1-w22w2-w1WZ(w)&#945;3 &#945;3&#945;1, &#945;2, &#945;3 &#946;1, &#946;2, &#946;3</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
Relationship Between Amplitude and Constellation
&#131;Distance of I/Q constellation point from origin 
corresponds to instantaneous amplitude of input 
signal at that sample time
&#131;Amplitude is measured at receiver and a function of-Transmit power-Distance between transmitter and receiver (and channel)Peak
AmplitudeAverage
Amplitude
IQ
Probability Density
Function for Noise
(I-Component)
Probability Density
Function for Noise
(Q-Component) dmindmin</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
Mathematical Analysis of SNR versus Bit Error Rate (BER)
&#131;Model noise impacting I and Q channels according to 
a probability density function (PDF)-Gaussian shape is often assumed
&#131;Receiver bit error rate can be computed by calculating 
probability of tail regions of PDF curvesDecision
Boundaries
Decision
Boundaries00 01 11 10
00
01
11
10IQ
Probability Density
Function for Noise
(I-Component)
Probability Density
Function for Noise
(Q-Component)</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
The Issue of Receiver Nonlinearity
&#131;Lower limit of input power into receiver is limited by 
sensitivity (i.e., required SNR, Noise Figure, etc.)
&#131;Upper limit of input power into receiver is determined 
by nonlinear characteristics of receiver-High input power will lead to distortion that reduces 
SNR (even in the absence of blockers)-Nonlinear behavior often characterized by IIP3 
performance of receiverSynthesizerLNAImage Reject
FilterChannel
Filter
RsensSource (Antenna)
Vs Rin
0Channel
Bandwidth = B Hzf|Gain|
Overall Receiver IIP3 = P IIP3 dBmAmpBand Select
Filter
IF out
f1 0 f2fVin(f)
Two-Tone TestVin
f
0&#8710;P
2f3-f42f3-f4IM3
product
f3f4</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Increased Signal Power At Receiver
&#131;Separation between constellation points, dmin, 
increases as received power increases
&#131;Noise variance remains roughly constant as input 
signal power is increased-Noise variance primarily determined by receiver circuits
&#131;Bit error rate improves with increased signal power!Peak
AmplitudeAverage
Amplitude
IQ
Probability Density
Function for Noise
(I-Component)
Probability Density
Function for Noise
(Q-Component)dmin
dmin</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
Method:  Refer All Noise to Input of First Stage
&#131;Model for referring stage 2 noise to input of stage 1RsensSource
Vs in1en1
Vin1Stage 1
(Noiseless)
Vout1
Rin1 Rout1in2en2
Vin2 Vout2
Rin2 Rout2RLInput-referred
Noise for Stage 1Input-referred
Noise for Stage 2Note: noise of R L
not included in
Noise Factor calculation
Stage 2
(Noiseless)
Unloaded
voltage gain
= Av1Unloaded
voltage gain
= Av2
in2en2
Rin2 Av1vin1Rout1
Rin1Rs
vsGain Stage 1
(Noiseless)Input impedance
and input-referred noise
for Gain Stage 2Source resistance
for Stage 1
vin1</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
Step 2:  Input Refer Voltage Noise Source
&#131;Scaling factor &#945;1is a function of unloaded gain, Av, 
and input voltage divideren2+Rout1in2
Rin2 Av1vin1Rout1
Rin1Rs
vs vin1
en2+Rout1in2
Rin2 Av1vin1Rout1
Rin1Rs
vs vin1&#945;1
</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
Refer All Signals to Input in Previous IIP3 Expression
&#131;Difference between fundam ental and IM3 products, &#8710;P, is 
the same (in dB) when referred to input of amplifier-Both are scaled by the inverse of the amplifier gain
&#131;Applying algebra:f
0&#8710;P
2f3-f42f3-f4IM3
product
f3f4
PIIP3POIP3
&#8710;P
x
PinFundamental
Power
IM3 Product
PowerFundamental
1
3
Input Power (dBm)Output Power (dBm)
</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
Define &#8220;Available Power Gain&#8221; For Passive Networks
&#131;Available power at output
&#131;Available source power
RL=Rout AvVinRout
RinRs
Vs Vin Rin=RsRs
Vs VinAvailable Source Power Available Power at Output
Vout</text>
        </slide>
        <slide>
          <slideno>47</slideno>
          <text>M.H. Perrott MIT OCW
Final Comments on IIP3 and Dynamic Range
&#131;Calculations we have presented assume-Narrowband stages
&#131;Influence of second order nonlinearity removed-IM3 products are the most important in determining 
maximum input power
&#131;Practical issues-Narrowband operation cannot always be assumed-Direct conversion architectures  are also sensitive to IM2 
products (i.e., second order distortion)-Filtering action of channel f ilter will not reduce in-band 
IM3 components of blockers (as assumed in the previous example in node E calculation)
Must perform simulations to accurately characterize
IIP3 (and IIP2) and dynamic range of RF receiver</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Noise Figure of Cascaded Stages
&#131;Want to calculate overall noise figure of above system
&#131;Assumptions-Input refer the noise sources of each stage-Model amplification (or attenuation) of each stage as a 
noiseless voltage controlled voltage source with an unloaded gain equal to A
v-Ignore noise of final load resi stor (or could input refer to 
previous stage)RsensSource
Vs in1en1
Vin1Stage 1
(Noiseless)
Vout1
Rin1 Rout1in2en2
Vin2 Vout2
Rin2 Rout2RLInput-referred
Noise for Stage 1Input-referred
Noise for Stage 2Note: noise of R L
not included in
Noise Factor calculation
Stage 2
(Noiseless)
Unloaded
voltage gain
= Av1Unloaded
voltage gain
= Av2</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
Alternate Noise Factor Expression
</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
Recall Digital Modulation for Wireless Link
&#131;Send discrete-leveled values on I and Q channels
&#131;Performance issues-Spectral efficiency (transmitter)-Bit error rate performance (receiver)
&#131;Nonidealities-Intersymbol interference-Noise-InterferersReceiver Output
2cos(2 &#960;f1t)
2sin(2 &#960;f1t)Lowpassir(t)
Lowpass
qr(t)it(t)
qt(t)2cos(2 &#960;f1t)
2sin(2 &#960;f1t)t
ttBaseband Input
tDecision
Boundaries Sample
Times</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
Receiver Dynamic Range
&#131;Defined as difference (in dB) between max and min input 
power levels to receiver-Min input power level set  by receiver sensitivity-Max input power set by nonlin ear characteristics of receiver
&#131;Often defined as max input power for which third order IM 
products do not exceed the noise floor in a two tone testSynthesizerLNAImage Reject
FilterChannel
Filter
RsensSource (Antenna)
Vs Rin
0Channel
Bandwidth = B Hzf|Gain|
Overall Receiver IIP3 = P IIP3 dBmAmpBand Select
Filter
IF out
f1 0 f2fVin(f)
Two-Tone TestVin
f
0Noise
Floor &#8710;P
B Hz
Overall Receiver Noise Factor = NF</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Available Power Gain Versus Loaded Voltage Gain
&#131;Available power gain for stage 1
&#131;If Rin1= Rout1= Rs
-Where Av1_lis defined as the &#8220;loaded gain&#8221; of stage 1RL=Rout1 Av1vin1Rout1
Rin1Rs
vsGain Stage 1
vin1 Rin1=RsRs
vsSource
vin1Available Source Power Available Power at Output
Source
</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Suppose that a receiver has a noise figure of 8 dB, 
channel bandwidth is 1 MHz, and the minimum SNR at 
the receiver output is 12 dB to achieve a BER of 1e-3-Receiver sensitivity (f or BER of 1e-3) isRsensSource (Antenna)
Vs RinVin
0Channel
Bandwidth = B HzfSNR in
Overall Receiver
Noise Factor = NFExample Calculation for Receiver Sensitivity
</text>
        </slide>
        <slide>
          <slideno>45</slideno>
          <text>M.H. Perrott MIT OCW
Cumulative IIP3 Calculations
LNAImage Reject
FilterChannel
FilterensSource (Antenna)
VsAmpBand Select
Filter
IF outLO
50 &#8486;
50 &#8486;Ap1 = -2.5 dB
Av2_l = 17 dB
IP32 = 11 dBmAp3 = -4 dB
Av4_l = 15 dB
IP34 = 8 dBmAp5 = -3 dB
IP36 = 800 mV rmsAB C D E F G
Av6_l = 15 dBIP31 = very large IP3 3 = very large IP3 5 = very large30 dB rejection
of interfers
IP32 = 793.4 mV rms IP34 = 561.7 mV rms
</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Noise Factor for Lossy Passive Networks
&#131;RF systems often employ passive filters for band 
select and channel select operations-Achieve high dynamic range and excellent selectivity
&#131;Practical filters have loss-Can model as resistance in  equivalent RLC network-Such resistance adds ther mal noise, thereby lowering 
noise factor of receiver
&#131;We would like to calculate noise factor contribution of lossy passive networks in a straightforward manner
-See pages 46-48 of Razavi bookVin
RinVout
RoutRLL
CRsensSource
VsPassive Network with LossNote: noise of R L
not included in
Noise Factor calculation enloss Rloss</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 20
Performance Measures of Wireless Communication
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Example: Noise Factor Calculation for RF Receiver
&#131;Ports A, B, C, and D are conjugate-matched for an 
impedance of 50 Ohms-Noise figure of LNA and mixer  are specified for source 
impedances of 50 Ohms
&#131;Ports E and F and conjugate-matched for an impedance of 500 Ohms
-Noise figure of rightmost amplifier is specified for a 
source impedance of 500 OhmsLNAImage Reject
FilterChannel
FilterensSource (Antenna)
VsAmpBand Select
Filter
IF outLO
50 &#8486;
50 &#8486;Ap1 = -2.5 dB
Av2_l = 17 dB
NF2 = 1.5 dBAp3 = -4 dB
Av4_l = 15 dB
NF4 = 13 dBAp4_l = 5 dBAp5 = -3 dB
NF6 = 9 dBAB C D E F G
Av6_l = 15 dB</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
Minimum Input Power to Achieve Acceptable SNR
&#131;Calculation of input SNR in terms of input power
&#131;Combine (1) and (2)
(1)
(2)RsensSource (Antenna)
Vs RinVin
0Channel
Bandwidth = B HzfSNR in
Overall Receiver
Noise Factor = NF</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Sensitivity of receiver is defined as minimum input 
power that achieves acceptable SNR (in units of dBm)
RsensSource (Antenna)
Vs RinVin
0Channel
Bandwidth = B HzfSNR in
Overall Receiver
Noise Factor = NFReceiver Sensitivity</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
Equivalent Noise Model and Resulting NF Calculation
&#131;Total noise at output
&#131;Noise due to source (referred to output)
&#131;Noise factor
Equivalent Model for
Computing Total Noise
RL AvVinRout
RinRs
Vsens
VoutRLRout
VoutenoutEquivalent Model for
Computing Source Noise Contribution
Vin
</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
Simplified Expression for Minimum Input Power
&#131;Assume that the receiver input impedance is matched 
to the source (i.e., antenna, etc.)
&#131;Resulting expression
-At room temperature:
</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Receiver Noise
&#131;Performance impact-SNR is reduced, leading to possible bit errors
&#131;Methods of increasing SNR-Decrease bandwidth of receiver lowpass
&#131;SNR is traded off for intersymbol interference-Increase input power into receiver
&#131;Increase transmit power and/or  shorten its distance from 
receiverReceiver Output
2cos(2 &#960;f1t)
2sin(2 &#960;f1t)Lowpassir(t)
Lowpass
qr(t)it(t)
qt(t)2cos(2 &#960;f1t)
2sin(2 &#960;f1t)t
ttBaseband Input
tDecision
Boundaries Sample
TimesInput-referred
Receiver
Noise</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Noise Factor on Input-Referred SNR
&#131;To achieve acceptable bit error rates (BER)
&#131;Refer SNR requirement to input
SynthesizerLNAImage Reject
FilterChannel
Filter
RsensSource (Antenna)
Vs RinVin
0Channel
Bandwidth = B Hzf|Gain|SNR in SNR out
Overall Receiver Noise Factor = NFAmpBand Select
Filter
IF out</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Guest Lecture by Analog Devices: RF Power Amplifiers</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/guest3/</lecture_pdf_url>
      <lectureno>24</lectureno>
      <slides>
        <slide>
          <slideno>17</slideno>
          <text>18
RF   IF
Seems simple, so why is this so hard?
&#139;Determining IMAXis not so easy 
zFor BJTs, one reference suggested that &#8220;the best way of 
estimating its value is to buil d an optimized class A amplifier 
and observe the dc supply current.&#8221;1
zSomewhat easier for depl etion-mode GaAs FETs &#8211; IMAXoften 
corresponds to VGS = 0V
zValues don&#8217;t scale linearly  with transistor size 
&#139;Optimal load resistance only a theoretical number
zTransmission line effects, par asitic L&#8217;s and C&#8217;s significant at RF
zCommon practice is to vary the lo ad of an actual transistor to 
determine the peak output power: the load-pull measurement
(Noticing a distinct pattern of  &#8220;empirical&#8221; design emerging?)
1RF Power Amplifiers for Wireless Communicat ions, Steve Cripps, Arte ch House, Boston, 1999.</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>40
RF   IF
Real-World Design Example
VB1VB250 &#8486; RF inputVPOS
VB2may need
to add feedback
for stability</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>26
RF   IF
High-Efficiency PAs
&#139;Summary of PA &#8220;ideal&#8221; peak efficiencies
Class A:(IMAX/2) /&#8730;2 &#8901;VPOS /&#8730;2
(IMAX /2) &#8901;VPOSP1
Pdc==  5 0  %
Class B:(IMAX/2) /&#8730;2 &#8901;VPOS /&#8730;2
(IMAX /&#960;) &#8901;VPOSP1
Pdc==  7 8  %
Class C: Ideally can go to 100%, but P1drops 
steadily beyond &#945;=&#960;, goes to 0 at 100%!</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>20
RF   IF
High-efficiency PAs
&#139;Input signal swing turns on transistor &#8211; conduction for 
only part of sinusoidal period
IDor IC (mA/mm)
VDSor VCE(V)IMAX
Quiescent point:
Class AB to BClass A</text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>43
RF   IF
System Specifications
&#139;Ruggedness
z50 &#8486;load is for antenna in free spac e.  Place antenna on a metal 
plate and can easily get VSWR of 4:1
zTypical PA specs are: don&#8217;t oscillate at up to 4:1, survive up to 
10:1 (!)
t = t2V1&#8722;V1
zt = t1V1+V1&#8722;= &#915;&#8901;V1+
tV1</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>8
RF   IF
Linear and Non-linear PAs
&#139;&#8220;Non-linear PA&#8221; generally refers to a PA designed to operate 
with constant PIN, output power varies by changing gainPOUT(dBm)
PIN(dBm)Designed to operate here:
NOT fixed gain!
POUTadjusted through
bias control
&#139;Operation in saturated mode le ads to high peak efficiencies 
&gt; 50%; &#8220;backed-off&#8221; efficiencies drop quickly
&#139;Useful for constant-envelope modulation schemes (GMSK)</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>9
RF   IF
PA Architectures
Typical 2-stage (6.012) design
VB150 &#8486; inputVPOS
50 &#8486;
Max power 
transfer?IREF
VB2</text>
        </slide>
        <slide>
          <slideno>44</slideno>
          <text>45
RF   IF
System Specifications
&#139;Linearity
zFor linear PAs, Adjacent Channel Power Ratio (ACPR) is very 
important
Power Spectral
Density (PSD)
(dBm/Hz)ch.
Ach.
Bch.
C
fc fc+&#8710;f fc&#8722;&#8710;f3rdorder distortion</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>13
RF   IF
PA Architectures
Typical 2-stage RF PA design
VB1VB250 &#8486; RF inputVPOS
matching
networkmatching
network
Consider this &#8230;</text>
        </slide>
        <slide>
          <slideno>50</slideno>
          <text>51
RF   IF
Power Control
&#139;For linear PA, expected to operate at constant gain.  Power 
control is therefore a function of PIN. 
&#139;Role of bias circuitry is to maintain constant gain over PIN, 
temperature (PTAT?).
Power 
transistor</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>10
RF   IF
PA Architectures
Typical 2-stage RF PA design
VB1VB250 &#8486; RF inputVPOS
matching
networkmatching
networkinductive RF choke
allows output to rise
above VPOS, doesn&#8217;t
dissipate power
May require additional
RF choke here to isolate
input from bias circuit L&#8217;s and C&#8217;s to 
transform load
impedance</text>
        </slide>
        <slide>
          <slideno>43</slideno>
          <text>44
RF   IF
System Specifications
&#139;Linearity
zFor linear PAs, Adjacent Channel Power Ratio (ACPR) is very 
important
raised cosine filterPower Spectral
Density (PSD)
(dBm/Hz)ch.
Ach.
Bch.
C
fc fc+&#8710;f fc&#8722;&#8710;f</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>14
RF   IF
PA Architectures
&#139;&#8220;Gain stage&#8221; is one transistor with passive elements
&#139;&#8220;Active&#8221; components often limited to 2 or 3 transistors (gain 
stages) in signal path
&#139;Transistor design very important!
zMany parallel transistors &#8211; oft en look like mini-circuits 
themselves
&#139;Passive components just as important as transistors!
zCircuits must be tunable to  account for uncertainties in 
determining values a priori (i.e. simulations stink &#8211; especially 
large-signal, RF simulations)
zQ and parasitic elements of passives important</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>24
RF   IF
High-Efficiency PAs
&#139;Now consider peak efficiencies
Calculate fundamental component of current*
* There are many texts which cover reduced-conducti on angle calculations.  See for example Principles
Of Power Electronics, Kassakian, Schelcht a nd Verghese, Ch. 3.IC
&#969;t 2&#960;
&#945;/2Ipk= IMAX &#8722;IQIMAX
IQ(1/2&#960;)&#8747;&#945;/2
&#8722;&#945;/2IQ+ Ipkcos(&#969;t) d&#969;t Idc=
(1/&#960;)&#8747;&#945;/2
&#8722;&#945;/2Ipkcos(&#969;t) cos( n&#969;t) d&#969;t In=</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>42
RF   IF
Real-World Design Example: Tuning
&#139;Example of inter-stage match, 2ndto 3rdstage
RL2= 19.4 &#8486; 
ZIN3= 2 &#8211; j2 
RL2ZIN3Transmission line
Bond wire
* Go to Winsmith: test2Bond wiresOff-chip</text>
        </slide>
        <slide>
          <slideno>45</slideno>
          <text>46
RF   IF
System Specifications
&#139;Linearity
zFor linear PAs, Adjacent Channel Power Ratio (ACPR) is very 
important
Power Spectral
Density (PSD)
(dBm/Hz)ch.
Ach.
Bch.
C
fc fc+&#8710;f fc&#8722;&#8710;f3rdorder 
distortion3rdorder 
distortion5thorder 
distortion5thorder 
distortion</text>
        </slide>
        <slide>
          <slideno>46</slideno>
          <text>47
RF   IF
System Specifications
&#139;Linearity
zFor linear PAs, Adjacent Channel Power Ratio (ACPR) is very 
important 
Power Spectral
Density (PSD)
(dBm/Hz)
fc fc+&#8710;f fc&#8722;&#8710;f30 kHz&#8710;f
ACPR =Pwr. Ch. B
Pwr. Ch. A</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>2
RF   IF
Outline
&#139;PA Introduction
zPower transfer characteristics
zIntrinsic PA metrics
zLinear and Non-linear amplifiers
zPA Architectures
&#139;Single-Stage Linear PA
zLoad-line theory
zTransistors size 
zInput and Output Matching
zSo why is this so hard?
&#139;High-efficiency PAs
zClass A, AB, B and C amplifiers</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>28
RF   IF
High-Efficiency PAs
&#139;What happened to our load line?  
zFor class B fundamental RL,opt= VPOS/(IMAX/2) &#8211; Didn&#8217;t changeIDor IC (mA/mm)
VDSor VCE(V)IMAX
Class A
2VPOS VPOS
Class B is here!quasi-staticIn quasi-static
picture, resistance presented to transistor output cut in half.  But average resistance is the same for class A
IMAX/2</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>39
RF   IF
Real-World Design Example
VB1VB250 &#8486; RF inputVPOS
VB2LBOND
+ TLprinted
inductor
LBOND + LVIALparasitic
+ LVIALBOND
+ TLLBOND</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>37
RF   IF
Real-World Design Example: The Circuit
VB1VB250 &#8486; RF inputVPOS
VB2GaAs die</text>
        </slide>
        <slide>
          <slideno>51</slideno>
          <text>52
RF   IF
Power Control
&#139;For non-linear PA, expected to  operate at constant PIN.  
Power control is achieved by varying gain.
VAPC
Power 
transistorOn-chip
bias circuitryExternal
control signal</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>7
RF   IF
Linear and Non-linear PAs
&#139;&#8220;Linear PA&#8221; generally refers to a PA which operates at 
constant gain, needs to preserve amplitude information
POUT(dBm)
PIN(dBm)Designed to operate here
&#139;Not necessarily class A (will discuss later &#8230;) Peak efficiencies often only 40 to 45 %
&#139;Useful for modulation schemes with amplitude modulation (QPSK, 8-PSK, QAM)</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>17
RF   IF
Single-Stage, Linear PA
&#139;Design output match to transform 50 &#8486;load to RL,optat 
transistor output; then design input match for gain (complex 
conjugate)
VB150 &#8486;CJCoutput
match input
matchVPOS</text>
        </slide>
        <slide>
          <slideno>49</slideno>
          <text>50
RF   IF
System Specifications
&#139;Noise in receive band:  
zObvious spec. in systems where Tx and Rx are operating at the 
same time (FDD)
zNot so obvious spec in TDD system.  Problem primarily of 
mixing by the PA (2 &#969;2&#8211;&#969;1or &#969;2&#8211;&#969;1)Power Spectral
Density (PSD)
(dBm/Hz)45 MHz
Rx Tx</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>35
RF   IF
Real-World Design Example: Load-Pull
&#139;After initial &#8220;guesses&#8221; at transistor sizes, load-pull to 
determine actual target load for matching circuits
VBRF input
ZLLoad pull: Vary ZL
Plot contours of
constant power
PMAX
PMAX&#8211; 1dB
PMAX&#8211; 2dB</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>41
RF   IF
Real-World Design Example: Tuning
&#139;Example of inter-stage match, 1stto 2ndstage
RL1= 194 &#8486; (?)
ZIN2= 30 &#8211; j10 (?)
RL1ZIN2Transmission line
Bond wireBoth are really
just guesses
* Go to Winsmith: test</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>16
RF   IF
Single-Stage Linear PA
&#139;Transistor size chosen to deliver required output power
POUT&#8776;IMAX&#8901;VPOS/ 4IDor IC (mA/mm)
VDSor VCE(V)2*VPOSIMAX Quiescent point:
Class A
IMAX/2, VPOSRL,opt.</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>19
RF   IF
Seems simple, so why is this so hard?
&#139;Now consider the problem for multiple stages &#8230; double the 
trouble
zTypical single-stage gain only 10 &#8211; 15 dB
zInter-stage match now required to match input impedance of 2nd
stage to desired output impedance of 1ststage.  
&#139;Problems with matching circuits:
zLarge matching ratios &#8594;high Q circuits for simple L matches
zMulti-segment matches use val uable real estate, add cost
&#139;Transistor itself maters &#8211; a lot!
zMany parallel transistor
zBallasting, balancing and layout extremely important </text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>The World Leader in High-Perfor mance Signal Processing SolutionsRF   IF
RF Power Amplifiers
May 7, 2003</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>4
RF   IF
PA Transfer characteristics
Defining linearity:
G
01
Pin(dBm)Pout(dBm)
Pout= Pin+ Glinear
non-linear (actual)</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>12
RF   IF
PA Architectures
Typical 2-stage RF PA design
VB1VB250 &#8486; RF inputVPOS
matching
networkmatching
network
bond wires (at least &#8230;)</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>21
RF   IF
High-Efficiency PAs
&#969;tIDor IC
Class A:
&#960;2&#960; 3&#960;IDor IC
Class AB:
&#969;t &#960;2&#960; 3&#960;IDor IC
Class B:
&#969;t &#960;2&#960; 3&#960;Conduction 
Angle:
&#945;= 2&#960;
&#960;&lt; &#945;&lt; 2&#960;
&#945;= &#960;
Class C: &#945;&lt; &#960;&#945;</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>29
RF   IF
High-Efficiency PAs
&#139;Now consider &#8220;linearity&#8221;
zClearly the current wavefor ms are far from linear
BUT &#8230;
zOverall POUTvs. PINtransfer function can still be quite linear, 
especially for true Class B wh ere output current waveform is 
symmetrical with respect to input waveform
IDor IC
&#969;t &#960;2&#960; 3&#960;
Because conduction angle is constant,
POUTchanges proportional to PIN</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>31
RF   IF
Real-World Design Example
GSM 900 MHz, GaAs HBT PA Design
&#139;POUT= 33 dBm (linear) = 2 W
VCC= 3.5V
RLOAD = VCC2/ 2*POUT= 3 &#8486;
IMAX= 2*VCC/RLOAD = 2.33 A
(Note: expect saturated power to be ~ 35 dBm)
&#139;Input power: constant-envelope +5 dBm
&#139;Gain =  POUT&#8211;PIN = 27 dB.  
&#139;Expect roughly 10 dB per stage
3 STAGE DESIGN</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>11
RF   IF
PA Architectures
Typical 2-stage RF PA design
VB1VB250 &#8486; RF inputVPOS
matching
networkmatching
networkAdditional caps
may be required for
matching network,
harmonic termination</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>36
RF   IF
Real-World Design Example: Load-pull
Notes on load-pulling:
&#139;Most accurate on probe station,  but insertion loss of probes 
prevents it from being useful for large transistors
(&#8220;Insertion loss&#8221; is RF code word for resistance)
&#139;Bonded devices on evaluation board must be carefully de-
embedded
&#139;Even using electronic tuners, accuracy is poor for very large 
transistor (i.e. for loads in the 2 &#8211; 5 &#8486;range)</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>25
RF   IF
High-Efficiency PAs
From phasor plot:     cos(&#945;/2) = &#8722;IQ/ Ipk=  &#8722;IQ/ (IMAX&#8211;IQ) 
Put it all together and do the math, you get:
Assume VOUTthe same for all classes:I1,0-p=&#945;&#8211;sin&#945;
1 &#8211;cos(&#945;/2)IMAX
2&#960;Idc=2sin(&#945;/2)&#8211;&#945;cos(&#945;/2)
1 &#8211;cos(&#945;/2)IMAX
2&#960;
V1,0-p= VPOS</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>27
RF   IF
High-Efficiency PAs
&#139;What happened to our load line?  
zFor class B fundamental RL,opt= VPOS/(IMAX/2) &#8211; Didn&#8217;t changeIDor IC (mA/mm)
VDSor VCE(V)IMAX
Class A
2VPOS VPOS?
Class B is here!</text>
        </slide>
        <slide>
          <slideno>47</slideno>
          <text>48
RF   IF
System Specifications
&#139;Linearity
zFor non-linear PA in TDMA systems, harmonic spurs and 
switching transients are most common measure of linearity 
timePOUT(dBm) 577&#181;s
GSM burstSignal ramping 
profile must fall 
within time mask</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>5
RF   IF
PA Transfer characteristics
Defining linearity:
Gain  (dB)
Pin(dBm)Pout(dBm)G
-1P1dBPMAX</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>6
RF   IF
PA Introduction: Intrinsic PA Metrics
&#139;P1dB: Output power at which lin ear gain has compressed by 
1dB (measure of linear power handling) 
&#139;PMAX: Maximum output power (saturated power)
&#139;Gain: Generally taken to mean transducer gain
&#139;PAE: Power-added EfficiencyPower delivered to load
Power available from source
Power to load &#8211; Power from source
Power from supply</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>22
RF   IF
High-Efficiency PAs
&#139;Assume output match will filter out non-linearities caused by 
discontinuous conduction:
VB150 &#8486;output
match input
match
50&#8486;transformed 
to RL,opt:
All harmonics 
filtered out</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>15
RF   IF
Single-Stage Linear PA
&#139;Load-line theory: the maximum power that a given transistor 
can deliver is determined by the power supply voltage and 
the maximum current of the transistor
IDor IC (mA/mm)
VDSor VCE(V)2*VPOSIMAXRLOAD,opt.&#8776;
2&#8901;VPOS/ IMAX</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>23
RF   IF
High-Efficiency PAs
&#139;If all harmonics filtered out, th en voltage output at load is a 
pure sinusoid, despite discontinuous conduction
&#969;tVOUT
&#960;2&#960; 3&#960;IC
&#969;t &#960;2&#960; 3&#960;IMAX
&#139;Energy stored in reactive elements delivers current to the 
load during transistor off-portion of cycle</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>38
RF   IF
Real-World Design Example: The Circuit
VB1VB250 &#8486; RF inputVPOS
VB2Inter-stage
match</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>32
RF   IF
Real-World Design Example
&#139;Stage 1: Gain = 10 dB  &#8594;POUT= 15 dBm
zRL1= VCC2/ 2*POUT= 194 &#8486;
zIMAX= 2*VCC/RLOAD= 36 mA
zChose class A: IDC= IMAX/2 = 18 mA
(18 mA insignificant compared to 2.33 A)
&#139;Stage 2: Gain = 10 dB  &#8594;POUT= 25 dBm
zRL2= 19.4 &#8486;
zIMAX= 360 mA
zStill probably class A (maybe AB): IDC= IMAX/2 = 180 mA
&#139;Stage 3: Gain = 7 dB &#8594;POUT= 33 dBm
zRL2= 3 &#8486;, IMAX= 2.33 A
zClass B: IDC= IMAX/&#960;= 742 mA</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>3
RF   IF
Outline (cont.)
&#139;Real-World Design Example
zSelecting architecture, number of stages
zDesigning stages
zTuning: inter-stage match and output
&#139;System specifications
zRuggedness: load mis-match and VSWR
zLinearity: spectral mask (ACPR), switching transients
zNoise in receive band
&#139;Power Control</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>33
RF   IF
Real-World Design Example
A note on &#8220;Gain&#8221; 
&#139;Taking a very simplistic view of common emitter stages:
zgm1= IC/ VTh= 18 mA / 0.025 V = 0.696 S
zgm1RL1= 0.696 &#8901;194 = 135 &#8594;NOT 10 dB!
BUT &#8230;
zre1= 1/gm1= 1.44 &#8486;
zre2= 1/gm2= 0.144 &#8486;
zre3= 1/gm3= 0.035 &#8486;
1. Remember it&#8217;s power gain, not voltage gain.  Can lose 
voltage at input match.
2. It&#8217;s pretty tough not to  get significant degeneration!</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>34
RF   IF
Real-World Design Example
&#139;Efficiency calculations:
zIDC1= 18 mA, IDC2= 180 mA, IDC3= 742 mA
zTotal DC Current: 940 mA
zRealistically may get as high as 55%(IMAX/2) /&#8730;2 &#8901;VPOS /&#8730;2
IDC&#8901;VPOSP1
Pdc==  6 2  %</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>30
RF   IF
Real-World Design Example
&#139;IDEAL: Design each stage independently
zDetermine required gain &#8211; number of stages
zDetermine POUTfor each stage
zDetermine RL,optfor each stage
zDetermine input impedance for each stage
zDesign matching networks for inter-stage, load and input
&#139;REALITY:
zIMAXdoesn&#8217;t scale nicely with tran sistor size. Without good IMAX
numbers, can&#8217;t determine RL,opt. Need to do load-pull.
zEven load pull measurements  have limited accuracy for very 
large transistors
zDesigns are very em pirically driven!</text>
        </slide>
        <slide>
          <slideno>48</slideno>
          <text>49
RF   IF
System Specifications
&#139;Noise in receive band:  
zObvious spec. in systems where Tx and Rx are operating at the 
same time (FDD)
Power Spectral
Density (PSD)
(dBm/Hz)30 kHz 30 kHz
45 MHz
Rx Tx</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Low Noise Amplifiers</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec9/</lecture_pdf_url>
      <lectureno>9</lectureno>
      <slides>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Second Step in Redesign &#8211; Lower W
&#131;Recall
&#131;Ibiascan be related to Q as
&#131;We previously chose Q = 2, let&#8217;s now choose Q = 6-Cuts power dissipation by a factor of 3!-New value of W is one third the old one
</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Gain
&#131;Assume Zin= Rs
&#131;Assume load tank resonates 
at frequency wo
vgs gmvgs Cgs indgZgsRsensinout
Lg
LdegvinioutLL RL CL
vout
Zin</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Output Current Noise
&#131;Step 3:  Plug in values to noise expression for indg
</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>M.H. Perrott MIT OCW
Example &#8211; Series-Shunt Amplifier
&#131;Recall that the above amplifier was analyzed in 
Lecture 5
&#131;Tom Lee points out that th is amplifier topology is 
actually used in noise figure measurement systems such as the Hewlett-Packard 8970A
-It is likely to be a much higher performance transistor 
than a CMOS device, thoughM1
VbiasvinvoutRf
R1RsRLRin Rout
vx</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
First Step in Redesign &#8211; Lower Current Density, Iden
M1Id
Vgs
W
L=1.8&#181;
0.18&#181;
0 100 200 300 400 500 600 70000.511.522.533.544.5
Current Density (microAmps/micron)gm and gdo (milliAmps/Volts) and Vgs (Volts)Vgs, gm, and gdo versus Current Density for 0.18 &#181; NMOS
gmgdo
VgsNew bias
point is V gs = 0.8 V
&#131;Need to verify that IIP3 still OK (once we know Q)</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
Recall Noise Factor Calculation for Resistor Load
&#131;Total output noise
&#131;Total output noise due to source
&#131;Noise Factor
vinRs
RLSource
voutenRs
enRLRs
RLSource
vnout</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 9
Low Noise Amplifiers
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
Another CMOS LNA Topology
&#131;Consider increasing gmfor a given current by using 
both PMOS and NMOS devices-Key idea:  re-use of current
&#131;Issues-PMOS device has poorer transconductance than NMOS 
for a given amount of current, and ftis lower-Not completely clear there is an advantage to using this 
technique, but published results are good
&#131;See A. Karanicolas, &#8220;A 2.7 V 900-MHz CMOS LNA and Mixer&#8221;, JSSC, Dec 1996M1M2
M1Id
W/LM2Id/2
M1Id/2
(1/2)W/L (1/2)W/LId
gmgm1+gm2
gm1+gm2Id/2
Id/2
(1/2)W/L(1/2)W/L</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Differential LNA
&#131;Advantages-Value of Ldegis now much better controlled-Much less sensitivity to noise from other circuits
&#131;Disadvantages-Twice the power as the single-ended version-Requires differential input at the chipM1
LdegLg Rs
vin
VbiasLL RL CL
Vout
M2LL RL CL
Vout
IbiasLdegLg Rs
2-vin
2</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Bias Current for Example Design
&#131;Calculate current density from previous plot
&#131;Calculate W from Hspice simulation (assume L=0.18 &#181;m)
-Could also compute this based on Coxvalue
&#131;Calculate bias current
-Problem:  this is not low power!!
</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Zgsw
&#131;By definition
&#131;Calculation
</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
Note:  Be Generous with Substrate Contact Placement
&#131;Having an abundance of nearby substrate contacts 
helps in three ways-Reduces possibility of latch up issues-Lowers Rsuband its associated noise
&#131;Impacts LNA through backgate effect (gmb)-Absorbs stray electrons from  other circuits that will 
otherwise inject noise into the LNA
&#131;Negative:  takes up a bit extra areaS DG
Substrate
ContactSubstrate
ContactGND
P-GND
N+N+
Rsub RsubTo L deg To L gTo amplifer
load
Hot electrons and
other noiseHot electrons and
other noiseenRsub enRsub</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
Narrowband LNA Design for Wireless Systems
&#131;Design Issues-Noise Figure &#8211; impacts receiver sensitivity-Linearity (IIP3) &#8211; impacts r eceiver blocking performance-Gain &#8211; high gain reduces impact of noise from components 
that follow the LNA (such as the mixer)-Power match &#8211; want Zin= Zo(usually = 50 Ohms) -Power &#8211; want low power dissipation-Bandwidth &#8211; need to pass the entire RF band for the intended radio application (i.e., all of the relevant channels)
-Sensitivity to process/temp variations &#8211; need to make it manufacturable in high volumeZin
Zo LNATo MixerFrom Antenna
and Bandpass
FilterPC board
trace
Package
Interface</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
We Have Two &#8220;Handles&#8221; to Lower Power Dissipation
&#131;Key formulas
&#131;Lower current density, Iden-Benefits
-Negatives
&#131;Lower W-Benefit:  lower power-Negatives
</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Power Dissipation and Noise Figure of New Design
&#131;Power dissipation
-At 1.8 V supply
&#131;Noise Figure-ftpreviously calculated, get scaling coeff. from plot
</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Input impedance (from Lec 6)
&#131;Set to achieve pure resistance = Rsat frequency woKey Assumption:  Design for Power Match
M1
VbiasvinRs
LdegZin
Iout
Lg
Real!
</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of &#951;
vgs gmvgs Cgs indgZgsRsensSource
inout
Lg
Ldeg
= Rs
</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
Updated Component Values
&#131;Assume Rs= 50 Ohms, Q = 6, fo= 1.8 GHz, ft= 42.8 GHz-Cgscalculated as
-Ldegcalculated as
-Lgcalculated as
</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
Recalculate Process Parameters
&#131;Assume that the only thing that changes is gm/gdoand ft-From previous graph (Iden= 100 &#181;A/&#181;m)
&#131;We now need to replot the Noise Factor scaling 
coefficient-Also plot over a wider range of Q
Noise Factor scaling coefficient
</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
Recall Small Signal Model for Noise Calculations
Iout
GD
Svgs gmvgs Cgs indgD
SG
ZgsZg
Zdegiout
ZgZdeg
</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
Biasing for LNA Employing Current Re-Use
&#131;PMOS is biased using a current mirror
&#131;NMOS current adjusted to match the PMOS current
&#131;Note:  not clear how the matc hing network is achieving 
a 50 Ohm match-Perhaps parasitic bondwire inductance is degenerating 
the PMOS or NMOS transistors?M2
M1
Cbig2IbiasRbig1
M4
Rbig2
M3opamp
VrefCbig3Cbig1
Matching
NetworkVrfVout1 Vout2Stage 1 Stage 2</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
Our Focus: Inductor Degenerated Amp
&#131;Same as amp in Lecture 7 except for inductor degeneration-Note that noise analysis in To m Lee&#8217;s book does not include 
inductor degeneration (i.e., Table 11.1)vgs gmvgs Cgs indgZgsRsensSource
inout
Lg
M1
LdegLg Rs
vin
VbiasIoutSourceLdeg</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Noise Factor Scaling Coefficient Versus Q
1 1.5 2 2.5 3 3.5 4 4.5 52.533.544.555.566.57
QNoise Factor Scaling CoefficientNoise Factor Scaling Coefficient Versus Q for 0.18 &#181; NMOS Device
Achievable values as
a function of Q under
the constraints that
(Lg+Ldeg)Cgs1= w o
Ldeg= R sCgsgm
2RswoCgs1Q =Note:c = -j0
c = -j0.55
c = -j1</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Noise Factor for Inductor Degenerated Amplifier
Noise Factor scaling coefficient
</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Output Noise Due to Source Resistance
vgs gmvgs Cgs indgZgsRsensSource
inout
Lg
LdegZin
</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>M.H. Perrott MIT OCW
Noise Figure For Amp with Resistor in Feedback                 
&#131;Total output noise (assume A is large)
&#131;Total output noise due to source (assume A is large)
&#131;Noise FactorVinRsRfSource
VoutenRs
A
VrefRsRf Source
Vnout AenRf
incremental
ground
</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Zgs
vgs gmvgs Cgs indgZgsRsensSource
inout
Lg
Ldeg
</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
Process and Topology Parameters for Noise Calculation
&#131;Process parameters-For 0.18 &#181;CMOS, we will assume the following
&#131;Circuit topology parameters Zgand Zdegvgs gmvgs Cgs indgZgsRsensSource
inout
Lg
Ldeg
</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Update Plot of Noise Factor Scaling Coefficient
1 2 3 4 5 6 7 8 9 1024681012141618
QNoise Factor Scaling CoefficientNoise Factor Scaling Coefficient Versus Q for 0.18 &#181; NMOS Device
Achievable values as
a function of Q under
the constraints that
(Lg+Ldeg)Cgs1= w o
Ldeg= R sCgsgm
2RswoCgs1Q =Note: c = -j0c = -j0.55
c = -j1</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
Achievable Noise Figure in 0.18&#181;with Power Match
&#131;Suppose we desire to build a narrowband LNA with 
center frequency of 1.8 GHz in 0.18 &#181;CMOS (c=-j0.55)-From Hspice &#8211; at Vgs= 1 V with NMOS (W=1.8 &#181;, L=0.18&#181;)
&#131;measured gm=871 &#181;S, Cgs= 2.9 fF
-Looking at previous curve, with Q &#8776;2 we achieve a Noise 
Factor scaling coefficient &#8776;3.5
</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
Our Focus in This Lecture
&#131;Designing for low Noise Figure
&#131;Achieving a good power match
&#131;Hints at getting good IIP3
&#131;Impact of power dissipation on design
&#131;Tradeoff in gain versus bandwidthZin
Zo LNATo MixerFrom Antenna
and Bandpass
FilterPC board
trace
Package
Interface</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Setting of Gain
&#131;Parameters gmand Q were set by Noise Figure and IIP3 
considerations-Note that Q is of the inpu t matching network, not the 
amplifier load
&#131;RLis the free parameter &#8211; use it to set the desired gain-Note that higher RLfor a given resonant frequency and 
capacitive load will increase QL(i.e., Q of the amplifier 
load)
&#131;There is a tradeoff between  amplifier bandwidth and gain-Generally set RLaccording to overall receiver noise and 
IIP3 requirements (highe r gain is better for noise)
&#131;Very large gain (i.e.,  high QL) is generally avoided to 
minimize sensitivity to process/te mp variations that will shift 
the center frequency 
</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Recall the alternate expression for Noise Factor derived in 
Lecture 8
&#131;We now know the output noise due to the transistor noise-We need to determine the ou tput noise due to the source 
resistanceDerive Noise Factor for Inductor Degenerated Amp
vgs gmvgs Cgs indgZgsRsensSource
inout
Lg
Ldeg</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
Inclusion of Load (Resonant Tank)
&#131;Add output load to achieve voltage gain-Note: in practice, use cascode device
&#131;We&#8217;re ignoring Cgdin this analysis
M1
LdegLg Rs
vin
VbiasLL RL CL
VoutIoutvgs gmvgs Cgs indgZgsRsensinout
Lg
LdegvinioutLL RL CL
vout
Zin</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
Have We Chosen the Correct Bias Point?  (Vgs= 1V)
M1Id
Vgs
W
L=1.8&#181;
0.18&#181;
0 100 200 300 400 500 600 70000.511.522.533.544.5
Current Density (microAmps/micron)gm and gdo (milliAmps/Volts) and Vgs (Volts)Vgs, gm, and gdo versus Current Density for 0.18 &#181; NMOS
gmgdo
VgsChosen bias
point is V gs = 1 V
Lower power
Lower f t
Lower IIP3Higher power
Higher f t
Higher IIP3
gdo
gmgdo
gmLower Higher
&#131;Note:  IIP3 is also a function of Q</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
The Issue of Package Parasitics
&#131;Bondwire (and package) inductance causes two issues-Value of degeneration inductor is altered-Noise from other circuits couples into LNAM1
LdegLext Rs
vin
VbiasLL RL CL
Vout
Lbondwire1Mixer and
Other Circuits
Noise
CurrentNoise
CurrentLbondwire2
Lbondwire3Equivalent
Source
Noise
VoltageNoise
Voltage</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
Broadband LNA Design
&#131;Most broadband systems are not as stringent on their 
noise requirements as wireless counterparts
&#131;Equivalent input voltage is of ten specified rather than a 
Noise Figure
&#131;Typically use a resistor to achieve a broadband match 
to input source-We know from Lecture 8 that this will limit the noise figure 
to be higher than 3 dB
&#131;For those cases where low Noise Figure is important, 
are there alternative ways to achieve a broadband 
match?Zin
Zo LNAPC board
trace
Package
InterfaceHigh Speed
Broadband
Signal</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Component Values for Minimum NF with Power Match
&#131;Assume Rs= 50 Ohms, Q = 2, fo= 1.8 GHz, ft= 47.8 GHz-Cgscalculated as
-Ldegcalculated as
-Lgcalculated as
</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>M.H. Perrott MIT OCW
Input Impedance For Amp with Resistor  in Feedback           
&#131;Recall from Miller effect discussion that
&#131;If we choose Zinto match Rs, then
&#131;Therefore, Noise Figure lowered by being able to 
choose a large value for RfsinceenRsRsRf Source
Vnout AenRf
Zin
</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
&#131;From Lecture 7, we derived for Ldeg= 0,  wo2= 1/(LgCgs)
&#131;We now have for (gm/Cgs)Ldeg= Rs,  wo2= 1/((Lg+ Ldeg)Cgs)Compare Noise With and Without Inductor Degeneration
vgs gmvgs Cgs indgZgsRsensSource
inout
Lg
Ldeg
</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Mixers</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec10/</lecture_pdf_url>
      <lectureno>10</lectureno>
      <slides>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
Image Reject Mixer Principles &#8211; Step 1
f
-f1 f12cos(2 &#960;f1t)
2sin(2 &#960;f1t)a(t)
b(t)e(t)
g(t)RF in IF out 2cos(2 &#960;f2t)
2sin(2 &#960;f2t)Lowpass
RF in(f)Desired
channelImage
Interferer
0
f
-f1 f1 0
f
-f1f1
0f
-f1 f1A(f)
0
f
-f1 f1B(f)
0c(t)
d(t)
j
-j11 1
j
-jLowpass
LowpassLowpass
&#131;Note:  we are assuming RF in(f) 
is purely real right now</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>M.H. Perrott MIT OCW
Double-Balanced Mixer Implementation
&#131;Applies technique from previous slide-Subtraction at the output achieved by cross-coupling 
the output current of each stageM1I1
Io = GmVRFTransconductorVRFIoI2
M2VLO VLO
DCVRF(t)M1I3
Io = GmVRFTransconductorVRFIoI4
M2VLO VLO
DCVRF(t)</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Image Reject Mixer Principles &#8211; Implementation Issues
&#131;For all analog architecture, going to zero IF 
introduces sensitivity to 1/f noise at IF output-Can fix this problem by digi tizing c(t) and d(t), and then 
performing final mixing in the digital domain
&#131;Can generate accurate quadrature sine wave signals 
by using a frequency divider02
fIF out(f) 
(after baseband filtering)f
-f1 f12cos(2 &#960;f1t)
2sin(2 &#960;f1t)a(t)
b(t)e(t)
g(t)RF in IF out 2cos(2 &#960;f2t)
2sin(2 &#960;f2t)Lowpass
RF in(f)Desired
channelImage
Interferer
0c(t)
d(t)Lowpass</text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>M.H. Perrott MIT OCW
Passive Mixers
&#131;We can avoid the transconductor and simply use 
switches to perform the mixing operation-No bias current required al lows low power operation to 
be achieved
&#131;You can learn more about it in Homework 4!VRFCL
RL/2 RL/2RS/2Cbig
RS/2 CbigVIF VIF2AinVLO VLO
VLO VLO</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Achieving a Balanced LO Signal with DC Biasing
&#131;Combine two mixer paths with LO signal 180 degrees 
out of phase between the paths
-DC component is cancelledRF in
LO sigIF out
1
-1RF inLO sig
IF out1
0
LO sig1
0
0</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>M.H. Perrott MIT OCW
Gilbert Mixer
&#131;Use a differential pair to achieve the transconductor
implementation
&#131;This is the preferred mixer implementation for most radio systems!RF DCVRF(t)M5 M6VLO M3I1 I2
M4VLO
VLO
M1 M2
IbiasVRF(t)RF DCLO DC
LO DC</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
Two Important Transform Pairs
&#131;Transform of an impulse train in time is an impulse 
train in frequencyT
2T
21x(t)
tX(f)
f
T1T
s(t)
tS(f)
f
T1
T1T1
T1
T&#131;Transform of a rectangle pulse in time is a sinc function in frequency</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 10
Mixers
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
LO Feedthrough
&#131;LO feedthrough will occur from th e LO port to IF output port 
due to parasitic capacitance, power supply coupling, etc.-Often significant since LO outpu t much higher than RF signal
&#131;If large, can potentially desensitiz e the receiver due to the extra 
dynamic range consumed at the IF output
&#131;If small, can generally be remo ved by filter at IF outputf-fo fo
= 2cos(2 &#960;fot)RF inRF in(f)Desired
channelImage
Interferer
0
f
-fo fo 011Local Oscillator
OutputIF out
LO out(f)
f-fo foIF out(f)
0&#8710;f -&#8710;f
&#8710;f -&#8710;fLO
feedthroughLO
feedthrough</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
e(t)
g(t)IF out 2cos(2 &#960;f2t)
2sin(2 &#960;f2t)
f
-f2 f2 0
f
-f2f2
0-f2 f2C(f)
0D(f)
0c(t)
d(t)
j
-j111
j
-j
-f2 f2E(f)
0
-f2 f2G(f)12
121
-11
-1
-2f
ff
fImage Reject Mixer Principles &#8211; Step 3</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Removal of Image Interference &#8211; Solution 2
&#131;Mix directly down to baseband (i.e., homodyne approach)-With an IF frequency of zero, there is no image band
&#131;Issues &#8211; many!-DC term of LO feedthrough can corrupt signal if time-varying-DC offsets can swamp out dy namic range at IF output-1/f noise, back radiation through antennaf-fo fo
= 2cos(2 &#960;fot)RF inRF in(f)Desired
channel
0
f
-fo fo 011Local Oscillator
OutputIF out
LO out(f)
f-fo foIF out(f)
0&#8710;f=0
LO
feedthroughReverse LO
feedthrough
LO
feedthroughReverse LO
feedthrough
Self-mixing
of reverse
LO feedthrough</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Overall Mixer Architecture &#8211; Use I/Q Demodulation
&#131;Both real and imag. parts of  RF input now pass through0fIF out(f) (I component) 
(after baseband filtering)f
-f1 f1
2cos(2 &#960;f1t)
2sin(2 &#960;f1t)a(t)
b(t)RF inIF out
I
2cos(2 &#960;f2t)2sin(2 &#960;f2t)Lowpass
Desired
channelImage
Interferer0
Lowpass1
2f
-f1 f1real part of RF in(f)
0
-jj1
imag. part of RF in(f)2cos(2 &#960;f2t)2sin(2 &#960;f2t)
IF out
Q
0f2IF out(f) (Q component) 
(after baseband filtering)</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>M.H. Perrott MIT OCW
Achieving a Balanced RF Signal with Biasing
&#131;Use the same trick as with LO balancing
RF inLO sig
IF out1
0
LO sig1
0DCVRF(t)RF inLO sig
IF out1
0
LO sig1
0
RF inLO sigIF out
1
0
LO sig1
0DCVRF(t)
DCVRF(t)signal
signalDC component
cancels
signal component
adds</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
Decomposition of Square Wave to Simplify Analysis
&#131;Decomposition in time1y(t)
t
T TW
s(t)
tT1
T*1x(t)
tW&#131;Consider now a square wave with duty cycle W/T</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
Transconductor Implementation 3
&#131;Add degeneration to common source amplifier-Inductor better than resistor
&#131;No DC voltage drop
&#131;Increased impedance at high fr equencies helps filter out 
undesired high frequency components-Don&#8217;t generally resonate inductor with Cgs
&#131;Power match usually not requ ired for IC implementation 
due to proximity of LNA and mixerM1Rs
VRF
VbiasCbig
LdegIo
Rbig</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Primary Focus is Typically Nonlinearity in RF Input Path
&#131;Nonlinearity B not detrimental in most cases-LO signal often a square wave anyway
&#131;Nonlinearity C can be avoided by using a linear load 
(such as a resistor)
&#131;Nonlinearity A can hamper rejection of interferers-Characterize with IIP3 as with LNA designs-Use two-tone test to m easure (similar to LNA)Memoryless
Nonlinearity A
y
w1 0 w2WRF in(w)Desired
Narrowband
SignalInterferers
0 w1
2w2+w1w2 2w2
2w1-w2 2w1+w2 2w2-w1w1+w2w2-w1 2w1 3w2 3w1WY(w)Corruption of desired signalIdeal
Mixer
RF in IF out
LO signalMemoryless
Nonlinearity BMemoryless
Nonlinearity C
xz</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>M.H. Perrott MIT OCW
A Highly Linear CMOS Mixer
&#131;Transistors are alternated between the off and triode 
regions by the LO signal-RF signal varies resistance of  channel when in triode-Large bias required on RF inpu ts to achieve triode operation
&#131;High linearity achieved, but very poor noise figureVLO
VLORf1Cf1
Cb1
Rf2
Cf2Cb2
VRF VRFM1
M2
M3
M4VIF
VIF</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
Removal of Image Interference &#8211; Solution 1
&#131;An image reject filter can be used before the mixer to 
prevent the image content from aliasing into the desired 
channel at the IF output
&#131;Issue &#8211; must have a high IF frequency-Filter bandwidth must be larg e enough to pass all channels-Filter Q cannot be arbitrarily large (low IF requires high Q)f-fo fo
= 2cos(2 &#960;fot)RF inRF in(f)Desired
channelImage
Interferer
0
f
-fo fo 011Local Oscillator
OutputIF out
LO out(f)
f-fo foIF out(f)
0&#8710;f -&#8710;f
&#8710;f -&#8710;fLO
feedthroughReverse LO
feedthrough
Self-mixing
of reverse
LO feedthroughImage
Rejection
Filter</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Image Reject Mixer Principles &#8211; Step 4
e(t)
g(t)IF out
-f2 f2E(f)
0
-f2 f2G(f)12
121
-11
-1
-2f
f
-f2 f2 02
fIF out(f)
Baseband
Filter</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Nonlinearity in Mixers
&#131;Ignoring dynamic effects, we can model mixer as 
nonlinearities around an ideal mixer-Nonlinearity A will have the same impact as LNA 
nonlinearity (measured with IIP3)-Nonlinearity B will change the spectrum of the LO signal 
&#131;Causes additional mixing that must be analyzed
&#131;Changes conversion gain somewhat-Nonlinearity C will cause sel f mixing of IF outputMemoryless
Nonlinearity A
y
w1 0 w2WRF in(w)Desired
Narrowband
SignalInterferersIdeal
Mixer
RF in IF out
LO signalMemoryless
Nonlinearity BMemoryless
Nonlinearity C</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Mixer Double-Sideband (DSB) Noise Figure
&#131;For zero IF, there is no image band-Noise from positive and negati ve frequencies combine, but 
the signals do as well
&#131;DSB noise figure is 3 dB lower than SSB noise figure-DSB noise figure often quoted since it sounds better
&#131;For either case, Noise Figure computed through simulationf-fo fo
= 2cos(2 &#960;fot)RF in(f)Desired
channel
0
f
-fo fo 01LO out
LO out(f)
fIF out(f)
0 &#8710;f -&#8710;fImage
Rejection
FilterNoise
RF in
Noise from
positive and negative
frequency bands addNoise
No
2NoSRF
2SRFIF outChannel
Filter</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
Single-Balanced Mixer
&#131;Works by converting RF input voltage to a current, then 
switching current between eac h side of differential pair
&#131;Achieves LO balance using technique on previous slide-Subtraction between paths is inherent to differential output
&#131;LO swing should be no larger than needed to fully turn on 
and off differential pair-Square wave is best to minimize noise from M1and M2
&#131;Transconductor designed for high linearityM1I1
Io = GmVRFTransconductorVRFIoI2
M2VLO VLO
DCVRF(t)</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
Impact of High Voltage Conversion Gain
&#131;Benefit of high voltage gain -The noise of later stages will have less of an impact
&#131;Issues with high voltage gain-May be accompanied by higher noise figure than could be 
achieved with lower voltage gain-May be accompanied by nonlinearities that limit interference rejection (i.e ., passive mixers can generally 
be made more linear than active ones)f-fo fo
Bcos(2 &#960;fot)RF in = 
Acos(2 &#960;(fo+&#8710;f)t)RF in(f)
0
f
-fo fo 0LO ouput =IF out
LO out(f)
f-fo foIF out(f)
0&#8710;f
&#8710;f -&#8710;fA
2
B
2AB
4</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Associated Frequency Transforms
&#131;Decomposition in frequency1y(t)
t
T TW
X(f)
fW1WS(f)
f
T1
T1T1&#131;Consider now a square wave with duty cycle W/T</text>
        </slide>
        <slide>
          <slideno>43</slideno>
          <text>M.H. Perrott MIT OCW
Square-Law Mixer
&#131;Achieves mixing through nonlinearity of MOS device-Ideally square law, which leads to a multiplication term
-Undesired components must be filtered out
&#131;Need a long channel device to get square law behavior
&#131;Issue &#8211; no isolation between LO and RF ports M1VRF
VbiasLL RL CL
VIF
VLO
</text>
        </slide>
        <slide>
          <slideno>44</slideno>
          <text>M.H. Perrott MIT OCW
Alternative Implementation of Square Law Mixer
&#131;Drives LO and RF inputs on separate parts of the 
transistor-Allows some isolation between LO and RF signals
&#131;Issue - poorer performance compared to multiplication-based mixers
-Lots of undesired spectral components-Poorer isolation between LO and RF portsIbiasM1
VbiasLL RL CL
VIF
RbigCbig
VRFCbig2
VLO</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
Modification of Mixer Architecture for Imaginary RF in(f)
&#131;Desired channel now appears given two changes-Sine and cosine demodulators are switched in second 
half of image rejection mixer-The two paths are now added rather than subtracted
&#131;Issue &#8211; architecture now zeros out desired channel 
when RF in(f) is purely real0fIF out(f) 
(after baseband filtering)f
-f1 f12cos(2 &#960;f1t)
2sin(2 &#960;f1t)a(t)
b(t)e(t)
g(t)RF in IF out
2cos(2 &#960;f2t)2sin(2 &#960;f2t)Lowpass
RF in(f)
Desired
channelImage
Interferer
0c(t)
d(t)Lowpass
-jj
2</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
LO Feedthrough in Single-Balanced Mixers
&#131;DC component of RF input causes very large LO 
feedthrough-Can be removed by filtering, but can also be removed by 
achieving a zero DC value for RF inputM1I1
Io = GmVinTransconductorVRFIoI2
M2VLO VLO
DC
0 -f1 f1VRF(t)
VRF(f)0 -fo foVLO(f)-VLO(f)
f
f
0fo-f1I1(f)-I2(f)
ffo fo+f1 -fo -fo-f1 -fo+f1Higher order
harmonicsHigher order
harmonics
Higher order
harmonicsHigher order
harmonics</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
Voltage Conversion Gain
&#131;Defined as voltage ratio of d esired IF value to RF input
&#131;Example: for an ideal mixer with RF input = Asin(2 &#960;(fo+ 
&#8710;f)t) and sine wave LO signal = Bcos(2 &#960;fot)
&#131;For practical mixers, value depends on mixer topology 
and LO signal (i.e., sine or square wave)
f-fo fo
Bcos(2 &#960;fot)RF in = 
Acos(2 &#960;(fo+&#8710;f)t)RF in(f)
0
f
-fo fo 0LO ouput =IF out
LO out(f)
f-fo foIF out(f)
0&#8710;f
&#8710;f -&#8710;fA
2
B
2AB
4</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>M.H. Perrott MIT OCW
Double-Balanced Mixer
&#131;DC values of LO and RF signals are zero (balanced)
&#131;LO feedthrough dramatically reduced!
&#131;But, practical transconductor needs bias currentM1I1
Io = GmVinTransconductorVRFIoI2
M2VLO VLO
DC
0 -f1 f1VRF(t)
VRF(f)0 -fo foVLO(f)-VLO(f)
f
f
0fo-f1I1(f)-I2(f)
ffo fo+f1 -fo -fo-f1 -fo+f1Higher order
harmonicsHigher order
harmonics
Higher order
harmonicsHigher order
harmonics</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Overall Frequency Transform of a Square Wave
&#131;Fundamental at frequency 1/T-Higher harmonics have lower magnitude
&#131;If W = T/2  (i.e., 50% duty cycle)-No even harmonics!
&#131;If amplitude varies between 1 and -1 (rather than 1 and 0)-No DC component1y(t)
t
T TWY(f)
f
T11TW
W&#131;Resulting transform relationship</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
Ideal Mixer Behavior
&#131;RF spectrum converted to a lower IF center frequency-IF stands for intermediate frequency
&#131;If IF frequency is nonzero &#8211; heterodyne or low IF receiver
&#131;If IF frequency is zero &#8211; homodyne receiver
&#131;Use a filter at the IF output to remove undesired high 
frequency componentsf-fo fo
= 2cos(2 &#960;fot)RF inRF in(f)Desired
channel
0
f
-fo fo 011Local Oscillator
OutputIF out
LO out(f)
f-fo foIF out(f)
0&#8710;f
&#8710;f -&#8710;fUndesired
componentUndesired
componentChannel
Filter</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
Transconductor Implementation 1
&#131;Apply RF signal to input of common source amp-Transistor assumed to be in saturation-Transconductance value is the same as that of the 
transistor
&#131;High Vbiasplaces device in velocity saturation-Allows high linearity to be achievedM1Rs
VRF
VbiasCbigIo
Rbig</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
Mixer Design for Wireless Systems
&#131;Design Issues-Noise Figure &#8211; impacts receiver sensitivity-Linearity (IIP3) &#8211; impacts r eceiver blocking performance-Conversion gain &#8211; lowers noise impact of following stages-Power match &#8211; want max voltag e gain rather than power 
match for integrated designs -Power &#8211; want low power dissipation-Isolation &#8211; want to minimize in teraction between the RF, IF, 
and LO ports-Sensitivity to process/temp variations &#8211; need to make it 
manufacturable in high volumeZin
Zo LNA To FilterFrom Antenna
and Bandpass
FilterPC board
trace
Package
Interface
Local Oscillator
OutputMixer
RF in IF out</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
f
-f1 f12cos(2 &#960;f1t)
2sin(2 &#960;f1t)a(t)
b(t)e(t)
g(t)RF in IF out 2cos(2 &#960;f2t)
2sin(2 &#960;f2t)Lowpass
RF in(f)Desired
channelImage
Interferer
0
f
-f1 f1 0
f
-f1f1
0f
-f1 f1C(f)
0
f
-f1 f1D(f)
0c(t)
d(t)
j
-j11 1
j
-jLowpassImage Reject Mixer Principles &#8211; Step 2</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
A Practical Issue &#8211; Square Wave LO Oscillator Signals
&#131;Square waves are easier to generate than sine waves-How do they impact the mixing operation when used as 
the LO signal?-We will briefly review Fourier  transforms (series) to 
understand this issue= 2sgn(cos(2 &#960;fot))RF in
Local Oscillator
OutputIF out
1
t
T TWLO out(t)</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
Transconductor Implementation 2
&#131;Apply RF signal to a common gate amplifier
&#131;Transconductance value set by inverse of series 
combination of Rsand 1/gmof transistor-Amplifier is effectively de generated to achieve higher 
linearity
&#131;Ibiascan be set for large current density through 
device to achieve higher linearity (velocity saturation)M1Rs
VRF IbiasCbigIo
Vbias</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
The Issue of Aliasing
&#131;When the IF frequency is nonzero, there is an image 
band for a given desired channel band-Frequency content in image ba nd will combine with that 
of the desired channel at the IF output-The impact of the image interference cannot be removed 
through filtering at the IF output!f-fo fo
= 2cos(2 &#960;fot)RF inRF in(f)Desired
channelImage
Interferer
0
f
-fo fo 011Local Oscillator
OutputIF out
LO out(f)
f-fo foIF out(f)
0&#8710;f -&#8710;f
&#8710;f -&#8710;f</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
Mixer Single-Sideband (SSB) Noise Figure
&#131;Issue &#8211; broadband noise from mixer or front end filter 
will be located in both image and desired bands-Noise from both image and desired bands will combine 
in desired channel at IF output
&#131;Channel filter cannot remove this-Mixers are inherently noisy!f-fo fo
= 2cos(2 &#960;fot)RF in(f)Desired
channelImage
band
0
f
-fo fo 011LO outIF out
LO out(f)
fIF out(f)
0&#8710;f -&#8710;f
&#8710;f -&#8710;fImage
Rejection
FilterNoise
RF in
Noise from Desired
and Image bands addNoise
No
2NoSRF
SRFChannel
Filter</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
What if RF in(f) is Purely Imaginary?
&#131;Both desired and image signals disappear! -Architecture is sensitive to the phase of the RF input
&#131;Can we modify the architecture to fix this issue?0fIF out(f) 
(after baseband filtering)f
-f1 f12cos(2 &#960;f1t)
2sin(2 &#960;f1t)a(t)
b(t)e(t)
g(t)RF in IF out 2cos(2 &#960;f2t)
2sin(2 &#960;f2t)Lowpass
RF in(f)
Desired
channelImage
Interferer
0c(t)
d(t)Lowpass
-jj</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
The Issue of Balance in Mixers
&#131;A balanced signal is defined to have a zero DC 
component
&#131;Mixers have two signals of concern with respect to 
this issue &#8211; LO and RF signals-Unbalanced RF input causes LO feedthrough-Unbalanced LO signal causes RF feedthrough
&#131;Issue &#8211; transistors require a DC offsetf-fo foRF inRF in(f)
0
f
-fo fo 0LO sigIF out
LO sig(f)
f-fo foIF out(f)
0&#8710;f
&#8710;f -&#8710;fLO
feedthroughRF
feedthroughDC component
DC component</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Analysis of Using Square-Wave for LO Signal
&#131;Each frequency component of LO signal will now mix 
with the RF input-If RF input spectrum sufficient ly narrowband with respect 
to fo, then no aliasing will occur
&#131;Desired output (mixed by the fundamental component) can be extracted using a filter at the IF outputf
-fo fo
= 2sgn(cos(2 &#960;fot))RF inRF in(f)
0
f-fo fo0Local Oscillator
OutputIF out
LO out(f)
f
-fo foIF out(f)
0 3fo -3fo -3fo 3fo 2fo 2fo2fo -2fo
Desired
OutputEven order harmonic
due to not having an
exact 50% duty cycle
DC component
of LO waveform</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
Self-Mixing of Reverse LO Feedthrough
&#131;LO component in the RF input can pass back through 
the mixer and be modulated by the LO signal-DC and 2focomponent created at IF output-Of no consequence for a heterodyne system, but can 
cause problems for homodyne systems (i.e., zero IF)f-fo fo
= 2cos(2 &#960;fot)RF inRF in(f)Desired
channelImage
Interferer
0
f
-fo fo 011Local Oscillator
OutputIF out
LO out(f)
f-fo foIF out(f)
0&#8710;f -&#8710;f
&#8710;f -&#8710;fLO
feedthroughReverse LO
feedthrough
LO
feedthroughReverse LO
feedthrough
Self-mixing
of reverse
LO feedthrough</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Removal of Image Interference &#8211; Solution 3
&#131;Rather than filtering out the image, we can cancel it out 
using an image rejection mixer-Advantages
&#131;Allows a low IF frequency to be used without requiring a 
high Q filter
&#131;Very amenable to integration-Disadvantage
&#131;Level of image rejection is determined by mismatch in gain 
and phase of the top and bottom paths
&#131;Practical architectures limited to 40-50 dB image rejectionf
-f1 f12cos(2 &#960;f1t)
2sin(2 &#960;f1t)a(t)
b(t)e(t)
g(t)RF in IF out 2cos(2 &#960;f2t)
2sin(2 &#960;f2t)Lowpass
RF in(f)Desired
channelImage
Interferer
0c(t)
d(t)Lowpass</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
Reverse LO Feedthrough
&#131;Reverse LO feedthrough will occur from the LO port 
to RF input port due to parasitic capacitance, etc.-If large, and LNA doesn&#8217;t pr ovide adequate isolation, 
then LO energy can leak out of antenna and violate 
emission standards for radio -Must insure that isolate to antenna is adequatef-fo fo
= 2cos(2 &#960;fot)RF inRF in(f)Desired
channelImage
Interferer
0
f
-fo fo 011Local Oscillator
OutputIF out
LO out(f)
f-fo foIF out(f)
0&#8710;f -&#8710;f
&#8710;f -&#8710;fLO
feedthroughReverse LO
feedthrough
LO
feedthroughReverse LO
feedthrough</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Enhancement of Broadband Amplifiers, Narrowband Amplifiers</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec6/</lecture_pdf_url>
      <lectureno>6</lectureno>
      <slides>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
Distributing the Input Capacitance
&#131;Lump input capacitance into LC network corresponding 
to a transmission line-Signal ideally sees a real im pedance rather than an RC 
lowpass-Often implemented as lumped networks such as T-coils-We can now trade delay (rat her than bandwidth) for gain
&#131;Issue:  outputs are delayed from each otherM1 M2 M3
Zo Zo Zo Zovout
RL=Z0delay
vinRs=Z0RL=Z0
Cout Cout Cout</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
To Do
&#131;Add eye diagrams</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
Gain-Bandwidth Product for Tuned Amplifiers
&#131;The gain-bandwidth product:
&#131;The above expression is independent of center 
frequency!-In practice, we need to opera te at a frequency less than 
the ftof the device
Rp Lp Cp
iin=gmvinZtankvoutvout
vin
wslope =
-20 dB/decgmRp
Rp2Cp1wo
Rp2Cp1RpCp1</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
Issue:  CgdCan Cause Undesired Oscillation
&#131;At frequencies below resona nce, tank looks inductiveM1vout
CL
VbiasvinCgdZin
Rs
CgsVdd
LT RL
Negative
Resistance!
</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>M.H. Perrott MIT OCW
Use A Series Inductor to Tune Resonant Frequency
&#131;Calculate input impedance with added inductor
&#131;Often want purely resistive component at frequency wo-Choose Lgsuch that resonant frequency = woM1
VbiasvinRs
LsZin
Iout
M1
VbiasvinRs
LsZin
Iout
Lg
</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Motivation for Distributed Amplifiers
&#131;We achieve higher gain for a given load resistance by 
increasing the device size (i.e., increase gm)-Increased capacitance lowers bandwidth
&#131;We therefore get a relatively constant gain-bandwidth product
&#131;We know that transmission li nes have (ideally) infinite 
bandwidth, but can be modeled as LC networks-Can we lump device capacitances into transmission line?M1 M2 M3vout
vinRs=Z0RL=Z0
Cin Cin CinCout Cout Cout</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Zero-peaked Common Source Amplifier
&#131;Inductors are expensive with respect to die area
&#131;We can instead achieve bandwidth extension with 
capacitor-Idea:  degenerate gain at low frequencies, remove 
degeneration at higher freque ncies (i.e., create a zero)
&#131;Issues:-Must increase RLto keep same gain (lowers pole)-Lowers achievable gate vo ltage bias (lowers device ft)M1RL
vout
M2CfixedId
VbiasvinVdd
Rs Csvout
vin
fgmRL
2&#960;CtotRL12&#960;CsRs1
1+g mRszero
overall
response</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
Plot of Bandwidth Extension Versus m
0 1 2 3 4 5 6 7 8 9 101.11.21.31.41.51.61.71.81.9Bandwidth Extension (w2/w1) Versus mw1/w2
m
&#131;Highest extension:  w2/w1= 1.85 at m &#8776;1.41-However, peaking occurs!</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
The Impact of Choosing Different Values of m &#8211; Part 1
&#131;Parameterized gain expression
&#131;Comparison of new and old       
3 dB frequencies
&#131;Want to solve for w2/w1RLLd
Ctotiin=gmvinvoutSmall Signal Model
Zout
</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>M.H. Perrott MIT OCW
Active Real Impedance Generator
&#131;Input impedance:Zin
Av(s)Vout Vin
Av(s) = -A oe-j&#934;Cf
Resistive component!</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
Analytical Derivation of Overall Bandwidth
&#131;The overall 3-db bandwidth of the amplifier is where
-w1is the overall bandwidth-A and woare the gain and bandwidth of each section
-Bandwidth decreases much sl ower than gain increases!
&#131;Overall gain bandwidth product of amp can be increased!
</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
Shunt-peaked Amplifier
&#131;Use inductor in load to extend bandwidth-Often implemented as a spiral inductor
&#131;We can view impact of inductor in both time and 
frequency-In frequency:  peaki ng of frequency response-In time:  delay of changing current in RL
&#131;Issue &#8211; can we extend bandwidth without significant peaking?M1RL
vout
M2CfixedId
VbiasvinVdd
Ld</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
Creating a Single-Ended Output
&#131;Input voltage is again dropped across two transistors-Ratio given by voltage divider in capacitance
&#131;Ideally is &#189; of input voltage on Cgsof each device
&#131;Input voltage source sees the series combination of 
the capacitances of each device-Ideally sees &#189; of the Cgsof M1
&#131;Currents of each device add to ideally yield ratio:M1 M2
2IbiasI1I2
VbiasvinM1
M2
IbiasIo
Vbiasvin
Ibias
</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
Distributing the Output Capacitance
&#131;Delay the outputs same amount as the inputs-Now the signals match up-We have also distributed the output capacitance!
&#131;Benefit &#8211; high bandwidth
&#131;Negatives &#8211; high power, poorer noise performance, 
expensive in terms of chip area-Each transistor gain is addi ng rather than multiplying!M1Zo Zo Zo Zo
M2 M3
Zo Zo Zo ZoRL=Z0
vout
RL=Z0delay
delay
vinRs=Z0RL=Z0</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Tuned Amplifiers
&#131;Put inductor in parallel across RLto create bandpass
filter-It will turn out that the gain-bandwidth product is 
roughly conserved regardless of the center frequency!
&#131;Assumes that center frequency (in Hz) &lt;&lt; ft
&#131;To see this and other design issues, we must look 
closer at the parallel resonant circuitM1vout
CL
VbiasvinRsVdd
LT RL</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Three key parameters-Gain = gmRp-Center frequency = wo-Q = wo/BW
&#131;Impact of high Q -Benefit: allows achievement of high gain with low power-Problem:  makes circuit sensitive to process/temp 
variationsDesign of Tuned Amplifiers
Rp Lp Cp
iin=gmvinZtankvoutvout
vin
wslope =
-20 dB/decgmRp
Rp2Cp1wo
Rp2Cp1RpCp1</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
Resistor Loaded Amplifier (Unsilicided Poly)
&#131;We decided this was the fastest non-enhanced amplifier-Can we go faster?  (i.e., can we enhance its bandwidth?)
&#131;We will look at the following-Reduction of Miller effect on Cgd-Shunt, series, and zero peaking-Distributed amplificationM1RL
vout
M2CfixedId
Vbiasvin
Ctot = Cdb1+CRL/2 + Cgs2+KCov2 + Cfixed
Miller multiplication factor (+Cov1)1vout
vin
fslope = 
-20 dB/dec
gm1
2&#960;Ctotgm1RL
2&#960;RLCtot1Vdd</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
Plot of Transfer Function Versus m
&#131;Maximum 
bandwidth:            m = 1.41   (extension = 1.85)
&#131;Maximally flat response:              m = 2.41   (extension = 1.72)
&#131;Best phase response:              m = 3.1      (extension = 1.6)
&#131;No peaking:          m = infinity
&#131;Eye diagrams often used to evaluate best m 1/100 1/10 1 10 100-45-40-35-30-25-20-15-10-505Normalized Gain (dB)
Normalized Frequency (Hz)Normalized Gain for Shunt Peaked Amplifier For Different m Values
m=1.41
m=2.41
m=3.1
m=infinity</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Choosing the Optimal Number of Stages
&#131;To first order, there is a constant gain-bandwidth 
product for each stage
-Increasing the bandwidth of each stage requires that we 
lower its gain-Can make up for lost gain by cascading more stages
&#131;We found that the overall bandwidth is calculated as
&#131;Assume that we want to achieve gain G with n stages
&#131;From this, Tom Lee finds optimum gain &#8776;1.65-See Tom Lee&#8217;s book, pp 207-211
</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Cgdis quite significant compared to Cgs-In 0.18 &#181;CMOS, Cgdis about 45% the value of Cgs
&#131;Input capacitance calculation
-For 0.18 &#181;CMOS, gain of 3, input cap is almost tripled 
over Cgs!M1RL
vout
CLId
VbiasvinCgdZin
Rs
CgsMiller Effect on CgdIs Significant
</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Bandwidth Enhancement With ftDoublers
&#131;A MOS transistor has ftcalculated as
&#131;ftdoubler amplifiers attempt to 
increase the ratio of 
transconductance to capacitanceM1 M2
2IbiasI1I2
Vbiasvin
&#131;We can make the argument that differential amplifiers 
are ftdoublers-Capacitance seen by Vinfor single-ended input:-Difference in current: 
&#131;Transconductance to Cap ratio is doubled:
</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Creating the Bias for M2
&#131;Use current mirror for bias-Inspired by bipolar circuits (see Tom Lee&#8217;s book, page 198)
&#131;Need to set Vbiassuch that current through M1has the 
desired current of Ibias-The current through M2will ideally match that of M1
&#131;Problem:  achievable bias voltage across M1(and M2) is 
severely reduced (thereby reducing effective ftof device)-Do ftdoublers have an advantage in CMOS?M1 M2
2IbiasI1I2
VbiasvinM1
M2
IbiasIo
Vbiasvin
IbiasM1
M2Io
Vbiasvin
Ibias M3</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
T-Coil Bandwidth Enhancement
&#131;Uses coupled inductors to realize T inductor network-Works best if capacitance at drain of M1is much less than 
the capacitance being driven at the output load
&#131;See Chap. 8 of Tom Lee&#8217;s book (pp 187-191) for analysis
&#131;See S. Galal, B. Ravazi, &#8220;10 Gb/s Limiting Amplifier and 
Laser/Modulator Driver in 0.18u CMOS&#8221;, ISSCC 2003, pp 
188-189 and &#8220;Broadband ESD Protection &#8230;&#8221;, pp. 182-183M1RL
vout
M2CfixedId
VbiasvinVdd
L1
L2 L3
M1vout
M2CfixedVbiasvinL2
L1CB
kRLVdd</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Achievable Bandwidth Versus G and n
0 5 10 15 20 25 3000.050.10.150.20.25Achievable Bandwidth (Normalized to f  ) t
 Versus Gain (G) and Number of Stages (n)
nw1/wt0.3
A=1.65
A=3G=10
G=100
G=1000
&#131;Optimum gain per 
stage is about 1.65-Note than gain 
per stage derived 
from plot as
-Maximum is fairly soft, though
&#131;Can dramatically 
lower power (and 
improve noise) by 
using larger gain per stage
</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
Source-Coupled Amplifier
&#131;Remove impact of Miller effect by sending signal 
through source node rather than drain node-Cgdnot Miller multiplied AND impact of Cgscut in half!
&#131;The bad news-Signal has to go through source node (Csbsignificant)-Power consumption doubledM1
VbiasvinCgd
RsM2RL
Cgd
2Ibiasvout
Zin
</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 6
Enhancement Techniques for Broadband Amplifiers,
Narrowband Amplifiers
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
The Impact of Choosing Different Values of m &#8211; Part 2
&#131;From previous slide, we have
&#131;After much algebra
&#131;We see that m directly sets the amount of bandwidth 
extension!-Once m is chosen, inductor value is
</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Tuned Amp Transfer Function About Resonance (Cont.)
&#131;From previous slide
&#131;Simplifies to RC circuit for bandwidth calculation!
=0
Rp Lp Cp
iin=gmvinZtankvoutvout
vin
wslope =
-20 dB/decgmRp
Rp2Cp1wo
Rp2Cp1RpCp1</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
Increasing Gain-Bandwidth Product Through Cascading
&#131;We can significantly increase the gain of an amplifier 
by cascading n stages
-Issue &#8211; bandwidth degrades, but by how much?Amp Amp
CfixedAmp
Cfixed
A
1 + s/w oA
1 + s/w oA
1 + s/w ovin vout
vin vout
</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>M.H. Perrott MIT OCW
This Principle Can Be Applied To Impedance Matching
&#131;We will see that it&#8217;s advantageous to make Zinreal 
without using resistors-For the above circuit (ignoring Cgd)M1
VbiasvinRs
LsZin
Iout
LsvgsgmvgsCgsItest Vtest
Looks like series resonant circuit!</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Back to Inductors &#8211; Shunt and Series Peaking
&#131;Combine shunt peaking with a series inductor-Bandwidth extension by con verting to a second order 
filter response
&#131;Can be designed for proper peaking
&#131;Increases delay of amplifierM1RL
vout
M2CfixedId
VbiasvinVdd
L1
L2vout
vin
fgmRL
2&#960;CtotRL1-40 dB/dec-20 dB/dec</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
&#131;By definition
&#131;For parallel tank (see Tom Lee&#8217;s book, pp 88-89)
&#131;Comparing to above:
The Issue of Q
Rp Lp Cp
iin=gmvinZtankvoutvout
vin
wslope =
-20 dB/decgmRp
Rp2Cp1wo
Rp2Cp1RpCp1</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Shunt-peaked Amplifier - Analysis
&#131;Expression for gain
&#131;Parameterize with
-Corresponds to ratio of RC  to LR time constantsM1RL
vout
M2CfixedId
VbiasvinVdd
Ld
RLLd
Ctotiin=gmvinvoutSmall Signal Model
Zout
</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
Tuned Amp Transfer Function About Resonance
&#131;Evaluate at s = jw
&#131;Look at frequencies about resonance:Rp Lp Cp
iin=gmvinZtankvout&#131;Amplifier transfer function
&#131;Note that conductances
add in parallel
</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
Neutralization
&#131;Consider canceling the effect of Cgd-Choose CN= Cgd-Charging of Cgdnow provided by CN
&#131;Benefit: Impact of Cgdremoved
&#131;Issues:-How do we create the inverting amplifier?-What happens if CNis not precisely matched to Cgd?M1RL
vout
CLId
VbiasvinCgdZin
Rs
Cgs-1CN
</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
Practical Implementation of Neutralization
&#131;Leverage differential signaling to create an inverted signal
&#131;Only issue left is matching CNto Cgd-Often use lateral metal caps for CN(or CMOS transistor)-If CNtoo low, residual influence of Cgd-If CNtoo high, input impedance has inductive component
&#131;Causes peaking in frequency response
&#131;Often evaluate acceptable leve l of peaking using eye diagramsM1RL
VbiasvinCgd
RsCN
M2RL
Cgd
2IbiasCN
-vinRs</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Narrowband Amplifiers
&#131;For wireless systems, we are interested in 
conditioning and amplifying the signal over a narrow 
frequency range centered at a high frequency-Allows us to apply narrowband transformers to create 
matching networks
&#131;Can we take advantage of this fact when designing 
the amplifier?VLC1 RLL1Delay = x
Characteristic Impedance = Zo
Transmission LineZ1
VinC2die Connector
Controlled Impedance
PCB tracepackage
On-ChipDriving
Source
AmpVoutMatching
Network
Matching
Network</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
Use Cascode Device to Remove Impact of Cgd
&#131;At frequencies above and below resonanceM1vout
CL
VbiasvinCgdZin
Rs
CgsVbias2M2Vdd
LT RL
Purely
Capacitive!</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
Transfer Function for Cascaded Sections
1/100 1/10 1 10 100-80-70-60-50-40-30-20-100Normalized Gain (dB)
Normalized Frequency (Hz)Normalized Transfer Function for Cascaded Sections
n=1
n=2
n=3
n=4-3
</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
Reduction of CgdImpact Using a Cascode Device
&#131;The cascode device lowers the gain seen by Cgdof M1
-For 0.18m CMOS and gain of 3, impact of Cgdis reduced 
by 30%:
&#131;Issue:  cascoding lowers achievable voltage swingM1RL vout
CL
VbiasvinCgdZin
Rs
CgsVbias2M2
</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>S-parameters and Impedance Transformers</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec3/</lecture_pdf_url>
      <lectureno>3</lectureno>
      <slides>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
Define Reflection Coefficient
&#131;Definition:
-No reflection if &#915;L= 0
&#131;Relation to load and characteristic impedances
&#131;Alternate expression
-No reflection if ZL= Zo
</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Broadband Impedance Transformers
&#131;Consider placing an ideal transformer between source 
and load
&#131;Transformer basics (passive, zero loss)
&#131;Transformer input impedanceVsRS
RLVoutIin Iout
Rin Vin
1:N
</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
What Value of N Maximizes Voltage Transfer?
&#131;Derive formula for Voutversus Vinfor given N value
&#131;Take the derivative and set it to zero
</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
S-Parameter Calculations &#8211; Example 1
&#131;Set Vi2= 0Z1 Z2Transmission
Line Junction
Derive S-Parameter 2-PortVi1
Vr1 Vr2Vi2
&#131;Set Vi1= 0
</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
The Catch
&#131;It&#8217;s hard to realize a transformer with good 
performance over a wide frequency range-Magnetic materials have limited frequency response-Inductors have self-resonant frequencies, losses, and 
mediocre coupling to other inductors without magnetic 
material
&#131;For wireless applications, we  only need transformers 
that operate over a small frequency range-Can we take advantage of this?</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Benefit of Impedance Matching with Transformers
&#131;Transformers allow maximum voltage and power 
transfer relationship to coincide
&#131;Turns ratio for max power/voltage transfer
&#131;Resulting voltage gain (can exceed one!)VsRS
RLVoutIin Iout
Rin Vin
1:N
</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Block Diagram of S-Parameter 2-Port Model
&#131;Key issue &#8211; two-port is parameterized with respect to 
the left and right side load impedances (Z1and Z2)-Need to recalculate S11, S21, etc. if Z1or Z2changes-Typical assumption is that Z1= Z2= 50 OhmsZ2 Z1Vi1
Vr1 Vr2Vi2
S11 S22S21Z2
Z1S12Z1
Z2S-Parameter Two-Port Model</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Note for CppSim Simulations
&#131;CppSim does block-by-block computation-Feedback introduces artificial delays in simulation
&#131;Prevent artificial delays by-Ordering blocks according to input-to-output signal flow-Creating an additional signal in CppSim modules to 
pass previous sample values-Note: both are already done for you in Homework #1ZL=Z1
Vi1
Vr1Vi2Vr2Z1
Z1+ZsVs
Zs+Z1Zs-Z1delay 1
delay 1ZR=Z2
S-param.
2-port
(1)ZL=Z2
Vi1
Vr1Vi2Vr2delay 2
delay 2ZR=Z3
S-param.
2-port
(2)delay 3
delay 3ZL+Z3ZL-Z3Vout</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Note:  Maximum Power Transfer Derivation
&#131;Formulation
&#131;Take the derivative and set it to zeroVsRS
RLI
Vout
</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
A Narrowband Transformer:  The L Match
&#131;Assume Q &gt;&gt; 1
&#131;So, at resonance
&#131;Transformer steps up impedance!Zin RpZin Lp C RsLs
CSeries to Parallel
Transformation
</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Comparison of Series and Parallel RL Circuits
&#131;Equate real and imaginary parts of the left and right 
expressions (so that Zinis the same for both)-Also equate Q valuesZin RpZin Lp RsLsParallel RL Circuit Series RL Circuit
</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Calculate Response to Input Voltage Sources
&#131;Reflections on same transmission line are 
parameterized by &#915;L-Note that &#915;Lis generally different on each side of the 
circuit/passive network
How do we parameterize feedthrough to 
the other transmission line?Z2 Z1Linear Network
Z1
Vin1 Vin2Z2Vi1
Vr1 Vr2Vi2&#915;L1 &#915;L2</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
Alternate Implementation of L Match
&#131;Assume Q &gt;&gt; 1
&#131;So, at resonance
&#131;Transformer steps down impedance!Zin RpZinL
CpRsLCsParallel to Series
Transformation
</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 3
S-Parameters and Impedance Transformers
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
What Happens When the Wave Hits a Boundary?
&#131;At boundary-Orientation of H-field flips with respect to E-field
&#131;Current reverses direction with respect to voltage
x
zEx
Hy yZL
Ex HyZLIncident Wave
Reflected WaveI
III</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
The T Match
&#131;Also combines two L sections
&#131;Again, benefit is in providing an extra degree of 
freedom in choosing component valuesZin C2Zin R CL1 L2C1 + C2 = C
Steps Down
ImpedanceSteps Up
ImpedanceL2 L1
C1 R</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
Relate to Characteristic Impedance
&#131;From previous slide
&#131;Voltage and current ratio in tr ansmission line set by it 
characteristic impedance
&#131;Substituting:
</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>M.H. Perrott MIT OCW
Tapped Capacitor as a Transformer
&#131;To first order:
&#131;Useful in VCO design
&#131;See Chapter 4 of Tom Lee&#8217;s book for analysis
Zin L
C2C1
RL</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
The &#960; Match
&#131;Combines two L sections
&#131;Provides an extra degree of freedom for choosing 
component values for a desired transformation ratioZin RL
C1 C2Zin R C1 C2L1 L2L1 + L2 = L
Steps Up
ImpedanceSteps Down
Impedance</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>Impedance Transformers</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
S-Parameter Calculations &#8211; Example 2
&#131;Same as before:
Z1 Z2Transmission Line
Junction with Capacitor
Derive S-Parameter 2-PortCVi1
Vr1 Vr2Vi2
&#131;But now:
</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
What Happens When the Wave Hits a Boundary?
&#131;Reflections can occur
x
zEx
Hy yZL
Ex HyZLIncident Wave
Reflected Wave</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
Calculate Response to Input Voltage Sources
&#131;Assume source impedances match their respective 
transmission lines
Z2 Z1Linear Network
Transmission Line 1 Transmission Line 2Z1
Vin1 Vin2Z2Same value
by definitionSame value
by definition</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
Consider Resonant Circuits (Chap. 4 of Lee&#8217;s Book)
&#131;Key insight:  resonance allows Zinto be purely real 
despite the presence of reactive elements
Zin RpZin Lp Cp RsLsCsParallel Resonant Circuit Series Resonant Circuit</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
Parameterization of High Speed Circuits/Passives
&#131;Circuits or passive structures are often connected to 
transmission lines at high frequencies-How do you describe their behavior?
Linear Network
Transmission Line 1 Transmission Line 2</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Calculate Response to Input Voltage Sources
&#131;Sources create incident waves on their respective 
transmission line
&#131;Circuit/passive network causes -Reflections on same transmission line-Feedthrough to other transmission line
Z2 Z1Linear Network
Z1
Vin1 Vin2Z2Vi1
Vr1 Vr2Vi2</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Voltage Versus Power
&#131;For most communication circuits, voltage (or current) 
is the key signal for detection-Phase information is important-Power is ambiguous with respect to phase information
&#131;Example:
&#131;For high speed circuits with transmission lines, 
achieving maximum power transfer is important-Maximum power transfer coincides with having zero 
reflections (i.e., &#915;L= 0)
Can we ever win on both issues?Voltage Power</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
Note: Alternate Form for S21and S12
Z2 Z1Linear Network
Z1
Vin1 Vin2Z2Vi1
Vr1 Vr2Vi2&#915;L1 &#915;L2
</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
What Happens At The Load Location?
&#131;Voltage and currents at load are ratioed according to the 
load impedance
x
zyZL
ZLIncident Wave
Reflected WaveIi
Ii
Ir
IrVi
Vr
Voltage at Load
Current at Load
Ratio at Load
</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
S-Parameter Calculations &#8211; Example 3
&#131;The S-parameter calculations are now more involved-Network now has more than one node
&#131;This is a homework problemZ1 Z2
Derive S-Parameter 2-PortVi1
Vr1 Vr2Vi2
C1L1
C2</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
Comparison of Series and Parallel RC Circuits
&#131;Equate real and imaginary parts of the left and right 
expressions (so that Zinis the same for both)-Also equate Q values
Zin RpZin Cp RsCsParallel RC Circuit Series RC Circuit
</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
What is the Input Impedance for Max Voltage Transfer?
&#131;We know from basic transformer theory that input 
impedance into transformer is
&#131;We just learned that, to maximize voltage transfer, we 
must set the transformer turns ratio to
&#131;Put them together
So, N should be set for max power transfer into transformer
to achieve the maximum volt age transfer at the load!
</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
S-Parameters &#8211; Definition
&#131;Model circuit/passive networ k using 2-port techniques-Similar idea to Thevenin/Norton modeling
&#131;Defining equations:Z2 Z1Linear Network
Z1
Vin1 Vin2Z2Vi1
Vr1 Vr2Vi2&#915;L1 &#915;L2
</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
S-Parameters &#8211; Calculation/Measurement
Z2 Z1Linear Network
Z1
Vin1 Vin2Z2Vi1
Vr1 Vr2Vi2&#915;L1 &#915;L2
</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Macro-modeling for Distributed, Linear Networks
Z3 Z1
Zs
VsZLLinear
Circuits &amp;
Passives
(1)Z2Linear
Circuits &amp;
Passives
(2) length = d 1 length = d 2 length = d 3
delay 1 = velocityd1
LCd1= 
&#181;&#949;d1= delay 2 = &#181;&#949;d2delay 3 = &#181;&#949;d3Vout
&#131;Model transmission line as a delay element-If lossy, could also add an attenuation factor (which is a 
function of its length)
&#131;Model circuits/passives with S-parameter 2-ports
&#131;Model source and load with custom blocks</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Macro-modeling for Distributed, Linear Networks
Z3 Z1
Zs
VsZLLinear
Circuits &amp;
Passives
(1)Z2Linear
Circuits &amp;
Passives
(2) length = d 1 length = d 2 length = d 3Vout
&#131;Key parameters for a transmission line-Characteristic impedance (only impacts S-parameter 
calculations)-Delay (function of length and &#181;, &#949;)-Loss (ignore for now)
&#131;Key parameters for circuits/passives-S-parameters 
We would like an overall macro-model for simulation</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
Matching for Voltage versus Power Transfer
&#131;Consider the voltage divider network
&#131;For maximum voltage transfer
&#131;For maximum power transferVsRS
RLI
Vout
Which one do we want?</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
Macro-modeling for Distributed, Linear Networks
Z3 Z1
Zs
VsZLLinear
Circuits &amp;
Passives
(1)Z2Linear
Circuits &amp;
Passives
(2) length = d 1 length = d 2 length = d 3
delay 1 = velocityd1
LCd1= 
&#181;&#949;d1= delay 2 = &#181;&#949;d2delay 3 = &#181;&#949;d3
ZL=Z1
Vi1
Vr1Vi2Vr2Z1
Z1+ZsVs
Zs+Z1Zs-Z1delay 1
delay 1ZR=Z2
S-param.
2-port
(1)ZL=Z2
Vi1
Vr1Vi2Vr2delay 2
delay 2ZR=Z3
S-param.
2-port
(2)delay 3
delay 3ZL+Z3ZL-Z3Vout
Vout</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Transmission Line Theory</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec2/</lecture_pdf_url>
      <lectureno>2</lectureno>
      <slides>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
Evaluate Curl Operations in Maxwell&#8217;s Formula
&#131;Definition
</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
Solution
&#131;Fields change only in time and in z-direction-Assume complex exponential solution
</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
Back to Maxwell&#8217;s Equations
&#131;From previous analysis
&#131;These can be equivalently written as
&#131;Where
</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
Assumptions
&#131;Orientation and direction-E field is in x-direction and traveling in z-direction-H field is in y-direction and traveling in z-direction-In freespace:
&#131;For transmission line (TEM mode)yx
zEx
Hy
direction
of travel
x
zEx Hyb
aydirection
of travel</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
Current and H-Field
&#131;Flux from one plate interact s with flux from the other 
plate
x
zEx Hyb
ay
x
yI
I</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Parallel Plate Waveguide
&#131;E-field and H-field are influenced by plates
x
zEx Hyb
ay</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
LC Network Analogy of Transmission Line (TEM)
&#131;LC network analogy
&#131;Calculate input impedanceL
CL
CL
CL
Zin
</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Voltage and Current
&#131;Definitions:
x
ya
bH
t
wx
zEx Hyb
a y
I
E</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
Current and H-Field
&#131;Assume that (AC) current is flowing 
x
zEx Hyb
ayI
I</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 2
Transmission Lines
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
Maxwell&#8217;s Equations
&#131;General form:
&#131;Assumptions for free space  and transmission line propagation-No charge buildup &#8658;&#961;= 0-No free current &#8658;J = 0
&#131;Note:  we&#8217;ll only need Equations 1 and 2
</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
How are Lumped LC and Tran smission Lines Different?
&#131;In transmission line, L and C values are infinitely 
small-It is always true that
&#131;For lumped LC, L and C have finite values
-Finite frequency range for L
CL
CL
CL
Zin
</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
Now Put All the Pieces Together
&#131;Solve Maxwell&#8217;s Equations (1) and (2)
</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Calculating Propagation Speed
&#131;The resulting cosine wave is a function of time AND 
position
&#131;Consider &#8220;riding&#8221; one part of the wave
&#131;Velocity calculation
yx
zdirection
of travel
ztEx(z,t)</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
Solution
&#131;Fields change only in time and in z-direction-Assume complex exponential solution
&#131;Implications:
</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Freespace Values
&#131;Constants
&#131;Impedance
&#131;Propagation speed
&#131;Wavelength of 30 GHz signal
</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
Voltage and E-Field
&#131;Approximate E-field to be uniform and restricted to lie 
between the plates
x
zEx Hyb
ay
abJ
J
x
yEV</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Integrated Circuit Values
&#131;Constants
&#131;Impedance (geometry dependant)
&#131;Propagation speed (geometry independent)
&#131;Wavelength of 30 GHz signal in silicon dioxide
</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Connecting to the Real World
&#131;Current solution is complex
&#131;But the following solution is also valid
&#131;And adding them together is also a valid solution
</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
Solution
&#131;Fields change only in time and in z-direction-Assume complex exponential solution
&#131;Implications:
But, what is the value of k ?</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
Wave Equation for Transmission Line (TEM)
&#131;Key formulas
&#131;Substitute (2) into (1)
&#131;Characteristic impedance (use Equation (1))
</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
Evaluate Curl Operations in Maxwell&#8217;s Formula
&#131;Definition
&#131;Given the previous assumptions
</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Now Put All the Pieces Together
&#131;Solve Maxwell&#8217;s Equation (1)
</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Current and H-Field
&#131;Current flowing down waveguide influences H-field 
x
zEx Hyb
ay
x
yI
I
H</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
Connecting to the Real World
&#131;Current solution is complex
&#131;But the following complex solution is also valid
&#131;And adding them together is also a valid solution that 
is now real-valued
</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Lossy Transmission Lines
&#131;Practical transmission lines have losses in their 
conductor and dielectric material-We model such loss by including resistors in the LC 
model
&#131;The presence of such losses has two effects on 
signals traveling through the line-Attenuation-Dispersion (i.e., bandwidth degradation)
&#131;See Chapter 5 of Thomas Lee&#8217;s book for analysisZin 1/GL
CR
1/GL
CR
1/GL
CR L R</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
Calculating Propagation Speed
&#131;The resulting cosine wave is a function of time AND 
position
&#131;Consider &#8220;riding&#8221; one part of the wave
&#131;Velocity calculation
yx
zdirection
of travel
ztEx(z,t)</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Now Put All the Pieces Together
&#131;Solve Maxwell&#8217;s Equations (1) and (2)
</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Current and H-Field
&#131;Approximate H-Field to be uniform and restricted to lie 
between the plates
x
zEx Hyb
ay
x
yabI
I</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>High Speed Broadband Amplifiers</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec5/</lecture_pdf_url>
      <lectureno>5</lectureno>
      <slides>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
Analysis of Amplifier Behavior
&#131;Typically focus on small signal behavior-Work with a linearized model such as hybrid- &#960;-Thevenin modeling techniques allow fast and efficient 
analysis
&#131;To do small signal analysis:
RSRGRD
vinvout
VbiasID1) Solve for bias current I d
2) Calculate small signal
     parameters (such as g m, ro)
3) Solve for small signal response     using transistor hybrid- &#960; small
     signal modelSmall Signal Analysis Steps</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Amplifier Example &#8211; CMOS Inverter
&#131;Assume that we set Vbiassuch that the amplifier 
nominal output is such that NMOS and PMOS 
transistors are all in saturation-Note:  this topology VERY  sensitive to bias errors
Cfixed
Ctot = Cdb1+Cdb2 + Cgs3+Cgs4 + K(Cov3+Cov4) + CfixedM2
M1M4
M3
Miller multiplication factorVbiasvin
(+Cov1+Cov2)vout</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Analytical Device Modeling in Velocity Saturation
&#131;If L small (as in modern devices), than velocity 
saturation will impact us for even moderate values 
of Vgs-VT
-Current increases linearly with Vgs-VT!
&#131;Transconductance in velocity saturation:
-No longer a function of Vgs!
</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
NMOS Load Amplifier
&#131;Gain set by the relative sizing of M1and M2Cfixed M1VbiasvinvoutM2
gm21
1vout
vin
fslope = 
-20 dB/dec
gm1
2&#960;Ctotgm1
2&#960;Ctotgm2
gm2 Ctot = Cdb1+Csb2+Cgs2 + Cgs3+KCov3 + Cfixed
Miller multiplication factor (+Cov1)M3Vdd
Id
</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Resistor Loaded Amplifier (Unsilicided Poly)
&#131;This is the fastest non-e nhanced amplifier I&#8217;ve found-Unsilicided poly is a pretty efficient current provider 
(i..e, has a good current to capacitance ratio)-Output swing can go all the way up to Vdd
&#131;Allows following stage to achieve high ft-Linear settling behavior (i n contrast to NMOS load)M1RL
vout
M2CfixedId
Vbiasvin
Ctot = Cdb1+CRL/2 + Cgs2+KCov2 + Cfixed
Miller multiplication factor (+Cov1)1vout
vin
fslope = 
-20 dB/dec
gm1
2&#960;Ctotgm1RL
2&#960;RLCtot1Vdd</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>M.H. Perrott MIT OCW
Example:  Design for Swing of 1 V, Gain of 1 and 2
&#131;Assume L=0.18 &#181;, use previous gmplot (Wo=1.8 &#181;)
0 100 200 300 400 500 600 70000.20.40.60.81
Current Density - I den (microAmps/micron)Transconductance (milliAmps/Volts)Transconductance versus Current Density
A=2 A=1
gm(wo=1.8 &#181;,Iden)
&#131;For gain of 1, 
current density = 
250 &#181;A/&#181;m
&#131;For gain of 2, 
current density = 
115 &#181;A/&#181;m 
&#131;Note that current 
density reduced as gain increases!
-fteffectively 
decreased</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
Example:  The Impact of Capacitance in Feedback
&#131;Consider Cgdin the MOS device as Cf-Assume gain is negative
&#131;Impact on input capacitance:
&#131;Output impedance:AmpZin
Av
ZLVout VinZoutCf
</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 200.10.20.30.40.50.60.70.80.91
Vgs (Volts)gm (milliAmps/Volts)gm versus VgsExample:  GmVersus Voltage for 0.18&#181;Device
M1Id
VgsW
L=1.8&#181;
0.18 &#181;</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Speed of NMOS Versus PMOS Devices
&#131;NMOS devices have much higher mobility than PMOS 
devices (in current, non-strained, bulk CMOS processes)
-Intuition:  NMOS devices pr ovide approximately 2.5 x gm
for a given amount of capacitance and gate bias voltage-Also: NMOS devices provid e approximately 2.5 x Idfor a 
given amount of capacitance and gate bias voltage
</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
The Issue of Velocity Saturation
&#131;We classically assume that MOS current is calculated as
&#131;Which is really
-Vdsat,lcorresponds to the saturation voltage at a given 
length, which we often refer to as &#8710;V
&#131;It may be shown that
-If Vgs-VTapproaches LEsatin value, then the top equation is 
no longer valid
&#131;We say that the device is in velocity saturation
</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
Derivation of ftfor MOS Device in Saturation
-gmbvsvgs ro gmvgsID+id
CsbCgsCgd
Cdb
iinVbiasRLARGEid
iin
</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
Broadband Communication System
&#131;Example:  high speed data link on a PC board
-We&#8217;ve now studied how to analyze the transmission line 
effects and package parasitics-What&#8217;s next?VLC1 RLL1Delay = x
Characteristic Impedance = Zo
Transmission LineZ1
VinC2dieAdjoining pinsConnector
Controlled Impedance
PCB tracepackage
On-ChipDriving
Source</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
0 100 200 300 400 500 600 70000.20.40.60.81
Current Density (microAmps/micron)Transconductance (milliAmps/Volts)Transconductance versus Current DensityExample:  GmVersus Current Density for 0.18&#181;Device
M1Id
VgsW
L=1.8&#181;
0.18 &#181;
</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>M.H. Perrott MIT OCW
&#131;We now know:
&#131;Substitute (2) into (1)
&#131;The above expression allows us to design the resistor 
loaded amp based on the gmcurve of a representative 
transistor of width Wo!
A Numerical Design Procedure for Resistor Amp &#8211; Step 2</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
Basics of MOS Large Signal Behavior (Qualitative)
SDG
Cchannel  = Cox(VGS-VT)VGS
VDS=0
SDGVGS
VD=&#8710;V
SDGVGS
VD&gt;&#8710;VTriode
Pinch-off
SaturationVDSID
ID
IDID
TriodePinch-offSaturation
&#8710;VOverall I-V Characteristic</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>M.H. Perrott MIT OCW
Example (Continued)
&#131;Knowledge of the current density allows us to design 
the amplifier-Recall-Free parameters are W, Ibias, and R (L assumed to be fixed)
&#131;Given Iden= 115 &#181;A/&#181;m (Swing = 1V, Gain = 2)-If we choose Ibias= 300 &#181;A
&#131;Note that we could instead choose W or R, and then calculate the other parameters
</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
Add Resistive Feedback
Bandwidth 
extended andless sensitivity
to bias offset
Cfixed
Ctot = Cdb1+Cdb2 + Cgs3+Cgs4 + K(Cov3+Cov4) + CRf /2 + CfixedM2
M1M4
M3
Miller multiplication factorVbiasvin
(+Cov1+Cov2)vout Rf1vout
vin
fslope = -20 dB/dec(gm1+gm2)(ro1||ro2)
2&#960;Ctot(ro1||ro2)1 gm1+gm2
2&#960;Ctot(gm1+gm2)Rf
2&#960;CtotRf1</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Shunt-Series Amplifier &#8211; Analysis Snapshot
&#131;From Chapter 8 of Tom Lee&#8217;s 
book (see pp 191-197):-Gain
-Input resistance
-Output resistanceM1
VbiasvinvoutRf
R1RsRLRin Rout
vx
Same for Rs= RL!</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 5
High Speed, Broadband Amplifiers
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
Design of NMOS Load Amplifier
&#131;Size transistors for gain and speed-Choose minimum L for maximum speed-Choose ratio of W1to W2to achieve appropriate gain
&#131;Problem:  VTof M2lowers the bias voltage of the next 
stage (thus lowering its achievable ft)-Severely hampers performance when amplifier is cascaded-One person solved this issue by increasing Vddof NMOS 
load (see Sackinger et. al., &#8220;A 3-GHz 32-dB CMOS Limiting 
Amplifier for SONET OC-48 receivers&#8221;, JSSC, Dec 2000)Cfixed M1VbiasvinvoutM2
gm21Ctot = Cdb1+Csb2+Cgs2 + Cgs3+KCov3 + Cfixed
Miller multiplication factor (+Cov1)
M3Vdd
Id
</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
A Numerical Design Procedure for Resistor Amp &#8211; Step 1
&#131;Two key equations-Set gain and swing (single-
ended)
&#131;Equate (1) and (2) through R
M6M1 M2
M5&#945;IbiasVin+R
Vin-R
Vo+
Vo-
2IbiasIbiasVdd
Can we relate this formula to a gmcurve taken
from a device of width Wo? </text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Shunt-Series Amplifier
&#131;Use resistors to control the bias, gain, and 
input/output impedances-Improves accuracy over process and temp variations
&#131;Issues-Degeneration of M1lowers slew rate for large signal 
applications (such as limit amps)-There are better high speed approaches &#8211; the advantage 
of this one is simply accuracyIbias
M1
Vbiasvinvout Rf
R1Rs
RLRin Rout
M1
VbiasvinvoutRf
R1RsRLRin Rout</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
Example:  Current Versus Voltage for 0.18&#181;Device
0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 200.20.40.60.811.21.4
Vgs (Volts)Id (milliAmps)Id versus VgsM1Id
VgsW
L=1.8&#181;
0.18 &#181;</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
Transfer Function of CMOS Inverter
Low Bandwidth!
Cfixed
Ctot = Cdb1+Cdb2 + Cgs3+Cgs4 + K(Cov3+Cov4) + CfixedM2
M1M4
M3
Miller multiplication factorVbiasvin
(+Cov1+Cov2)vout1vout
vin
fslope = -20 dB/dec(gm1+gm2)(ro1||ro2)
2&#960;Ctot(ro1||ro2)1 gm1+gm2
2&#960;Ctot</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
Assumptions for High Speed Amplifier Analysis
&#131;Assume that amplifier is loaded by an identical 
amplifier and by fixed wiring capacitance
&#131;Intrinsic performance-Defined as the bandwidth achieved for a given gain 
when Cfixedis negligible-Amplifier approaches intrinsi c performance as its device 
sizes (and current ) are increased
&#131;In practice, optimal sizing (a nd power) of amplifier is 
roughly where Cin+Cout= CfixedAmp Amp
CfixedCin CinCtot = Cout+Cin+Cfixed
Cout</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
Derivation of ftfor MOS Device in Saturation
&#131;Assumption is that input is current, output of device 
is short circuited to a supply voltage-Note that voltage bias is required at gate
&#131;The calculated value of ftis a function of this bias voltage-gmbvsvgs ro gmvgsID+id
CsbCgsCgd
Cdb
iinVbiasRLARGEid
iin</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
Frequency Performance of a CMOS Device
&#131;Two figures of merit in common use-ft :  frequency for which current gain is unity-fmax: frequency for which power gain is unity
&#131;Common intuition about ft-Gain, bandwidth product is conserved 
-We will see that MOS devices have an ftthat shifts with 
bias
&#131;This effect strongly impacts high speed amplifier 
topology selection
&#131;We will focus on ft-Look at pages 70-72 of Tom Lee&#8217;s book for discussion on f
max
</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Take PMOS Out of the Signal Path
&#131;Advantages-PMOS gate no longer loads the signal-NMOS device can be biased at a higher voltage
&#131;Issue-PMOS is not an efficient current provider (Id/drain cap)
&#131;Drain cap close in value to Cgs-Signal path is loaded by cap of Rfand drain cap of 
PMOSCLM2
M1
Vbiasvinvout RfVbias2 Ibias
CL M1
Vbiasvinvout Rf</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>M.H. Perrott MIT OCW
How Do We Choose IbiasFor High Bandwidth?
&#131;As you increase Ibias, the size of transistors also 
increases to keep a constant current density-The size of Cinand Coutincreases relative to Cfixed
&#131;To achieve high bandwidth, want to size the devices 
(i.e., choose the value for Ibias), such that -Cin+Coutroughly equal to CfixedAmp Amp
CfixedCin CinCtot = Cout+Cin+Cfixed
Cout</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
High Speed, Broadband Amplifiers
&#131;The first thing that you typica lly do to the input signal 
is amplify it
&#131;Function-Boosts signal levels to acceptable values-Provides reverse isolation
&#131;Key performance parameters-Gain, bandwidth, noise, linearityVLC1 RLL1Delay = x
Characteristic Impedance = Zo
Transmission LineZ1
VinC2dieAdjoining pinsConnector
Controlled Impedance
PCB tracepackage
On-ChipDriving
Source
AmpVout</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
MOS AC Small Signal Model (Device in Saturation)
RSRGRDRD
RSRG
-gmbvsvgs
vsro gmvgsID
CsbCgsCgd
Cdb
Cgs = Cgc + Cov =      CoxW(L-2LD) + Cov2
3
Cgd = Cov
Csb = Cjsb (area + perimeter junction capacitance)
Cdb = Cjdb (area + perimeter junction capacitance)</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Wiring Parasitics
&#131;Capacitance-Gate: cap from poly to substrate and metal layers-Drain and source:  cap from  metal routing path to 
substrate and other metal layers
&#131;Resistance-Gate:  poly gate has resistance (reduced by silicide)-Drain and source:  some resi stance in diffusion region, 
and from routing long metal lines
&#131;Inductance-Gate:  poly gate has negligible inductance-Drain and source:  becoming an issue for long wires
Extract these parasitics from circuit layout </text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
MOS DC Small Signal Model
&#131;Assume transistor in saturation:
&#131;Thevenin modeling based on the aboveRSRGRDRD
RSRG
-gmbvsvgs
vsro gmvgs
gm = &#181;nCox(W/L)(VGS - VT)(1 + &#955;VDS)
     =   2 &#181;nCox(W/L)ID    (assuming &#955;VDS &lt;&lt; 1)
Cox2q&#949;sNA
2   2| &#934;p| + VSB&#947;gmwhere &#947; = gmb =
In practice:   gmb = gm/5 to gm/3
&#955;ID1ro =ID</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
We Can Still Do Better
&#131;We are fundamentally looking for high gmto 
capacitance ratio to get the highest bandwidth-PMOS degrades this ratio-Gate bias voltage is constrained
Cfixed
Ctot = Cdb1+Cdb2 + Cgs3+Cgs4 + K(Cov3+Cov4) + CRf /2 + CfixedM2
M1M4
M3
Miller multiplication factorVbiasvin
(+Cov1+Cov2)vout Rf</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Implementation of Resistor Loaded Amplifier
&#131;Typically implement using differential pairs
&#131;Benefits-Self-biased-Common-mode rejection
&#131;Negative-More power than single-ended versionM6M1 M2
M5&#945;IbiasVin+R1
Vin-R2Vo+
Vo-
M7M3M4Cfixed Cfixed
IbiasIbias/2Vdd</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
Basics of MOS Large Signal Behavior (Quantitative)
SDG
Cchannel  = Cox(VGS-VT)VGS
VDS=0
SDGVGS
VD=&#8710;V
SDGVGS
VD&gt;&#8710;VTriode
Pinch-off
SaturationID
ID
IDID = &#181;nCoxW
L(VGS - VT - VDS/2)VDS
ID &#181;nCoxW
L(VGS - VT)VDSfor VDS &lt;&lt; VGS - VT
ID = &#181;nCoxW
L1
2(VGS-VT)2(1+&#955;VDS)
(where &#955; corresponds to
channel length modulation)&#8710;V = VGS-VT
&#8710;V =
&#181;nCoxW2IDL</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
Capacitors For MOS Device In Saturation
SDGVGS
VD&gt;&#8710;VID
LDLD
overlap cap:  Cov = WLDCox + WCfringeBCgc
CcbCov
CjdbCjsbCovSide View
gate to channel cap:  Cgc =      CoxW(L-2LD)
channel to bulk cap:  Ccb - ignore in this classSDTop View
W
E
LEE
source to bulk cap:  Cjsb = 
1 +VSB &#934;BCj(0)
1 +VSB &#934;BCjsw(0)
WE + (W + 2E)junction bottom wall 
cap (per area)junction sidewall 
cap (per length)
drain to bulk cap:  Cjsd = 
1 +VDB &#934;BCj(0)
1 +VDB &#934;BCjsw(0)
WE + (W + 2E)
2
3(make 2W for "4 sided" 
 perimeter in some cases)L</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
The Miller Effect
&#131;Concerns impedances that connect from input to 
output of an amplifier
&#131;Input impedance:
&#131;Output impedance:AmpZinZf
Av
ZLVout VinZout
</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Why is fta Function of Voltage Bias?
&#131;ftis a ratio of gmto gate capacitance-gmis a function of gate bias, wh ile gate cap is not (so long 
as device remains biased)
&#131;First order relationship between gmand gate bias:
-The larger the gate bias, the higher the value for ft
&#131;Alternately, ftis a function of current density
-So ftmaximized at max current density (and minimum L)
</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
How Do We Design the Amplifier?
&#131;Highly inaccurate to assume square law behavior
&#131;We will now introduce a numerical procedure based 
on the simulated gmcurve of a transistor-A look at gmassuming square law device:
-Observe that if we keep the current density (Id/W) 
constant, then gmscales directly with W
&#131;This turns out to be true outside the square-law regime 
as well-We can therefore relate gmof devices with different 
widths given that have the same current density
</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Derivation of ftfor MOS Device in Saturation
1id
iin
f
ftslope = -20 dB/dec
</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Guest Lecture by Gu-Yeon Wei, Harvard University: Low-Power High-Speed Links</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/guest1/</lecture_pdf_url>
      <lectureno>22</lectureno>
      <slides>
        <slide>
          <slideno>32</slideno>
          <text>Wei Low-Power High-Speed Links 33
3.1Gb/s, 
113mWPower and Performance
</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>Wei Low-Power High-Speed Links 9
Critical Path in Links
&#8226; The critical path in links can be as short as 1~2 gate delays
&#8211; Transmit path
&#8211; Receive path
DQ
DQ
&#934;Rterm
Zo=50&#8486;
VrefDeven
Dodd&#934;DQ
DQ&#934;&#934;
Rterm
Zo=50&#8486;</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>Wei Low-Power High-Speed Links 12
Sources of Noise
&#8226; Power supply noise
&#8211; Translates into voltage and timing uncertainty
&#8226; Cross talk
&#8211; Near- and Far-End Cross Talk (NEXT and FEXT)
&#8211; High-frequency coupling
&#8226; Clock Jitter
&#8211; Timing uncertainty in transmitted and sampled symbol&#8211; Probabilistic distribution of timing edges (bounded and 
unbounded components)
&#8226; Device mismatches and systematic offsets
&#8211; Deterministic or systematic variation in timing edges from 
multi-phase clock generators</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>Wei Low-Power High-Speed Links 35
Summary
&#8226; Higher performance links require low noise &#198;low noise 
solutions lead to lower power
&#8211; Trade performance (speed) for power reduction
&#8226; DVS links enable energy-efficient link operation and also have 
some nice properties
&#8226; Outstanding issues with using DVS links
&#8211; Communication during frequency and voltage transitions
&#8211; Supply voltage regulator slew rate limits
&#8211; Overhead of multiple regulators</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>Wei Low-Power High-Speed Links 20
DVS Links
&#8226; Dynamic Voltage Scaling (DVS)
&#8211; Technique first introduced for digital systems (e.g., uP, DSP 
chips)
&#8226; Lot&#8217;s of work done in both academia and industry 
(e.g., Intel, Transmeta)
&#8211; Allows trade off between speed and power
&#8226; Let&#8217;s investigate DVS for high-speed links
&#8211; Motivation and potential benefits
&#8211; Design example from Dr. Jaeha Kim 
(ISSCC2002, JSSC2002 , PhD thesis 2002)</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>Wei Low-Power High-Speed Links 6
Performance Limitations
&#8226; Important to look at performance because higher performance can lead 
to lower power by trading off performance for energy reduction
&#8226; Several factors limit the performance of high-speed links
&#8211; Non-ideal channel characteristics
&#8211; Bandwidth limits of transceiver circuitry
&#8211; Noise from power supply, cross talk , clock jitter, device mismatches, etc.
&#8226; Eye diagrams &#8211; a qualitative measure of link performance
random bit stream
ideal data eye realistic data eyeTbit</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>Wei Low-Power High-Speed Links 30
Clock Recovery
&#8226; Optimal receiver timing is recovered from the 
incoming data stream
   RXData
VCO FilterPD
Clock
Recovery</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>Wei Low-Power High-Speed Links 5
Link Components
&#8226; High-speed links consist of 4 main components
&#8211; Serializing transmitter driver
&#8211; Communication channel&#8211; De-serializing receiver samplers&#8211; Timing recoveryRX
data in
timing
recovery10010
channelTXdata out10010</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>Wei Low-Power High-Speed Links 19
Power vs. M
&#8226; Larger M
BCan reduce voltage 
BLower power
BLess accurate timing
&#8211; static phase offsets
&#8211; jitter
&#8226; Cannot make M 
arbitrarily large b/c there 
is a lower limit to Vdd
&#8226; Choice: M= 4~6
choiceLower Supply &#8733;1/M or fCLKFixed Supply
This begs the questions&#8230; What if we make Vdd adaptive 
w/ fCLK? </text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>Wei Low-Power High-Speed Links 4
High-Speed Links Overview
&#8226; High-speed data communication between chips across an 
impedance controlled channel
&#8211; Shared communication bus (memories)
&#8211; Point-to-point links
&#8226; Types of link architectures and implementations
&#8211; Parallel vs. serial&#8211; Differential vs. single-ended&#8211; Low-impedance vs. high-impedance driver
&#8211; Transmitter-only vs. receiver-only vs. double termination
&#8226; We will focus on point-to-point se rial links using differential high-
impedance drivers with double te rmination for network routers
&#8211; Techniques to reduce power applicable to other link types</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>Low-Power High-Speed Links
Gu-Yeon Wei
Division of Engineering and Applied Sciences
Harvard University
6.976 Guest Lecture, Spring 2003 </text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>Wei Low-Power High-Speed Links 17
Multiplexing
 TX
 TX
 TX RX
 RX
 RX
Multiphase ClocksParallelized Transmitter Parallelized Receiver
channel
bitrate = M.fclk</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>Wei Low-Power High-Speed Links 28
Dual-Loop Clock Generation
Reference VCO fCoarse Control
Local VCOFine Control
Local VCOFine ControlAdaptive Supply, V
  1:5 Demultiplexing
  Receiver    5:1 Multiplexing    TransmitterfrefAdaptive Power Supply Regulator
Local Multiphase Clock Recovery Lo cal Multiphase Clock Generation</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>Wei Low-Power High-Speed Links 8
Equalization
&#8226; Placing a high-pass filter in the signal path can counter the roll-
off effects of the channel
&#8211; Preemphasis or transmit-side equalization is commonly used</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>Wei Low-Power High-Speed Links 26
Example: Adaptive Supply Serial Links
&#8226; Jaeha Kim (Ph.D. defense 2002)
Adaptive
Supply, V  1:5 Demultiplexing
  Receiver    5:1 Multiplexing    TransmitterMultiphase Clock
RecoveryMultiphase Clock
Generation
Adaptive Power
Supply Regulatorfref</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>Wei Low-Power High-Speed Links 15
Differential Signaling
&#8226; Differential communication can lead to a lower power solution
&#8211; Immunity to common mode noise
&#8211; Injects less noise into the supplies
&#8226; But aren&#8217;t there now are two ch annels that switch?  Yes, but&#8230;
&#8211; Signal amplitudes can be  smaller on both channels
&#8211; Alternative is pseudo-differen tial signaling but needs a refe rence voltage which can be 
noisy and require larger Vswing
&#8226; What does it cost?
&#8211; Requires two pins per linkRterm
Zo=50&#8486;
Rterm
Zo=50&#8486; DVswingdiff pk2pk = 2(I*R) Rterm
Zo=50&#8486;Vswing = I*R
Vref</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>Wei Low-Power High-Speed Links 34
Power Breakdown
</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>Wei Low-Power High-Speed Links 13
Considerations for Low Power
&#8226; Low noise &#198;low power
&#8211; Target some signal to noise ratio (SNR)
&#8211; Reducing noise allows for lower signal power
&#8226; Trade speed for lower power
&#8211; Reducing bit rate improves SNR&#8211; Many noise sources are fixed &#198;ratio of timing uncertainty to 
bit time improves (have longer bit times)
&#8226; Let&#8217;s look at a few design choices for low power
&#8211; Circuit level
&#8211; Architecture level
&#8211; System level</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>Wei Low-Power High-Speed Links 24
Performance Monitoring DLL
&#8226; Reduces design complexity by enabling one to replace precision analog 
components with simple digital gates.  How?
&#8211; Inverters of the delay line model th e critical path (clock distribution)
&#8211; Delay of gates in I/O circuitry are fixed relative to clock periodCP
PD
A
clkVCTRLAVCP1
0O180ODN UP</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>Wei Low-Power High-Speed Links 16
Signal Multiplexing
&#8226; There are different options for choosing where to combine pulses to 
create sub-clock period symbols
&#8211; Combine at the final transmit ter stage vs. farther up stream
&#8211;Cloadfor the clocks higher when comb ined at the final transmitter
vs.
&#8211; Need faster signal path after the multiplexer
&#8226; Best choice depends on implementation (see Zerbe, ISSCC2003)Rterm
Zo=50&#8486;
D0D1D2D3Rterm
Zo=50&#8486;high-speed path</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>Wei Low-Power High-Speed Links 11
Parallelism
&#8226; Parallelism can increase bit rate even with limited clock 
frequency 
&#8211; Time-interleaved multiplexing
&#8211; Multi-level signaling
&#8226; Some performance issues to be wary of
&#8211; Static timing offsets in multi-phase clock generator (DLL or PLL)&#8211; Requires higher voltage dynamic range in transmitter and receiver
&#8226; Parallelism can also be low power00011110clk[n]
clk[n+1]
data</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>Wei Low-Power High-Speed Links 3
Motivation
&#8226; Demand for high bandwidth communications
&#8226; Advancements in IC fabrication technology
&#8211; Higher performance
&#8211; More complex functionality&#198;Chip I/O becomes performance bottleneck
&#198;Increasing power consumption
&#8226; Network router example
&#8226; 10&#8217;s to 100&#8217;s of links on a single crosspoint switchbackplane PCB
50-&#8486; tracesswitch card network card
digital
crosspoint
transceivers</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>Wei Low-Power High-Speed Links 25
Adaptive Receiver Filter
&#8226; Filter signal frequencies beyond the Nyquist rate at the receiver (helps 
for dealing with cross talk) 
&#8226; Receiver example
&#8211; Filter&#8217;s corner frequency tracks fsymbolPreamplifier&#934;0
&#934;1Regenerative
LatchIN IN
fsymbolVbias
AdB
f</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>Wei Low-Power High-Speed Links 32
Chip Prototype
&#8226;0 . 2 5&#181;m CMOS
&#8226; 2.5V / 0.55Vth
&#8226;3 . 1&#215;2.9mm2
&#8226; 0.4~5.0Gb/s
&#8226; 0.9~2.5V&#8226; 5.6~375mW&#8226; BER &lt; 10
-15
&#8226; Reg. Efficiency:
83-94%TX TX TX TXTX-PLL
TX-DLL
Testing
Interface
RXRX-DLL
RXRX-
PLLTX/RX
Feedback
Biasingdata gen data genDigital Sliding
ControllerPower
Transistors
PRBS
PRBS</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>Wei Low-Power High-Speed Links 27
Multi-Phase Clock Generation
&#8226; Must minimize static offsets between phases
&#8226; Generate multiphase clocks locally at each pin, but 
watch out for power and area overhead
 TX
 TX
 TXStatic Offsets Jitter</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>Wei Low-Power High-Speed Links 31
Phase Detection
&#8226; Phase detector made of an identical set of 
receivers minimizes timing error
   RX
   PD
  Data  RXEdge Detection
/ Majority Voting5
5&#936;[4:0]
Early/Late
/None
Received DataRXPD
PD
RX
PD
RXPDRX
PD</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>Wei Low-Power High-Speed Links 18
Multiplexing = Low Power?
With M:1 multiplexing, fCLK= bit rate/M
&#8226; Power = M&#183;CV2&#183;f = M&#183;CV2 &#183;(BR/M) = C&#183;V2&#183;BR
&#8226; With fixed supply, power does not vary with M
But wait, at lower frequencies, I can lower voltage!
&#8226; With lower supply voltage (V &#8733;fCLK= BR/M), 
&#8226; Power decreases as &#8733;1/M2 !</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>Wei Low-Power High-Speed Links 21
DVS Links
&#8226; Dynamic Voltage Scaling (DVS) can reduce power consumption in 
two ways
1) Digital circuits operate at their most energy-efficient point in the 
presence of PVT variations by elim inating extra performance margins
0.5 V
0.8 V88%
00.20.40.60.811.2
1 1.5 2 2.5 3 3.5Normalized Frequency
Supply Voltage (V)0 50 130FV C Pswitched dynamic2
&#945;=</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>Wei Low-Power High-Speed Links 29
Dual-Loop Clock Generation (2)
&#8226; Global loop brings the local VCO frequency close 
to lock
&#8226; Narrow local tuning range (+/-15%) is sufficient to 
compensate for on-chip mismatches
&#8226; Narrow tuning range leads to low VCO gain
&#8211; Small loop capacitor area (2.5pF)
&#8211; Low sensitivity on Vctrl noise</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>Wei Low-Power High-Speed Links 22
Trade Performance for Energy Savings
2) DVS enables trade off between performance and energy
&#8226; Reducing frequency alone reduce s power but not energy per bit
00.20.40.60.81
0 0.2 0.4 0.6 0.8 1Normalized energy / bit
Normalized bit rate2VCE&#8901;&#8733;Fixed Vdd = 3.3V
Dynamically scaled VddEnergy Savings</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>Wei Low-Power High-Speed Links 2
Outline
&#8226; Motivation
&#8226; Brief Overview of High-Speed Links&#8226; Design Considerations for Low Power&#8226; DVS Link Design Example&#8226; Summary</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>Wei Low-Power High-Speed Links 14
Offset Calibration
&#8226; Two sets of offsets that can mani fest itself as voltage and timing 
uncertainty to close the eye and may require higher power to overcome 
them:
&#8211; Multi-phase clock generator timing offsets
&#8211; Receiver input voltage offsets
&#8226; Static offsets due to systematic (layout) and random (device) 
mismatches
&#8211; Calibration enables more timing and voltage margins (i.e., lower noise)ideal Tx timing
w/ offsets
sampling edgezero
Rx offset
non-zero
Rx offsetlower
marginshigher
margins</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>Wei Low-Power High-Speed Links 7
Channel Impairments and ISI
&#8226; One of the dominant causes of eye closure is inter-symbol 
interference (ISI) due to channel bandwidth limitations
&#8211; Two ways to view channel impairments
</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>Wei Low-Power High-Speed Links 10
&#8226; While a symbol time can be short, there is a limit to the maximum 
on-chip clock frequency
&#8211; Must distribute a clock driven by a buffer chain
&#8226; Overcome this limitation with parallelism
Clock Frequency Limit
CLKINCLKOUT</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>Wei Low-Power High-Speed Links 23
DVS Link Components
&#8226; DVS links require two additional components
&#8211; Mechanism to measure circuit critical path to appropriately adjust 
voltage with respect to frequency
&#8226; Use an on-chip performance monitor ci rcuit (inverter delay elements of 
core DLL)
&#8211; Efficient supply-voltage regulator (buck converter)
&#8226; Overall Block diagram (Wei et al, ISSCC2000)
Digital
ControllerVCTRL
RVddcore DLL
Buck Converter
I/O Transceiver
DTX
DRXFCLK</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Noise in Integer-N Frequency Synthesizers</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec16/</lecture_pdf_url>
      <lectureno>16</lectureno>
      <slides>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Charge Pump Noise Impact
&#131;Contribution of charge pump noise to overall output noise
-Need to determine impact of Icpon SIcpn(f)&#934;div[k]&#934;ref[k] KV
jfv(t) &#934;out(t)
H(f)
1
N/K32&#960;&#945; e(t)en(t) &#934;vn(t) &#921;cpn(t)
IcpVCO Noise
f0S&#921;cpn(f)Charge Pump
Noise
f0S&#934;vn(f)
-20 dB/dec
PFDCharge
PumpLoop
Filter
DividerVCOPFD-referred
Noise
</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
Parameterized PLL Noise Model
&#131;PFD-referred noise is lowpass filtered
&#131;VCO-referred noise is highpass filtered
&#131;Both filters have the same transition frequency values-Defined as fo&#934;vn(t) en(t)
&#934;out(t) &#934;c(t)&#934;n(t)&#934;nvco(t) &#934;npfd(t)fo1-G(f)foG(f)/K32&#960;N&#945;VCO-referred
Noise
f0SEn(f)PFD-referred
Noise
1/Tf0S&#934;vn(f)
-20 dB/dec
Divider Control
of Frequency Setting
(assume noiseless for now)</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Out-of-band emission requirements are function of 
the power of the signal in the desired channel-For offset channel 1 (as calc ulated on previous slide)
-Most stringent case is when Y0maximumCondition for Most Stringent Emission Requirement
ffRFRF Output
(dBm)Y0 dBm
Y0+X1 dBm
Y0+X2 dBm
ffRFMaximum
RF Output
Emission
(dBm)M0 dBm
M1 dBm
M2 dBm
M3 dBm
Channel Spacing
= W HzChannel Spacing
= W HzChannel
Spacing= W HzIntegrationBandwidth= R Hz
Y0+X3 dBmPiecewise Constant Approximation
of Transmitter Output Spectrum Emission Specification
</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>M.H. Perrott MIT OCW
Quantifying Tolerable In-Band Interference Levels
&#131;Digital radios quantify performa nce with bit error rate (BER)-Minimum BER often set at 1e-3 for many radio systems-There is a corresponding minimum SNR that must be achieved
&#131;Goal:  design so that SNR with interferers is above SNRminfRFf
SynthesizerLNATo 
IF Processing
StageBand Select
FilterChannel
FilterBand Select Filter Must
Pass All Channels
-73-58-39RF Input
(dBm)
fIF
fLOfChannel Filter
BandwidthIF Output
(dBm)
Synthesizer Noise
 and Mixer/LNA Distortion
Produce Inband Interference
Phase Noise
(dBc/Hz)
Spurious Noise
(dBc)
fSynthesizer
Spectrum
(dBc/Hz)Min SNR: 15-20 dB
0 dBc</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
Frequency Synthesizer Noise in Wireless Systems
&#131;Synthesizer noise has a negative impact on system-Receiver &#8211; lower sensitivity,  poorer blocking performance-Transmitter &#8211; increased spectral emissions (output spectrum 
must meet a mask requirement)
&#131;Noise is characterized in frequency domainZin
Zo LNA To FilterFrom Antenna
and Bandpass
FilterPC board
trace
Package
Interface
LO signalMixer
RF in IF out
Frequency
SynthesizerReference
FrequencyVCO
fPhase
Noise
fo</text>
        </slide>
        <slide>
          <slideno>43</slideno>
          <text>M.H. Perrott MIT OCW
Blocking Performance Analysis (Part 2)
&#131;Consider the impact of blockers surrounding the 
desired signal with a given phase noise profile-SNRminmust be maintained-Evaluate impact on SNR one blocker at a timeffLOSynthesizer
Spectrum
(dBc)
X0 dBc0 dBc
X1 dBc
X2 dBcRF
LOIFfRFfRF Input
(dBm)
Y1 dB
Y2 dB
fIFfChannel Filter
BandwidthIn-Channel
IF Output
(dBm)
Inband Interference
Produced by
Synth. Phase Noise= W Hz
Channel Spacing
Channel SpacingSNRmin:  15-20 dB</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Impact of PLL Parameters on Noise Scaling
&#131;PFD-referred noise is scaled by square of divide value 
and inverse of PFD gain-High divide values lead to la rge multiplication of this noise
&#131;VCO-referred noise is not scaled (only filtered)&#934;vn(t) en(t)
&#934;out(t) &#934;c(t)&#934;n(t)&#934;nvco(t) &#934;npfd(t)fo1-G(f)foG(f)/K32&#960;N&#945;VCO-referred
Noise
f0SEn(f)PFD-referred
Noise
1/Tf0S&#934;vn(f)
-20 dB/dec
Divider Control
of Frequency Setting
(assume noiseless for now)Sen(f)/K32&#960;N&#945;2Radians2/Hz
S&#934;vn(f)
f
0</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 16
Noise in Integer-N Frequency Synthesizers
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>45</slideno>
          <text>M.H. Perrott MIT OCW
Blocking Performance Analysis (Part 4)
ffLOSynthesizer
Spectrum
(dBc)
X0 dBc0 dBc
X1 dBc
X2 dBcRF
LOIFfRFfRF Input
(dBm)
Y1 dB
Y2 dB
fIFfChannel Filter
BandwidthIn-Channel
IF Output
(dBm)
Inband Interference
Produced by
Synth. Phase Noise= W Hz
Channel Spacing
Channel SpacingSNRmin:  15-20 dB
Y1 dB X1 = -SNRmin-Y1 dBc
X2 = -SNRmin-Y2 dBc Y2 dBChannel
OffsetRelative Blocking
PowerMaximum Synth. Noise
Power at Channel Offset
1
2
X3 = -SNRmin-Y3 dBc Y3 dB 30 dB X0 = -SNRmin dBc 0
X1 - dB(W) dBc/Hz
X2 - dB(W) dBc/HzMaximum Synth. Phase
Noise at Channel Offset
X3 - dB(W) dBc/HzX0 - dB(W) dBc/HzConvert power to
spectral density</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
Synthesizer Phase Noise Requirements for DECT
&#131;Using previous calculations with DECT values
&#131;Graphical display of phase noise mask-8 dBm X1 = -29.6 dBc
X2 = -51.6 dBc-92 dBc/Hz
-114 dBc/Hz24 dBm
 -30 dBm Channel
OffsetMask
PowerMaximum Synth. Noise
Power in Integration BWMaximum Synth. Phase Noise
 at Channel Offset
0
1.728 MHz
3.456 MHz
X3 = -65.6 dBc -128 dBc/Hz -44 dBm 5.184 MHzset by required transmit SNR
ffLOSynthesizer
Spectrum
(dBc)-92 dBc/Hz
-114 dBc/Hz
-128 dBc/Hz
Channel Spacing = 1.728 MHz</text>
        </slide>
        <slide>
          <slideno>46</slideno>
          <text>M.H. Perrott MIT OCW
Example &#8211; DECT Cordless Telephone Standard
&#131;Receiver blocking specifications-Channel spacing:  W = 1.728 MHz-Power of desired signal fo r blocking test:  -73 dBm-Minimum bit error rate (BER) with blockers:  1e-3
&#131;Sets the value of SNRmin
&#131;Perform receiver simulations to determine SNRmin
&#131;Assume SNRmin= 15 dB for calculations to follow-Strength of interferers for blocking test
</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Synthesizer Spurious Noise on Blockers
&#131;Spurious tones cause the blocker (Y dB) (and desired) 
signals to &#8220;leak&#8221; into other frequency bands-In-band interference occurs when spurious tone offset 
frequency is same as blocker offset frequency-Resulting SNR = -X-Y dB with spurious tone (X dBc)fRFf
ffoffsetRF Input
(dBm)
foffsetfIFf
fLOIF Output
(dBm)
Synthesizer
Spectrum
(dBc)
X dBc0 dBcY dB
SNR: -X-Y dBX dB
RF
LOIF
Spurious
Tone</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Charge Pump Current Value on Output Noise
&#131;Recall
&#131;Given previous slide, we can say
-Assumes a fixed current dens ity for the key transistors 
in the charge pump as Icpis varied
&#131;Therefore
-Want high charge pump current to achieve low noise-Limitation set by power and area considerations
</text>
        </slide>
        <slide>
          <slideno>48</slideno>
          <text>M.H. Perrott MIT OCW
Graphical Display of Required Phase Noise Performance
&#131;Mark phase noise requirements  at each offset frequency
&#131;Calculate critical specification for receive synthesizer-Critical specification is - 117 dBc/Hz at 5.184 MHz offset
&#131;Lower performance demanded of receiver synthesizer than 
transmitter synthesizer in DECT applications!ffLOSynthesizer
Spectrum
(dBc)
-92 dBc/Hz0 dBc
-111 dBc/Hz
-117 dBc/Hz
Channel Spacing = 1.728 MHzPhase Noise
Rolloff: -20 dB/dec
Critical
Spec.</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Resulting Output Noise with Optimal Bandwidth
&#131;PFD-referred noise dominates at low frequencies-Corresponds to close-in phase noise of synthesizer
&#131;VCO-referred noise dominates at high frequencies-Corresponds to far-away phase noise of synthesizer&#934;vn(t) en(t)
&#934;out(t) &#934;c(t)&#934;n(t)&#934;nvco(t) &#934;npfd(t)fo1-G(f)foG(f)/K32&#960;N&#945;VCO-referred
Noise
f0SEn(f)PFD-referred
Noise
1/Tf0S&#934;vn(f)
-20 dB/dec
Divider Control
of Frequency Setting
(assume noiseless for now)Sen(f)/K32&#960;N&#945;2Radians2/Hz
S&#934;vn(f)
f
(fo)opt0Radians2/HzS&#934;npfd(f)
S&#934;nvco(f)
f
(fo)opt0</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
Synthesizer Phase Noise Requirements
&#131;Impact of channel bandwidth (offset channel 1)
&#131;Overall requirements (most stringent, i.e., Y0= M0)f
fLOSynthesizer
Spectrum
(dBc)
X0 dBc0 dBc
X1 dBc
X2 dBcIF
LORFTo 
Antenna
Band Select
FilterPA
Channel Spacing
= W HzX3 dBc
X1 - dB(W)  dBc/Hz
X2 - dB(W)  dBc/HzChannel
OffsetMaximum Synth. Phase Noise
(Most Stringent)
1
2
X3 - dB(W)  dBc/Hz 3X1 = M1-M0 + dB(W/R) dB
X2 = M2-M0 + dB(W/R) dBEmission Requirements
(Most Stringent)
X3 = M3-M0 + dB(W/R) dB0 Y0 = M0 set by required transmit SNR
</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Remaining Portion of Transmitter
&#131;Power amplifier-Nonlinearity will increase ou t-of-band emission and create 
harmonic content
&#131;Band select filter-Removes harmonic content, but not out-of-band emissionSx(f)
f
Sout(f)
ffLOSy(f)
ffRF fIF
x(t) y(t)
out(t)
Synthesizerclose-in
phase noise
far-away
phase noisereduction
of SNR
out-of-band
emission
To 
AntennaBand Select
Filter
PA</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
A Simpler Parameterization for PLL Transfer Functions
&#131;Define G(f) as
-A(f) is the open loop transfer function of the PLL
&#934;div[k]&#934;ref[k] KV
jfv(t) &#934;out(t)
H(f)
1
N/K32&#960;&#945; e(t)&#934;vn(t) en(t)
IcpVCO-referred
Noise
f0SEn(f)PFD-referred
Noise
1/Tf0S&#934;vn(f)
-20 dB/dec
PFDCharge
PumpLoop
Filter
DividerVCO
Always has a gain
of one at DC</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Synthesizer Phase Noise (Isolated Channel)
&#131;Consider phase noise at a given offset frequency-Convolution with IF signal produces a smeared version 
of the desired signal at the given offset frequency
&#131;For simplicity, approximate smeared signal as shownf
fLOSynthesizer
Spectrum
(dBc)0 dBc
X2 dBcffRFRF Output
(dBm)M0 dBm
IF
LORFfIFfIF Input
(dBm)
To 
Antenna
Band Select
FilterPAM0+X2 dBm
foffset
foffset</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Transmitter Output Versus Emission Specification
&#131;Assume a piecewise constant spectral density profile 
for transmitter-Simplifies calculations
&#131;Issue: emission specification is measured over a narrower band than channel spacing
-Need to account for bandwidth discrepancy when doing 
calculationsffRFRF Output
(dBm)Y0 dBm
Y0+X1 dBm
Y0+X2 dBm
ffRFMaximum
RF Output
Emission
(dBm)M0 dBm
M1 dBm
M2 dBm
M3 dBm
Channel Spacing
= W HzChannel Spacing
= W HzChannel
Spacing= W HzIntegrationBandwidth= R Hz
Y0+X3 dBmPiecewise Constant Approximation
of Transmitter Output Spectrum Emission Specification</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Phase noise is non-periodic
-Described as a spectral densit y relative to carrier power
&#131;Spurious noise is periodic
-Described as tone power relative to carrier powerPhase Noise Versus Spurious Noise
S&#934;out(f)Sout(f)
f-fo fo1
dBc/Hz
Sout(f)
f-fo fodBc1fspur
21dspur
fspur2</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Synthesizer Noise on Transmitters
&#131;Synthesizer noise can be lumped into two categories-Close-in phase noise:  reduc es SNR of modulated signal-Far-away phase noise:  creates spectral emissions outside 
the desired transmit channel
&#131;This is the critical issue for transmittersSx(f)
f
Sout(f)
ffLOSy(f)
ffRF fIF
x(t) y(t)
out(t)
Synthesizerclose-in
phase noise
far-away
phase noisereduction
of SNR
out-of-band
emission</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Nonidealities on Blocking Performance
&#131;Blockers leak into desired band due to-Nonlinearity of LNA and mixer (IIP3)-Synthesizer phase and spurious noise
&#131;In-band interference cannot be removed by channel filter!fRFf
SynthesizerLNATo 
IF Processing
StageBand Select
FilterChannel
FilterBand Select Filter Must
Pass All Channels
-73-58-39RF Input
(dBm)
fIF
fLOfChannel Filter
BandwidthIF Output
(dBm)
Synthesizer Noise
 and Mixer/LNA Distortion
Produce Inband Interference
Phase Noise
(dBc/Hz)
Spurious Noise
(dBc)
fSynthesizer
Spectrum
(dBc/Hz)0 dBc</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
Why is Out-of-Band Emission A Problem?
&#131;Near-far problem-Interfering transmitter closer to receiver than desired 
transmitter-Out-of-emission requirements must be stringent to prevent complete corruption of desired signalTransmitter
        2   Base
 StationTransmitter        1
 Desired Channel
()
Interfering
  Channel( ) Relative   PowerDifference    (dB)
 Desired ChannelInterfering  Channel</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
Noise Modeling for Frequency Synthesizers
&#131;PLL has an impact on VCO noise in two ways-Adds extrinsic noise from various PLL circuits-Highpass filters VCO noise through PLL feedback dynamics
&#131;Focus on modeling the above based on phase deviations-Simpler than dealing directly  with PLL sine wave outputvin(t) vc(t)vn(t)PLL dynamics
set VCO
carrier frequency fPhase
Noise
foSout(f)
Extrinsic noise
(from PLL)
out(t)Intrinsic
noise
To PLL</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Specification of Out-of-Band Emissions
&#131;Maximum radiated power is specified in desired and 
adjacent channels-Desired channel power:  maximum is M0dBm-Out-of-band emission:  maximum power defined as 
integration of transmitted spectral density over bandwidth R centered at midpoint of each channel offsetffRFMaximum
RF Output
Emission
(dBm) M0 dBm
M1 dBm
M2 dBm
Channel Spacing
= W HzIntegration
Bandwidth= R Hz
M3 dBm</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
Example &#8211; DECT Cordless Telephone Standard
&#131;Standard for many cordless phones operating at 1.8 GHz
&#131;Transmitter Specifications-Channel spacing:  W = 1.728 MHz-Maximum output power:  Mo= 250 mW (24 dBm)-Integration bandwidth: R = 1 MHz-Emission mask requirements
</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
vin(t) vc(t)vn(t)PLL dynamics
set VCO
carrier frequency fPhase
Noise
foFrequency-domain view
Sout(f)
Extrinsic noise
(from PLL)
Intrinsic
noise
2&#960;Kv
s&#934;out&#934;vn(t)
2cos(2 &#960;fot+&#934;out(t))out(t)
To PLLPhase Deviation Model for Noise Analysis
&#131;Model the impact of noise on instantaneous phase-Relationship between PLL output and instantaneous phase
-Output spectrum (from Lecture 12)
Note:  Kvunits are Hz/V
</text>
        </slide>
        <slide>
          <slideno>47</slideno>
          <text>M.H. Perrott MIT OCW
Synthesizer Phase Noise Requirements for DECT
ffLOSynthesizer
Spectrum
(dBc)
X0 dBc0 dBc
X1 dBc
X2 dBcRF
LOIFfRFfRF Input
(dBm)
fIFfChannel Filter
BandwidthIn-Channel
IF Output
(dBm)
Inband Interference
Produced by
Synth. Phase NoiseW = 1.73 MHz
Channel Spacing
= 1.73 MHz
Channel Spacing
= 1.73 MHzSNRmin:  15 dB
Y1 = 15 dB X1 = -30 dBc
X2 = -49 dBc Y2 = 34 dBChannel
OffsetRelative Blocking
PowerMaximum Synth. Noise
Power at Channel Offset
1.728 MHz
3.456 MHz
X3 = -55 dBc Y3 = 40 dB 5.184 MHz0 dB X0 = -15 dBc 0
-92 dBc/Hz
-111 dBc/HzMaximum Synth. Phase
Noise at Channel Offset
-117 dBc/Hz-77 dBc/Hz-73 dBm-58 dBm-39 dBm-33 dBm
X3 dBc</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
Simplified Noise Model
&#131;Refer all PLL noise sources (other than the VCO) to 
the PFD output-PFD-referred noise corresponds to the sum of these 
noise sources referred to the PFD output&#934;div[k]&#934;ref[k] KV
jfv(t) &#934;out(t)
H(f)
1
N/K32&#960;&#945; e(t)&#934;vn(t) en(t)
IcpVCO-referred
Noise
f0SEn(f)PFD-referred
Noise
1/Tf0S&#934;vn(f)
-20 dB/dec
PFDCharge
PumpLoop
Filter
DividerVCO</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Synthesizer on Blockers
&#131;Synthesizer passes desired signal and blocker-Assume blocker is Y dB high er in signal power than 
desired signalfRFf
ffoffsetRF Input
(dBm)
fIFf
fLOIF Output
(dBm)
Synthesizer
Spectrum
(dBc) 0 dBcY dB
RF
LOIF</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Impact of PFD-referred Noise on Synthesizer Output
&#131;Transfer function derived using Black&#8217;s formula&#934;div[k]&#934;ref[k] KV
jfv(t) &#934;out(t)
H(f)
1
N/K32&#960;&#945; e(t)&#934;vn(t) en(t)
IcpVCO-referred
Noise
f0SEn(f)PFD-referred
Noise
1/Tf0S&#934;vn(f)
-20 dB/dec
PFDCharge
PumpLoop
Filter
DividerVCO
</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Table of Most Stringent Emission Requirements
ffRFRF Output
(dBm)Y0 dBm
Y0+X1 dBm
Y0+X2 dBm
ffRFMaximum
RF Output
Emission
(dBm)M0 dBm
M1 dBm
M2 dBm
M3 dBm
Channel Spacing
= W HzChannel Spacing
= W HzChannel
Spacing= W HzIntegrationBandwidth= R Hz
Y0+X3 dBmPiecewise Constant Approximation
of Transmitter Output Spectrum Emission Specification
M1 dBm X1 = M1-M0 + dB(W/R) dB
X2 = M2-M0 + dB(W/R) dBY0 = M0 (for most stringent case) M0 dBm
M2 dBmChannel
OffsetMask
PowerEmission Requirements
(Most Stringent)
0
12
X3 = M3-M0 + dB(W/R) dB M3 dBm 3
</text>
        </slide>
        <slide>
          <slideno>44</slideno>
          <text>M.H. Perrott MIT OCW
Blocking Performance Analysis (Part 3)
ffLOSynthesizer
Spectrum
(dBc)
X0 dBc0 dBc
X1 dBc
X2 dBcRF
LOIFfRFfRF Input
(dBm)
Y1 dB
Y2 dB
fIFfChannel Filter
BandwidthIn-Channel
IF Output
(dBm)
Inband Interference
Produced by
Synth. Phase Noise= W Hz
Channel Spacing
Channel SpacingSNRmin:  15-20 dB
Y1 dB X1 = -SNRmin-Y1 dBc
X2 = -SNRmin-Y2 dBc Y2 dBChannel
OffsetRelative Blocking
PowerMaximum Synth. Noise
Power at Channel Offset
1
2
X3 = -SNRmin-Y3 dBc Y3 dB 30 dB X0 = -SNRmin dBc 0Derive using 
the relationship
SNR = -X-Y dB &gt;= SNRmin</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Transmitted Power in a Given Channel
&#131;For simplicity, assume that the spectral density is flat 
over the channel bandwidth-Actual spectral density of signal often varies with 
frequency over the bandwi dth of a given channel
&#131;Resulting power calculation (single-sided Sx(f))
&#131;Express in dB ( Note: dB(x) = 10log(x) )R Hz R Hz
fmidSx(fmid)Sx(fmid)
fmid
</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
Receiver Blocking Performance
&#131;Radio receivers must operate in the presence of large 
interferers (called blockers)
&#131;Channel filter plays critical role in removing blockers 
&#131;Passes desired signal channel, rejects interferersfRFf
SynthesizerLNATo 
IF Processing
StageBand Select
FilterChannel
FilterBand Select Filter Must
Pass All Channels
-73-58-39RF Input
(dBm)
fIF
fLOfChannel Filter
BandwidthIF Output
(dBm)
fSynthesizer
Spectrum
(dBc/Hz)0 dBc</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
Modeling the Impact of Noise on Output Phase of PLL
&#131;Determine impact on output phase by deriving 
transfer function from each noise source to PLL 
output phase-There are a lot of transfer  functions to keep track of!&#934;div[k]&#934;ref[k] KV
jfv(t) &#934;out(t)
H(f)
1
N/K32&#960;&#945; e(t)espur(t) &#934;jit[k] &#934;vn(t) &#921;cpn(t)
IcpVCO Noise
f0S&#934;jit(f)
f0S&#921;cpn(f)
f0SEspur(f)Divider/Reference
JitterReference
FeedthroughCharge Pump
Noise
1/Tf0S&#934;vn(f)
-20 dB/dec
PFDCharge
PumpLoop
Filter
DividerVCO</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Transistor Current Value on its Noise
&#131;Charge pump noise will be re lated to the current it 
creates as
&#131;Recall that gdois the channel resistance at zero Vds-At a fixed current density , we have
M2 M1Ibias
current
sourcecurrent 
biasId
idbias2id2
CbigW
L
</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Synthesizer Noise on Transmitter Output
&#131;Consider a spurious tone at a given offset frequency-Convolution with IF signal produces a replica of the 
desired signal at the given offset frequencyf
fLOSynthesizer
Spectrum
(dBc)0 dBc
X2 dBcffRFRF Output
(dBm)M0 dBm
IF
LORFfIFfIF Input
(dBm)
To 
Antenna
Band Select
FilterPAM0+X2 dBm
foffset
foffset</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
Sources of Noise in Frequency Synthesizers
&#131;Extrinsic noise sources to VCO-Reference/divider jitter and reference feedthrough-Charge pump noisePFDCharge
Pumpe(t) v(t)
NLoop
Filter
DividerVCOref(t)
div(t)fCharge Pump
NoiseVCO Noise
f-20 dB/dec
1/TfReference
Jitter
fReference
Feedthrough
T
fDivider
Jitter</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Synthesizer Phase Noise (All Channels)
&#131;Partition synthesizer phase noise into channels-Required phase noise power (dBc) in each channel is 
related directly to spectral mask requirements
&#131;Exception is X0&#8211; set by transmit SNR requirementsf
fLOSynthesizer
Spectrum
(dBc)
X0 dBc0 dBc
X1 dBc
X2 dBcffRFRF Output
(dBm)M0 dBm
M0+X1 dBm
IF
LORFfIFfIF Input
(dBm)
To 
Antenna
Band Select
FilterPAChannel Spacing
= W Hz
Channel Spacing
= W HzX3 dBcM0+X3 dBmM0+X2 dBm</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Synthesizer Phase Noise on Blockers
&#131;Same impact as spurious tone, but blocker signal is 
&#8220;smeared&#8221; by convolution with phase noise-For simplicity, ignore &#8220;smearing&#8221; and approximate as 
shown abovefRFf
ffoffsetRF Input
(dBm)
foffsetfIFf
fLOIF Output
(dBm)
Synthesizer
Spectrum
(dBc)
X dBc0 dBcY dB
SNR: -X-Y dBX dB
RF
LOIF</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
Parameterize Noise Transfer Functions in Terms of G(f)
&#131;PFD-referred noise
&#131;VCO-referred noise
</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
Correction Factor for Bandwidth Mismatch
&#131;Calculation of maximum emission in offset channel 1ffRFRF Output
(dBm)Y0 dBm
Y0+X1 dBm
Y0+X2 dBm
ffRFMaximum
RF Output
Emission
(dBm)M0 dBm
M1 dBm
M2 dBm
M3 dBm
Channel Spacing
= W HzChannel Spacing
= W HzChannel
Spacing= W HzIntegrationBandwidth= R Hz
Y0+X3 dBmPiecewise Constant Approximation
of Transmitter Output Spectrum Emission Specification
</text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>M.H. Perrott MIT OCW
Blocking Performance Analysis (Part 1)
&#131;Ignore all out-of-band energy at the IF output-Assume that channel filter removes it-Motivation:  simplifies analysisfRFf
ffoffsetRF Input
(dBm)
foffsetfIFf
fLOSynthesizer
Spectrum
(dBc)
X dBc0 dBcY dB
SNR: -X-Y dB
RF
LOIFIn-Channel
IF Output
(dBm)</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
Analysis of Charge Pump Noise Impact 
&#131;We can refer charge pump noise to PFD output by 
simply scaling it by 1/Icp&#934;div[k]&#934;ref[k] KV
jfv(t) &#934;out(t)
H(f)
1
N/K32&#960;&#945; e(t)en(t) &#934;vn(t) &#921;cpn(t)
IcpVCO Noise
f0S&#921;cpn(f)Charge Pump
Noise
f0S&#934;vn(f)
-20 dB/dec
PFDCharge
PumpLoop
Filter
DividerVCOPFD-referred
Noise
</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Optimal Bandwidth Setting for Minimum Noise
&#131;Optimal bandwidth is where scaled noise sources meet-Higher bandwidth will pass more PFD-referred noise-Lower bandwidth will pass more VCO-referred noise&#934;vn(t) en(t)
&#934;out(t) &#934;c(t)&#934;n(t)&#934;nvco(t) &#934;npfd(t)fo1-G(f)foG(f)/K32&#960;N&#945;VCO-referred
Noise
f0SEn(f)PFD-referred
Noise
1/Tf0S&#934;vn(f)
-20 dB/dec
Divider Control
of Frequency Setting
(assume noiseless for now)Sen(f)/K32&#960;N&#945;2Radians2/Hz
S&#934;vn(f)
f
(fo)opt0</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Impact of VCO-referred Noise on Synthesizer Output 
&#131;Transfer function again derived from Black&#8217;s formula
&#934;div[k]&#934;ref[k] KV
jfv(t) &#934;out(t)
H(f)
1
N/K32&#960;&#945; e(t)&#934;vn(t) en(t)
IcpVCO-referred
Noise
f0SEn(f)PFD-referred
Noise
1/Tf0S&#934;vn(f)
-20 dB/dec
PFDCharge
PumpLoop
Filter
DividerVCO</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
Critical Specification for Phase Noise
&#131;Critical specification is defi ned to be the one that is 
hardest to meet with an assumed phase noise rolloff-Assume synthesizer phase noise rolls off at -20 
dB/decade
&#131;Corresponds to VCO phase noise characteristic
&#131;For DECT transmitter synthesizer-Critical specification is - 128 dBc/Hz at 5.184 MHz offset
ffLOSynthesizer
Spectrum
(dBc)-92 dBc/Hz0 dBc
-114 dBc/Hz
-128 dBc/Hz
Channel Spacing = 1.728 MHzPhase Noise
Rolloff: -20 dB/dec
Critical
Spec.</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Generalized Reflection Coefficient, Smith Chart, Passives</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec4/</lecture_pdf_url>
      <lectureno>4</lectureno>
      <slides>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
Transmission Line Version:  Z(&#955;0 /4) with Shorted Load
&#131;As previously calculated
&#131;Impedance calculation
&#131;Relate &#955;to frequency
x
zyZL
0 Lz&#955;0/4
Z(&#955;0/4)</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
Now Look At  Z(&#8710;)  (Impedance Close to Load)
&#131;Impedance formula ( &#8710;very small)
-A useful approximation:
-Recall from Lecture 2:
&#131;Overall approximation:
</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
Polysilicon Resistors
&#131;Use unsilicided polysilicon to create resistor
&#131;Key parameters-Resistance (usually 100- 200 Ohms per square)-Parasitic capacitance (usually small)
&#131;Appropriate for high speed amplifiers-Linearity (quite linear compared to other options)-Accuracy (usually can be set within &#177;15%)ARpoly
B
BA</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
Example:  Z(&#955;/4) with Shorted Load
&#131;Calculate reflection coefficient
&#131;Calculate generalized reflection coefficient
&#131;Calculate impedance
x
zyZL
0 Lz&#955;/4
Z(&#955;/4)</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Example:  Look At  Z(&#8710;)  With Load Open
&#131;Reflection coefficient:
&#131;Resulting impedance looks capacitive!
x
zyZL
0&#8710;zZ(&#8710;)</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Resistance and Conducta nce on the Smith Chart
0.2 0.5 1 2 5Im{&#915;L}
Re{&#915;L}&#915;L=0 &#915;L=1 &#915;L=-1&#915;L=j
&#915;L=-jYn=2Yn=0.5 Zn=0.5
Zn=2</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>M.H. Perrott MIT OCW
High Q Capacitors (Signal Path)
&#131;Lateral metal capacitors offer high Q and reasonably 
large capacitance per unit area-Stack many levels of metal on top of each other (best 
layers are the top ones), via them at maximum density
-Accuracy often better than  &#177;10%-Parasitic side cap is symmetric , less than 10% of cap value
&#131;Example:  CT= 1.5 fF/ &#181;m2for 0.24&#181;m process with 7 
metals, Lmin= Wmin= 0.24&#181;m, tmetal= 0.53&#181;m-See &#8220;Capacity Limits and  Matc hing Properties of Integrated 
Capacitors&#8221;, Aparicio et. al., JSSC, Mar 2002BA
C1A
B</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>M.H. Perrott MIT OCW
Spiral Inductors
&#131;Create integrated inductor using spiral shape on top level 
metals (may also want a patterned ground shield)
-Key parameters are Q (&lt; 10), L (1 -10 nH), self resonant freq.-Usually implemented in top metal layers to minimize series 
resistance, coupling to substrate-Design using Mohan et. al, &#8220;Simple, Accurate Expressions for Planar Spiral Inductances, JSSC, Oct, 1999, pp 1419-1424
-Verify inductor parameters (L, Q, etc.) using ASITIC
http://formosa.eecs.berkeley.edu/~niknejad/asitic.htmlLmA
BBA</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
A Geometric View of  |1 + &#915;(z)|
|&#915;L|
Re{1+&#915;(z)}Im{1+&#915;(z)}
&#915;(z)
1 0|1+&#915;(z)|
</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Smith Chart
&#131;Define normalized impedance
&#131;Mapping from normalized impedance to &#915;
is one-to-one
-Consider working in coordinate system based on &#915;
&#131;Key relationship between Znand &#915;
-Equate real and imaginary parts to get Smith Chart
</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Reactance and Susceptance on the Smith Chart
 j0.2
-j0.20 j0.5
-j0.50 j1
-j10 j2
-j20 j5
-j50Im{&#915;L}
Re{&#915;L}&#915;L=0 &#915;L=1 &#915;L=-1&#915;L=j
&#915;L=-jYn=-j2
Yn=j2Zn=j2
Zn=-j2</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
Real Impedance in &#915;Coordinates (Equate Real Parts)
0.2 0.5 1 2 5&#915;L=0Im{&#915;L}
Re{&#915;L}&#915;L=1 &#915;L=-1&#915;L=j
&#915;L=-jZn=0.5
</text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>M.H. Perrott MIT OCW
Integrated Transformers
&#131;Utilize magnetic coupling between adjoining wires
&#131;Key parameters-L (self inductance for primary and secondary windings)-k (coupling coefficient between primary and secondary)
&#131;Design &#8211; ASITIC, other CAD packagesABL2B
L1A
Cpar1
k CD
CDCpar2
</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Inductor Value Calculation Using Smith Chart
&#131;From Smith chart, we found that the desired 
normalized inductor reactance is
&#131;Required inductor value is therefore
</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
Example &#8211; Match RC Network to 50 Ohms at 2.5 GHz
&#131;Circuit
&#131;Step 1:  Calculate ZLn
&#131;Step 2:  Plot ZLnon Smith Chart (use admittance, YLn)Zin Rp=200 Cp=1pFMatching
NetworkZL
</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>Passives</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
A Closer Look at &#915;(z)
&#131;Recall &#915;Lis
&#131;We can view &#915;(z) 
as a complex 
number that 
rotates clockwise 
as z (distance 
from the load) 
increases
Note:|&#915;L|
|&#915;L| Re{&#915;(z)}Im{&#915;(z)}
&#915;L&#8710; = 2kz
&#915;L
&#915;(z)
0
</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Consider an Ideal LC Tank Circuit
&#131;Calculate input impedance about resonanceL C Zin
= 0 negligible
</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>M.H. Perrott MIT OCW
MOS Resistors
&#131;Bias a MOS device in its triode region
&#131;High resistance values can be achieved in a small 
area (MegaOhms within tens of square microns)
&#131;Resistance is quite nonlinear-Appropriate for small swing circuits
AW/LRds
B AB</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Calculate Z(&#8710;f) &#8211; Step 1
&#131;Wavelength as a function of &#8710;f
&#131;Generalized reflection coefficientx
zyZL
0 Lz&#955;0/4
Z(&#955;0/4)
</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
Capacitor Value Calculation Using Smith Chart
&#131;From Smith chart, we found that the desired 
normalized capacitor susceptance is
&#131;Required capacitor value is therefore
</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
Reflections Cause Amplitude to Vary Across Line
&#131;Equation:
&#131;Graphical representation:
direction
of travel
ztV+ejwtejkz
z|1 + &#915;(z)|
max|1+&#915;(z)|&#955;
0min|1+&#915;(z)||1+&#915;(0)|
</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Reflections Influence Impedance Across The Line 
&#131;From Slide 4
-Note: not a function of time! (only of distance from load)
&#131;Alternatively
-From Lecture 2:
</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 4
Generalized Reflection Coefficient, Smith Chart, 
Integrated Passive Components
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
Determine Voltage and Current At Different Positions 
&#131;Incident and reflected waves must be added togetherx
zEx
Hy yZL
Ex HyZLIncident Wave
Reflected Wave
0 LzV+ejwtejkz
I+ejwtejkz
V-ejwtejkz
I-ejwtejkz</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
Generalize Relationship Between Z(&#955;/4) and Z(0)
&#131;General formulation
&#131;At load (z=0)
&#131;At quarter wavelength away (z = &#955;/4)
-Impedance is inverted!
&#131;Shorts turn into opens
&#131;Capacitors turn into inductors
</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
Overall Smith Chart
0.2 0.5 1 2 5 j0.2
&#8722;j0.20 j0.5
&#8722;j0.50 j1
&#8722;j10 j2
&#8722;j20 j5
&#8722;j50</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
Just For Fun
&#131;Play the &#8220;matching game&#8221; at
-Allows you to graphically tune several matching 
networks-Note: game is set up to matc h source to load impedance 
rather than match the load to the source impedance
&#131;Same results, just different viewpointhttp://contact.tm.agilent.com/Agilent/tmo/an-95-1/classes/imatch.html</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Plot Starting Impedance (A dmittance) on Smith Chart
0.2 0.5 1 2 5 j0.2
-j0.20 j0.5
-j0.50 j1
-j10 j2
-j20 j5
-j50
YLn=0.25+j0.7854
(Note: Z Ln=0.37-j1.16)</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
Add Reactance of Inductor Lm
0.2 0.5 1 2 5 j0.2
-j0.20 j0.5
-j0.50 j1
-j10 j2
-j20 j5
-j50
ZLn=0.37-j1.16Z2n=0.37+j0.48
normalized
inductor
reactance
= j1.64</text>
        </slide>
        <slide>
          <slideno>43</slideno>
          <text>M.H. Perrott MIT OCW
High Speed Transformer Example &#8211; A T-Coil Network
&#131;A T-coil consists of a center-tapped inductor with 
mutual coupling between each inductor half
&#131;Used for bandwidth enhancement-See S. Galal, B. Ravazi, &#8220;10 Gb/s Limiting Amplifier and 
Laser/Modulator Driver in 0. 18u CMOS&#8221;, ISSCC 2003, pp 
188-189 and &#8220;Broadband ESD Protection &#8230;&#8221;, pp. 182-183 ABXL2B
L1
ACB X
k</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>M.H. Perrott MIT OCW
Bondwire Inductors
&#131;Used to bond from the package to die-Can be used to advantage
&#131;Key parameters-Inductance ( &#8776;1 nH/mm &#8211; usually achieve 1-5 nH)-Q (much higher than spiral inductors &#8211; typically &gt; 40)CpinLbondwire
Cbonding_paddieAdjoining pinspackage
To chip circuits From board</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
Calculate |Vmax| and |Vmin| Across The Transmission Line
&#131;We found that
&#131;So that the max and min of V(z,t) are calculated as
&#131;We can calculate this geometrically!
</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
Define Generalized Reflection Coefficient 
Similarly:
</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Develop Matching &#8220;Game Plan&#8221; Based on Smith Chart
&#131;By inspection, we see that the following matching 
network can bring us to Zin= 50 Ohms (center of 
Smith chart)
&#131;Use the Smith chart to come up with component values
-Inductance Lmshifts impedance up along reactance 
curve-Capacitance Cmshifts impedance down along 
susceptance curveZin Rp=200 Cp=1pF ZLLm
CmMatching Network</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Voltage Standing Wave Ratio (VSWR)
&#131;Definition
&#131;For passive load (and line)
&#131;We can infer the magnitude of the reflection 
coefficient based on VSWR
</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
What Happens When We Invert the Impedance?
&#131;Fundamental formulas
&#131;Impact of inverting the impedance
-Derivation:
&#131;We can invert complex impedances in &#915;plane by 
simply changing the sign of &#915;!
&#131;How can we best exploit this?
</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
The Smith Chart as a Calculator for Matching Networks
&#131;Consider constructing both impedance and 
admittance curves on Smith chart
-Conductance curves derived from resistance curves-Susceptance curves derived from reactance curves
&#131;For series circuits, work with impedance-Impedances add for series circuits
&#131;For parallel circuits, work with admittance-Admittances add for parallel circuits
</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
Calculate Z(&#8710;f) &#8211; Step 2
&#131;Impedance calculation
&#131;Recallx
zyZL
0 Lz&#955;0/4
Z(&#955;0/4)
-Looks like LC tank circuit about frequency wo!</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
Imag. Impedance in &#915;Coordinates (Equate Imag. Parts)
j0.2
-j0.20j0.5
-j0.50j1
-j10j2
-j20j5
-j50Im{&#915;L}
Re{&#915;L}&#915;L=0 &#915;L=1 &#915;L=-1&#915;L=j
&#915;L=-jZn=j0.5
Zn=-j0.5</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>M.H. Perrott MIT OCW
High Density Capacitors (Biasing, Decoupling)
&#131;MOS devices offer the highest capacitance per unit area-Limited to a one terminal device-Voltage must be high enough  to invert the channel
&#131;Key parameters-Capacitance value
&#131;Raw cap value from MOS device is 6.1 fF/ &#181;m2for 0.24u 
CMOS-Q (i.e., amount of series resistance)
&#131;Maximized with minimum L (tradeoff with area efficiency)
&#131;See pages 39-40 of Tom Lee&#8217;s book A
W/LA
C1=CoxWL </text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
Determine Voltage and Current At Different Positions 
x
zEx
Hy yZL
Ex HyZLIncident Wave
Reflected Wave
0 LzV+ejwtejkz
I+ejwtejkz
V-ejwtejkz
I-ejwtejkz</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Example:  Look At  Z(&#8710;)  With Load Shorted
&#131;Reflection coefficient:
&#131;Resulting impedance looks inductive!
x
zyZL
0&#8710;zZ(&#8710;)</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
Add Susceptance of Capacitor Cm(Achieves Match!)
0.2 0.5 1 2 5 j0.2
-j0.20 j0.5
-j0.50 j1
-j10 j2
-j20 j5
-j50
ZLn=0.37-j1.16Z2n=0.37+j0.48
1.0+j0.0normalized
capacitor
susceptance
= j1.31(note: Y 2n=1.00-j1.31)</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Overview of Course</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec1/</lecture_pdf_url>
      <lectureno>1</lectureno>
      <slides>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
Future Goals
&#131;Low cost, low power, and small area solutions-New architectures and circuits!
&#131;Increased spectral efficiency-Example:  GSM cellphones (GMSK) to 8-PSK (Edge)
&#131;Requires a linear power amplifier!
&#131;Increased data rates-Example:  802.11b (11 Mb/ s) to 802.11a (&gt; 50 Mb/s)
&#131;GFSK modulation changes to OFDM modulation
&#131;Higher carrier frequencies-802.11b (2.5 GHz) to 802.11a (5 GHz) to ? (60 GHz)
&#131;New modulation formats-GMSK, CDMA, OFDM, pulse position modulation
&#131;New application areas</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Project 1 - High Speed Frequency Dividers
&#131;High speed 
latches/registers&#131;High speed dual-modulus 
divider
Load
Load
IN INOUT OUT
&#934; &#934;22/3
Core
Control
QualifierCONIN OUT2AB2/3
IN
A
B
OUT
CON*8 + CON Cycles
CON*
CON</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
The Catch
&#131;Equalization enhances noise-Overall SNR may be reduced
&#131;Optimal approach is to make ISI and noise 
degradation about equal
Transmitter
DriverReceiver
DetectorChannelTransmitter Receiver
EqualizationNoise</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
A Custom C++ Simulator Will Be Used - CppSim
&#131;Blocks are implemented with C/C++ code-High computation speed-Complex block descriptions
&#131;Users enter designs in graphical form using Cadence 
schematic capture-System analysis and transi stor level analysis in the 
same CAD framework
&#131;Resulting signals are viewed in Matlab-Powerful post-processing and viewing capability
&#131;Note:  Hspice used for circuit level simulations
CppSim is on Athena and freely downloadable at
http://www-mtl.mit.edu/~perrott</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Multi-Level Signaling
&#131;Increase spectral efficiency by sending more than one 
bit during a symbol interval-Example:  4-Level PAM at 12.5 Gb/s on same channel
&#131;Effective data rate:  25 Gb/s
0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6
x 10&#8722;10&#8722;0.2&#8722;0.100.10.20.30.40.5
Time (seconds)outEye Diagram</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
What are the Issues with Wireless Systems?
&#131;Noise-Need to extract the radio signal with sufficient SNR
&#131;Selectivity (filtering, processing gain)-Need to remove interferers (which are often much larger!)
&#131;Nonlinearity-Degrades transmit spectral mask-Degrades selectivity for receiver
&#131;Multi-path (channel response)-Degrades signal &#8211; nulls rather than ISI usually the issue-Can actually be used to advantage!
We will look at BOTH broadband data links and 
wireless systems in this class</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>Basics of Digital Communication</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
The Goal &#8211; Design at Circuit/System Level
1.Design architecture with analytical models
&#131;May require new circuits &#8211; guess what they look like
2.Verify architectural ideas by simulating with ideal 
macro-models of circuit blocks
&#131;Guess macro-models for new circuits 
3.Add known non-idealities of circuit blocks (nonlinearity, noise, offsets, etc.) 
&#131;Go back to 1.if the architecture breaks!
4.Design circuit blocks and get better macro-models
&#131;Go back to 1.if you can&#8217;t build the circuit!
&#131;Go back to 1.if the architecture breaks!
5.Verify as much of system as possible with SPICE
6.Layout, extract, verify
&#131;Do this soon for high speed systems - iteration likely!</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
What is the Impact of the Bondwire Inductance?
&#131;Rule of thumb:  1 nH/mm for bondwire-Assume 1 nH
&#131;Impact of inductance here increases bandwidth-less ISI occurs
0 1 2
x 10&#8722;10&#8722;0.100.10.20.30.40.50.6
Time (seconds)outEye Diagram</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 1
Overview of Course
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Relationship of Eye to Sampling Time and Slice Level
0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2
x 1090.0500.050.10.150.20.250.30.350.4
Time (seconds)outEye Diagram
Slice
LevelSampling
Instant&#131;Horizontal portion of eye indicates sensitivity to timing 
jitter
&#131;Vertical portion of eye indica tes sensitivity to additional 
noise and ISI</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
High Speed Data Links
&#131;A common architecture
DEMUX
Digital
Processing
Block
Receive ICAmp
Clock
and Data
Recovery
Clock
Distribution10 Gb/s
Data Link
MUX DriverDigital
Processing
Block
Transmit ICClock Generation
&#131;Transmitter Issues-Intersymbol interference (limited bandwidth of IC 
amplifiers, packaging), clock jitter, power, area
&#131;Receiver Issue-Intersymbol interference (same as above), jitter from clock and data recovery, power, area</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
Modulation Format
&#131;Binary, Non-Return to Zero (NRZ), Pulse Amplitude 
Modulation (PAM)-Send either a zero or one in a given time interval Td-Time interval set by a low jitter clock-Ideal signal from transmitter:
0 0.5 1 1.5 2 2.5
x 10&#8722;8&#8722;0.0500.050.10.150.20.250.30.350.4in
TIME</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
HW6 &#8211; Phase Locked Loop Design
&#131;Integer-N synthesizer
&#131;Phase noise simulationPFDLoop
Filterref(t) out(t)
DividerT
Te(t) vin(t)
div(t)VCO
N[k] = N nomIcp
out(t) = cos (2&#960;  (fo+Kvvin(&#964;))d&#964;)vin out
ts
1 + s/(2 &#960;fp)
vph2S&#934;out(f)
foffset0-20 dBc/Hz/dec
vspur = Asin(2 &#960;fst)K2 dBc 
K1 dBc/Hz 
fpfs</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
This Class
&#131;Circuit AND system focus-Knowing circuit design is not enough-Knowing system theory is not enough
&#131;Circuit stuff-RF issues: transmission lin es and impedance transformers-High speed design techniques-Basic building blocks: amplifie rs, mixers, VCO&#8217;s, digital 
components-Nonidealities:  noise and nonlinearity
&#131;System stuff-Macromodeling and simulation-Wireless and high speed data link principles-System level blocks:  PLL&#8217;s, CDR&#8217;s, transceivers</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
Wireless Systems
&#131;Direct conversion architecture
sin(wot)
90oD/A
D/ADigital
Processing
BlockDigital
Processing
Blocksin(wot)
90oA/D
A/D
Transmit IC Receive ICLNA
Power
Amp
&#131;Transmitter issues-Meeting the spectral mask (LO phase noise &amp; feedthrough, 
quadrature accuracy), D/A accur acy, power amp linearity
&#131;Receiver Issues-Meeting SNR (Noise figure, blocking performance, channel selectivity, LO phase noise, A/D nonlinearity and noise), 
selectivity (filtering), and emission requirements</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
Alternative &#8211; Pre-emphasize at Transmitter
&#131;Put inverse filter at transmitter instead of receiver-No enhancement of noise, but &#8230;-Need feedback from receiver to learn channel-Requires higher dynamic range/power from transmitter
Transmitter
DriverReceiver
DetectorChannelTrransmitter Receiver
NoiseCompensation
(Pre-emphasis)</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
HW1 &#8211; Transmission Lines and Transformers
&#131;High speed data link application:
VoutC1 RLL1Delay = x
Characteristic Impedance = Ro
Ideal Transmission LineRo
VinTwo-Port Model
C2Ei1
Er1Ei2
Er2dieAdjoining pinsConnector
Controlled Impedance
PCB tracepackage
On-ChipDriving
SourceHigh Speed Trace (RF Connector to Chip Die)</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
HW2 &#8211; High Speed Amplifiers
M4M1 M2
M3IbiasVin+R1
Vin-R2
Vo+
Vo-
50 &#8486;
VinM1M2
LsLd
Lg
CbigIbias = 1mA
M3Vout
CL=1pF5 k&#8486;
Zinx&#131;Broadband
&#131;Narrowband</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Equalization
&#131;Undo channel frequency response with an inverse 
filter at the receiver-Removes ISI!-Can make it adaptive to learn channel
Transmitter
DriverReceiver
DetectorChannelTransmitter Receiver
Equalization</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Project 2 &#8211; GMSK Transmitter for Wireless Apps
Kv = 30 MHz/V
fo = 900 MHz
Gaussian
LPFData
GeneratorDigital I/Q Generationout(t)
T
T
tTd
tTLoop FilterReference
Frequency
vin(t)
PFD
NRF Transmit
Spectrum
0ffRFTrans.
NoisePower
Amp
Kph
1 - z-1cos( &#934;)
sin(&#934;)D/A
D/A&#934; finst90o
IQ
Peak-to-Peak
Frequency
Deviation
TdtInstantaneous
FrequencyData EyeLimit
Amp(100 MHz)
=1
1 MHzIncludes
Zero-Order
HoldIcp H(s)</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
Future Goals
&#131;Low cost, low power, small area solutions-New architectures and circuits!
&#131;Increased data rates-40 Gb/s for optical (moving to 120 Gb/s!)
&#131;Electronics is a limitation (optical issues getting significant)-&gt; 5 Gb/s for backplane applications
&#131;The channel (i.e., the PC board trace) is the limitation
&#131;High frequency compensation/equalization-Higher data rates, lower bit error rates (BER), improved 
robustness in the face of varying conditions-How do you do this at GHz speeds?
&#131;Multi-level modulation-Better spectral efficiency (more bits in given bandwidth)</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
Project 2 &#8211; Accompanying Receiver
0f
ffRFfRFReceived
SpectrumReceiver
Noise
fBaseband
Spectrum
cos(2 &#960;fRFt)IR
QRNR
Receiver
NoiseModulation
Signal
Transmitter
NoiseS(IR+jQR)
Trans.
Noise LNABand
Select
FilterChannel
Select
Filter
sin(2 &#960;fRFt)</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
Best Overall Performance
&#131;Combine compensation and equalization-Starting to see this for high speed links
Transmitter
DriverReceiver
DetectorChannelTrransmitter Receiver
EqualizationNoiseCompensation
(Pre-emphasis)</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
Key System Level Simulation Needs
&#131;You need a fast simulator-To design new things well, you must be able to iterate-The faster the simulation, the faster you can iterate
&#131;You need to be able to add non-idealities in a 
controlled manner-Fundamental issues with architectures need to be 
separated from implementation issues
&#131;An architecture that is f undamentally flawed should be 
quickly abandoned
&#131;You need flexibility-Capable of implementing circ uit blocks such as filters, 
VCO&#8217;s, etc.-Capable of implementing algorithms-Arbitrary level of detail</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
HW3 &#8211; Amplifier Noise and Nonlinearity
&#131;Amplifier circuit
&#131;Model
M1Ibias
Vout
10
0.182
0.18
M2RL
VinCbig2
Cbig1RT
50 &#8486;
Vin50 &#8486;
50 &#8486;Nonlinearity
Vout
Vout = co + c1x + c2x2 + c3x3Noise</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
How High of a Data Rate Can The Channel Support?
&#131;Raise it to 25 Gb/s
&#131;However, we haven&#8217;t considered other issues-PC board trace attenuates severely at high frequencies
&#131;Bandwidth is &lt; 5 GHz for 48 inch PC board trace (FR4)0 2 4 6 8
x 10&#8722;11&#8722;0.100.10.20.30.40.50.6
Time (seconds)outEye Diagram</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Issue:  PC Board Trace is Not an Ideal Channel
&#131;Chip capacitance and inductance limits bandwidth
&#131;Transmission line effects cause reflections in the 
presence of impedance mismatch
&#131;Example:  transmit at 1 Gb/s across link in previous slide (assume bondwire inductance is zero)
-Signal at receiver termination resistor
0 0.5 1 1.5 2 2.5
x 10&#8722;8&#8722;0.0500.050.10.150.20.250.30.350.4out
TIME</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Eye Diagram for 1 Gb/s Data Rate
&#131;Wrap signal back onto itself every 2*Tdseconds-Same as an oscilloscope would do
&#131;Allows immediate assessment of the quality of the 
signal at the receiver (look at eye opening)
00.2 0.4 0.6 0.8 11.2 1.4 1.6 1.8 2
x 10&#8722;9&#8722;0.0500.050.10.150.20.250.30.350.4
Time (seconds)outEye Diagram</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
How Else Can We Reduce ISI?
&#131;Consider a system level view of the link-Channel can be viewed as having an equivalent 
frequency response
&#131;Assumes linearity and time-inv ariance (accurate for most 
transmission line systems)
Transmitter
DriverReceiver
DetectorChannelTransmitter Receiver</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
HW5 &#8211; Voltage Controlled Oscillators
&#131;Differential CMOS
&#131;Colpitts
Vbias=1.2VM1Ld=4nH
Vout
C1=2pF
Ibias=100 &#181;AC2=8pFRd=10k &#8486;
M1 M2M3
VoutCtune
3 nH100/0.18
50/0.18M4
100/0.18
50/0.18VoutVin1.8 V
0 V</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
HW4 &#8211; Low Noise Amplifiers and Mixers
&#131;Narrowband LNA
&#131;Passive Mixer
VinCL
RL/2 RL/2RS/2Cbig
RS/2 CbigLO
LO LOLO
Vout Vout
0 V
0Vdd0Vdd50 &#8486;
VinM1M2
LsLg
CbigIbias = 1mA
M3Vout
CL=1pF5 k&#8486;
ZinRpsRpg
RpsCbigLd
Rpd</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
Receiver Function
&#131;Two operations-Recover clock and use it to sample data-Evaluate data to be 0 or 1 based on a slicer
Slice
LevelSampling
Instant
Recovered
ClockDetector
Data
Clock
RecoveryOut
Data
Out 011 1 1 110 0 000 0Recovered
Clock</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>A Quick Preview of Homeworks and Projects</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
What Happens if We Increase the Data Rate?
&#131;Limited bandwidth and reflections cause intersymbol
interference (ISI)
&#131;Eye diagram at 10 Gb/s for same data link
0 1 2
x 10&#8722;10&#8722;0.100.10.20.30.40.50.6
Time (seconds)outEye Diagram</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
Example:  A High Speed Backplane Data Link
&#131;Suppose we consider packaging issues at the receiver 
side (ignore transmitter packaging now for simplicity)
VoutDelay = 110 ps
Characteristic Impedance = 50 &#8486;Ideal Transmission Line
100 &#8486;
VinTwo-Port Model
Ei1
Er1Ei2
Er2dieAdjoining pins
Controlled Impedance
PCB tracepackage
On-ChipDriving
Source
55 &#8486;0.5 pFM4M1 M2
M3IbiasVin+ Vin-Vo+100 &#8486; 100 &#8486;Receiver Transmitter
unintentional
mismatchintentional
mismatch0.5 pF1 nH</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Integer-N Frequency Synthesizers</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec15/</lecture_pdf_url>
      <lectureno>15</lectureno>
      <slides>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Relate Pulse Width to Phase Error
&#131;Two cases:
1
-1e(t)ref(t)
div(t)
W1
-1e(t)ref(t)
div(t)
W
W =&#934;ref &#8722; &#934;div
&#960;T/2T/2 T/2
W = -  &#934;ref &#8722; &#934;div
&#960;T/20 &lt; &#934;ref &#8722; &#934;div  &lt; &#960; &#8722;&#960; &lt; &#934;ref &#8722; &#934;div  &lt; 0</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Phase Detector (PD)
&#131;XOR structure-Average value of error puls es corresponds to phase error-Loop filter extracts the average value and feeds to VCO
ref(t)
div(t)e(t)
ref(t)
div(t)
e(t)1
-1</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>M.H. Perrott MIT OCW
PFD Enables PLL to Always Regain Frequency Lock
&#131;Asymmetric phase error characteristic allows positive 
frequency differences to be distinguished from 
negative frequency differences -Average value is now positiv e or negative according to 
sign of frequency offset-PLL will always relock
&#934;ref - &#934;div2&#960; 4&#960; 2n&#960;&#8722;2&#960;1
-1Tristate DC characteristic
cycle slipping
0
lock</text>
        </slide>
        <slide>
          <slideno>44</slideno>
          <text>M.H. Perrott MIT OCW
A Common Loop Filter for Type II PLL Implementation
&#131;Use a charge pump to create the integrator-Current onto a capacitor forms integrator-Add extra pole/zero using resistor and capacitor
&#131;Gain of loop filter can be  adjusted according to the 
value of the charge pump current
&#131;Example:  lead/lag network
C1
C2R1v(t) e(t)Charge
Pumpi(t)</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
Example:  First Order Loop Filter
&#131;Overall PLL block diagram
&#131;Loop filterN&#934;ref(t) &#934;out(t)
&#934;div(t)e(t) v(t)
H(f)Kv
jf2
&#960;
1Loop FilterXOR PDVCO
Divider
C1R1 e(t) v(t)
</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>M.H. Perrott MIT OCW
Another PFD Structure
&#131;XOR-based PFD
SR
D
QQD
QQD
QQ
D
QQref(t)
div(t)e(t)
Divide-by-2 Frequency
DetectorPhase
Detector
ref(t)
div(t)
ref/2(t)div/2(t)
-11e(t)ref/2(t)
div/2(t)</text>
        </slide>
        <slide>
          <slideno>49</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Parasitics When Lead/Lag Filter Used
&#131;We can again model impact of parasitics by including 
them in loop filter transfer function
&#131;Example:  include two parasi tic poles with the lead/lag 
transfer functionC1
C2R1e(t)Charge
Pumpi(t) v(t)
Parasitics
</text>
        </slide>
        <slide>
          <slideno>51</slideno>
          <text>M.H. Perrott MIT OCW
Negative Issues For Type II PLL Implementations
&#131;Parasitic pole/zero pair causes-Peaking in the closed loop frequency response
&#131;A big issue for CDR systems, but not too bad for wireless-Extended settling time due to parasitic &#8220;tail&#8221; response
&#131;Bad for wireless systems demanding fast settling timeffo fzfzfcp|G(f)|Peaking caused by
undesired pole/zero pair
01
Frequency (Hz)01 2 3 40.611.4
Normalized time: t*foNormalized AmplitudeStep Responses for a Second Order
G(f) implemented as a Bessel Filter
Type II:  f z/fo = 1/3
Type II:  f z/fo = 1/8
Type I</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
Back to PLL Response Shown Previously
&#131;PLL output frequency indeed oscillates-Eventually locks when freque ncy difference is small enough
-How do we extend the frequency lock-in range?4060801001201401601802002202409293949596N (Divide Value)Synthesizer Response To Divider Step
4060801001201401601802002202401.841.861.881.91.92Output Frequency (GHz)
Time (microseconds)</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
Overview of Integer-N Frequency Synthesizer
&#131;VCO                 produces high frequency sine wavePFDout(t) e(t) v(t)
NLoop
Filter
DividerVCOref(t)
div(t)</text>
        </slide>
        <slide>
          <slideno>47</slideno>
          <text>M.H. Perrott MIT OCW
PLL Design with Lead/Lag Filter
&#131;Overall PLL block diagram
&#131;Loop filter
&#131;Set open loop gain to ach ieve adequate phase margin-Set fzlower than and fphigher than desired PLL bandwidthN&#934;ref(t) &#934;out(t)
&#934;div(t)e(t) v(t)
H(f)Kv
jf&#945;
2&#960;
1Loop FilterPFDVCO
DividerTristate:  &#945;=1
XOR-based:  &#945;=2
IcpCharge
Pump
</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
Popular VCO Structures
Vout
VinCRp L -RampVCO Amp
Vout
VinLC oscillator
Ring oscillator
-1
&#131;LC Oscillator:  low phase noise, large area
&#131;Ring Oscillator:  easy to integrate, higher phase noise</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>M.H. Perrott MIT OCW
Type I versus Type II PLL Implementations
&#131;Type I: one integrator in PLL open loop transfer 
function-VCO adds on integrator-Loop filter, H(f), has no integrators
&#131;Type II:  two integrators in PLL open loop transfer function
-Loop filter, H(f), has one integrator
N&#934;ref(t) &#934;out(t)
&#934;div(t)e(t) v(t)
H(f)Kv
jf&#945;
2&#960;
1Loop FilterPFDVCO
DividerTristate:  &#945;=1
XOR-based:  &#945;=2</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
Integer-N Frequency Synthesizers in Wireless Systems
&#131;Design Issues:  low noise, fast settling time, low powerZin
Zo LNA To FilterFrom Antenna
and Bandpass
FilterPC board
trace
Package
Interface
LO signalMixer
RF in IF out
Frequency
SynthesizerReference
FrequencyVCO
PFDCharge
Pumpout(t) e(t) v(t)
NLoop
Filter
DividerVCOref(t)
div(t)v(t) out(t) ref(t)</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Model for Voltage to Frequency Mapping of VCO
Vout
VinCRp L -RampVCO Amp
Vout
VinLC oscillator
Ring oscillator
-1VCO
Frequency
Input Voltageslope=Kv
VbiasvinFvco
Fout
vfc
</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Response of PLL to Divide Value Changes
&#131;Change in output frequency achieved by changing the 
divide value
&#131;Classical approach provides no direct model of impact of divide value variations
-Treat divide value variation as a perturbation to a linear 
system
&#131;PLL responds according to its closed loop responseN&#934;ref(t) &#934;out(t)
&#934;div(t)e(t) v(t)
H(f)Kv
jf2
&#960;
1Loop FilterXOR PDVCO
Divider
NN+1
t</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>M.H. Perrott MIT OCW
XOR-based PFD Characteristic
&#131;Calculate using similar approach as used for XOR phase 
detector
&#131;Phase errror characteristic asymmetric about zero phase-Average value of phase error is  positive or negative during 
cycle slipping depending on sign of frequency error2&#960; &#960; &#8722;2&#960; 5&#960; 4&#960;&#8722;3&#960;1
&#8722;1avg{e(t)}
phase detector
range = 2 &#960;gain = 1/ &#960;
&#934;ref - &#934;div0</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
What Happens with Large Divide Value Variations?
&#131;PLL temporarily loses frequency lock (cycle slipping 
occurs)
-Why does this happen?4060801001201401601802002202409293949596N (Divide Value)Synthesizer Response To Divider Step
4060801001201401601802002202401.841.861.881.91.92Output Frequency (GHz)
Time (microseconds)</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Modeling of XOR Phase Detector
&#131;Average value of pulses is extracted by loop filter-Look at detector output over one cycle:
&#131;Equation:T/2W
1
-1e(t)
</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
Frequency-Domain Model for VCO
&#131;Time-domain relationship (from previous slide)
&#131;Corresponding frequency-domain model
Laplace-Domain
out(t)
VCOv(t) &#934;out(t) v(t)2&#960;Kv
s
VCO&#934;out(t) v(t)Kv
jf
VCOFrequency-Domain
</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Frequency-Domain Model of XOR Phase Detector
&#131;Assume phase difference confined within 0 to &#960;radians-Phase detector characteristic looks like a constant gain 
element 
&#131;Corresponding frequency-domain model&#934;ref - &#934;div&#960; &#960;/2 &#8722;&#960;/2 &#8722;&#960; 0avg{e(t)}
1
-1gain = 2/ &#960; gain = -2/ &#960;
ref(t)
PDe(t)
PD gain
div(t)&#934;ref(t)
&#934;div(t)2
&#960;e(t)</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
Loop Filter
&#131;Consists of a lowpass filter to extract average of 
phase detector error pulses
&#131;Frequency-domain model
&#131;First order example
C1R1 e(t) v(t)Laplace-Domain
e(t) e(t)
VCOe(t)
VCOFrequency-Domain
v(t) v(t)
H(s)
H(s)H(f)Loop
Filterv(t)
</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
Classical PLL Transfer  Function Design Approach
1. Choose an appropriate topology for H(f)
&#131;Usually chosen from a small set of possibilities
2. Choose pole/zero values for H(f) as appropriate for 
the required filtering of the phase detector output
&#131;Constraint:  set pole/zero locations higher than 
desired PLL bandwidth to allow stable dynamics to be possible
3. Adjust the open-loop gain  to achieve the required 
bandwidth while maintaining stability
&#131;Plot gain and phase bode plots of A(f)
&#131;Use phase (or gain) margin criterion to infer stability</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
Overview of Integer-N Frequency Synthesizer
&#131;VCO                 produces high frequency sine wave
&#131;Divider            divides down VCO frequency
&#131;PFD                 compares phase of ref and div
&#131;Loop filter       smooths phase error signal
VCO frequency locks to ref. frequency multiplied by NPFDout(t) e(t) v(t)
NLoop
Filter
DividerVCOref(t)
div(t)Fout = N  Fref Fref</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
Divider
&#131;Implementation
&#131;Time-domain model-Frequency:
-Phase:out div(t)
div(t)out(t)N
out(t)count value
N = 6Counter
</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>M.H. Perrott MIT OCW
Linearized PLL Model With PFD Structures
&#131;Assume that when PLL in lock, phase variations are 
within the linear range of PFD-Simulate impact of cycle slipping if desired (do not 
include its effect in model)
&#131;Same frequency-domain PLL model as before, but 
PFD gain depends on topology used
N&#934;ref(t) &#934;out(t)
&#934;div(t)e(t) v(t)
H(f)Kv
jf&#945;
2&#960;
1Loop FilterPFDVCO
DividerTristate:  &#945;=1
XOR-based:  &#945;=2</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
Overview of Integer-N Frequency Synthesizer
&#131;VCO                 produces high frequency sine wave
&#131;Divider            divides down VCO frequency
&#131;PFD                 compares phase of ref and divPFDout(t) e(t) v(t)
NLoop
Filter
DividerVCOref(t)
div(t)</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
Cycle Slipping
&#131;Consider the case where there is a frequency offset 
between divider output and reference-We know that phase difference will accumulate
&#131;Resulting ramp in phase causes PD characteristic to be swept across its differ ent regions (cycle slipping)
&#934;ref - &#934;div&#960; &#960;/2 &#8722;&#960;/2 &#8722;&#960; 0avg{e(t)}
1
-1gain = 2/ &#960; gain = -2/ &#960;ref(t)
div(t)</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Response of an Actual PLL to Divide Value Change
&#131;Example:  Change divide value by one
40608010012014016018020022024091.89292.292.492.692.893N (Divide Value)Synthesizer Response To Divider Step
4060801001201401601802002202401.831.841.851.861.87Output Frequency (GHz)
Time (microseconds)
-PLL responds according to closed loop response!</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Overall Linearized PLL Frequency-Domain Model
&#131;Combine models of individual components
N&#934;ref(t) &#934;out(t)
&#934;div(t)e(t) v(t)
H(s)2&#960;Kv
s2
&#960;
1Loop FilterXOR PDVCO
Divider
N&#934;ref(t) &#934;out(t)
&#934;div(t)e(t) v(t)
H(f)Kv
jf2
&#960;
1Laplace-Domain Model
Frequency-Domain Model
Loop FilterXOR PDVCO
Divider</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
Overall XOR Phase Detector Characteristic
&#934;ref - &#934;div&#960; &#960;/2 &#8722;&#960;/2 &#8722;&#960; 0avg{e(t)}
1
-1
phase detector
range = &#960;gain = 2/ &#960; gain = -2/ &#960;1
-1e(t)ref(t)
div(t)
W1
-1e(t)ref(t)
div(t)
W
W =&#934;ref &#8722; &#934;div
&#960;T/2T/2 T/2
W = -  &#934;ref &#8722; &#934;div
&#960;T/20 &lt; &#934;ref &#8722; &#934;div  &lt; &#960; &#8722;&#960; &lt; &#934;ref &#8722; &#934;div  &lt; 0</text>
        </slide>
        <slide>
          <slideno>48</slideno>
          <text>M.H. Perrott MIT OCW
Closed Loop Poles Versus Open Loop Gain
&#131;Open loop gain cannot be too low or too high if 
reasonable phase margin is desiredNon-dominant
poleDominant
pole pairOpen loop
gain
increased
120o
-180o-140o
-160o20log|A(f)|
f
fz0 dB
PM = 55o for CPM = 53o for APM = 54o for Bangle(A(f))
AA
AA
BB
BBC
CCCEvaluation of
Phase MarginClosed Loop Pole
Locations of G(f)
fp
Re{s}Im{s}
0</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Time-domain frequency relationship (from previous 
slide)
&#131;Time-domain phase relationshipModel for Voltage to Phase Mapping of VCO
1/Fvco= &#945;
1/Fvco= &#945;+&#949;out(t)
out(t)&#131;Intuition of integral relati onship between frequency and 
phase:</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
Phase Frequency Detectors (PFD)
D
QQD
QQ
RRref(t)
div(t)
Ref(t)
Div(t)1
1up(t)
e(t)
down(t)
Up(t)
Down(t)
1
0
-1E(t)&#131;Example:  Tristate PFD</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
Overview of Integer-N Frequency Synthesizer
&#131;VCO                 produces high frequency sine wave
&#131;Divider            divides down VCO frequency
&#131;PFD                 compares phase of ref and div
&#131;Loop filter       smooths phase error signalPFDout(t) e(t) v(t)
NLoop
Filter
DividerVCOref(t)
div(t)</text>
        </slide>
        <slide>
          <slideno>50</slideno>
          <text>M.H. Perrott MIT OCW
Closed Loop Poles Versus Open Loop Gain
&#131;Closed loop response becom es unstable if open loop 
gain is too highNon-dominant
polesDominant
pole pairOpen loop
gain
increased
120o
-180o-140o
-160o20log|A(f)|
f
fz0 dB
PM = -7o for CPM = 38o for BPM = 46o for Aangle(A(f))
AA
AA
BB
BBC
CCCEvaluation of
Phase MarginClosed Loop Pole
Locations of G(f)
Re{s}Im{s}
0fp2fp fp3</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
Corresponding Closed Loop Response
&#131;Increase in open loop gain now eventually leads to 
instability-Large peaking in closed loop frequency response-Increasing amplitude in closed loop step response0 dBClosed Loop Frequency Response Closed Loop Step Response
1
Time FrequencyAC
BCB
A</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Cycle Slipping
&#131;Loop filter averages out phase detector output
&#131;Severe cycle slipping causes phase detector to 
alternate between regions very quickly-Average value of XOR charact eristic can be close to 
zero-PLL frequency oscillates according to cycle slipping-In severe cases, PLL will not re-lock
&#131;PLL has finite frequency lock-in range!
&#960; &#8722;&#960; 3&#960; n&#960; (n+2) &#960;1
-1XOR DC characteristic
cycle slipping
&#934;ref - &#934;div</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Closed Loop Poles Versus Open Loop Gain
&#131;Higher open loop gain lead s to an increase in Q of 
closed loop poles-90o
-180o-120o
-150o20log|A(f)|
f
angle(A(f))Open loop
gain
increased
0 dB
PM = 33o for CPM = 45o for BPM = 59o for AAA
A
BB
BC
C
CEvaluation of
Phase MarginClosed Loop Pole
Locations of G(f)
Dominant
pole pair
fp
Re{s}Im{s}
0</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
Closed Loop Poles Versus Open Loop Gain
-90o
-315o-165o
-180o
-240o20log|A(f)|
ffp3
angle(A(f))Open loop
gain
increased
0 dB
PM = 51o for B
PM = -12o for CPM = 72o for ANon-dominant
polesDominant
pole pair
ABC
BAABC
CEvaluation of
Phase MarginClosed Loop Pole
Locations of G(f)
fpfp2
Re{s}Im{s}
0</text>
        </slide>
        <slide>
          <slideno>45</slideno>
          <text>M.H. Perrott MIT OCW
Charge Pump Implementations
&#131;Switch currents in and out:
e(t) down(t) e(t)Iout(t)
Iout(t)Icp
Icp 2IcpIcp IcpSingle-Ended Differential
up(t)</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
Frequency-Domain Model of Divider
&#131;Time-domain relationship between VCO phase and 
divider output phase (from previous slide)
&#131;Corresponding frequency-domain model (same as Laplace-domain)
out(t) &#934;out(t)
NDividerdiv(t) &#934;div(t)1
Divider</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
Overview of Integer-N Frequency Synthesizer
&#131;VCO                 produces high frequency sine wave
&#131;Divider            divides down VCO frequencyPFDout(t) e(t) v(t)
NLoop
Filter
DividerVCOref(t)
div(t)</text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>M.H. Perrott MIT OCW
&#131;DC output range of gain block versus integrator
&#131;Issue:  DC gain of loop filter often small and PFD 
output range is limited-Loop filter output fails to cover full input range of VCOVCO Input Range Issue for Type I PLL Implementations
PFDLoop
Filter
N[k]ref(t) out(t)
Dividere(t) v(t)VDD
GndOutput Range
of Loop FilterNo
Integrator
VCO0K
sIntegrator
0Gain Block
K</text>
        </slide>
        <slide>
          <slideno>43</slideno>
          <text>M.H. Perrott MIT OCW
Options for Achieving Full Range Span of VCO
Loop
FilterD/A
e(t) v(t)
C.P.VDD
GndOutput Range
of Loop Filter Course
Tune
No
Integrator
Loop
Filtere(t) v(t)
C.P.VDD
GndOutput Range
of Loop Filter
Contains
IntegratorType I Type II&#131;Type I-Add a D/A converter to provide coarse tuning
&#131;Adds power and complexity
&#131;Steady-state phase error inconsistently set
&#131;Type II-Integrator automatically provides DC level shifting
&#131;Low power and simple implementation
&#131;Steady-state phase error always set to zero</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Corresponding Closed Loop Response
&#131;Increase in open loop gain leads to-Peaking in closed loop frequency response-Ringing in closed loop step response5 dB
0 dB
-5 dB
fAC
fpBFrequency Response of G(f)
1.4
01
0.6
tABCStep Response of G(f)</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
Tristate PFD Characteristic
&#131;Calculate using similar approach as used for XOR 
phase detector
&#131;Note that phase error characteristic is asymmetric about zero phase
-Key attribute for enabling frequency detection2&#960;&#8722;2&#960;1
&#8722;1avg{e(t)}
phase detector
range = 4 &#960;gain = 1/(2 &#960;)
&#934;ref - &#934;div</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 15
Integer-N Frequency Synthesizers
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
The Impact of Parasitic Poles
&#131;Loop filter and VCO may have additional parasitic 
poles and zeros due to th eir circuit implementation
&#131;We can model such parasitics by including them in 
the loop filter transfer function
&#131;Example:  add two parasitic poles to first order filter
C1R1 e(t) v(t)
Parasitics
</text>
        </slide>
        <slide>
          <slideno>46</slideno>
          <text>M.H. Perrott MIT OCW
Modeling of Loop Filter/Charge Pump
&#131;Charge pump is gain element
&#131;Loop filter forms transfer function
&#131;Example:  lead/lag network from previous slidee(t) v(t)
H(s) IcpLoop
FilterCharge
Pump
</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Recall Phase Detector Characteristic
&#131;To simplify modeling, we assumed that we always 
operated in a confined phase range (0 to &#960;)-Led to a simple PD model
&#131;Large perturbations knock us  out of that confined 
phase range-PD behavior varies depending on the phase range it 
happens to be in&#934;ref - &#934;div&#960; &#960;/2 &#8722;&#960;/2 &#8722;&#960; 0avg{e(t)}
1
-1gain = 2/ &#960; gain = -2/ &#960;</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
Open Loop versus Closed Loop Response
&#131;Frequency-domain model
&#131;Define A(f) as open loop response
&#131;Define G(f) as a parameterizing function (related to 
closed loop response)
N&#934;ref(t) &#934;out(t)
&#934;div(t)e(t) v(t)
H(f)Kv
jf2
&#960;
1Loop FilterXOR PDVCO
Divider
</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>MSK Modulation and Clock and Data Recovery Circuits</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec21/</lecture_pdf_url>
      <lectureno>21</lectureno>
      <slides>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Include Influence of Transmit Filter
&#131;For MSK modulation
-Where * denotes convolution
cos(&#934;mod(t))
sin(&#934;mod(t))I(t)
Q(t)&#934;mod(t)
2&#960;Transmit
Filterfmod(t) data(t) 1
4Td
1
4Td
Transmit filter
bandwidth = B Hz
&#960;/2TdTdTd
1
-1Td
01 x(t)
0rect(T d,t)
p(t)</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>M.H. Perrott MIT OCW
The Impact of Delays in a Bang-Bang Loop
&#131;Delays increase the period of limit cycles, thereby 
increasing jitterclk(t) e(t) v(t)
VCOdata(t)
Sense Drive Delay&#934;clk(t)Bang-Bang Style
 Phase Detector
&#934;clk(t)
e(t)v(t)
&#934;clk(t)
e(t)v(t)</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
A More Convenient Model for Analysis
&#131;Same as previous model, but we represent data as 
impulses convolved with a rectangular pulse-Note that h = 1/2 for MSKcos(&#934;mod(t))
sin(&#934;mod(t))I(t)
Q(t)&#934;mod(t)
2&#960;Transmit
Filterfmod(t) data(t) hAssume DC gain = 1
2Td
h
2Td
h
2Tdfor infinite
transmit filter
bandwidth
h&#960;TdTdTd
1
-1Td
01 x(t)</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>M.H. Perrott MIT OCW
A Closer Look at the Hogge Detector
&#131;Error output, e(t), consists of two pulses with 
opposite polarity-Positive polarity pulse has an area that is proportional 
to the phase error between the data and clk-Negative polarity pulse has a fixed area corresponding to half of the clk period
-Overall area is zero when da ta edge is aligned to falling 
clk edgeclk(t)data(t)
retimed data(t)
e(t)AA(t) B
B(t)C
C(t)
1
-10DQ DQ
clk(t)data(t)retimed
data(t)Reg Latche(t)Hogge Detector (Linear)</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Open Loop Response and Closed Loop Pole/Zeros
&#131;Key issue:  an undesired pole/zero pair occurs due to 
stabilizing zero in the lead/lag filter Non-dominant
poleDominant
pole pairOpen loop
gain
increased
120o
-180o-140o
-160o20log|A(f)|
f
fz0 dB
PM = 55o for CPM = 53o for APM = 54o for Bangle(A(f))
AA
AA
BB
BBC
CCCEvaluation of
Phase MarginClosed Loop Pole
Locations of G(f)
fp
Re{s}Im{s}
0</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
Transmit Filter Selection
&#131;Recall from Lecture 19 that output spectrum is related 
in a nonlinear manner to transmit filter-Raised cosine filter is not  necessarily the best choice
&#131;We&#8217;ll come back to this issue-Focus instead on choosing &#8710;ff
0S&#934;mod(f)
cos(2&#960;f2t)
sin(2&#960;f2t)y(t)
-fo fo 0cos(&#934;mod(t))
sin(&#934;mod(t))f
0Sa(f)
Sy(f)it(t)
qt(t)
f
0Sb(f)
f&#934;mod(t)</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Example Jitter Tolerance Mask
&#131;CDR tested for tolerance compliance by adding sine wave 
jitter at various frequencies (with amplitude greater than 
mask) to the data input and observing bit error rateJitter Frequency (Hz)Jitter Tolerance U.I.OC-192 Jitter Tolerance Mask
24 kHz 4 MHz 100 MHz0.15 UI1.5 UI15 UI
400 kHz 2.4 kHzAcceptable
Region</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
Frequency Shift Keying
&#131;Sends information encoded in  instantaneous frequency-Can build simple tran smitters and receivers
&#131;Pagers use this modulation method
&#131;Issue &#8211; want to obtain high spectral efficiency-Need to choose an appropriate transmit filter-Need to choose an appropriate value of &#8710;fGHzout(t)
out(t)Sout(f)
data(t) 2&#8710;fTransmit
Filterv(t) out(t) data(t)
Assume infinite bandwidth
in this example
fo1
-1</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Jitter Tolerance
&#131;Definition-The maximum amount of jitter allowed on the input while 
still achieving low bit error rates (&lt; 10e-12)
&#131;SONET specifies jitter tolerance according to the 
frequency of the jitter-Low frequency jitter can be larg e since it is tracked by PLL-High frequency jitter (above the PLL bandwidth) cannot be 
as high (PLL can&#8217;t track it out)
&#131;Limited by setup and hold times of PD retiming registerPDCharge
Pumpclk(t) e(t) v(t)Loop
Filter
VCOretimed
data(t)
data(t)</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
Popular CDR Phase Detectors
&#131;Linear-Hogge detector produces an error signal that is 
proportional to the instantaneous phase error
&#131;Nonlinear-Alexander (Bang-bang) detector produces an error signal that corresponds to the sign of the instantaneous phase errorDQ DQ
clk(t)data(t)retimed
data(t)Reg Latche(t)
DQ DQReg LatchDQ DQ
clk(t)e(t)data(t)retimed
data(t)Reg Reg
clk(t)Hogge Detector (Linear) Bang-Bang Detector (Nonlinear)</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
Corresponding Closed Loop Frequency Response
&#131;Undesired pole/zero pair causes peaking in the closed 
loop frequency response
&#131;SONET demands that peaking must be less than 0.1 dB-For classical lead/lag filter appr oach, this must be achieved 
by having a very low-valued zero
&#131;Requires a large loop filter capacitorw
wo wzwz wcp|G(w)|Peaking caused by
undesired pole/zero pair
01
Frequency (rad/s)</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
One Possible Fix
&#131;Modify Hogge so that the doub le integral of the e(t) 
pulse sequence is zero-Low frequency noise is now removed
&#131;See L. Devito et. al., &#8220;A 52 MHz and 155 MHz Clock-
recovery PLL&#8221;, ISSCC, Feb, 1991clk(t)data(t)
retimed data(t)
e(t)AA(t)
B B(t) C
C(t)
1
-20
clk(t)data(t)retimed
data(t)
DQRege(t)
DQLatchHogge Detector (Linear)
D(t)
e(t)0Latch
DQD2</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
Culprit Behind Data Dependent Jitter for Hogge PD
&#131;The double integral of the e(t) pulse sequence is 
nonzero (i.e., has DC content)-Since the data transition activity is random, a low 
frequency noise source is created
&#131;Low frequency noise not attenuated by PLL dynamicsABC
DQ DQ
clk(t)data(t)retimed
data(t)Reg Latche(t)clk(t)data(t)
retimed data(t)
e(t)A(t)
B(t)
C(t)
1
-10Hogge Detector (Linear)
e(t)0</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Sending a Single Data Impulse
&#131;To achieve MSK modulation, resulting phase shift 
must be &#177;90o(i.e., &#960;/4)cos(&#934;mod(t))
sin(&#934;mod(t))I(t)
Q(t)&#934;mod(t)
2&#960;Transmit
Filterfmod(t) data(t) 1Assume DC gain = 1
4Td
1
4Td
for infinite
transmit filter
bandwidth
&#960;/2TdTdTd
1
-1Td
01 x(t)
0</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
A Closer Look at the Bang-Bang Detector
&#131;Error output consists of pu lses of fixed area that are 
either positive or negative depending on phase error
&#131;Pulses occur at data edges-Data edges detected when sampled data sequence is 
different than its previous value
&#131;Above example illustrates the impact of having the 
data edge lagging the clock edgeclk(t)data(t)
retimed data(t)
e(t)A(t)
B(t)
C(t)
1
-10DQ DQReg LatchDQ DQ
clk(t)e(t)data(t)retimed
data(t)Reg Reg
clk(t)Bang-Bang Detector (Nonlinear)
A
BC
D D(t)</text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>M.H. Perrott MIT OCW
Some References on CDR&#8217;s and Delay-Locked Loops
&#131;Gu-Yeon Wei will discuss DLL&#8217;s in his guest lecture
&#131;Tom Lee has a nice paper-See T. Lee et. al., &#8220;A 2.5 V CMOS Delay-Locked Loop for an 
18 Mbit, 500 Megabyte/s DRAM&#8221;, JSSC, Dec 1994
&#131;Check out papers from Mark Horowitz&#8217;s group at Stanford-Oversampling data recovery approach
&#131;See C-K K. Yang et. al., &#8220;A 0.5-um CMOS 4.0-Gbit/s Serial 
Link Transceiver with Data Recovery using Oversampling&#8221;, JSSC, May 1998
-Multi-level signaling
&#131;See Ramin Farjad-Rad et. al., &#8220;A 0.3-um CMOS 8-Gb/s 4-PAM Serial Link Transceiver&#8221;, JSSC, May 2000
-Bi-directional signaling
&#131;See E. Yeung, &#8220;A 2.4 Gb/s/p in simultaneous bidirectional 
parallel link &#8230;&#8221;, JSSC, Nov 2000</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Gaussian Minimum Shift Keying
&#131;Definition-Minimum shift keying in which th e transmit filter is chosen 
to have a Gaussian shape (i n time and frequency) with 
bandwidth = B Hz
&#131;Key parameters-Modulation index:  as previously discussed
&#131;h = 1/2-BTdproduct:  ratio of transmit filter bandwidth to data rate
&#131;For GSM phones:   BTd= 0.3  
</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
The Issue of Data Dependent Jitter
&#131;For classical or Bulzacchelli CDR-Type II PLL dynamics are empl oyed so that steady state 
phase detector error is zero
&#131;Issue:  phase detector output influences VCO phase 
through a double integrator operation-The classical Hogge detector ends up creating data 
dependent jitter at the VCO outputPDCharge
Pumpclk(t) e(t) v(t)Loop
Filter
VCOretimed
data(t)
data(t)&#934;clk(t)</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
High Speed Data Links
&#131;A challenging component is the clock and data 
recovery circuit (CDR)-Two primary functions
&#131;Extract the clock correspondin g to the input data signal
&#131;Resample the input dataZin
Zo AmpFrom Broadband
TransmitterPC board
trace
Package
InterfaceIn Clock and
Data 
RecoveryData
Clk
Loop
FilterPhase
DetectorData Out
Data In Clk Out
VCO</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
Summary of CDR Performance Specifications
&#131;Jitter-Jitter generation-Jitter tolerance-Jitter transfer (and peaking)
&#131;Acquisition time-Must be less than 10 ms  for many SONET systems
&#131;Bit error rates-Must be less than 10e-12 for many SONET systems</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
A Closer Look at the Bang-Bang Detector (continued)
&#131;Above example illustrates the impact of having the 
data edge leading the clk edge-Error pulses have opposite sign from lagging edge caseclk(t)data(t)
retimed data(t)
e(t)A(t)
B(t)
C(t)
1
-10DQ DQReg LatchDQ DQ
clk(t)e(t)data(t)retimed
data(t)Reg Reg
clk(t)Bang-Bang Detector (Nonlinear)
A
BC
D D(t)</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Model of CDR with Delay Element
&#131;Delay &#8220;gain&#8221;, Kd, is set by delay implementation
&#131;Note that H(s) can be implemented as a simple 
capacitor-H(s) = 1/(sC)1
&#960;&#945;Kv&#934;out(t) &#934;data(t)
s2&#960;Hogge Detector
Phase
Sampler VCO
e(t)
H(s) IcpCharge
PumpLoop
Filter
&#945; = transition density
0 &lt; &#945; &lt; 1, = 1/2
for PRBS inputv(t) i(t)
Kd
Note:  K d units
are radians/VNote:  K v units
are Hz/V</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
Project 2
&#131;Simulate a GMSK transmitter and receiver
&#131;What you&#8217;ll learn-How GMSK works at the system level-Behavioral level simulation of a communication system-Generation of eye diagrams and spectral plots-Analysis and simulation of di screte-time version of loop 
filter and other signals
&#131;Note:   you&#8217;ll also be exposed a little to GFSK 
modulation-Popular for cordless phones-Similar as GMSK, but frequen cy is the important variable 
rather than phase
&#131;Typical GFSK specs:  h = 0.5 &#177;0.05, BTd= 0.5</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
PLL Based Clock and Data Recovery
&#131;Use a phase locked loop to tune the frequency and 
phase of a VCO to match that of the input data
&#131;Performance issues-Jitter-Acquisition time-Bit error rate (at given input levels)
&#131;Let&#8217;s focus on specifications for OC-192-i.e., 10 Gbit/s SONETPDCharge
Pumpclk(t) e(t) v(t)Loop
Filter
VCOretimed
data(t)
data(t)</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 21
MSK Modulation and
Clock and Data Recovery Circuits
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Jitter Generation
&#131;Definition-The amount of jitter at the ou tput of the CDR when no 
jitter (i.e., negligible jitter) is present on the data input
&#131;SONET requires-&lt; 10 mUI rms jitter-&lt; 100 mUI peak-to-peak jitter
&#131;Note:  UI is unit interval, and is defined as the period 
of the clk signal (i.e., 100 ps for 10 Gbit/s data rates)PDCharge
Pumpclk(t) e(t) v(t)Loop
Filter
VCOretimed
data(t)
data(t)</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>M.H. Perrott MIT OCW
Example CDR Settling Characteristic with Bang-Bang PD
&#131;Bang-bang CDR response is slew rate limited-Much faster than linear CDR, in general
&#131;Steady-state jitter often dominated by bang-bang 
behavior (jitter set by erro r step size and limit cycles)Instantaneous Phase Error (UI)0.05
0
-0.05
-0.1
-0.15
-0.2
20 18 16 14 12 10 8 6 4 2 0
Time (Micro Seconds)Instantaneous Phase Error vs Time for CDR 2 (Bang-Bang Detector)
(Steady-State RMS Jitter = 3.4598 mUI)</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>M.H. Perrott MIT OCW
The Issue of Limit Cycles
&#131;Bang-bang loops exhibit limit cycles during steady-
state operation-Above diagram shows resulting waveforms when data 
transitions on every cycle-Signal patterns more complicated for data that randomly transitions
&#131;For lowest jitter:  want to minimize period of limit cyclesclk(t) e(t) v(t)
VCOdata(t)
Sense Drive&#934;clk(t)Bang-Bang Style
 Phase Detector
&#934;clk(t)
e(t)v(t)</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Method of Achieving Zero Peaking
&#131;We can implement a stabilizing zero in the PLL feedback 
path by using a variable delay element-Loop filter can now be implemented as a simple integrator
&#131;Issue:  delay must support a large range
&#131;See T.H. Lee and J.F. Bulzacchelli, &#8220;A 155-MHz Clock Recovery Delay- and Phase-Locked Loop&#8221;, JSSC, Dec 
1992PDCharge
Pumpclk(t) e(t) v(t)Loop
Filter
VCOretimed
data(t)
data(t)
Adjustable
Delay Element</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
MSK Modulation
&#131;Choose h such that the phase rotates &#177;90oeach 
symbol period-Based on previous slide, we need h = 1/2-Note:  1-bit of information per symbol period
&#131;Bit rate = symbol rateIQ</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>M.H. Perrott MIT OCW
Practical Implementation Issues for Bang-Bang Loops 
&#131;Minimize limit cycle periods-Use phase detector with mini mal delay to error output-Implement a high bandwidth feedforward path in loop 
filter
&#131;One possibility is to realiz e feedforward path in VCO
&#131;See B. Lai and R.C Walker, &#8220;A Monolithic 622 Mb/s Clock Extraction Data Retiming Circuit&#8221;, ISSCC, Feb 1991
&#131;Avoid dead zones in phase detector-Cause VCO phase to wonder within the dead zone, 
thereby increasing jitter
&#131;Use simulation to examine system behavior-Nonlinear dynamics can be non-intuitive-For first order analysis, see R.C. Walter et. al., &#8220;A Two-Chip 1.5-GBd Serial Link Interface&#8221;, JSSC, Dec 1992</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
Derivation of Zero Produced by Delay Element
&#131;Zero set by ratio of delay gain to VCO gain1
&#960;&#945;Kv&#934;out(t) &#934;data(t)
s2&#960;Hogge Detector
Phase
Sampler VCO
e(t)
H(s) IcpCharge
PumpLoop
Filter
&#945; = transition density
0 &lt; &#945; &lt; 1, = 1/2
for PRBS inputv(t) i(t)
Kd
Kv&#934;out(t)
s2&#960;VCO
H(s)Loop
Filter
v(t) i(t)
KdKvs
2&#960;Kv&#934;out(t)
s2&#960;VCO
H(s)Loop
Filter
v(t) i(t)
Kd
Kvs2&#960;1+Note:  K d units
are radians/VNote:  K v units
are Hz/V</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Alternate Implementation
&#131;Can delay data rather than clk-Same analysis as beforePDCharge
Pumpclk(t) e(t) v(t)Loop
Filter
VCOretimed
data(t)
data(t)
-1Adjustable
Delay Element</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
Example CDR Settling Characteristic with Hogge PD
&#131;CDR tracks out phase error with an exponential 
transition response
&#131;Jitter occuring at steady state is due to VCO and non-idealities of phase detector
Instantaneous Phase Error (UI)0.6
0.50.40.30.20.1
0
36 32 28 24 20 16 12 8 4 0-0.1Instantaneous Phase Error vs Time for CDR 1 (Hogge Detector)
(Steady-State RMS Jitter = 3.0756 mUI)</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
Phase Detectors in Clock and Data Recovery Circuits
&#131;Key issue-Must accommodate &#8220;missing&#8221; transition edges in input 
data sequence
&#131;Two styles of detection-Linear &#8211; PLL can analyzed in a similar manner as frequency synthesizers
-Nonlinear &#8211; PLL operates as a bang-bang control system (hard to rigorously analyze in many cases)PDCharge
Pumpclk(t) e(t) v(t)Loop
Filter
VCOretimed
data(t)
data(t)</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
A More Detailed Model
&#131;By inspection of figure
&#131;The choice of &#8710;f is now parameterized by h and Td-h is called the modulation index, Tdis symbol periodcos(&#934;mod(t))
sin(&#934;mod(t))I(t)
Q(t)&#934;mod(t)
2&#960;Transmit
Filterfmod(t) data(t) hAssume DC gain = 1
1
-12Td
h
2Td
h
2Tdfor infinite
transmit filter
bandwidth
h&#960;TdTdTd
</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
Recall Constant Envelope Modulation from Lecture 19
&#131;Popular for cell phones and cordless phones due to 
the reduced linearity requirements on the power amp-Allows a more efficient power amp design
&#131;Transmitter power is reducedBaseband to RF Modulation Power Amp
Transmitter
OutputBaseband
Input
Constant-Envelope ModulationTransmit
Filter</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
A Common Loop Filter Implementation
&#131;Use a lead/lag filter to implement a type II loop-Integrator in H(s) forces th e steady-state phase error to 
zero (important to minimize jitter)1
&#960;&#945;Kv&#934;out(t) &#934;data(t)
s2&#960;Hogge Detector
Phase
Sampler VCO
e(t)
H(s) IcpCharge
PumpLoop
Filter
&#945; = transition density
0 &lt; &#945; &lt; 1, = 1/2
for PRBS input
sCtot(1+s/wp)1+s/wzv(t)
C1
C2R1i(t)
1
s(C1+C2)=1+sR1C2
1+sR1C||C|| =C1C2
C1+C2
=v(t) i(t)
H(s)</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
An Interesting Observation
&#131;Calculation of closed loop transfer function
&#131;Key observation-Zeros in feedback loop do not appear as zeros in the 
overall closed loop transfer function!NA(s) X(s)
DA(s)Y(s)
NB(s)
DB(s)
</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
Jitter Transfer
&#131;Definition-The amount of jitter attenuation that the CDR provides 
from input to output
&#131;SONET specifies jitter transfer by placing limits on its 
transfer function behavior from input to output-Peaking behavior:  low freque ncy portion of CDR transfer 
function must be less than 0.1 dB-Attenuation behavior:  high frequency portion of CDR 
transfer function must not exceed a mask limitPDCharge
Pumpclk(t) e(t) v(t)Loop
Filter
VCOretimed
data(t)
data(t)</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Modeling of CDR with Hogge Detector
&#131;Similar to frequency synthesizer model except-No divider-Phase detector gain depends on the transition density 
of the input data
&#131;The issue of transition density-Phase error information of th e input data signal is only 
seen when it transitions
&#131;VCO can wander in the absence of transitions-Open loop gain (and th erefore the closed loop 
bandwidth) is decreased at  low transition densities1
&#960;&#945;Kv&#934;out(t) &#934;data(t)
s2&#960;Hogge Detector
Phase
Sampler VCO
e(t)
H(s) IcpCharge
PumpLoop
Filter
&#945; = transition density
0 &lt; &#945; &lt; 1, = 1/2
for PRBS inputv(t) i(t)</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>M.H. Perrott MIT OCW
Delay-Locked Loops
&#131;In some applications you have a reference clock that 
is perfectly matched in frequency to data sequence-Phase mismatch is present due to different propagation 
delays between clock and data on the PC board
&#131;A delay-locked loop limits adjustment to phase (as 
opposed to phase and frequency)-Faster, and much simpler to design than PLL structurePDCharge
Pumpe(t) v(t)Loop
Filterretimed
data(t)
data(t)
Adjustable
Delay Element
clk(t)Clock and Data
arrive misaligned
in phaseClock and Data
are now re-aligned
in phase
adjusted
clk(t)</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Example Jitter Transfer Mask
&#131;CDR tested for compliance by adding sine wave jitter 
at various frequencies and observing the resulting 
jitter at the CDR output-35-30-25-20-15-10-50.1
Frequency (Hz)Magnitude (dB)
100 kHz 8 MHz 100 MHz 1 MHz 10 kHzAcceptable
RegionOC-192 Jitter Transfer Mask
Maximum Allowed "Peaking" = 0.1 dB</text>
        </slide>
      </slides>
    </lecture>
    <lecture>
      <lecture_title>Advanced Frequency Synthesizers</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/resources/lec17/</lecture_pdf_url>
      <lectureno>17</lectureno>
      <slides>
        <slide>
          <slideno>21</slideno>
          <text>Is There a Better Way?</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>M.H. Perrott MIT OCW
The Phase Interpolation Technique
&#131;Phase error due to fractional technique is predicted 
by the instantaneous residue of the accumulator-Cancel out phase error based on accumulator residue1-bit
M-bitM-bitPFDLoop
Filterref(t)
div(t)out(t)
frac[k]
AccumulatorN/N+1
carry_out[k]e(t)
D/A
residue[k]&#945;</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>M.H. Perrott MIT OCW
Sigma-Delta Frequency Synthesizers
&#131;Use Sigma-Delta modulator rather than accumulator 
to perform dithering operation-Achieves much better spurious performance than 
classical fractional-N approachPFDCharge
Pump
Nsd[m]out(t) e(t)
&#931;&#8722;&#8710;
Modulatorv(t)
N[m]Loop
Filter
DividerVCOref(t)
div(t)
MM+1Fout = M.F  F ref
f&#931;&#8722;&#8710;
Quantization
NoiseFref
Riley et. al.,
JSSC, May 1993</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>M.H. Perrott MIT OCW
MASH topology
&#131;Cascade first order sections
&#131;Combine their outputs after they have passed through 
digital differentiatorsx[k]
y[k]r1[k]
&#931;&#8710;M1[k]
y1[k]r2[k]
&#931;&#8710;M2[k]
y2[k]
u[k]&#931;&#8710;M3[k]
y3[k]M 1 1
1-z-1 (1-z-1)2</text>
        </slide>
        <slide>
          <slideno>45</slideno>
          <text>M.H. Perrott MIT OCW
Divider Impact For Classical Vs Fractional-N Approaches
G(f)
n[k] Fout(t)
D/A and FilterT1n(t)1/T 1
fo
G(f)
n[k] Fout(t)
D/A and FilterT11/T 1
foDithering
Modulatornsd(t) n sd[k]Classical Synthesizer
Fractional-N Synthesizer
&#131;Note:  1/T block represents sam pler (to go from CT to DT)</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>M.H. Perrott MIT OCW
Advantage #2:  Provides Suppression of VCO Noise
&#131;Top VCO has much more phase noise than bottom VCO 
due to its much higher operating frequency-Suppress top VCO noise by choosing a high PLL 
bandwidth for top synthesizer
&#131;High PLL bandwidth possible since ref1is highoutPFD
NLoop
Filter
DividerVCOref1
PFDLoopFilter
DividerVCOref2cos(w 1t)
sin(w 1t)
sin(w 2t)cos(w 2t)
MSingle-sideband
Mixer</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>M.H. Perrott MIT OCW
Parameterized Version of New Model
&#934;vn(t)
T G(f)
2&#960;z-1
1 - z-1n[k]en(t)
&#934;out(t) &#934;c(t) &#934;d(t)&#934;n(t)&#934;nvco(t) &#934;npfd(t)fo1-G(f)fo
foG(f)/K32&#960;Nnom
z=ej2&#960;fT&#945;T
/K32&#960;&#945;
1
&#921;espur(t)&#934;jit[k]
&#921;cpn(t)
G(f)
n[k] &#934;c(t)
jf1 Fc(t)
Freq.      Phase D/A and FilterAlternate Representation
foNoise
Divide
value
variationf0SEn(f)PFD-referred
Noise
1/TVCO-referred
Noise
f0S&#934;vn(f)
-20 dB/dec</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of Signal and Noise Transfer Functions
&#131;Calculate using Z-transform of signals in linearized
model
-NTF:   Hn(z) = H(z)-STF:   Hs(z) = 1x[k] u[k]
e[k]y[k]
H(z) - 1x[k] u[k]r[k]
e[k]y[k]
H(z) - 1
</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>M.H. Perrott MIT OCW
Direct Digital Synthesis (DDS)
&#131;Encode sine-wave values in a ROM
&#131;Create sine-wave output by indexing through ROM 
and feeding its output to a DAC and lowpass filter-Speed at which you index through ROM sets frequency 
of output sine-wave
&#131;Speed of indexing is set by increment value on counter (which is easily adjustable in a digital manner)Counter ROM DAC LPFclk
out</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>M.H. Perrott MIT OCW
Accumulator Operation
&#131;Carry out bit is asserted when accumulator residue 
reaches or surpasses its full scale value-Accumulator residue increments by input fractional 
value each clock cycleresidue[k]
carry_out[k]frac[k] =.251-bitM-bitM-bit
frac[k]
Accumulator
carry_out[k]residue[k]clk(t)</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>M.H. Perrott MIT OCW
Spectral Density Calculations
&#131;Case (a):
&#131;Case (b):
&#131;Case (c):y[k] x[k]
H(ej2&#960;fT)
y(t) x[k]
H(f)y(t) x(t)
H(f) case (a):  CT     CT
case (b):  DT     DT
case (c):  DT     CT
</text>
        </slide>
        <slide>
          <slideno>49</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Increased PLL Bandwidth
&#131;Allows more PFD noise to pass through
&#131;Allows more Sigma-Delta noise to pass through
&#131;Increases suppression of VCO noise-160-150-140-130-120-110-100-90-80-70-60
FrequencySpectral Density (dBc/Hz)
f0 1/T10 kHz 100 kHz 1 MHz 10 MHzPFD-referred
noise
S&#934;out,En(f)
VCO-referred
 noise
S&#934;out,vn(f)&#931;&#8722;&#8710;
noise
S&#934;out,&#8710;&#931;(f)
f0 1/T10 kHz 100 kHz 1 MHz 10 MHz
Frequency-160-150-140-130-120-110-100-90-80-70-60Spectral Density (dBc/Hz)PFD-referred
noise
S&#934;out,En(f)
VCO-referred
 noise
S&#934;out,vn(f)&#931;&#8722;&#8710;
noise
S&#934;out,&#8710;&#931;(f)fo = 84 kHz fo = 160 kHz</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>M.H. Perrott MIT OCW
A PLL Model Accommodating Divide Value Variations
&#131;See derivation in Perrott et. al., &#8220;A Modeling Approach 
for Sigma-Delta Fractional-N Frequency Synthesizers 
&#8230;&#8221;, JSSC, Aug 2002&#934;div[k]&#934;ref[k] KV
jfv(t) &#934;out(t)
H(f)
1
Nnom
2&#960;z-1
z=ej2&#960;fT 1 - z-1 n[k]T1
&#934;d[k]T
2&#960;e(t)PFD
DividerLoop
Filter C.P. VCO
&#945;Tristate: &#945;=1
XOR: &#945;=2
Icpen(t)f0SEn(f)PFD-referred
Noise
1/T
&#934;vn(t)VCO-referred
Noise
f0S&#934;vn(f)
-20 dB/dec</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>M.H. Perrott MIT OCW
Advantage of Alternate Dual-Loop Architecture
&#131;Issue:  a practical single-sideband mixer implementation 
will produce a spur at frequency w1+ w2
&#131;PLL bandwidth of top synthesizer can be chosen low enough to suppress the single-sideband spur
-Negative:  lower suppression of top VCO noisePFD
NLoop
Filter
DividerVCOref1
PFD
MLoopFilter
DividerVCOref2cos(w 1t)
sin(w 1t)
sin(w 2t)cos(w 2t)out
Single-sideband
Mixery</text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>M.H. Perrott MIT OCW
Example:  Calculate Impact of Ref/Divider Jitter (Step 1)
&#131;Assume jitter is white-i.e., each jitter value independe nt of values at other time 
instants
&#131;Calculate spectra for discrete-time input and output-Apply case (b) calculation&#8710;tjit[k](&#8710;tjit)rms= &#946; sec.
/K32&#960;&#934;jit[k]
TT
/K32&#960;
Tf0S&#934;jit(ej2&#960;fT)
tDiv(t)
&#946;22
</text>
        </slide>
        <slide>
          <slideno>50</slideno>
          <text>M.H. Perrott MIT OCW
Impact of Increased Sigma-Delta Order
&#131;PFD and VCO noise unaffected
&#131;Sigma-Delta noise no longer attenuated by G(f) such 
that a -20 dB/dec slope is achieved above its bandwidth-160-150-140-130-120-110-100-90-80-70-60
FrequencySpectral Density (dBc/Hz)
f0 1/T10 kHz 100 kHz 1 MHz 10 MHzPFD-referred
noise
S&#934;out,En(f)
VCO-referred
 noise
S&#934;out,vn(f)&#931;&#8722;&#8710;
noise
S&#934;out,&#8710;&#931;(f)
-160-150-140-130-120-110-100-90-80-70-60Spectral Density (dBc/Hz)
f0 1/T10 kHz 100 kHz 1 MHz 10 MHzPFD-referred
noise
S&#934;out,En(f)
VCO-referred
 noise
S&#934;out,vn(f)&#931;&#8722;&#8710;
noise
S&#934;out,&#8710;&#931;(f)
Frequencym = 2 m = 3</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>M.H. Perrott MIT OCW
Alternate Dual-Loop Architecture
&#131;Calculation of output frequencyPFD
NLoop
Filter
DividerVCOref1
PFD
MLoopFilter
DividerVCOref2cos(w 1t)
sin(w 1t)
sin(w 2t)cos(w 2t)out
Single-sideband
Mixery
</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>M.H. Perrott MIT OCW
A Common Choice for H(z)
m = 1m = 2m = 3Magnitude 
0
Frequency (Hz)1/(2T)8
76543210
</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>M.H. Perrott MIT OCW
Bandwidth Versus Frequency Resolution
&#131;Frequency resolution set by reference frequency (1/T)-Higher resolution achieved by lowering 1/TPFDLoop
Filter
1.80 1.82GHz(1/T = 20 MHz)ref(t) out(t)
out(t)Sout(f)N[k]
N[k]9091Divider
frequency resolution = 1/T1/T1/TLoop Filter
Bandwidth &lt;&lt; 1/T</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>M.H. Perrott MIT OCW
Cascaded Sigma-Delta Modulator Topologies
&#131;Achieve higher order shaping by cascading low order 
sections and properly combining their outputs
&#131;Advantage over single loop approach-Allows pipelining to be applied to implementation
&#131;High speed or low power applications benefit
&#131;Disadvantages-Relies on precise matching requirements when combining 
outputs (not a problem fo r digital implementations)-Requires multi-bit quantiz er (single loop does not)x[k]
y[k]q1[k]
&#931;&#8710;M1[k]
y1[k]q2[k]
&#931;&#8710;M2[k]
y2[k]&#931;&#8710;M3[k]
y3[k]M 1 1
Digital Cancellation Logic
Multibit
output</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>M.H. Perrott MIT OCW
Example:  First Order Sigma-Delta Modulator
&#131;Choose NTF to be
&#131;Plot of output in time and frequency domains with 
input of
00Amplitude
Magnitude (dB)
Sample Number 200 01
Frequency (Hz) 1/(2T)x[k] u[k]
e[k]y[k]
H(z) - 1
</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>M.H. Perrott MIT OCW
The Problem With Phase Interpolation
&#131;Gain matching between PFD error and scaled D/A 
output must be extremely precise-Any mismatch will lead to spurious tones at PLL output1-bit
M-bitM-bitPFDLoop
Filterref(t)
div(t)out(t)
frac[k]
AccumulatorN/N+1
carry_out[k]e(t)
D/A
residue[k]&#945;</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>M.H. Perrott MIT OCW
Dual-Loop Frequency Synthesizer
&#131;Overall synthesizer output
&#131;From trigonometry:  cos(A-B) = cosAcosB+sinAsinBoutPFD
NLoop
Filter
DividerVCOref1
PFDLoopFilter
DividerVCOref2cos(w 1t)
sin(w 1t)
sin(w 2t)cos(w 2t)
MSingle-sideband
Mixer</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>M.H. Perrott MIT OCW
A Better Dithering Method:  Sigma-Delta Modulation
&#131;Sigma-Delta dithers in a manner such that resulting 
quantization noise is &#8220;shaped&#8221; to high frequenciesM-bit Input 1-bit
D/AAnalog Output
InputQuantization
NoiseDigital Input
SpectrumAnalog Output
SpectrumTime Domain
Frequency Domain
&#931;&#8722;&#8710;Digital  &#931;&#8722;&#8710;
Modulator</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>M.H. Perrott MIT OCW
Classical Fractional-N Synthesizer Architecture
&#131;Use an accumulator to perform dithering operation-Fractional input value fed into accumulator-Carry out bit of accumulator fed into divider1-bitPFDLoop
Filterref(t)
div(t)out(t)
frac[k]
AccumulatorN/N+1
carry_out[k]e(t)
Nsd[k] = N + frac[k]</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>M.H. Perrott MIT OCW
Observations
&#131;Low order Sigma-Delta modulators do not appear to 
produce &#8220;shaped&#8221; noise very well-Reason:  low order feedback does not properly 
&#8220;scramble&#8221; relationship betw een input and quantization 
noise
&#131;Quantization noise, r[ k], fails to be white
&#131;Higher order Sigma-Delta modulators provide much 
better noise shaping with fewer spurs-Reason:  higher order feedback filter provides a much 
more complex interaction between input and quantization noise</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>M.H. Perrott MIT OCW
Example:  Second Order Sigma-Delta Modulator
&#131;Choose NTF to be
&#131;Plot of output in time and frequency domains with 
input ofx[k] u[k]
e[k]y[k]
H(z) - 1
Magnitude (dB)
0 Sample Number 200 0-1Amplitude2
10
Frequency (Hz) 1/(2T)</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>M.H. Perrott MIT OCW
Example:   Cutler Sigma-Delta Topology
&#131;Output is quantized in a multi-level fashion
&#131;Error signal, e[k], represents the quantization error
&#131;Filtered version of quantizat ion error is fed back to 
input-H(z) is typically a highpass filt er whose first tap value is 1
&#131;i.e., H(z) = 1 + a1z-1+ a2z-2L-H(z) &#8211; 1 therefore has a first tap value of 0
&#131;Feedback needs to have del ay to be realizablex[k] u[k]
e[k]y[k]
H(z) - 1</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>M.H. Perrott MIT OCW
Example:  Third Order Sigma-Delta Modulator
&#131;Choose NTF to be
&#131;Plot of output in time and frequency domains with 
input ofx[k] u[k]
e[k]y[k]
H(z) - 1
Magnitude (dB)
00 Sample Number 200Amplitude4
3210
-1
-2-3Frequency (Hz) 1/(2T)</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>M.H. Perrott MIT OCW
The Issue of Noise
&#131;Lower 1/T leads to higher divide value-Increases PFD noise at synthesizer outputPFDLoop
Filter
1.80 1.8002GHz(1/T = 200 kHz)ref(t) out(t)
out(t)Sout(f)N[k]
N[k]90009001Divider
frequency resolution = 1/T1/T1/TLoop Filter
Bandwidth &lt;&lt; 1/T
10020 MHz</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>M.H. Perrott MIT OCW
Fractional-N Synthesizer Signals with N = 4.25
&#131;Divide value set at N = 4 most of the time -Resulting frequency offset causes phase error to 
accumulate-Reset phase error by &#8220;swallowing&#8221; a VCO cycle
&#131;Achieved by dividing by 5 every 4 reference cyclesphase error(t)carry_out(t)
out(t)
div(t)
ref(t)
e(t)</text>
        </slide>
        <slide>
          <slideno>44</slideno>
          <text>M.H. Perrott MIT OCW
Now Consider Impact of Divide Value Variations
&#934;vn(t)
T G(f)
2&#960;z-1
1 - z-1n[k]en(t)
&#934;out(t) &#934;c(t) &#934;d(t)&#934;n(t)&#934;nvco(t) &#934;npfd(t)fo1-G(f)fo
foG(f)/K32&#960;Nnom
z=ej2&#960;fT&#945;T
/K32&#960;&#945;
1
&#921;espur(t)&#934;jit[k]
&#921;cpn(t)
G(f)
n[k] &#934;c(t)
jf1 Fc(t)
Freq.      Phase D/A and FilterAlternate Representation
foNoise
Divide
value
variationf0SEn(f)PFD-referred
Noise
1/TVCO-referred
Noise
f0S&#934;vn(f)
-20 dB/dec</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>M.H. Perrott MIT OCW
Linearized Model of Sigma-Delta Modulator
&#131;Composed of two transfer fu nctions relating input and 
noise to output-Signal transfer function (STF)
&#131;Filters input (gen erally undesirable)-Noise transfer function (NTF)
&#131;Filters (i.e., shapes) noise th at is assumed to be whitex[k] y[k] y[k] x[k]q[k]r[k]
z=ej2&#960;fT
z=ej2&#960;fTNTF
STF
&#931;&#8722;&#8710;Hn(z)
Hs(z)1Sr(ej2&#960;fT)=1
12
Sq(ej2&#960;fT)=    |Hn(ej2&#960;fT)|2 1
12</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Choose top synthesizer to provide coarse tuning and 
bottom synthesizer to provide fine tuning-Choose w1to be high in frequency
&#131;Set ref1to be high to avoid large N            low resolution-Choose w2to be low in frequency
&#131;Allows ref2to be low without large M         high resolutionAdvantage #1:  Avoids Large Divide Values
outPFD
NLoop
Filter
DividerVCOref1
PFDLoopFilter
DividerVCOref2cos(w 1t)
sin(w 1t)
sin(w 2t)cos(w 2t)
MSingle-sideband
Mixer</text>
        </slide>
        <slide>
          <slideno>48</slideno>
          <text>M.H. Perrott MIT OCW
A Well Designed Sigma-Delta Synthesizer
&#131;Order of G(f) is set to equal to the Sigma-Delta order-Sigma-Delta noise falls at -2 0 dB/dec above G(f) bandwidth
&#131;Bandwidth of G(f) is set low enough such that synthesizer 
noise is dominated by intrinsic PFD and VCO noise-160-150-140-130-120-110-100-90-80-70-60
FrequencySpectral Density (dBc/Hz)
f0 1/T10 kHz 100 kHz 1 MHz 10 MHzPFD-referred
noise
S&#934;out,En(f)
VCO-referred
 noise
S&#934;out,vn(f)&#931;&#8722;&#8710;
noise
S&#934;out,&#8710;&#931;(f)fo = 84 kHz</text>
        </slide>
        <slide>
          <slideno>43</slideno>
          <text>M.H. Perrott MIT OCW
&#131;Compute impact on output phase noise of synthesizer-We now apply case (c) calculation
-Note that G(f) = 1 at DC&#934;jit[k]
fofo
G(f)Nnom
&#934;n(t)S&#934;n(f)
Nnom
f
02
TTT1 /K32&#960;
T&#946;22
&#8710;tjit[k](&#8710;tjit)rms= &#946; sec.
/K32&#960;&#934;jit[k]
TT
/K32&#960;
Tf0S&#934;jit(ej2&#960;fT)
tDiv(t)
&#946;22Example:  Calculate Impact of Ref/Divider Jitter (Step 2)
</text>
        </slide>
        <slide>
          <slideno>47</slideno>
          <text>M.H. Perrott MIT OCW
Quantifying the Quantization Noise Impact
&#131;Calculate by simply attaching Sigma-Delta model-We see that quantization noise  is integrated and then 
lowpass filtered before impacting PLL output &#934;vn(t)
T G(f)
2&#960;z-1
1 - z-1n[k] nsd[k] &#934;n[k]En(t)
&#934;out(t) &#934;div(t)&#934;tn,pll(t)fo1-G(f)fo
foG(f)/K32&#960;Nnom
z=ej2&#960;fT&#945;f0f0-20 dB/decSEn(f)
Sq(ej2&#960;fT)S&#934;vn(f)
1/T
f
0
z=ej2&#960;fT
&#931;&#8722;&#8710;q[k]r[k]
NTF
STFHn(z)
Hs(z)Sr(ej2&#960;fT)=1
12PFD-referred
NoiseVCO-referred
Noise
&#931;&#8722;&#8710;
Quantization
Noise</text>
        </slide>
        <slide>
          <slideno>46</slideno>
          <text>M.H. Perrott MIT OCW
Focus on Sigma-Delta Frequency Synthesizer
&#131;Divide value can take on fractional values-Virtually arbitrary r esolution is possible
&#131;PLL dynamics act like lowpass filter to remove much 
of the quantization noiseG(f)
n[k]n[k]
nsd[k]nsd[k]
nsd(t) Fout(t)Fout(t)
D/A and FilterT11/T 1
fo&#931;&#8722;&#8710;
freq=1/T</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>M.H. Perrott MIT OCW
Increasing Resolution in Integer-N Synthesizers
&#131;Use a reference divider to achieve lower 1/T-Leads to a low PLL bandwidth ( &lt; 20 kHz here )PFDLoop
Filter
1.80 1.8002GHz(1/T = 200 kHz)ref(t) out(t)
out(t)Sout(f)N[k]
N[k]90009001Divider
frequency resolution = 1/T1/T1/TLoop Filter
Bandwidth &lt;&lt; 1/T
10020 MHz</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>M.H. Perrott MIT OCW
Bandwidth Constraints for Integer-N Synthesizers
&#131;PFD output has a periodicity of 1/T-1/T = reference frequency
&#131;Loop filter must have a bandwidth &lt;&lt; 1/T-PFD output pulses must be filtered out and average value 
extractedPFDLoop
Filter(1/T = 20 MHz)ref(t) out(t)
N[k]Divider1/TLoop Filter
Bandwidth &lt;&lt; 1/T
Closed loop PLL bandwidth often chosen to be a
factor of ten lower than 1/T</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>M.H. Perrott MIT OCW
Background:  The Need for A Better PLL Model
&#131;Classical PLL model-Predicts impact of PFD and VCO referred noise sources-Does not allow straightforward modeling of impact due 
to divide value variations
&#131;This is a problem when using fractional-N approach&#934;div[k]&#934;ref[k] KV
jfv(t) &#934;out(t)
H(f)
1
N/K32&#960;&#945; e(t)&#934;vn(t) en(t)
IcpVCO-referred
Noise
f0SEn(f)PFD-referred
Noise
1/Tf0S&#934;vn(f)
-20 dB/dec
PFDCharge
PumpLoop
Filter DividerVCO
N[k]</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>6.976
High Speed Communication Circuits and Systems
Lecture 17
Advanced Frequency Synthesizers
Michael Perrott
Massachusetts Institute of Technology
Copyright &#169; 2003 by Michael H. Perrott
</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>M.H. Perrott MIT OCW
Fractional-N Frequency Synthesizers
&#131;Break constraint that divide value be integer-Dither divide value dynamical ly to achieve fractional values-Frequency resolution is now arbitrary regardless of 1/T
&#131;Want high 1/T to allow a high PLL bandwidthDithering
ModulatorPFDLoop
Filter
1.80 1.82GHz(1/T = 20 MHz)ref(t)out(t)
out(t)Sout(f)N[k]Nsd[k]
Nsd[k]
9090
9191
Divider
frequency resolution &lt;&lt; 1/T1/T</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>M.H. Perrott MIT OCW
Warning:  Higher Order Modulators May Still Have Tones
&#131;Quantization noise, r[k], is best whitened when a 
&#8220;sufficiently exciting&#8221; input is  applied to the modulator-Varying input and high order helps to &#8220;scramble&#8221; 
interaction between input and quantization noise
&#131;Worst input for tone generation are DC signals that are 
rational with a low valued denominator-Examples (third order modulator):
Magnitude (dB)
0 Frequency (Hz) 1/(2T)
Magnitude (dB)
0 Frequency (Hz) 1/(2T)x[k] = 0.1 x[k] = 0.1 + 1/1024</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>M.H. Perrott MIT OCW
Pros and Cons of Direct Digital Synthesis
&#131;Advantages-Very fast adjustment of frequency-Very high resolution can be achieved-Highly digital approach
&#131;Disadvantages-Difficult to achieve high frequencies-Difficult to achieve low noise-Power hungry and complexCounter ROM DAC LPFclk
out</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>M.H. Perrott MIT OCW
Hybrid Approach
&#131;Use DDS to create a finely adjustable reference 
frequency
&#131;Use integer-N synthesizer to multiply the DDS output frequency to much higher values
&#131;Issues-Noise of DDS is multiplied by N2
-Complex and power hungryout
Counter ROM DAC LPFclk
PFDLoop
Filter
DividerVCOref
N</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of STF and NTF for MASH topology (Step 1)
&#131;Overall modulator behavior
-STF:  Hs(z) = 1-NTF:  Hn(z) = (1 &#8211; z-1)3x[k]
y[k]r1[k]
&#931;&#8710;M1[k]
y1[k]r2[k]
&#931;&#8710;M2[k]
y2[k]
u[k]&#931;&#8710;M3[k]
y3[k]M 1 1
1-z-1 (1-z-1)2
</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>M.H. Perrott MIT OCW
Modeling PFD Noise Multiplication
&#131;Influence of PFD noise seen in model from Lecture 16-PFD spectral density multiplied by N2before influencing PLL 
output phase noise&#934;vn(t) en(t)
&#934;out(t) &#934;c(t)&#934;n(t)&#934;nvco(t) &#934;npfd(t)fo1-G(f)foG(f)/K32&#960;N&#945;VCO-referred
Noise
f0SEn(f)PFD-referred
Noise
1/Tf0S&#934;vn(f)
-20 dB/dec
Divider Control
of Frequency Setting
(assume noiseless for now)Sen(f)/K32&#960;N&#945;2Radians2/Hz
S&#934;vn(f)
f
(fo)opt0Radians2/HzS&#934;npfd(f)
S&#934;nvco(f)
f
(fo)opt0
High divide values         high phase noise at low frequencies</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>M.H. Perrott MIT OCW
The Issue of Spurious Tones
&#131;PFD error is periodic-Note that actual PFD waveform is series of pulses &#8211; the 
sawtooth waveform represents pul se width values over time
&#131;Periodic error signal creates spurious tones in synthesizer 
output-Ruins noise performance of synthesizer1-bitPFDLoop
Filterref(t)
div(t)out(t)
frac[k]
AccumulatorN/N+1
carry_out[k]e(t)
Nsd[k] = N + frac[k]</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>M.H. Perrott MIT OCW
Linearized Model of Cutler Topology
&#131;Represent quantizer block as a summing junction in 
which r[k] represents quantization error-Note:
&#131;It is assumed that r[k] ha s statistics similar to white 
noise-This is a key assumption for modeling &#8211; often not true!x[k] u[k]
e[k]y[k]
H(z) - 1x[k] u[k]r[k]
e[k]y[k]
H(z) - 1
</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>M.H. Perrott MIT OCW
Calculation of STF and NTF for MASH topology (Step 1)
&#131;Individual output signals of each first order modulator
&#131;Addition of filtered outputsx[k]
y[k]r1[k]
&#931;&#8710;M1[k]
y1[k]r2[k]
&#931;&#8710;M2[k]
y2[k]
u[k]&#931;&#8710;M3[k]
y3[k]M 1 1
1-z-1 (1-z-1)2
</text>
        </slide>
      </slides>
    </lecture>
    <videos>
      <video>
        <video_url/>
        <video_title/>
        <transcript>
          <slice>
            <text_slice/>
            <time_slice/>
          </slice>
        </transcript>
      </video>
    </videos>
  </lectures>
</doc>
