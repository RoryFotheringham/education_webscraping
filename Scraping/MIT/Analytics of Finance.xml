<doc>
  <source>MIT</source>
  <date>28/01/2023</date>
  <course>
    <course_url>https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/</course_url>
    <course_title>Analytics of Finance</course_title>
    <course_tags>
      <list>Mathematics </list>
      <list>Probability and Statistics </list>
      <list>Economics </list>
    </course_tags>
  </course>
  <lectures>
    <lecture>
      <lecture_title>Review: DP and econometrics</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/resources/mit15_450f10_review02/</lecture_pdf_url>
      <lectureno>12</lectureno>
      <slides>
        <slide>
          <slideno>8</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
Parameter Estimation 
MLE 
MLE tells us that a par ticular choice of moments w ould w ork and w ould
produce the most precise estimates .
For IID obser vations , MLE prescr ibes estimating par ameters as 
= arg max E[ln p(xt , )] 
 
In moment f orm, this implies 
T  ln p(x, ) = 0  t=1 
MLE is a special case of GMM with a particular choice of moments , based on 
the pdf . 
c Leonid K ogan ( MIT , Sloan ) Review: Part II 15.450, F all 2010 9 / 22</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
Boostr ap Condence Inter vals
Basic bootstr ap condence inter val. Nonpar ametr ic approach in IID samples . 
For non-IID samples , use par ametr ic bootstr ap. 
c Leonid K ogan ( MIT , Sloan ) Review: Part II 15.450, F all 2010 21 / 22</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
Bootstr ap: Gener al Principle
Bootstr ap is a re-sampling method which can be used to e valuate proper ties 
of statistical estimators . 
Bootstr ap is eff ectively a Monte Car lo study which uses the empir ical
distribution as if it w ere the tr ue distr ibution.
Key applications of bootstr ap methodology: 
Evaluate distr ibutional proper ties of complicated estimators , perf orm bias 
adjustment; 
Impro ve the precision of asymptotic appro ximations in small samples 
(condence inter vals, test rejection regions , etc.) 
Bootstr ap bias correction (e .g., predictiv e reg ressions): 
E  0  ER   
c Leonid K ogan ( MIT , Sloan ) Review: Part II 15.450, F all 2010 20 / 22</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>MIT OpenCourseWare
http://ocw.mit.edu 
15.450 Analytics of Finance 
Fall 2010 
For information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms .</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
Review: DP and Econometr ics 
Leonid K ogan 
MIT, Sloan 
15.450, F all 2010
 Leonid K ogan ( MIT , Sloan ) Review: Part II 15.450, F all 2010 1 / 22
 c</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
MLE f or Dependent Obser vations 
MLE approach w orks even if obser vations are dependent. 
Consider a time ser ies x t , xt+1, ... and assume that the distr ibution of x t+1 
depends only on L lags: xt , ..., xt+1L. 
Log lik elihood conditional on the rst L obser vations: 
T 1
= arg max L() = arg max ln p(xt+1|xt , ..., xt+1L; ) 
  t=L 
AR(p) (AutoReg ressiv e) time ser ies model with IID Gaussian errors: 
IID xt+1 = a0 + a1xt + ...apxt+1p + t+1, t+1 N(0, 2) 
Constr uct log lik elihood: 
 (xt+1  a0  a1xt  ...apxt+1p)2 
L() = T 1
 ln 
22  22 
t=p 
c Leonid K ogan ( MIT , Sloan ) Review: Part II 15.450, F all 2010 10 / 22</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
GMM Standard Errors 
Dependent obser vations 
The relation 
1  1  1 1 
Var[]= d1Sd = dS1d
T T 
is still v alid. But need to modify the estimate S . 
In an innite sample , 

S = E [f (xt , 0)f (xtj , 0)] 
j= 
Newey-West procedure f or computing standard errors prescr ibes 
k T k  |j| 1  
S= f (xt , )f (xtj , ) (Drop out-of-r ange ter ms) kT j=k t=1 
Of special impor tance: OLS with Ne wey-West errors . 
c Leonid K ogan ( MIT , Sloan ) Review: Part II 15.450, F all 2010 18 / 22</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
Portfolio Choice: Static Approach
In models in which all options are redundant (e .g., Blac k-Scholes), dynamic 
portfolio choice is relativ ely easy . 
Solve a static prob lem: 
Find the best state contingent pa yoff (under giv en utility) which is 
budget-f easib le. 
Replicate the chosen pa yoff using dynamic tr ading in a vailab le assets . 
Mertons solution: CRRA utility with r isk aversion , Blac k-Scholes model: 
   r = t 2 
Myopic por tfolio is optimal. 
c Leonid K ogan ( MIT , Sloan ) Review: Part II 15.450, F all 2010 4 / 22</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
Additional Results
Delta method: distribution of h () is appro ximately 
h()  
h()N (h(), V (h)) , V (h)= V () 
 
Hypothesis testing: constr uct a 2 test of the h ypothesis h ()= 0 
Derive the v ar-co v of h (), V (h). 
Constr uct the test statistic 
 = h()V (h)1h()  2(dim h()) 
Model selection: pick an order of the AR(p) model using an AIC or BIC 
criterion. 
c Leonid K ogan ( MIT , Sloan ) Review: Part II 15.450, F all 2010 19 / 22</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
DP
Dynamic prog ramming pr inciple . 
Bellman equation. 
Controlled Mar kov processes . Prob lem f ormulation. 
Key examples: portfolio choice with time-v arying moments of retur ns; 
Amer ican option pr icing. 
c Leonid K ogan ( MIT , Sloan ) Review: Part II 15.450, F all 2010 6 / 22</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
Example: Interest Rate Model 
Iterated e xpectations 
Interest r ate model:
rt+1 = a0 + a1rt + t+1, E(t+1|rt )= 0, E(2 
t+1|rt )= b0 + b1rt
GMM with moment conditions der ived using iter ated e xpectations 
E [(rt+1  a0  a1rt )  1]= 0 
E [(rt+1  a0  a1rt )  rt ]= 0 
E (rt+1  a0  a1rt )2  b0  b1rt  1 = 0 
E (rt+1  a0  a1rt )2  b0  b1rt  rt = 0 
(a0, a1) can be estimated from the rst pair of moment conditions . Equiv alent 
to OLS , ignore inf ormation about second moment. 
c Leonid K ogan ( MIT , Sloan ) Review: Part II 15.450, F all 2010 13 / 22</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
Outline 
1 
2 Dynamic P ortfolio Choice 
Financial Econometr ics 
c Leonid K ogan ( MIT , Sloan ) Review: Part II 15.450, F all 2010 7 / 22</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
Outline
1 
2 Dynamic P ortfolio Choice 
Financial Econometr ics 
c Leonid K ogan ( MIT , Sloan ) Review: Part II 15.450, F all 2010 2 / 22</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
Parameter Estimation 
QMLE 
QMLE helps f ormulate moment conditions when the e xact f orm of the pdf is 
not kno wn. 
Pretend that errors are Gaussian and use MLE to f orm moment restr ictions . 
Make sure that the moment restr ictions w e have der ived are v alid, based on 
what w e kno w about the model. 
Intuition: we ma y only need limited inf ormation, e .g., a couple of moments , to 
estimate the par ameters . No need to kno w the entire distr ibution. 
QMLE is a v alid (consistent) approach, less precise than MLE b ut more
robust.
c Leonid K ogan ( MIT , Sloan ) Review: Part II 15.450, F all 2010 12 / 22</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
Outline 
1 
2 Dynamic P ortfolio Choice 
Financial Econometr ics 
c Leonid K ogan ( MIT , Sloan ) Review: Part II 15.450, F all 2010 3 / 22</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
GMM Standard Errors 
IID Obser vations 
Under mild regular ity conditions , GMM estimates are consistent: 
asymptotically , as the sample siz e T approaches innity , 0 (in
probability). 
Dene 
d= E(f (xt , ))  
, S= E[f (xt , )f (xt , )]
  

GMM estimates are asymptotically nor mal: 

T ( 0)  N  
0,  
dS1d1  
Standard errors are based on the asymptotic v ar-co v matr ix of the estimates , 
1 
T Var[]= dS1d
c Leonid K ogan ( MIT , Sloan ) Review: Part II 15.450, F all 2010 15 / 22</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
Example: Interest Rate Model 
QMLE 
Treat t as Gaussian N(0, b0 + b1rt1). 
Constr uct log lik elihood: 
T 1  (rt+1  a0  a1rt )2 
L() =  ln 2(b0 + b1rt ) 2(b0 + b1rt )t=1 
(a0, a1) can no longer be estimated separ ately from (b0, b1). 
Optimality conditions f or (a0, a1): 
T 1 (rt+1  a0  a1rt )(1, rt ) = 0b0 + b1rtt=1 
This is no longer OLS , but GLS . More precise estimates of (a0, a1). 
Down-w eight residuals with high v ariance . 
c Review: Part II 14 / 22  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
Parameter Estimation 
GMM 
Estimate par ameters using moment restr ictions . 
If the tr ue distr ibution satises 
E[f (xt , 0)] = 0, E[f (xt , )] = 0 if  = 0 
estimate 0 using a sample analog of the population moments 
1 T
E[f (xt , )]  f (xt , )= 0T t=1 
Which moments to choose f or estimation? 
c Leonid K ogan ( MIT , Sloan ) Review: Part II 15.450, F all 2010 8 / 22</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>Dynamic P ortfolio Choice Financial Econometr ics 
Parameter Estimation 
Iterated e xpectations 
Another approach to f orming moment conditions is to use iter ated
expectations .
For example , consider a linear model 
yt = b0 + b1xt + t 
Assume that
E[t |xt ]= 0
Using iter ated e xpectations , we can f orm tw o moments 
E[(yt  b0  b1xt )  1]= 0
E[(yt  b0  b1xt )  xt ]= 0
Reco ver standard OLS f ormulas. 
t could be heteroscedastic , our estimator is still v alid since our moment 
restrictions are v alid. 
c Review: Part II 11 / 22  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
      </slides>
      <videos/>
    </lecture>
    <lecture>
      <lecture_title>Dynamic portfolio choice III: Numerical approximations in dynamic programming
Code: Numerical DP solution</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/resources/mit15_450f10_lec06/</lecture_pdf_url>
      <lectureno>6</lectureno>
      <slides>
        <slide>
          <slideno>5</slideno>
          <text>Numer ical Appro ximation 
Discretizing dynamics 
We want to replace the or iginal prob lem with a discrete prob lem amenab le to 
numer ical analysis . 
Instead of the or iginal process f or the state v ector , we introduce a
discrete-v alue controlled Mar kov chain.
Replace the spread process X t with a discrete Mar kov chain Xt jumping 
betw een g rid points 
X(1), X(2), ..., X(NX ) 
Same f or the por tfolio v alue process: Wt is a discrete process with v alues 
W (1), W (2), ..., W (NW ) 
Assume an equally spaced rectangular g rid for Xand W . 
Need to der ive transition probabilities on the g rid to appro ximate the
distribution of the or iginal state v ector .
Transition probabilities depend on the control t : the discrete process is a 
controlled Mar kov chain. 
 Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice III 15.450, F all 2010 6 / 14 c</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>Predictability and Margin Constr aints 
DP formulation 
The state v ector is 
Yt =(Wt , Xt ) 
Yt is a controlled Mar kov process with control t : 
Wt+1 = Wt + t (Xt+1  Xt ) 
IIDXt+1 = Xt + t+1, t+1 N(0, 1) 
The Bellman equation tak es form
J(t, Wt , Xt )= max Et [J(t + 1, Wt+1, Xt+1)]
t :|t |m1Wt 
We look f or the v alue function J (t, Wt , Xt ) satisfying the ter minal condition 
J(T , WT , XT )=eWT 
 Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice III 15.450, F all 2010 5 / 14 c</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>Numer ical Appro ximation 
Discrete Bellman equation 
As a result of our discretization approach, w e obtain tr ansition probabilities 
on the g rid which depend on the chosen control : 
P ((i, j), (i , j )|) 
Transition from (X(i), W (j)) to (X(i ), W (j )). 
We discretiz e the possib le values of the control (the tr ade siz e). Impose the 
margin constr aint so that 
t  1 1 
Wt  (1), ..., (N) , (1)= m , (N)= m 
The Bellman equation f or the discrete prob lem tak es form 
  J(t, Wt , Xt )= max EtJ(t + 1, Wt+1, Xt+1) 
t 
where the conditional e xpectation is computed using the tr ansition 
probabilities P (i, j), (i , j )|t . 
 Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice III 15.450, F all 2010 11 / 14 c</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>Numer ical Appro ximation 
Discretizing dynamics 
Xt  Xt+1 
W
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice III 15.450, F all 2010 7 / 14</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>Numer ical Appro ximation 
Discretizing dynamics 
The tr ansition probabilities f or Xt are dened as
p(i, i )= Np
X (i, 
pi 
(
i) 
, k)k=1 
To dene tr ansition probabilities f or W , note that f or a gener ic choice of , 
W = W (j)+ (i   i)X 
would not be on the W -grid. 
We emplo y randomization to replace tr ansition to W with a tr ansition to one 
of the tw o points , W(k) or W(k + 1), such that  W &lt;  W (k) &lt;  W (k + 1). 
Set the tr ansition probability to W (k + 1) equal to 
 W (k) W  
p(i, i ) ,  =  W (k) W (k + 1) 
Note that  W (k)=  W (k + 1)+(1  ) W . 
 Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice III 15.450, F all 2010 9 / 14 c</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>Numer ical Appro ximation 
Discretizing dynamics 
We need to handle the possibility that
If it happens thatIfW WN,wereplace W with WN.This isequiv alent to () () &gt; W W 
 extrapolating thevalue function totherightof 
W falls outside of the r ange of the 
W (NW ) as equal to its v alue at 
W (NW ). 
W &lt; 0, we set the v alue function at (t + 1,W ,Xt+1) to W -grid. 
eW 
The reason is that the tr ader is loc ked out of the mar ket after reaching 
negativ e por tfolio v alue le vels, and w e kno w the v alue function f ollowing such 
an event e xplicitly . 
 Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice III 15.450, F all 2010 10 / 14 c</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>Numer ical Appro ximation 
Discretizing dynamics 
Consider rst the spread process X t . We want to appro ximate it with a 
discrete Mar kov chain Xt with tr ansition probabilities p (i, i ) betw een g rid 
points i and i : 
p(i, i )= Prob(Xt+1 = X(i )|Xt = X(i)) 
The tr ansition density of the or iginal process X t is giv en by 
1  (Xt+1 Xt )2 
f (Xt+1|Xt )= e 22 
22 
Let F (Xt+1|Xt ) denote the corresponding CDF . 
Let X be the spacing of the X -grid. 
We rst dene the unnor maliz ed transition probabilities f or Xt as 
fX(i )|X(i) X , i  = 2, ..., NX  1 
FX(1)+ X /2 | X(i) 
 
 p(i, i )= , i  = 1 
1  FX(NX ) X /2 | X(i) , i  = NX 
 Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice III 15.450, F all 2010 8 / 14 c</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>Numer ical Appro ximation 
Results 
For a x ed W , plot the (smoothed) optimal por tfolio policy as a function of the 
price spread X at 1, 12, 36, and 60 months left until T . 
Note ho w the optimal in vestment str ategy depends on the hor izon. 
0.50.40.30.20.1 00.10.20.30.40.554321012345
Price Spread (X)Optimal Policy ( *)W = 1
   
 1  
 12 
 36 
 60
 Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice III 15.450, F all 2010 14 / 14 c</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>Predictability and Margin Constr aints 
Prob lem f ormulation 
Portfolio v alue W t changes according to 
Wt+1 = Wt + t (Xt+1  Xt ) 
Trader maximiz es a m ulti-per iod objectiv e 
E0 eWT 
If the por tfolio v alue e ver becomes negativ e, the tr ader is loc ked out from the 
market, since the margin constr aint 
1 |t |  Wt m 
excludes fur ther tr ades . 
We formulate the prob lem as a dynamic prog ram and solv e it n umer ically . 
 Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice III 15.450, F all 2010 4 / 14 c</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>Numer ical Appro ximation 
Results 
Value function at t = 0 
00.511.52
0.500.510.90.80.70.60.50.40.30.20.10
Portfolio Value (W)Price Spread (X)
Value Function (J)
 Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice III 15.450, F all 2010 13 / 14 c</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>MIT OpenCourseWare
http://ocw.mit.edu 
15.450 Analytics of Finance 
Fall 2010 
For information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms .</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>Numer ical Appro ximation 
Parameters 
Assume the f ollowing par ameters f or numer ical analysis
 4
m 0.25 
 exp(0.5t) 
 0.10
t 
t 1/12 
T 5 
Time per iod t corresponds to monthly rebalanci ng of the por tfolio. 
Prob lem hor izon T is ve years. 
 Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice III 15.450, F all 2010 12 / 14 c</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>Dynamic P ortfolio Choice III 
Numer ical Appro ximations in Dynamic Prog ramming 
Leonid K ogan 
MIT, Sloan 
15.450, F all 2010
 Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice III 15.450, F all 2010 1 / 14
 c</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>Overview
Appro ximate the prob lem with contin uous state space using the one with 
nite state space . 
Finite state space DP prob lems are easy to implement n umer ically . 
Many ways to discretiz e a prob lem. 
We focus on a par ticular approach that is gener al and easy to implement. 
Develop and illustr ate the method in the conte xt of a par ticular application: 
portfolio optimization with retur n predictability and margin constr aints . 
 Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice III 15.450, F all 2010 2 / 14 c</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>Predictability and Margin Constr aints 
Prob lem f ormulation 
Suppose w e obser ve a pr ice spread betw een tw o assets X t following an 
AR(1) process 
IIDXt+1 = Xt + t+1, 0 &lt;&lt; 1, t+1 N(0, 1) 
We would like to design a trading strategy taking advantage of the predictab le 
spread uctuations . 
Assume that the interest r ate is z ero. 
A unit tr ade siz e gener ates P&amp;L change of X t+1  Xt . 
t is the notional position siz e at time t . 
The tr ader star ts with W 0 dollars . 
Assume that the margin constr aints are such that f or every dollar of the 
absolute tr ade siz e, m &gt; 0 dollars m ust be in vested in the r isk-free asset. 
Thus , the tr ade siz e is constr ained b y 
1 |t |  Wt m 
 Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice III 15.450, F all 2010 3 / 14 c</text>
        </slide>
      </slides>
      <videos/>
    </lecture>
    <lecture>
      <lecture_title>Review: Arbitrage-free pricing and stochastic calculus</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/resources/mit15_450f10_review01/</lecture_pdf_url>
      <lectureno>11</lectureno>
      <slides>
        <slide>
          <slideno>0</slideno>
          <text>Review: Arbitr age-F ree Pr icing and Stochastic
Calculus
Leonid K ogan 
MIT, Sloan 
15.450, F all 2010
 Leonid K ogan ( MIT , Sloan ) Review: Part I 15.450, F all 2010 1 / 15
 c</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>Pricing by Replication: Limitations
In many models one cannot derive a unique price for a derivative.
Term structure models, stochastic volatility.
Price assets relative to each other. Replication argument combined with
assumptions on prices of risk.
Alternatively, specify dynamics directly under Q.
c&#13;Leonid Kogan ( MIT, Sloan ) Review: Part I 15.450, Fall 2010 10 / 15</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>Problem
Consider a 3-period model with t=0,1,2,3. There are a stock and a
isk-free asset. The initial stock price is $4 and the stock price doubles with
robability 2=3 and drops to one-half with probability 1 =3 each period. The
isk-free rate is 1=4.r
p
r
1Compute the risk-neutral probability at each node.
Compute the Radon-Nikodym derivative (d Q=dP) of the risk-neutral measure
with respect to the physical measure at each node.
Compute the state-price density at each node.
Compare two assets, both with cash ows only at time 1. One pays (2,1)in up
and down nodes, the other pays (3,0). Which one has higher risk premium?
2
3
4
c&#13;Leonid Kogan ( MIT, Sloan ) Review: Part I 15.450, Fall 2010 3 / 15</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>Monte Carlo Simulation
Random number generation: inverse transform, acceptance-rejection
method.
Variance reduction: antithetic variates, control variates.
Intuition behind control variates: carve out the part of the estimated moment
that is known in closed form, no need to estimate that by Monte Carlo.
Good control variates: highly correlated with the variable of interest,
expectation known in closed form.
Examples of control variates: stock price, payoff of similar option, etc.
c&#13;Leonid Kogan ( MIT, Sloan ) Review: Part I 15.450, Fall 2010 15 / 15</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>MIT OpenCourseWare
http://ocw.mit.edu 
15.450 Analytics of Finance 
Fall 2010 
For information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms .</text>
        </slide>
      </slides>
      <videos/>
    </lecture>
    <lecture>
      <lecture_title>Simulation methods
Code: Black-Scholes model Monte Carlo illustration
Code: Black-Scholes with a jump Monte Carlo (PS1, Q2)
Code: Monte Carlo with control variates, stochastic volatility model</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/resources/mit15_450f10_lec03/</lecture_pdf_url>
      <lectureno>3</lectureno>
      <slides>
        <slide>
          <slideno>6</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
The In verse T ransform Method
Consider a r andom v ariable X with a contin uous , strictly increasing CDF 
function F (x). 
We can sim ulate X according to
X = F 1(U), U  Unif [0, 1]
This w orks, because
Prob(X  x)= Prob(F 1(U)  x)= Prob(U  F (x)) = F (x)
If F (x) has jumps , or at sections , gener alize the abo ve rule to
X = min (x : F (x)  U)
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 7 / 35</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Antithetic V ariates 
When do the y work best? 
Suppose that f is a monotonically increasing function. Then 
Cov[f (X ), f (X )] &lt; 0 
and the antithetic v ariates reduce sim ulation v ariance . By ho w much? 
Dene 
f0(X ) = f (X ) + f (X ) 
2 , f1(X ) = f (X )  f (X ) 
2 
f0(X ) and f 1(X ) are uncorrelated: 
1E[f0(X )f1(X )] = E[f 2(X ) f 2(X )] = 0 = E[f0(X )]E[f1(X )]4 
Conclude that 
Var[f (X )] = Var[f0(X )] + Var[f1(X )] 
If f (X ) is linear , Var[f0(X )] = 0, and antithetic v ariates eliminate all v ariance! 
Antithetics are more eff ective when f (X ) is close to linear . 
c Simulation Methods 17 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
The In verse T ransform Method 
Example: Exponential Distr ibution 
Consider an e xponentially-distr ibuted r andom v ariable, char acter ized by a 
CDF 
F (x)= 1  ex/ 
Exponential distr ibutions often ar ise in credit models . 
Compute F 1(u) 
u = 1  ex/ X = ln(1  U)   ln U  
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 8 / 35</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Quasi-Monte Car lo
We focus on gener ating a d -dimensional sequence of lo w-discrepancy points 
lling a d -dimensional h ypercube , [0, 1)d . 
QMC is a substitute f or draws from d -dimensional unif orm distr ibution. 
As discussed, all distr ibutions can be obtained from Unif [0, 1] using the
inverse tr ansform method.
There are man y algor ithms f or producing lo w-discrepancy sequences . In 
nancial applications , Sobol sequences ha ve sho wn good perf ormance . 
In practice , due to the nature of Sobol sequences , it is recommended to use 
N = 2k (integer k ) points in the sequence . 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 30 / 35</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Overview
Simulation methods (Monte Car lo) can be used f or option pr icing, r isk 
management, econometr ics, etc. 
Naive Monte Car lo ma y be too slo w in some pr actical situations . Many 
special techniques f or variance reduction: antithetic v ariables, control 
variates , stratied sampling, impor tance sampling, etc. 
Recent de velopments: Quasi-Monte Car lo (lo w discrepancy sequences). 
 Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 3 / 35 c</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Hedges as Control V ariates 
Example 
 0.1 0.2 0.3 0.4 0.5 
2 0.9944 0.9896 0.9799 0.9618 0.9512 
Naive Monte Car lo 
C
S.E.(C)
C
S.E.(C)
2.7102 2.6836 2.5027 2.5505 2.4834 
0.0559 0.0537 0.0506 0.0504 0.0483 
Control v ariates 
2.7508 2.6908 2.6278 2.5544 2.4794 
0.0042 0.0056 0.0071 0.0088 0.0107 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 27 / 35</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Control V ariates 
Suppose w e want to estimate the e xpected v alue E [Y ]. 
On each replication, gener ate another v ariable, Xi . Thus , draw a sequence of 
pairs (Xi , Yi ). 
Assume that E [X ] is kno wn. How can w e use this inf ormation to reduce the 
variance of our estimate of E [Y ]? 
Dene
Yi (b)= Yi  b(Xi  E[X ])
Note that E[Yi (b)] = E[Yi ], so N 1 
iN 
=1 Yi (b) is an unbiased estimator of E[Y ]. 
Can choose b to minimiz e variance of Y i (b): 
Var[Yi (b)] = Var[Y ] 2b Cov[X , Y ]+ b2 Var[X ] 
Optimal choice b is the OLS coefcient in reg ression of Y on X : 
b Cov[X , Y ] = Var[X ] 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 19 / 35</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Quasi-Monte Car lo 
Randomization 
Two independent r andomizations using 256 points from a 2-dimensional Sobol 
sequence 
MATLAB Code 
        
00.10.20.30.40.50.60.70.80.9100.10.20.30.40.50.60.70.80.91 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 33 / 35</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Quasi-Monte Car lo 
Illustr ation 
256 points from a 2-dimensional Sobol sequence 
MATLAB Code 
        
00.10.20.30.40.50.60.70.80.9100.10.20.30.40.50.60.70.80.91 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 31 / 35</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Quasi-Monte Car lo 
Randomization 
Low-discrepancy sequence can be r andomiz ed to produce independent
draws.
1Each independent draw of N points yields an unbiased estimate of 0 f (x) dx. 
By using K independent dr aws, each containing N points , we can constr uct 
condence inter vals. 
Since r andomizations are independent, standard Nor mal appro ximation can 
be used f or condence inter vals. 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 32 / 35</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Control V ariates
The idea behind the control v ariates approach is to decompose the unkno wn 
expectation E [Y ] into the par t kno wn in closed f orm, and the par t that needs 
to be estimated b y sim ulation. 
There is no need to use sim ulation f or the par t kno wn explicitly . The v ariance 
of the remainder ma y be m uch smaller than the v ariance of Y . 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 18 / 35</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Control V ariates 
Example: Pricing a European Call Option 
Suppose w e want to pr ice a European call option using sim ulation. 
Assume constant interest r ate r . Under the r isk-neutr al probability Q, w e 
need to e valuate  
EQ 
0 erT max(0, ST  K )
The stoc k price itself is a natur al control v ariate. Assuming no dividends , 
EQ 
0 erT ST = S0 
Consider the Blac k-Scholes setting with 
r = 0.05,  = 0.3, S0 = 50, T = 0.25 
Evaluate correlation betw een the option pa yoff and the stoc k price for 
different v alues of K . 2 is the percentage of v ariance eliminated b y the 
control v ariate. 
c Simulation Methods 21 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Quasi-Monte Car lo 
Overview 
Quasi-Monte Car lo, or lo w-discrepancy methods present an alter nativ e to
Monte Car lo sim ulation.
Instead of probability theor y, QMC is based on n umber theor y and algebr a.
1Consider a prob lem of integ rating a function, 0 f (x) dx. 
Monte Car lo approach prescr ibes sim ulating N draws of a r andom v ariable 
X  Unif [0, 1] and appro ximating 
1 N1  
f (x) dx  f (Xi )N0 i=1 
QMC gener ates a deter ministic sequence X i , and appro ximates
1 N
1  
0 f (x) dx  Ni=1 f (Xi ) 
Monte Car lo error declines with sample siz e as O (1/
N). QMC error 
declines almost as f ast as O (1/N). 
c Simulation Methods 29 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>1
2
3Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
The Acceptance-Rejection Method
Gener ate samples with probability density f (x). 
The acceptance-rejection (A-R) method can be used f or multivariate
problems as w ell.
Suppose w e kno w ho w to gener ate samples from the distr ibution with pdf 
g(x), s.t.,
f (x)  cg(x), c &gt; 1
Follow the algor ithm
Gener ate X from the distr ibution g (x);
Gener ate U from Unif [0, 1];
If U  f (X )/[cg(X)], retur n X ;
otherwise go to Step 1.
Probability of acceptance on each attempt is 1 /c. Want c close to 1. 
See the Appendix f or der ivations . 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 10 / 35</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Outline
1 
2 
3 Gener ating Random Numbers 
Variance Reduction 
Quasi-Monte Car lo 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 28 / 35</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>1
2
 Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Control V ariates
The higher the R2 in the reg ression of Y on X , the larger the v ariance 
reduction. 
Denoting the correlation betw een X and Y by XY , nd
 N 
Var N 1 
i=1 Yi (b) 
 N  = 1  2 
XY 
Var N 1 
i=1 Yi 
In practice , b is not kno wn, b ut is easy to estimate using OLS . 
Two-stage approach: 
Simulate N 0 pairs of (Xi , Yi ) and use them to estimate b . 
Simulate N more pairs and estimate E [Y ] as 
1 N
Yi  b(Xi  E[X])N i=1 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 20 / 35</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Gener ating Random Numbers
Pseudo r andom n umber gener ators produce deter ministic sequences of 
numbers that appear stochastic , and match closely the desired probability 
distribution. 
For some standard distr ibutions , e.g., unif orm and Nor mal, MATLAB
provides built-in r andom n umber gener ators .
Sometimes it is necessar y to simulate from other distributions , not covered by 
the standard softw are. Then apply one of the basic methods f or gener ating 
random v ariables from a specied distr ibution. 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 6 / 35</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Variance reduction
Suppose w e have sim ulated N independent dr aws from the distr ibution f (x).
How accur ate is our estimate of the e xpected v alue E [f (X )]?
Using the CL T, constr uct the 100 (1  )% condence inter val
  
N   z1/ 2, N +  z1/ 2 , 
N 
N 
 2 
2 = 1 N 
f (Xi ) NN i=1 
where z 1/ 2 is the (1  /2) percentile of the standard Nor mal distr ibution. 
For a x ed number of sim ulations N , the length of the inter val is propor tional
to .
The n umber of sim ulations required to achie ve desired accur acy is
propor tional to the standard de viation of f (Xi ), .
The idea of v ariance reduction: replace the or iginal prob lem with another
simulation prob lem, with the same ans wer but smaller v ariance!
c Simulation Methods 14 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
The Basic Prob lem 
Consider the basic prob lem of computing an e xpectation
 = E[f (X )], X  pdf (X )
Monte Car lo sim ulation approach species gener ating N independent dr aws 
from the distr ibution pdf (X ), X1, X2, ..., XN , and appro ximating 
1 N
E[f (X )]  N  Nf (Xi ) 
i=1 
By La w of Large Numbers , the appro ximation N converges to the tr ue value 
as N increases to innity . 
Monte Car lo estimate N is unbiased: 
E N =  
By Centr al Limit Theorem, 

N N   N(0, 1), 2 = Var[f (X )]  
 Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 4 / 35 c</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Antithetic V ariates
Attempt to reduce v ariance b y introducing negativ e dependence betw een 
pairs of replications . 
Suppose w ant to estimate 
 = E[f (X )], pdf (X )= pdf (X ) 
Note that   f (X )+ f (X )X  pdf (X ) E = E[f (X )]  2 
Dene Y i =[f (Xi )+ f (Xi )]/2 and compute 
N
AV 
N 1  
Yi = N i=1 
Note that Y i are IID , and b y CLT, 
N
N AV  E[f (X )] N(0, 1), AV =  
Var[Yi ]AV  
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 15 / 35</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Hedges as Control V ariates 
Example 
Consider a model of stoc k retur ns with stochastic v olatility under the 
risk-neutr al probability measure 
v(i)
QS((i + 1))= S(i) exp (r  v(i)/2) + i+1 
v((i + 1))= v(i) (v(i) v) +  v(i)uQ 
i+1 
Q 
i IID N(0, 1), uQ 
i IID N(0, 1), corr(Q 
i , uQ 
i )=  
Price a European call option under the par ameters 
r = 0.05, T = 0.5, S0 = 50, K = 55,  = 0.01 
v0 = 0.09, v = 0.09,  = 2,  =0.5,  = 0.1, 0.2, 0.3, 0.4, 0.5 
Perform 10,000 sim ulations to estimate the option pr ice. Repor t the fr action 
of variance eliminated b y the control v ariate. 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 26 / 35</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>Generating Random Numbers Variance Reduction Quasi-Monte Carlo 
The Acceptance-Rejection Method 
Example: Beta Distribution 
Source: Glasserman 2004, Figure 2.8 
c Leonid Kogan ( MIT, Sloan ) Simulation Methods 15.450, Fall 2010 12 / 35
Accept U1 if cU2 in this rangef (U 1)
Illustration of the acceptance-rejection method using uniformly distributed candidates.c
U1 0 1
Image  by MIT OpenCourseWare.</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Readings
Campbell, Lo, MacKinla y, 1997, Section 9.4. 
Boyle, P., M. Broadie , P. Glasser man, 1997, Monte Car lo methods f or 
secur ity pr icing,  Jour nal of Economic Dynamics and Control, 21, 1267-1321. 
Glasser man, P., 2004, Monte Carlo Methods in Financial Engineer ing,
Springer , New York. Sections 2.2, 4.1, 4.2, 7.1, 7.2.
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 34 / 35</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Antithetic V ariates 
When are the y useful? 
Assume that the computational cost of computing Y i is roughly twice that of 
computing f (Xi ). 
Antithetic v ariates are useful if 
Var[AV 
N ] &lt; Var 21 
N 2N
f (Xi ) 
i=1 
using the IID proper ty of Yi , as well as Xi , the above condition is equiv alent to 
1Var[Yi ] &lt; Var[f (Xi )]2 
4Var[Yi ]=Var [f (Xi )+ f (Xi )] = 
Var[f (Xi )] + Var[f (Xi )] + 2Cov[f (Xi ), f (Xi )] = 
2Var[f (Xi )] + 2Cov[f (Xi ), f (Xi )] 
Antithetic v ariates reduce v ariance if 
Cov[f (Xi ), f (Xi )] &lt; 0 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 16 / 35</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>MIT OpenCourseWare
http://ocw.mit.edu 
15.450 Analytics of Finance
Fall 2010
 
For information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms .</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>1
2Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
The Acceptance-Rejection Method 
Example: Beta Distr ibution 
The beta density is 
f (x)= B(1 
, ) x1(1  x)1 , 0  x  1 
Assume ,   1. Then f (x) has a maxim um at (  1)/( +   2). 
Dene 
  1
c = f  +   2 
and choose g (x)= 1. 
The A-R method becomes
Gener ate independent U 1 and U 2 from Unif [0, 1] until cU 2  f (U1);
Retur n U 1. 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 11 / 35</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>1
2
3 Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
The In verse T ransform Method 
Example: Discrete Distr ibution 
Consider a discrete r andom v ariable X with v alues 
c1 &lt; c2 &lt;&lt; cn, Prob(X = ci )= pi  
Dene cum ulativ e probabilities 
i
F (ci )= qi = pj 
j=1 
Can sim ulate X as follows:
Gener ate U  Unif [0, 1].
Find K  {1, ..., n} such that q K 1  U  qK . 
Set X = cK . 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 9 / 35</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Control V ariates 
Example: Pricing a European Call Option 
K 40 45 50 55 60 65 70 
2 0.99 0.94 0.80 0.59 0.36 0.19 0.08 
Source: Glasser man 2004, T able 4.1 
For in-the-mone y call options , option pa yoff is highly correlated with the stoc k 
price, and signicant v ariance reduction is possib le. 
For out-of-the-mone y call options , correlation of option pa yoff with the stoc k 
price is lo w, and v ariance reduction is v ery modest. 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 22 / 35</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Control V ariates 
Example: Stochastic V olatility 
Suppose w e want to pr ice a European call option in a model with stochastic 
volatility . 
Consider a discrete-time setting, with the stoc k price following 
S(ti+1)= S(ti ) exp (r  (ti )2/2)(ti+1  ti )+ (ti )Qti+1  ti i+1 
Q 
i IID N(0, 1) 
(ti ) follows its o wn stochastic process . 
Along with S (ti ), sim ulate another stoc k price process 
2 
Q 
i+1 S(ti+1)= S(ti ) exp r  (ti+1  ti )+ ti+1  ti 2 
Pick close to a typical v alue of (ti ). 
Use the same sequence of Nor mal v ariables Q 
i for S(ti ) as for S(ti ). 
Can use the discounted pa yoff of the European call option on S as a control 
variate: expectation giv en by the Blac k-Scholes f ormula. 
c Simulation Methods 24 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Simulation Methods 
Leonid K ogan 
MIT, Sloan 
15.450, F all 2010
 Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 1 / 35
 c</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Control V ariates 
Example: Pricing an Asian Call Option 
Suppose w e want to pr ice an Asian call option with the pa yoff 
J1  
max(0, ST  K ), ST  JS(tj ), t1 &lt; t2 &lt;  &lt; tJ  T 
j=1 
A natur al control v ariate is the discounted pa yoff of the European call option: 
X = erT max(0, ST  K ) 
Expectation of the control v ariate under Q is giv en by the Blac k-Scholes
formula.
Note that w e ma y use m ultiple controls , e.g., option pa yoffs at m ultiple dates . 
When pr icing look-bac k options , barr ier options b y sim ulation can use similar 
ideas . 
c Simulation Methods 23 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Outline
1 
2 
3 Gener ating Random Numbers 
Variance Reduction 
Quasi-Monte Car lo 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 13 / 35</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Outline
1 
2 
3 Gener ating Random Numbers 
Variance Reduction 
Quasi-Monte Car lo 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 5 / 35</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Outline
1 
2 
3 Gener ating Random Numbers 
Variance Reduction 
Quasi-Monte Car lo 
c Leonid K ogan ( MIT , Sloan ) Simulation Methods 15.450, F all 2010 2 / 35</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Control V ariates 
Example: Hedges as Control V ariates 
Suppose , again, that w e want to pr ice the European call option on a stoc k 
with stochastic v olatility . 
Let C (t, St ) denote the pr ice of a European call option with some constant 
volatility , given by the Blac k-Scholes f ormula. 
Constr uct the process f or discounted gains from a discretely-rebalanced 
delta-hedge . 
The delta is based on the Blac k-Scholes model with constant v olatility . 
The stoc k price follows the tr ue stochastic-v olatility dynamics . 
I1
V (T )= V (0)+  C(ti , S(ti ))  
erti+1 S(ti+1) erti S(ti )  
, tI = T S(ti )i=1 
Under the r isk-neutr al probability Q,
EQ 
0 [V (T )] = V (0) (Chec k using iter ated e xpectations)
Can use V (T ) as a control v ariate. The better the discrete-time delta-hedge , 
the better the control v ariate that results . 
c Simulation Methods 25 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>Gener ating Random Numbers Variance Reduction Quasi-Monte Car lo 
Appendix 
Derivation of the Acceptance-Rejection Method 
Suppose the A-R algor ithm gener ates Y . Y has the same distr ibution as X ,
conditional on
f (X )U  cg(X ) 
Derive the distr ibution of Y . For an y event A, 
  Prob f (X )
f (X ) X  A, U  cg(X )Prob(Y  A)= Prob X  A|U  cg(X )= 
Prob  
U  f (X )  
cg(X ) 
Note that   
Prob U  f (X ) |X = f (X ) and theref ore cg(X ) cg(X) 
Prob U  f (X )= f (x) g(x) dx = 1 
cg(X ) cg(x) c 
Conclude that 
Prob(Y  A)= c Prob f (X )= cf (x) g(x) dx = f (x) dx X  A, U  cg(X) A cg(x) A 
Since A is an arbitr ary event, this v eries that Y has density f . 
c Simulation Methods 35 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
      </slides>
      <videos/>
    </lecture>
    <lecture>
      <lecture_title>Stochastic calculus and option pricing
Code: Quadratic variation simulation</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/resources/mit15_450f10_lec02/</lecture_pdf_url>
      <lectureno>2</lectureno>
      <slides>
        <slide>
          <slideno>20</slideno>
          <text>1
2
3Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Black-Scholes Option Replication
The replicating str ategy requires holding 
f (t, St )t = St 
stock shares in the por tfolio. t is called the option s delta. 
It is possib le to replicate an y option in the Blac k-Scholes setting because 
Price of the stoc k S t is driven by a Bro wnian motion; 
Rebalancing of the replicating por tfolio is contin uous; 
There is a single Bro wnian motion aff ecting the pa yoff of the option and the pr ice 
of the stoc k. More on this later , when w e cover multivariate It processes . 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 21 / 74</text>
        </slide>
        <slide>
          <slideno>51</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Risk-Neutr al Probability Measure
Under the r isk-neutr al probability measure Q, e xpected conditional asset 
returns m ust equal the r isk-free r ate. 
Alternativ ely, using the discounted cash o w formula, the pr ice Pt of an asset 
with pa yoff H T at time T is giv en by 
 T  
Pt t exp  rsds HT = EQ 
t 
where r s is the instantaneous r isk-free interest r ate at time s . 
The DCF f ormula under the r isk-neutr al probability can be used to compute 
asset pr ices b y Monte Car lo sim ulation (e .g., using an Euler scheme to 
appro ximate the solutions of SDEs). 
Alternativ ely, one can der ive a PDE char acter izing asset pr ices using the 
connection betw een PDEs and SDEs . 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 52 / 74</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Example of It s formula 
We nd that the e xpected g rowth r ate of the r atio X t /Yt is 
 
X Y  
Y 2  
t t t +Xt Yt Yt 2 
Assume that tX = tY . Then, 
 dft  
Y
t 2 
Et = dtft Yt 2 
Repeating the same calculation f or the in verse r atio, ht = Yt /Xt , we nd 
 2 
Et dht = tX 
dtht Xt 2 
It is possib le for both the r atio X t /Yt and its in verse Y t /Xt to be e xpected to 
grow at the same time . Application to FX. 
c Stochastic Calculus 31 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
It Processes
An It process is a contin uous-time stoch astic process Xt , or X(t), of the form 
t t 
u du + u dZu 
0 0 
u is called the instantaneous dr ift of X t at time u , and u is called the
instantaneous v olatility , or the diffusion coefcient.
t dt captures the e xpected change of X t betw een t and t + dt. 
t dZt captures the une xpected (stochastic) component of the change of X t 
betw een t and t + dt. 
Conditional mean and v ariance: 
Et (Xt+dt  Xt )= t dt + o(dt), Et (Xt+dt  Xt )2= t 2 dt + o(dt) 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 8 / 74</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Its Lemma
Using the T aylor e xpansion, 
df (t, Xt )  f (
t, 
tXt ) dt + f (
t
X, X
t t ) dXt + 21 2f 
(t
t, 
2 Xt ) dt2 
+ 21 2f 
(
Xt, 
t 2 Xt )(dXt )2 + 2
f
t(
t, 
XX
t t ) dt dXt 
f (t, Xt ) f (t, Xt ) f (t, Xt ) = dt + t dt + t dZtt Xt Xt 
+ 21 2f 
(
Xt, 
t 2 Xt ) 2 
t dt + o(dt) 
Shor t-hand notation 
df (t, Xt )= f (
t, 
tXt ) dt + f (
t
X, X
t t ) dXt + 21 2f 
(
Xt, 
t 2 Xt )(dXt )2 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 13 / 74</text>
        </slide>
        <slide>
          <slideno>46</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Example: Square-Root Diffusion 
Consider a popular diffusion process used to model interest r ates and 
stochastic v olatility 
dXt =(Xt  X ) dt +  Xt dZt 
We want to compute the conditional moments of this process , to be used as 
a par t of GMM estimation. 
Compute the second non-centr al moment 
f (t, X)= E(XT 2|Xt = X) 
Using K olmogoro v bac kward equation, 
f (t, X ) (X  X ) f (t, X )+ 1 2X 2f (t, X )= 0,
t X 2 X 2
with boundar y condition
f (T , X)= X 2 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 47 / 74</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Single-F actor T erm Str ucture Model
Consider a model of the ter m str ucture of def ault-free bond yields . 
Assume that the shor t-term interest r ate follows 
drt = (rt ) dt + (rt ) dZt 
Let P (t, ) denote the time-t price of a discount bond with unit f ace v alue 
matur ing at time . 
We want to constr uct an arbitr age-free model captur ing, sim ultaneously , the 
dynamics of bond pr ices of man y different matur ities. 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 22 / 74</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Its Lemma
Its Lemma states that if X t is an It process , 
t t
Xt = u du + u dZu
0 0 
then so is f (t, Xt ), where f is a sufciently smooth function, and 
df (t, Xt )= f (t, Xt )+ f (t, Xt ) t + 1 2f (t, Xt ) 2 
t dt + f (t, Xt ) t dZtt Xt 2 Xt 2 Xt 
Its Lemma is , heur istically , a second-order T aylor e xpansion in t and X t , 
using the r ule that 
(dZt )2 = dt, dt dZt = o(dt), (dt)2 = o(dt) 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 12 / 74</text>
        </slide>
        <slide>
          <slideno>68</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Variance Sw ap in Heston s Model 
Consider a v ariance s wap, paying 
T 
(d ln Su)2  Kt 2 
t 
at time T . What should be the str ike price of the s wap, Kt , to mak e sure that 
the mar ket value of the s wap at time t is zero? 
Using the result on quadr atic v ariation, 
(d ln St )2 = vt dt 
the str ike price m ust be such that 
T  
er(T t)EQ 
t vu du  Kt 2 = 0 
t 
Need to compute T  
K 2 = Et Q 
t 
t vu du 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 69 / 74</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Black-Scholes Option Pr ice 
We conclude that the option pr ice can be computed as a solution of the 
Black-Scholes PDE 
f f 1 2f rf + + rS + 2S2 = 0 t S 2 S2 
If the option is a European call with strike K , the PDE can be solved in closed 
form, yielding the Blac k-Scholes f ormula: 
C(t, St )= StN(z1) exp(r(T  t))KN(z2), 
where N (.) is the cum ulativ e distr ibution function of the standard nor mal 
distribution,   
log S
Kt + r + 21 2(T  t) z1 = , 
T  t 
and 
z2 = z1  
T  t. 
Note that  does not enter the PDE or the B-S f ormula. This is intuitiv e from 
the perspectiv e of r isk-neutr al pricing. Discuss later . 
c Stochastic Calculus 20 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Option Pr icing in the Heston Model 
Suppose there are N derivatives with pr ices giv en by 
fi (t, St , vt )
where the rst option is the stoc k itself: f 1(t, St , vt )= St .
Using Ito s lemma, their pr ices satisfy 
df i (t, St , vt )= ai
tdt + fi (t, St , vt ) dSt + fi (t, St , vt ) dvtSt vt 
Compare the abo ve to our APT argument 
Conclude that there e xist S
t and v
t such that 
E  
df i (t, St , vt ) rf i (t, St , vt ) dt  
= fi (t
, 
SS
tt , vt ) tS dt + fi (t
, 
vS
tt , vt ) tv dt 
We work with pr ice changes instead of retur ns, as w e did in the APT ,
because some of the der ivatives ma y have zero pr ice.
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 41 / 74</text>
        </slide>
        <slide>
          <slideno>47</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Example: Square-Root Diffusion 
Look f or the solution in the the f orm 
f (t, X )= a0(t)+ a1(t)X + a2(t) X 2 
2 
Substitute f (t, X ) into the PDE 
a0(t)+ a1(t)X + a2(t) X 2  (X  X )(a1(t)+ a2(t)X )+ 2 
Xa2(t)= 02 2 
Collect ter ms with diff erent po wers of X , zero, one and tw o, to get 
a0(t)+ Xa1(t)= 0 
2 
a1(t) a1(t)+ + Xa2(t)= 02 
a2(t) 2a2(t)= 0 
with initial conditions 
a0(T )= a1(T )= 0, a2(T )= 2 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 48 / 74</text>
        </slide>
        <slide>
          <slideno>55</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Risk-Neutr al Probability Measure
Under the r isk-neutr al probability measure , expected conditional asset 
returns m ust equal the r isk-free r ate. 
We conclude that f or an y asset (pa ying no dividends), the conditional r isk 
premium is giv en by 
EP dSt  rt dt = EP dSt  EQ dSt 
t t tSt St St 
Thus , mathematically , the r isk premium is the diff erence betw een e xpected 
returns under the P and Q probabilities . 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 56 / 74</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Common SDEs 
Ornstein-Uhlenbec k process 
The mean-re verting Or nstein-Uhlenbec k process is the solution X t to the 
stochastic diff erential equation 
dXt =(X  Xt ) dt +  dZt 
We solv e this equation using et as an integ rating f actor . 
Setting Y t = et and using It s lemma f or the function f (X , Y )= XY , we nd 
d(etXt )= et (X dt +  dZt ).
Integ rating this betw een 0 and t , we nd
t t 
etXt  X0 = esXds + esdZs, 
0 0 
i.e., t
Xt = etX0 +(1  et )X +  estdZs.
0 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 37 / 74</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Proper ties of Bro wnian Motion
Brownian motion has independent increments: if t &lt; t  &lt; t , then Z t   Zt is 
independent of Z t   Zt  . 
Increments of the Bro wnian motion ha ve nor mal distr ibution with z ero mean, 
and v ariance equal to the time inter val betw een the obser vation points 
Zt   Zt N(0, t   t) 
Thus , for example ,
Et [Zt   Zt ]= 0
Intuition: Centr al Limit Theorem applied to the r andom w alk. 
Trajector ies of the Bro wnian motion are contin uous . 
Trajector ies of the Bro wnian motion are no where diff erentiab le, theref ore 
standard calculus r ules do not apply . 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 5 / 74</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Outline 
1 Stochastic Integ ral 
2 Its Lemma 
3 Black-Scholes Model 
4 Multiv ariate It Processes 
5 SDEs 
6 SDEs and PDEs 
7 Risk-Neutr al Probability 
8 Risk-Neutr al Pricing 
c Stochastic Calculus 32 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Its Lemma 
Example 
Let X t = exp(at + bZt ). 
We can wr ite X t = f (t, Zt ), where
f (t, Zt )= exp(at + bZt )
Using 
f (t, Zt )= af (t, Zt ), f (t, Zt )= bf (t, Zt ), 2f (t, Zt )= b2f (t, Zt )t Zt Zt 2 
Its Lemma implies 
b2 
dXt = a + Xt dt + bXt dZt2 
Expected g rowth r ate of X t is a + b2/2. 
c Stochastic Calculus 14 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Outline 
1 Stochastic Integ ral 
2 Its Lemma 
3 Black-Scholes Model 
4 Multiv ariate It Processes 
5 SDEs 
6 SDEs and PDEs 
7 Risk-Neutr al Probability 
8 Risk-Neutr al Pricing 
c Stochastic Calculus 2 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Stochastic Diff erential Equations 
Example: Heston s stochastic v olatility model 
dSt = dt + vt dZS 
St t 
dvt = (vt  v) dt + vt dZtv 
dZtS dZtv = dt 
Conditional v ariance v t is descr ibed b y a Stochastic Diff erential Equation. 
Denition (SDE) 
The It process X t satises a stochastic diff erential equation 
dXt = (t, Xt ) dt + (t, Xt ) dZt 
with an initial condition X 0 if it satises 
Xt = X0 + t 
0 (s, Xs) ds + (s, Xs) dZs. 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 33 / 74</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Ito Integ ral
Ito integ ral, also called the stochastic integ ral (with respect to the Bro wnian 
motion) is an object t 
u dZu 
0 
where u is a stochastic process . 
Impor tant: u can depend on the past histor y of Z u , but it cannot depend on 
the future . u is called adapted to the histor y of the Bro wnian motion. 
Consider discrete-time appro ximations 
N t (i1)t (Zit  Z(i1)t ), t = N i=1 
and then tak e the limit of N  (the limit m ust be tak en in the 
mean-squared-error sense). 
The limit is w ell dened, and is called the Ito integ ral. 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 6 / 74</text>
        </slide>
        <slide>
          <slideno>53</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Change of Measure
If we consider a probability measure Q different from P, b ut the one that 
agrees with P on which e vents ha ve zero probability , then the P-Bro wnian 
motion Zt P becomes an Ito process under Q: 
dZt P = dZt Q  t dt 
for some t . Zt Q is a Bro wnian motion under Q. 
When we change probability measures this way, only the drift of the Brownian 
motion changes , not the v ariance . 
Intuition: a probability measure assigns relativ e likelihood to diff erent 
trajector ies of the Bro wnian motion. Variance of the Ito process can be 
recovered from the shape of a single tr ajector y (quadr atic v ariation), so it 
does not depend on the relativ e likelihood of the tr ajector ies, hence , does not 
depend on the choice of the probability measure . 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 54 / 74</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
The Blac k-Scholes Model of the Mar ket
Consider the market with a constant risk-free interest rate r and a single risky 
asset, the stoc k. 
Assume the stoc k does not pa y dividends and the pr ice process of the stoc k 
is giv en by   
St = S0 exp   1 2 t + Zt2 
Because Bro wnian motion is nor mally distr ibuted, using
E0[exp(Zt )] = exp(t/2), nd
E0[St ]= S0 exp(t) 
Using It s Lemma (chec k) 
dSt =  dt +  dZtSt 
 is the e xpected contin uously compounded stoc k retur n,  is the v olatility of 
stock retur ns. 
Stock retur ns ha ve constant v olatility . 
c Stochastic Calculus 16 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Single-F actor T erm Str ucture Model 
Portfolio v alue e volves according to 
dW t = Wt  P(
t, 
 )+ P(
t, 

 ) rt + 
 t  
 
t 
 
dt+ 
t t t t 
  
t t dZt  
t t 
= Wt  P(
t, 
 )+ P(
t, 

 ) rt + 
 t  
 
t 

 
dt 
t t t t 
Portfolio v alue changes are instantaneously r isk-free . 
To avoid arbitr age, the por tfolio v alue m ust g row at the r isk-free r ate: 
Wt  P(
t, 
 )+ P(
t, 

 ) rt + 
t 
  
t 
 = Wtrt 
t t t t 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 24 / 74</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Quadr atic V ariation 
Consider a time discretization
0 = t1 &lt; t2 &lt; ... &lt; tN = T , max |tn+1  tn| &lt;
n=1,...,N1 
Quadr atic v ariation of an It process X (t) betw een 0 and T is dened as 
N1
[X ]T = lim |X(tn+1) X (tn)|2 
 0n=1 
For the Bro wnian motion, quadr atic v ariation is deter ministic: 
[Z ]T = T 
To see the intuition, consider the r andom-w alk appro ximation to the Bro wnian 
motion: each increment equals tn+1  tn in absolute v alue. 
c Stochastic Calculus 10 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>56</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Risk-Neutr al Probability Measure 
If we want to connect Q to P explicitly , how can w e compute the density , 
dQ/dP? 
In discrete time , the density w as conditionally lognor mal. 
The density T =(dQ/dP)T is giv en by 
  t t  
t = exp  u dZu P  1 2 
u du , 0  t  T20 0 
The state-pr ice density is giv en by 
 t  
t = exp ru du t 
0 
The re verse is tr ue: if we dene T as abo ve, for an y process t satisfying 
certain regular ity conditions (e .g., t is bounded, or satises the No vikovs 
condition as in Bac k 2005, Appendix B .1), then measure Q is equiv alent to P 
and t 
Zt Q = Zt P + u du 
0 
is a Bro wnian motion under Q. 
c Stochastic Calculus 57 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>59</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Black-Scholes Model
Assume that the stoc k pays no dividends and the stoc k price follows 
dSt =  dt +  dZt P 
St 
Assume that the interest r ate is constant, r . 
Under the r isk-neutr al probability Q, the stoc k price process is 
dSt = r dt +  dZt Q 
St
Terminal stoc k price S T is lognor mally distr ibuted:
ln ST = ln S0 + r  2 
T + 
T Q , Q N(0, 1)2 
Price of an y European option with pa yoff H(ST ) can be computed as 
= EQ e Pt t r(T t)H(ST ) 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 60 / 74</text>
        </slide>
        <slide>
          <slideno>60</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Term Str ucture of Interest Rates
Consider the V asicek model of bond pr ices. 
A single-f actor arbitr age-free model. 
To guar antee that the model is arbitr age-free , build it under the r isk-neutr al 
probability measure . 
Assume the shor t-term risk-free r ate process under Q 
drt =(rt  r) dt +  dZt Q 
Price of a pure discount bond matur ing at T is giv en by 
 T  
P(t, T )= EQ 
t exp  rs ds 
t 
Char acter ize P(t, T ) as a solution of a PDE. 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 61 / 74</text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Numer ical Solution of SDEs
Except f or a f ew special cases , SDEs do not ha ve explicit solutions . 
The most basic and common method of appro ximating solutions of SDEs 
numer ically is using the rst-order Euler scheme . 
Use the g rid ti = i. 
Xi+1 = Xi + (ti , Xi )  + (ti , Xi ) 
i , 
where i are IID N(0, 1) random v ariables. 
Using a binomial distr ibution f or i , with equal probabilities of 1, is also a 
valid procedure f or appro ximating the distr ibution of X t 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 43 / 74</text>
        </slide>
        <slide>
          <slideno>50</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Outline 
1 Stochastic Integ ral 
2 Its Lemma 
3 Black-Scholes Model 
4 Multiv ariate It Processes 
5 SDEs 
6 SDEs and PDEs 
7 Risk-Neutr al Probability 
8 Risk-Neutr al Pricing 
c Stochastic Calculus 51 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>67</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Heston s Model of Stochastic V olatility
Assume that under the r isk-neutr al probability Q, stoc k price is giv en by 
d ln St =(r  1 vt ) dt + vtdZt Q,S 
2 
dvt = (vt  v) dt + vtdZt Q,S +   
1  2vtdZt Q,v 
dZt Q,S dZt Q,v = 0 
Z Q,v models v olatility shoc ks uncorrelated with stoc k retur ns. t 
Constant interest r ate r .
The pr ice of a European option with a pa yoff H(ST ) can be computed as
= EQ [exp (r(T  t)) H(ST )] Pt t 
Assume that the pr ice of v olatility r isk is constant, v , and the pr ice of stoc k
price risk is constant, S .
c Stochastic Calculus 68 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>70</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Expected Prot/Loss on a V ariance Sw ap 
To compute e xpected prot/loss on a v ariance s wap, we need to e valuate 
T  
EP (d ln Su )2  K 2 
t t 
t 
Instantaneous e xpected gain on a long position in the s wap is easy to 
compute in closed f orm. 
The mar ket value of a s wap star ts at 0 at time t , and at s &gt; t becomes 
s T  
Ps  EQ er (T s) vu du + vu du  K 2 
s t 
t s s 
= er(T s) vu du + Ks 2  Kt 2 
t 
We conclude that the instantaneous gain on the long s wap position at time s 
equals 
[...] ds + 1 er(T s)  
1  e(T s)  
dvs 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 71 / 74</text>
        </slide>
        <slide>
          <slideno>48</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Example: Square-Root Diffusion
We solv e the system of equations star ting from the third one and w orking up 
to the rst: 
a0(t) = XA  1 
2 e2(tT )  e(tT ) + 1 2  
  
a1(t) = A e(tT )  e2(tT ) 
a2(t) = 2e2(tT ) 
A = 2 + 2X 
 
Compare the exact expression above to an appro ximate expression, obtained 
by assuming that T  t = t is small. 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 49 / 74</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Brownian Motion
Consider a r andom w alk x t+nt with equally lik ely increments of 
t. 
Let the time step of the r andom w alk shr ink to z ero: t 0. 
The limit is a contin uous-time process called Bro wnian motion, which w e 
denote Z t , or Z (t). 
We alw ays set Z 0 = 0. 
Brownian motion is a basic b uilding b lock of contin uous-time models . 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 4 / 74</text>
        </slide>
        <slide>
          <slideno>62</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Term Str ucture of Interest Rates
Look f or the solution in the f orm
f (t, rt )= exp (a(T  t) b(T  t)rt )
Derive a system of ODEs on a (t) and b (t) to nd 
a(T  t)= r(T  t) r 1  e(T t)   
2  
2(T  t) e2(T t) + 4e(T t)  3  
43 
1  
(T t)  
b(T  t)= 1  e 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 63 / 74</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Outline 
1 Stochastic Integ ral 
2 Its Lemma 
3 Black-Scholes Model 
4 Multiv ariate It Processes 
5 SDEs 
6 SDEs and PDEs 
7 Risk-Neutr al Probability 
8 Risk-Neutr al Pricing 
c Stochastic Calculus 3 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Outline 
1 Stochastic Integ ral
2 Its Lemma
3 Black-Scholes Model 
4 Multiv ariate It Processes 
5 SDEs 
6 SDEs and PDEs 
7 Risk-Neutr al Probability 
8 Risk-Neutr al Pricing 
c Stochastic Calculus 15 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Stochastic Calculus and Option Pr icing 
Leonid K ogan 
MIT, Sloan 
15.450, F all 2010
 Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 1 / 74
 c</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Outline 
1 Stochastic Integ ral 
2 Its Lemma 
3 Black-Scholes Model 
4 Multiv ariate It Processes 
5 SDEs 
6 SDEs and PDEs 
7 Risk-Neutr al Probability 
8 Risk-Neutr al Pricing 
c Stochastic Calculus 9 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Proper ties of It Integ ral 
It integ ral is linear 
t t t 
(au + c  bu ) dZu = au dZu + c bu dZu 
0 0 0 
t
Xt = 0 u dZu, is contin uous as a function of time . 
Increments of X t have conditional mean of z ero (under some technical
restrictions on u ):
Et [Xt   Xt ]= 0, t  &gt; t
T T  
Note: a sufcient condition f or E t t u dZu = 0isE0 0 2 
u du &lt; . 
Increments of X t are uncorrelated o ver time . 
If t is a deter ministic function of time and 
0 t 2 du &lt; , then X t is nor mally u 
distributed with mean z ero, and v ariance 
 t 
E0[Xt 2]= u 2 du 
0 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 7 / 74</text>
        </slide>
        <slide>
          <slideno>61</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Term Str ucture of Interest Rates 
Look f or P(t, T )= f (t, rt ). 
Using Ito s lemma, 
EQ 
t [df (t, rt )] = f (t, rt ) (rt  r) f (t, rt )+ 1 2 2f (t
2 , rt ) dt t rt 2 rt 
Risk-neutr al pricing requires that 
EQ 
t [df (t, rt )] = rtf (t, rt ) dt 
and theref ore f (t, rt ) must satisfy the PDE 
f (t, r) (r  r) f (t, r)+ 1 2 2f (t, r)= rf (t, r)t r 2 r2 
with the boundar y condition 
f (T , r)= 1 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 62 / 74</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Single-F actor T erm Str ucture Model
What if 
 
t  rt P(t, ) 
 
t = (t, rt ) 
for an y function , i.e., the LHS depends on something other than r t and t ? 
Then the ter m str ucture will not ha ve a single-f actor f orm.
We have seen that, f or each choice of (t, rt ), absence of arbitr age implies
that bond pr ices m ust satisfy the pr icing PDE.
The re verse is tr ue: if bond pr ices satisfy the pr icing PDE (with w ell-beha ved 
(t, rt )), there is no arbitr age (sho w later , using r isk-neutr al pricing). 
The choice of (t, rt ) deter mines the joint arbitr age-free dynamics of bond 
prices (yields). 
(t, rt ) is the pr ice of interest r ate risk. 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 26 / 74</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Common SDEs 
Geometr ic Bro wnian Motion 
Consider the SDE 
dXt = Xt dt + Xt dZt 
Dene the process
Yt = ln(Xt ).
By It s Lemma, 
dYt = X1 
t Xt dt + X1 
t Xt dZt + 1
2 (X 1 
t 2 )2Xt 2 dt =(  2/2) dt +  dZt . 
Yt is an ar ithmetic Bro wnian motion, giv en in the pre vious e xample , and 
Yt = Y0 +(  2/2)t + Zt . 
Then  
Xt = eYt = X0 exp (  2/2)t + Zt
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 36 / 74</text>
        </slide>
        <slide>
          <slideno>63</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Term Str ucture of Interest Rates
Assume a constant pr ice of r isk . What does this imply f or the interest r ate 
process under the ph ysical measure P and f or the bond r isk premia? 
Use the relation 
dZt P = dt + dZt Q 
to der ive 
drt =(rt  r) dt +  dt +  dZt P = rt  r +  dt +  dZt P 
 
Expected bond retur ns satisfy 
EP dP(t, T ) =(rt + P
t ) dtt P(t, T ) 
where 
P
t = 1 f (t, rt )  =b(T  t)f (t, rt ) rt 
|b(T  t)| is the v olatility of bond retur ns. 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 64 / 74</text>
        </slide>
        <slide>
          <slideno>69</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Variance Sw ap in Heston s Model 
Since 
vu = vt 	u 
(vs  v) ds +  u vs dZs Q,S +   
1  2 u vs dZs Q,v 
t t t 
we nd that 
u u 
EQ 
t [vu ]= vt  EQ 
t (vs  v) ds = vt  (EQ 
t [vs] v) ds 
t	 t 
Solving the abo ve equation f or EQ 
t [vu], we nd
EQ 
t [vu ]= v + e(ut)(vt  v)
We obtain the str ike price 
T  1   
Kt 2 = EQ 
t vu du = v(T  t)+(vt  v) 1  e(T t) 
t  
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus	 15.450, F all 2010 70 / 74</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Outline 
1 Stochastic Integ ral 
2 Its Lemma 
3 Black-Scholes Model 
4 Multiv ariate It Processes 
5 SDEs 
6 SDEs and PDEs 
7 Risk-Neutr al Probability 
8 Risk-Neutr al Pricing 
c Stochastic Calculus 27 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>74</slideno>
          <text>MIT OpenCourseWare
http://ocw.mit.edu 
15.450 Analytics of Finance 
Fall 2010 
For information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms .</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Option Replication 
Apply It s Lemma to por tfolio v alue, W t = f (t, St ): 
f f 1 2fdW t = t dSt +(Wt  tSt )r dt = t dt + St dSt + 2 St 2 (dSt )2 
where (dSt )2 = 2St 2 dt 
The abo ve equality holds at all times if 
t = f (
t
S, S
t t ) , f (
t, 
tSt )+ 21 2f 
(
St, 
t 2 St ) 2St 2  rf (t, St ) 
Sf
t St = 0 
If we can nd the solution f (t, S) to the PDE
f (t, S) f (t, S) 1 2S2 2f (t, S)
rf (t, S)+ + rS + = 0 t S 2 S2 
with the boundar y condition f (T , S)= H(S), then the por tfolio with 
f (t, St )W0 = f (0, S0), t = St 
replicates the option! 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 19 / 74</text>
        </slide>
        <slide>
          <slideno>43</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Outline 
1 Stochastic Integ ral 
2 Its Lemma 
3 Black-Scholes Model 
4 Multiv ariate It Processes 
5 SDEs 
6 SDEs and PDEs 
7 Risk-Neutr al Probability
8 Risk-Neutr al Pricing
c Stochastic Calculus 44 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>49</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Example: Square-Root Diffusion
Assume T  t = t is small. Using T aylor e xpansion,
a0(t)= o(t), a1(t)= At + o(t)
a2(t)= 2(1  2t)+ o(t)
Then   
Et (Xt2 
+t |Xt = X )  X 2 + t (2 + 2X )X  2X2
Alternativ ely, 
Xt+t  Xt  (Xt  X ) t +   
Xt 
tt , t N(0, 1) 
Theref ore 
Et (Xt2 
+t |Xt = X )  X 2 + t 2X  2X (X  X ) 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 50 / 74</text>
        </slide>
        <slide>
          <slideno>66</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Equity Options with Stochastic V olatility
Our assumptions regarding the mar ket prices of r isk tr anslate directly into 
implications f or retur n predictability . 
For stoc k retur ns, our assumption of constant pr ice of r isk predicts a
nonlinear patter n in e xcess retur ns: expected e xcess stoc k retur ns
propor tional to conditional v olatility .
Suppose w e constr uct a position in options with the e xposure t to stochastic 
volatility shoc ks and no e xposure to the stoc k price: 
dW t =[...] dt + tdZt P,v 
Then the conditional e xpected gain on such a position is 
(Wtr + t v ) dt 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 67 / 74</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Recap of APT 
To avoid arbitr age, any por tfolio satisfying 
b111 + b122 + ... + b1 N N = 0 
b211 + b222 + ... + b2 N N = 0 
must satisfy 
1Et [Rt 1] r + 2Et [Rt 2] r + ... + N Et [RtN ] r = 0 
Restating this in v ector f orm, an y vector or thogonal to 
(b11 , b12 , ..., b1 N ) and (b21 , b22 , ..., b2 N ) 
must be or thogonal to (Et [Rt 1] r, Et [Rt 2] r, ..., Et [RtN ] r). 
Conclude that the third v ector is spanned b y the rst tw o: there e xist 
constants (pr ices of r isk) (1 
t , 2 
t ) such that
Et [Rti ] r = 1 
tb1 i + t 2b2i , i = 1, ..., N
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 40 / 74</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Existence of Solutions of SDEs
Assume that f or some C , D &gt; 0
|(t, X)| + |(t, X )|  C(1 + |X |)
and 
|(t, X ) (t, Y )| + |(t, X) (t, Y )|  D|X  Y | 
for an y X and Y (Lipschitz proper ty). 
Then, the SDE 
dXt = (t, Xt ) dt + (t, Xt ) dZt , X0 = x, 
has a unique contin uous solution X t . 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 34 / 74</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Option Pr icing in the Heston Model 
The APT pr icing equation, applied to the stoc k, implies that 
E [dSt  rSt dt]=(  r)St dt = tS dt 
v
t is the pr ice of v olatility r isk, which deter mines the r isk premium on an y 
investment with e xposure to dv t . 
Writing out the pr icing equation e xplicitly , with the Ito s lemma pro viding an 
expression f or E df i (t, St , vt ) , 
fi fi fi 
+ S + ()( v  v)+t S v 
1 2fi 1 2fi 2fi fi fi 
vS2 + 2v + Sv  rf i = (  r)S + v 
2 S22 v2 Sv S vt 
As long as w e assume that the pr ice of v olatility r isk is of the f orm 
v = v (t, St , vt )t 
the assumed functional f orm for option pr ices is justied and w e obtain an
arbitr age-free option pr icing model.
c Stochastic Calculus 42 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>64</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Equity Options with Stochastic V olatility 
Consider again the Heston s model. Assume that under the r isk-neutr al 
probability Q, stoc k price is giv en by 
d ln St =(r  1 vt ) dt + vtdZt Q,S 
2 
dvt = (vt  v) dt + vtdZt Q,S +   
1  2vtdZt Q,v 
dZt Q,S dZt Q,v = 0 
Zt Q,v models v olatility shoc ks uncorrelated with stoc k retur ns.
Constant interest r ate r .
The pr ice of a European option with a pa yoff H(ST ) can be computed as
Pt = EQ 
t [exp (r(T  t)) H(ST )] 
We havent said an ything about the ph ysical process f or stochastic v olatility . 
In par ticular , how is v olatility r isk pr iced? 
c Stochastic Calculus 65 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Quadr atic V ariation 
Quadr atic v ariation of an It process 
t t
Xt = u du + u dZu
0 0 
is giv en by T 
[X ]T = 2 
t dt 
0 
Heur istically , the quadr atic v ariation f ormula states that 
(dZt )2 = dt, dt dZt = o(dt), (dt)2 = o(dt) 
Random w alk intuition: 
|dZt | = 
dt, |dt dZt | =(dt)3/2 = o(dt), dZt 2 = dt 
Conditional v ariance of the It process can be estimated b y appro ximating its 
quadr atic v ariation with a discrete sum. This is the basis f or variance 
estimation using high-frequency data. 
c Stochastic Calculus 11 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Multiple Bro wnian motions 
Consider tw o independent Bro wnian motions Zt 1 and Zt 2. Constr uct a third 
process 
Xt = Zt 1 + 1  2Zt 2
Xt is also a Bro wnian motion: 
Xt has IID nor mal increments; 
Xt is contin uous . 
Xt and Zt 1 are correlated: 
E0 XtZt 1 = t
Correlated Bro wnian motions can be constr ucted from uncorrelated ones , 
just lik e with nor mal r andom v ariables. 
Cross-v ariation 
N1
[Zt 1 , Zt 2]T = lim (Z 1(tn+1) Z 1(tn))  (Z 2(tn+1) Z 2(tn)) = 0 
 0n=1 
Shor t-hand rule 
dZt 1 dZt 2 = 0 dZt 1 dXt =  dt 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 28 / 74</text>
        </slide>
        <slide>
          <slideno>57</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Risk-Neutr al Probability and Arbitr age
If there e xists a r isk-neutr al probability measure , then the model is
arbitr age-free .
If there e xists a unique r isk-neutr al probability measure in a model, then all 
options are redundant and can be replicated b y trading in the under lying 
assets and the r isk-free bond. 
A con venient w ay to b uild arbitr age-free models is to descr ibe them directly 
under the r isk-neutr al probability . 
One does not need to descr ibe the P measure e xplicitly to specify an
arbitr age-free model.
However, to estimate models using histor ical data, par ticular ly, to estimate 
risk premia, one m ust specify the pr ice of r isk, i.e ., the link betw een Q and P. 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 58 / 74</text>
        </slide>
        <slide>
          <slideno>71</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Expected Prot/Loss on a V ariance Sw ap
We conclude that the instantaneous gain on the long s wap position at time s 
equals 
[...] ds + 1 er(T s)  
1  e(T s)  
dvs 
Given our assumed mar ket prices of r isk, S and v , the time-s expected 
instantaneous gain on the s wap opened at time t is 
r (T s) (T s)Psr ds + vs 1 e 
1  e 
S +  
1  2v  
ds  
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 72 / 74</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Single-F actor T erm Str ucture Model 
Assume that bond pr ices can be e xpressed as a function of the shor t rate 
only (single-f actor str ucture) 
P(t, )= f (t, rt , ) 
It formula implies that 
dP(t, )= f + f (rt )+ 1 2f 2(rt ) dt + f (rt ) dZtt r 2 r2 r   
  
tt 
Consider a self-nancing por tfolio which in vests P (t, )/ 
t dollars in the 
bond matur ing at , and P(t, )/
t  dollars in the bond matur ing at . 
Self-nancing requires that the in vestment in the r isk-free shor t-term bond is 
Wt  P(
t
 , )+ P(
t, 

 ) 
t t 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 23 / 74</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Recap of APT 
Recall the logic of APT . 
Suppose w e have N assets with tw o-factor str ucture in their retur ns: 
Rti = ai + bi 1Ft 1 + bi 2Ft 2 
Interest r ate is r . 
While not stated e xplicitly , all factor loadings ma y be stochastic. 
Unlik e the gener al version of the APT , we assume that retur ns ha ve no 
idiosyncr atic component. 
At time t , consider an y por tfolio with fr action i in each asset i that has z ero 
exposure to both f actors: 
b111 + b122 + ... + b1 N N = 0 
b211 + b222 + ... + b2 N N = 0 
This por tfolio m ust ha ve zero e xpected e xcess retur n to a void arbitr age 
1Et [Rt 1] r + 2Et [Rt 2] r + ... + N Et [RtN ] r = 0 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 39 / 74</text>
        </slide>
        <slide>
          <slideno>44</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Moments of Diffusion Processes
Often need to compute conditional moments of diffusion processes: 
Expected retur ns and v ariances of retur ns on nancial assets o ver nite time 
intervals; 
Use the method of moments to estimate a diffusion process from discretely 
sampled data; 
Compute pr ices of der ivatives. 
One approach is to reduce the prob lem to a PDE, which can sometimes be 
solved analytically . 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 45 / 74</text>
        </slide>
        <slide>
          <slideno>73</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Readings
Back 2005, Sections 2.1-2.6, 2.8-2.9, 2.11, 13.2, 13.3, Appendix B .1. 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 74 / 74</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Common SDEs 
Arithmetic Bro wnian Motion 
The solution of the SDE 
dXt =  dt +  dZt 
is giv en by 
Xt = X0 + t + Zt . 
The process X t is called an ar ithmetic Bro wnian motion, or Bro wnian motion 
with a dr ift. 
Guess and v erify. 
We typically reduce an SDE to a f ew common cases with e xplicit solutions . 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 35 / 74</text>
        </slide>
        <slide>
          <slideno>72</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Summar y
Risk-neutr al pricing is a con venient fr amework for de veloping arbitr age-free 
pricing models . 
Connection to classical results: risk-neutr al expectation can be char acter ized 
by a PDE. 
Risk premium on an asset is the diff erence betw een e xpected retur n under P 
and under Q probability measures . 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 73 / 74</text>
        </slide>
        <slide>
          <slideno>54</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Risk-Neutr al Probability Measure
Under the r isk-neutr al probability measure , expected conditional asset 
returns m ust equal the r isk-free r ate. 
Start with the stoc k price process under P: 
dSt = tSt dt + tSt dZt P 
Under the r isk-neutr al measure Q, 
dSt = rtSt dt + tSt dZt Q
Thus , if dZt P =t dt + dZt Q,
t  t t = rt
t is the pr ice of r isk. 
The r isk-neutr al measure Q is such that the process Zt Q dened b y 
dZt Q = t  rt dt + dZt P 
t 
is a Bro wnian motion under Q. 
c Stochastic Calculus 55 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Option Replication in the Heston Model
Assume the Heston stochastic-v olatility model f or the stoc k. 
Attempt to replicate the option pa yoff with the stoc k and the r isk-free bond. 
Can w e nd a tr ading str ategy that w ould guar antee perf ect replication? 
It is possib le to replicate an option using a bond, a stoc k, and another option. 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 38 / 74</text>
        </slide>
        <slide>
          <slideno>45</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Kolmogoro v Bac kward Equation 
Diffusion process X t with coefcients (t, X) and (t, X ). 
Objectiv e: compute a conditional e xpectation 
f (t, X)= E[g(XT )|Xt = X ] 
Suppose f (t, X ) is a smooth function of t and X . By the la w of iter ated 
expectations , 
f (t, Xt )= Et [f (t + dt, Xt+dt )] Et [df (t, Xt )] = 0  
Using Ito s Lemma, 
Et [df (t, Xt )] = f (t, X )+ (t, X ) f (t, X )+ 1 (t, X)2 2f (t, X ) dt = 0 t X 2 X 2 
Kolmogoro v bac kward equation 
f (t, X )+ (t, X) f (t, X)+ 1 (t, X )2 2f (t, X )= 0,
t X 2 X 2
with boundar y condition
f (T , X)= g(X) 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 46 / 74</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Option Replication
Consider a European option with the pa yoff H(ST ). 
We will constr uct a self-nancing por tfolio replicating the pa yoff of the option. 
Look f or the por tfolio such that 
Wt = f (t, St ) 
for some function f (t, St ). 
By La w of One Pr ice, f (t, St ) must be the pr ice of the option at time t , being 
the cost of a tr ading str ategy with an identical pa yoff. 
Note that the self-nancing condition is impor tant f or the abo ve argument: we 
do not w ant the por tfolio to produce inter mediate cash o ws. 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 18 / 74</text>
        </slide>
        <slide>
          <slideno>58</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Outline 
1 Stochastic Integ ral 
2 Its Lemma 
3 Black-Scholes Model 
4 Multiv ariate It Processes 
5 SDEs 
6 SDEs and PDEs 
7 Risk-Neutr al Probability 
8 Risk-Neutr al Pricing 
c Stochastic Calculus 59 / 74  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Multiv ariate It Processes
A multivariate It process is a v ector process with each coordinate dr iven by 
an It process . 
Consider a pair of processes 
dXt =tX dt + X
t dZtX , 
dYt =tY dt + Y
t dZtY , 
dZtX dZtY =t dt 
Its formula can be e xtended to m ultiple process as f ollows: 
f f fdf (t, Xt , Yt )= dt + dXt + dYt + t Xt Yt 
1 2f 1 2f 2f (dXt )2 + (dYt )2 + dXt dYt2 Xt 22 Yt 2 Xt Yt 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 29 / 74</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Dynamic T rading
Consider a tr ading str ategy with contin uous rebalancing. 
At each point in time , hold t shares of stoc ks in the por tfolio. 
Let the por tfolio v alue be W t . Then W t  tSt dollars are in vested in the 
short-term risk-free bond. 
Portfolio is self-nancing: no exogenous incoming or outgoing cash o ws. 
Portfolio v alue changes according to 
dW t = t dSt +(Wt  tSt )r dt 
Discrete-time analogy 
Bt+tWt+t  Wt = t (St+t  St )+(Wt  tSt )  1Bt 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 17 / 74</text>
        </slide>
        <slide>
          <slideno>65</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Equity Options with Stochastic V olatility 
In the Heston s model, assume that the pr ice of v olatility r isk is constant, v , 
and the pr ice of stoc k price risk is constant, S . 
Then, under P, stoc k retur ns follow 
d ln St = r + S vt  21 vt dt + vtdZt P,S 
dvt =  
(vt  v)+ vt  
S +  
1  2v  
dt+ 
vtdZt P,S +   
1  2vtdZt P,v 
dZt P,S dZt P,v = 0 
We have used 
dZt P,S = S dt + dZt Q,S 
dZt P,v = v dt + dZt Q,v 
Conditional e xpected e xcess stoc k retur n is 
EP  dSt  r dt  
= EP  
d ln St + vt dt  r dt  
=  
S vt  
dtt tSt 2 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 66 / 74</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Single-F actor T erm Str ucture Model 
We conclude that 
t   rtP(t, )= t   rtP(t, ) , for an y  and  
  
t t 
Assume that, f or some ,
t   rtP(t, )
= (t, rt ) 
t 
Then, for all bonds , must ha ve 
t   rtP(t, )= (t, rt ) 
t 
Recall the denition of t  ,  
t to der ive the pr icing PDE on P (t, )= f (t, rt , ) 
f f 1 2f f + (r)+ 2(r) rf = (t, r)(r) , f (, r, )= 1 t r 2 r2 r 
The solution, indeed, has the f orm f (t, r, ). 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 25 / 74</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Example of It s formula
Consider tw o asset pr ice processes , Xt and Y t , both giv en by It processes 
dXt =  X
t dt + X
t dZtX 
dYt = tY dt + Y
t dZtY 
dZtX dZtY = 0 
Using It s formula, w e can der ive the process f or the r atio ft = Xt /Yt (use 
f (X, Y )= X/Y ): 
2dft dXt dYt dXt dYt dYt =   +ft Xt Yt XtYt Yt 2  
X Y Y X Y
= t  t + t dt + t dZtX  t dZtY
Xt Yt Yt 2 Xt Yt
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 30 / 74</text>
        </slide>
        <slide>
          <slideno>52</slideno>
          <text>Stochastic Integ ral Its Lemma Black-Scholes Model Multiv ariate It Processes SDEs SDEs and PDEs Risk-Neutr al Probability Risk-Neutr al Pricing 
Change of Measure
We often w ant to consider a probability measure Q different from P, b ut the 
one that ag rees with P on which e vents ha ve zero probability (equiv alent to 
P) (e .g., Q could be a r isk-neutr al measure). 
Different probability measures assign diff erent relativ e likelihoods to the 
trajector ies of the Bro wnian motion. 
It is easy to e xpress a ne w probability measure Q using its density 
dQT = dP T 
For an y random v ariable X T , 
EQ 
0 [XT ]= EP 
0 [T XT ], EQ 
t [XT ]= EP T XT , t  EP 
t [T ]t t 
Q is equiv alent to P if T is positiv e (with probability one). 
c Leonid K ogan ( MIT , Sloan ) Stochastic Calculus 15.450, F all 2010 53 / 74</text>
        </slide>
      </slides>
      <videos/>
    </lecture>
    <lecture>
      <lecture_title>Standard errors and tests</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/resources/mit15_450f10_lec08/</lecture_pdf_url>
      <lectureno>8</lectureno>
      <slides>
        <slide>
          <slideno>10</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Mean and Standard De viation, Gaussian Distr ibution
Recall that f or Gaussian distr ibution, E [(x  0)3]= 0, E[(x  0)4]= 34
0. 
Using LLN, 
plimT  d= d  1
0 20
0 
20plimT  S= S  00 
204 
1  0 N(0, V)T 
1 20plimT  V= d S1d = 00 
1
2 02 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 11 / 41</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Key Points
Delta method. 
GMM standard errors , MLE and QMLE standard errors . 
OLS standard errors with correlated obser vations . 
2 test. 
Testing restr ictions on OLS coefcients , nonlinear restr ictions . 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 39 / 41</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Outline 
1 The Delta Method 
2 GMM Standard Errors 
3 Regression as GMM 
4 Correlated Obser vations 
5 MLE and QMLE 
6 Hypothesis T esting 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 3 / 41</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
MLE and GMM 
MLE or QMLE can be related to GMM. 
TOptimality conditions f or maximizing L() = t=1 ln p(xt |past x ; ) are 
T  ln p(xt |past x ; ) = 0  t=1 
If we set f (xt , )=  ln p(xt |past x ; )/ (the score vector), then MLE is 
GMM with the moment v ector f . 
Scores are uncorrelated over time because Et [f (xt+1, 0)] = 0 (Campb ell, Lo, 
MacKinla y, 1997, Appendix A.4). Standard errors using GMM f ormulas: 
d= E2 ln p(xt |past x ; ) , S= E ln p(xt |past x ; )  ln p(xt |past x ; ) 
     
1 
T Var[]= dS1d
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 28 / 41</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Outline 
1 The Delta Method 
2 GMM Standard Errors 
3 Regression as GMM 
4 Correlated Obser vations 
5 MLE and QMLE 
6 Hypothesis T esting 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 8 / 41</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Estimating S : Newey-West
Newey-West procedure f or computing standard errors prescr ibes 
k T
S=  k  |j| 1  
f (xt , )f (xtj , ) (Drop out-of-r ange ter ms) kT j=k t=1 
k is the band width par ameter . The larger the sample siz e, the larger the k 
one should use . Suggested g rowth r ate is k  T 1/3. 
In a nite sample , need k to be small compared to T , but large enough to 
cover the inter tempor al dependence r ange . 
Consider se veral values of k and compare the results . 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 22 / 41</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Example: Mean and Standard De viation, Gaussian 
Distribution 
MATLAB Output 
       
      
        
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 13 / 41</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Example: Shar pe Ratio Compar ison 
Under the n ull hypothesis , h(0)= 0, and theref ore 
h() h() h(0
 ) N(0, 1) 
Var Var = 
h() h() 
Dene the rejection region f or the test of the n ull h(0)= 0 as 
A =  
 
 h() 
Var h()  z  
 
 
A 5% test is obtained b y setting z = 1.96 = 1(0.975), where  is the
Standard Nor mal CDF .
c Condence Inter vals and T ests 38 / 41  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Outline 
1 The Delta Method
2 GMM Standard Errors
3 Regression as GMM 
4 Correlated Obser vations 
5 MLE and QMLE 
6 Hypothesis T esting 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 17 / 41</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Outline 
1 The Delta Method 
2 GMM Standard Errors 
3 Regression as GMM 
4 Correlated Obser vations 
5 MLE and QMLE
6 Hypothesis T esting
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 20 / 41</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Example: Shar pe Ratio Compar ison
Stack together the tw o retur n ser ies to create a ne w obser vation v ector 
xt =(xt 1 , xt 2) 
The par ameter v ector is 
0 =(10 , 0
1, 20 , 0
2) 
The n ull hypothesis is 0 0 
H0 : 
01  
02 = 0 
1 2 
To constr uct the rejection region f or H 0, estimate the asymptotic distr ibution 
1 2of  .1 2 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 36 / 41</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Example: Shar pe Ratio Compar ison
Suppose w e obser ve two ser ies of e xcess retur ns, gener ated o ver the same 
period of time b y two trading str ategies: 
(x11 , x21 , ..., xT 1 ) and (x12 , x22 , ..., xT 2 ) 
We do not kno w the e xact distr ibution behind each str ategy , but we do kno w 
that these retur ns are IID o ver time . 
Contempor aneously , xt 1 and xt 2 may be correlated. 
We want to test the n ull hypothesis that these tw o strategies ha ve the same 
Shar pe ratio. 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 35 / 41</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Example: Long-Hor izon Retur n Predictability
Predict S&amp;P 500 retur ns using the log of the dividend-pr ice ratio (1934/01  
2008/12)  D rtt+h =  +  ln + ut+h Pt1 
Retur ns are cum ulativ e over 6 or 12 months . Sum of monthly retur ns. 
h  Standard Error 
k = 0 k = 5 k = 12 k = 24 k = 36 
6 0.0530 0.0089 0.0185 0.0215 0.0233 0.0232 
12 0.1067 0.0129 0.0297 0.0378 0.0428 0.0431 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 25 / 41</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
GMM Standard Errors 
Under mild regular ity conditions , GMM estimates are consistent: 
asymptotically , as the sample siz e T approaches innity , 0 (in
probability). 
Dene 
d= E(f (xt , ))  
, S= E[f (xt , )f (xt , )]
  

GMM estimates are asymptotically nor mal: 

T ( 0)  N  
0,  
dS1d1  
Standard errors are based on the asymptotic v ar-co v matr ix of the estimates , 
1 
T Var[]  dS1d
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 9 / 41</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Hypothesis T ests
Sample of independent obser vations x 1, ..., xT with distr ibution p (x, 0). 
Want to test the n ull hypothesis H 0, which is a set of restr ictions on the
parameter v ector 0, e.g., b 0 = 0.
Statistical test is a decision r ule, rejecting the n ull if some conditions are
satised b y the sample , i.e.,
Reject if (x1, ..., xT )  A 
Test size is the upper bound on the probability of rejecting the n ull hypothesis 
over all cases in which the n ull hypothesis is correct. 
Type I error is f alse rejection of the n ull H 0. Test siz e is the maxim um
probability of f alse rejection.
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 31 / 41</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Example: Shar pe Ratio Distr ibution b y Delta Method
Estimate mean and standard de viation of e xcess retur ns (, ). 
Asymptotic v ariance-co variance matr ix of par ameter estimates =(, ) is 
estimated to be . 
Shar pe ratio is estimated to be = h()  . SR /
Compute  
h()  1 
A=   
=  2 
Variance of the Shar pe ratio estimate is 
1    
 1    
2 
 
2 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 7 / 41</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Ordinar y Least Squares (OLS) and GMM
Consider a linear model 
yt = xt + ut 
OLS is based on the assumption that the residuals ha ve zero mean 
conditionally on the e xplanator y variables and each other : 
E[ut |xt , xt1, ..., ut1, ut2, ...]= 0 
If we dene 
f (xt , yt , )= xt (yt  xt)
then  can be estimated using GMM:
Iterated Expectations E[xt (yt  xt)] = E[xtut ] = E[xt E[ut |xt ]] = 0 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 18 / 41</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Appendix: Intuition f or GMM Standard Errors 
Consider IID obser vations x 1, ..., xT . 
Delta method computes the v ar-co v of E[f (xt , )], given the v ariance of . By 
going in re verse direction, w e compute the v ar-co v of starting from the 
var-co v of E[f (xt , )]. 
The latter is estimated as 
 Var[E(f (xt , ))] (= 1) 1 Var[f (xt , )] (= 2) 1E[f (xt , ) f (xt , )]  1 ST T T 
(1) IID obser vations , so V ar( )= Var(); (2) Use E[f (xt , )] = 0 
Using the delta method on the LHS , with A= d= E[f (xt , )]/, 
1 
T S  d Var[] d  
and theref ore 
Var[]  1 
T  
d1 S  
d  1  
= 1 
T  
d S1 d  1 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 41 / 41</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Outline 
1 The Delta Method 
2 GMM Standard Errors 
3 Regression as GMM 
4 Correlated Obser vations 
5 MLE and QMLE 
6 Hypothesis T esting 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 27 / 41</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Outline 
1 The Delta Method 
2 GMM Standard Errors 
3 Regression as GMM 
4 Correlated Obser vations 
5 MLE and QMLE 
6 Hypothesis T esting 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 2 / 41</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Outline 
1 The Delta Method 
2 GMM Standard Errors 
3 Regression as GMM 
4 Correlated Obser vations 
5 MLE and QMLE 
6 Hypothesis T esting 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 30 / 41</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Example: Mean and Standard De viation, Gaussian 
Distribution 
MATLAB Code 
     
  
          
         
          
           
 
     
100,000 sim ulations: coverage frequencies are (0.945, 0.929). 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 15 / 41</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Discussion
Classical OLS is based on v ery restr ictive assumptions . 
In practice , the RHS v ariables are stochastic , and not uncorrelated with 
lagged residuals . 
GMM pro vides a po werful fr amework for dealing with reg ressions: OLS is 
valid as long as the moment conditions are v alid. 
Impor tant to treat standard errors correctly . GMM off ers a gener al recipe . 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 26 / 41</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
2 Test 
Want to test the Null Hypothesis regarding model par ameters:
h()= 0
Constr uct a 2 test: 
Estimate the v ar-co v of h (), V. 
Constr uct the test statistic
 = h()V1h()  2(dim h())
Reject the Null if the test statistic  is sufciently large . Rejection threshold is 
deter mined b y the desired test siz e and the distr ibution of  under the Null. 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 32 / 41</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Example: OLS
Suppose w e run a predictiv e reg ression of y t on a v ector of predictors x t : 
yt = 0 + xt + ut 
Compute par ameter estimates by OLS . Use Ne wey-West to obtain v ar-co v 
matrix for , Var(). 
Test the Null of no predictability:  = 0. 
Test statistic is
 =   
Var() 1  2(dim())
Test of siz e : reject the Null if   , where 
CDF2(dim())()= 1   
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 33 / 41</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Example: Mean and Standard De viation, Gaussian 
Distribution 
MATLAB Code 
         
          
          
         
           
       
       
       
             
         
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 12 / 41</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>MIT OpenCourseWare
http://ocw.mit.edu 
15.450 Analytics of Finance 
Fall 2010 
For information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms .</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
The Delta Method 
Given the estimator , want to der ive the asymptotic distr ibution of the v ector 
of smooth functions h (). 
Locally , a smooth function is appro ximately linear : 
( 0) 
0 h()  h(0)+ h() 
 
Let  0 N(0, ),  = Var() is small ( 1/T ), then 
h() h(0) N (0, AA) 
h()A =  
0 
In estimation, replace A and  with consistent estimates A= h() and :  
c Condence Inter vals and T ests 6 / 41  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010 h() h(0) N 0,A A</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Readings
Cochr ane, 2005, Sections 11.1, 11.3-4, 11.7, 20.1. 
Campbell, Lo, MacKinla y, 1997, Sections A.2-4. 
Cochr ane, New facts in nance .: 
    
   
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 40 / 41</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Multi-V ariate Nor mal Distr ibution
Linear combinations of nor mal r andom v ariables are nor mally distr ibuted: 
x N(0, ) Ax N(0, AA)  
The distr ibution of the sum of squares of n independent N(0, 1) variables is 
called 2 with n degrees of freedom: 
 N(0, I)   2(dim()) 
Distribution of a common quadr atic function of a nor mal v ector
x N(0, ) x 1x  2(dim(x))
  
Density function of x N(, ): 
(x)=  
(2)N || 1/2 e 1
2 (x) 1(x) 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 5 / 41</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Example: Mean and Standard De viation
Compute standard errors f or estimates of mean and standard de viation 
f1(xt , )= xt  , f2(xt , )=(xt  )2  2 
E(f (xt , ))   1 0  1 0  
d=  = =   2(E(xt ) )2 0 2

S= E[f (xt , )f (xt , )]= Ef12 f1
ff
22 
f1f2 2 
 0 N(0, 1 V), V=  
dS1d1 
T 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 10 / 41</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Example: Shar pe Ratio Distr ibution b y Delta Method 
Gaussian distr ibution 
Asymptotic v ariance-co variance matr ix of the par ameter estimates 
=(, ) is 
1 20
= T 0 1
2 2 
Asymptotic v ariance of the Shar pe ratio is 
  1  
1   1 1 2    = 1 + SR 2 
 
2 T 2 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 16 / 41</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Example: Mean and Standard De viation, Gaussian 
Distribution 
95% Condence inter vals for par ameter estimates can be constr ucted as 
 i ),  CI(i )=[i  1.96  SE(i + 1.96  SE(i )], i = 1, 2 
Asymptotically , these should contain the tr ue values with 95% probability . 
How good are the CI s in a nite sample? 
Perform a Monte Car lo experiment: simulate N independent ar ticial samples 
and compute the co verage frequency . 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 14 / 41</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Standard Errors: Correlated Obser vations
When f (xt , ) are correlated o ver time , formulas f or standard errors m ust be
adjusted to account f or autocorrelation.
Correlated obser vations aff ect the eff ective sample siz e.
The relation 
Var[] = 1 
T  
d1 S  
d  1  
= 1 
T  
d S1 d  1 
is still v alid. But need to modify the estimate S . 
In an innite sample , 

S = E [f (xt , 0)f (xtj , 0)] 
j= 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 21 / 41</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Example: Estimating A verage Interest Rate 
We want to estimate the a verage 3-months TBill r ate using histor ical data. 
3-Month Treasur y Bill secondar y mar ket rate, monthly obser vations . 
024681012141618
1927
1941
1954
196819821995
2009InterestRate(%)
Date3monthsTBillRate
Source: Federal Reser ve Bank of St. Louis . 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 24 / 41</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>1
2
( The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Testing the Shar pe Ratio
Suppose w e are giv en a time ser ies of e xcess retur ns. 
We want to test whether the Shar pe ratio of retur ns is equal to SR 0. 
Two steps:
Using the delta method, der ive the asymptotic v ariance of the Shar pe ratio
estimate , = .
 SR /
Test statistic 
SR  SR0)2 
 2(1)
Var( SR) 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 34 / 41</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Nonlinear Least Squares (NLS) 
Consider a nonlinear model
yt = h(xt , )+ ut , E[ut |xt ]= 0
We use QMLE to estimate this model. Pretend that errors ut are IID N(0, 2). 
Minimiz e log-lik elihood 
L() = T
 ln 
22 (yt  h(xt , ))2 
22 
t=1 
First-order conditions can be vie wed as moment conditions in GMM: 
= arg min E  
(yt  h(xt , ))2 
E h(xt , )(yt  h(xt , )) = 0 
   
Nonlinear Least Squares . Can use GMM f ormulas f or standard errors . 
Why not choose other moments , e.g., f = g(xt )(yt  h(xt , )) with pretty
much arbitr ary g(xt ), e.g., g(xt )= xt ?
We could. But this ma y result in less precise estimates of or invalid
moment conditions . In fact, if u t are Gaussian, NLS is optimal (see MLE).
c Condence Inter vals and T ests 29 / 41  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Standard Errors and T ests 
Leonid K ogan 
MIT, Sloan 
15.450, F all 2010
 Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 1 / 41
 c</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Vector Notation 
Suppose  is a v ector . We alw ays think of  as a column: 
 1 
. . ,  = 1 ... N  = 
. 
N 
Partial der ivatives of a smooth scalar-v alued function h (): 
 h() 
1 . . .  h() , h() 
  h() h()= ... 1 N  h() 
N 
If h() is a v ector of functions , (h1(), ..., hM ()), 
  h1() h1() 
1 N   h() . . . . . . = . . . 
hM () hM () 
1 N 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 4 / 41</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Example: Shar pe Ratio Compar ison 
Using standard GMM f ormulas, estimate the asymptotic v ariance-co variance 
. matrix of the par ameter estimates ,
Dene 
h()= 1  2 
1 2 
Compute 
2 1 
2 h() 1 
1 1 
(1 )2 A = 
Asymptotically , variance of h () is   = (2)2  
1 
  h() = 1 (1)2 (2 )2 (1 )2 
 1 
2 1 1 
Var 1  1 2 1 2 
2 
(2 )2 
c Condence Inter vals and T ests 37 / 41  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
Ordinar y Least Squares (OLS) and GMM 
GMM estimate is based on
E[xt (yt  xt)] = 0 = = E(xtxt)1E(xtyt )
  
which is the standard OLS estimate . 
To nd standard errors , compute 
S= E(ftft)= E(ut 2xt xt), ut  yt  xt
d= E[f ] =E(xtxt) 
Then
1 11
Var[]= dS1d = E(xt xt)1E(ut 2xtxt)E(xtxt)1 
T T 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 19 / 41</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>The Delta Method GMM Standard Errors Regression as GMM Correlated Obser vations MLE and QMLE Hypothesis T esting 
OLS Standard Errors With Correlated Residuals 
Linear model 
yt = xt + ut 
Assume that 
E[ut |xt , xt1, ...]= 0
but allo w u t to be autocorrelated.
Since f (xt , )= xtut , Newey-West estimate of S is 
k T k  |j| 1   
S= utxtxt
jutj (Drop out-of-r ange ter ms) kT j=k t=1 
Asymptotic v ar-co v matr ix of the reg ression coefcients: 
Var[]= 1E(xtxt)1 SE(xtxt)1 
T 
c Leonid K ogan ( MIT , Sloan ) Condence Inter vals and T ests 15.450, F all 2010 23 / 41</text>
        </slide>
      </slides>
      <videos/>
    </lecture>
    <lecture>
      <lecture_title>Volatility models</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/resources/mit15_450f10_lec10/</lecture_pdf_url>
      <lectureno>10</lectureno>
      <slides>
        <slide>
          <slideno>42</slideno>
          <text>1
2Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Dynamic Conditional Correlations (DCC)
Model 
t = Dt tDt 
t is the time-v arying conditional correlation matr ix; 
Dt is the diagonal matr ix of conditional standard de viations . 
Two-step estimation method: 
Fit a scalar GARCH(1,1) to each component of x to estimate D t ; 
Model t as 
(t )ij =  (Qt )ij , Qt =(1  a  b) + a(ut1ut
1)+ bQt1 (Qt )ii (Qt )jj 
Estimate the par ameters  , a, b by QMLE on the ut series. As bef ore, 
ut = Dt 1xt . 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 43 / 45</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Example: S&amp;P GSCI 
Fitted time ser ies of conditional v olatility t computed using 
2 2 2t = a0 + a1xt1 + b1t1 
2004 2005 2006 2007 2008 20090.010.0150.020.0250.030.0350.04
DatetConditional Volatility of S&amp;P GSCI Spot Price Changes
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 21 / 45</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
GARCH: Non-Gaussian Errors
Standard GARCH f ormulation assumes that errors t are Gaussian. 
Assume that x t follow a diff erent distr ibution, b ut still 
xt = t t , Et [t ]= 0, Et [2 
t ]= 1 
Two approaches: 
QMLE estimation, treating errors as Gaussian. 
MLE with an alter nativ e distr ibution f or t , e.g. Student s t. 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 25 / 45</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Example: S&amp;P GSCI Inde x
S&amp;P GSCI Spot Index
01002003004005006007008009001000
Jan-04 May-05 Oct-06 Feb-08 Jul-09DateIndexLevel
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 5 / 45</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Outline 
1 Heteroscedasticity 
2 GARCH 
3 GARCH Estimation: MLE 
4 GARCH: QMLE 
5 Alternativ e Models
6 Multiv ariate Models
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 24 / 45</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
QMLE vs . MLE: Monte Car lo Exper iments
How effective is the QMLE approach when dealing with non-nor mal shoc ks? 
We can gain intuition using Monte Car lo experiments . 
Beyond this par ticular conte xt, our Monte Car lo design illustr ates a typical 
simulation e xperiment. 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 29 / 45</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Monte Car lo Results
T Method 
1,000 
1,000 QMLE MLE 
3,000 3,000 QMLE MLE RMSE() 
a1 b1 
0.0286 0.1951 
0.0228 0.1396 
0.0149 0.0356 
0.0115 0.0289 Mean() 
a1 b1 
0.0551 0.8335 
0.0538 0.8613 
0.0513 0.8920 
0.0503 0.8940 C.I.() Coverage 
a1 b1 
0.9240 0.8930 
0.9170 0.8920 
0.9380 0.9200 
0.9370 0.9390 
Both QMLE and MLE produce consistent par ameter estimates . 
At T = 1, 000 there is a bias , which disappears at T = 3, 000. 
MLE estimates are more efcient: smaller RMSE. 
QMLE estimates do not rely on the e xact distr ibution, more rob ust. 
QMLE condence inter vals are reliab le, GMM f ormulas w ork. 
c Volatility Models 32 / 45  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Outline 
1 Heteroscedasticity 
2 GARCH 
3 GARCH Estimation: MLE 
4 GARCH: QMLE 
5 Alternativ e Models 
6 Multiv ariate Models 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 33 / 45</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
GARCH(1,1) Monte Car lo
Compare the tails of the sim ulated sample to the Gaussian distr ibution: 
k Prob  
  
1 xt 
E  
x2 
t  &gt; 
2 k   
3 4 
GARCH(1,1) 0.1540 0.0239 0.0025 0.0002 
Gaussian 0.1587 0.0228 0.0013 0.0000 
S&amp;P GSCI 0.1351 0.0188 0.0077 0 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 16 / 45</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Mixed Data Sampling (MID AS) 
Motiv ation 
Suppose w e want to predict realiz ed variance o ver a single holding per iod of 
the por tfolio, which is a month. 
GARCH approach: 
Use monthl y histor ical data, ignore the availab le higher-frequency (daily) data; or 
Model daily v olatility and e xtend the f orecast to a one-month per iod. Sensitiv e to 
specication errors . 
Mixed Data Sampling approach f orecasts monthly v ariance directly using 
daily data. 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 35 / 45</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
GARCH(p ,q)
Consider a widely used model of time-v arying v ariance: GARCH(p ,q)
(gener alized autoreg ressiv e conditional heterosk edasticity).
Consider a ser ies of obser vations 
xt = t t , t N(0, 1), IID 
Assume that the ser ies of conditional v ariances 2 
t follows 
p q  
2 
t = a0 + aixt2 
i + bj t2 
j , ai , bj  0 (GARCH(p,q)) 
i=1 j=1 
Focus on a popular special case GARCH(1,1). 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 11 / 45</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Outline 
1 Heteroscedasticity
2 GARCH
3 GARCH Estimation: MLE 
4 GARCH: QMLE 
5 Alternativ e Models 
6 Multiv ariate Models 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 17 / 45</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Example: S&amp;P GSCI
Extract a ser ies of tted errors xtt = t 
Tail Probabilities (Prob [t &gt; k]) 
k 1 2 3 4 
Gaussian 0.1587 0.0228 0.0013 0.0000 
t 0.1595 0.0209 0.0014 0 
Fitted errors conf orm much better to the Gaussian distr ibution than the 
unconditional distr ibution of x t does . 
In case of S&amp;P GSCI spot pr ice ser ies, can attr ibute hea vy tails in 
unconditional distr ibution of daily changes to conditional heteroscedasticity . 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 22 / 45</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
GARCH: MLE with Student s t Shoc ks
One prominent e xample of GARCH with non-Gaussian errors is the GARCH 
model with Student s t error distr ibution. 
Assume that 
[( + 1)/2]  2 (+ 1)/2 
p(t ; )=  1 + t , &gt; 2 
(/2) (  2)   2 
/(  2)t have the Student s t distribution with  degrees of freedom.  
is the Gamma function, (x)= 
0  zx1ez dz. 
Likelihood function f or GARCH(1,1): 
L() =  T 
ln [(  + 1)/2]  + 1ln 1 + xt 2 
t=1 (/2) (  2) 2 (  2)2 
t 
 ln(2 
t )/2 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 27 / 45</text>
        </slide>
        <slide>
          <slideno>44</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Readings
Campbell, Lo, MacKinla y, 1997, Sections 12.2 (Introduction), 12.2.1. 
Note: there are typos in eq. (12.2.19). 
Tsay, 2005, Sections 3.3-3.5, 3.8. 
T. Andersen, T . Bollersle v, P. Chr istoffersen, F . Diebold, 2006, V olatility and 
Correlation Forecasting,  in G. Elliott, C. Granger , and A. Timmer mann (eds.), 
Handbook of Economic F orecasting. Amsterdam: North-Holland, 778-878. 
E. Ghysels , P. Santa-Clar a, R. V alkano v, 2006, Predicting v olatility: getting 
the most out of retur n data sampled at diff erent frequencies , Journal of 
Econometr ics 131, 59-95. 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 45 / 45</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Example: S&amp;P GSCI
Fit the GARCH(1,1) model to the ser ies of S&amp;P GSCI spot pr ice changes . 
Use MA TLAB  function garcht. garcht constr ucts the lik elihood function 
and optimiz es it n umer ically . 
Parameter estimates: 
a1 = 0.0453 , b1 = 0.9457 
Shoc ks to conditional v ariance are persistent, giving r ise to volatility
cluster ing.
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 20 / 45</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Standard Errors
We treat MLE as a special case of GMM with moment conditions 
 ln p(xt |t ; )E = 0  
Use gener al formulas f or standard errors: 
2 ln p(x, )  ln p(x, )  ln p(x, )d= E , S= E
   
1 
T Var[]= dS1d
How to compute der ivatives, e.g.,  ln p(x,) ? 
Use nite-diff erence appro ximations (garcht). 
Compute der ivatives analytically , recursiv ely (discussed in recitations). 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 23 / 45</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Volatility Models 
Leonid K ogan 
MIT, Sloan 
15.450, F all 2010
 Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 1 / 45
 c</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
GARCH(1,1) Dynamics
Stable dynamics requires
a1 + b1 &lt; 1
Convergence of f orecasts: 
 a0lim Et t2 
+n = 
n 1  a1  b1
Average conditional v ariance:
E  
xt2 
+1  
= a0 + a1E  
xt 2 
+ b1E  
2 
t  
 E  
xt 2 
= 1  aa
10 
 b1
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 13 / 45</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Outline 
1 Heteroscedasticity 
2 GARCH 
3 GARCH Estimation: MLE 
4 GARCH: QMLE 
5 Alternativ e Models 
6 Multiv ariate Models 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 3 / 45</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Multiv ariate V olatility Models 
Overview 
Model the dynamics of conditional v ariance-co variance matr ix of the time 
series 
1/2 IID xt = t t , t N(0, I) 
Many multivariate gener alizations of GARCH fr amework. Main challenge is 
parameter prolif eration. 
Use f actor str uctures to treat high-dimensional cases . 
Averaging of realiz ed co variances (e xponentially w eighted mo ving a verage, 
MIDAS fr amework). 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 40 / 45</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Engle T est
MATLAB code 
    
            
MATLAB output 
  
   
      
 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 9 / 45</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>1
2Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Constant Conditional Correlations (CCC)
Model 
t = Dt Dt 
 is the constant matr ix of conditional correlations;
Dt is the diagonal matr ix of conditional standard de viations .
Two-step estimation method:
Fit a scalar GARCH(1,1) to each component of x to estimate D t ;
Estimate the unconditional correlation matr ix of ut , ut = Dt 1xt 
T1   = utut
T t=1 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 42 / 45</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Outline 
1 Heteroscedasticity 
2 GARCH 
3 GARCH Estimation: MLE 
4 GARCH: QMLE 
5 Alternativ e Models 
6 Multiv ariate Models 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 10 / 45</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Monte Car lo Design
Data Gener ating Process: 
2 = a0 + a1xt2 
1 + b12 
t t1 
a1 = 0.05, b1 = 0.9 
t are IID , Student s t distribution with  = 6. 
Simulate N = 1, 000 samples of length T = 1, 000or 3 , 000. 
In each case , star t with 1 = 1aa
10 
b1 and use a b urn-in sample of 500 
periods. 
Perform MLE and QMLE estimations f or each sim ulated sample and sa ve 
point estimates a1, b1, and their standard errors . 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 30 / 45</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>1
2
3 Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
GARCH(1,1) Monte Car lo
Unconditional distr ibution of x t has hea vier tails than the conditional
(Gaussian) distr ibution.
Monte Car lo experiment: simulate GARCH (1,1) process with par ameters 
a0 = 1, a1 = 0.1, b1 = 0.8 
Initiate 1 = 1aa
10 
b1. 
Gener ate a sample of 100,000 obser vations using dynamics 
2 = a0 + a1xt2 
1 + b12 
t t1 
xt = t t , t N(0, 1), IID 
Drop the rst 10% of the sim ulated sample (b urn-in) and analyz e the distr ibution 
of the remaining sample . 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 14 / 45</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Example: S&amp;P GSCI Inde x
Model daily changes in S&amp;P GSCI inde x. 
The S&amp;P GSCI inde x is a composite commodity inde x, maintained b y S&amp;P . 
The S&amp;P GSCI R provides in vestors with a reliab le and pub licly 
availab le benchmar k for investment perf ormance in the commodity 
markets. The inde x is designed to be tr adab le, readily accessib le to 
market par ticipants , and cost efcient to implement. The S&amp;P GSCI 
is widely recogniz ed as the leading measure of gener al commodity 
price mo vements and ination in the w orld econom y. 
Source:Standard &amp; P oors. 
Changes in daily spot inde x levels: 
Pt zt = ln Pt1 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 4 / 45</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Example: S&amp;P GSCI Inde x
While x t s ma y be uncorrelated, the y ma y not be IID . 
Look f or evidence of heteroscedasticity: time-v arying conditional v ariance . 
Perform the Engle test, e .g., Tsa y, 2005 (Section 3.3.1). 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 7 / 45</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>1
2
3
4Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Engle T est for Conditional Heteroscedasticity
The idea of the test is simple: t the AR(p) model to squared shoc ks and test 
the h ypothesis that all coefcients are jointly z ero. 
2 2 2xt = a0 + a1xt1 + ... + apxtp + ut 
One w ay to der ive the test statistic:
Estimate the coefcients of the AR(p) model, =(a0, a1, ..., ap).
Estimate the v ar-co v matr ix of the coefcients 
. Dont w orry about 
autocorrelation, since under the n ull it is not there . 
Form the test statistic 
 
 1 a1   . F =(a1, ..., ap)  a1,...,ap ;a1,...,ap 	..  
ap 
Rejection region: F  F . Size of the test based on the asymptotic distr ibution: 
F  2(p). 
c Leonid K ogan ( MIT , Sloan ) Volatility Models	 15.450, F all 2010 8 / 45</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
GARCH: QMLE
Keep using the objectiv e function 
T2 
L() =  
 ln 
2  2x
t 
2  21 ln  
t 2 
t=1 t 
Because the function x   ln x  a/x is maximiz ed at x = a, conditional 
expectation   x21  
Et  22 
tt 
() 2 ln t 2() 
is maximiz ed at the tr ue value of . This means that 0 maximiz es the
unconditional e xpectation as w ell, and hence w e can estimate it b y
maximizing L() .
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 26 / 45</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Mixed Data Sampling 
Example 
Beta-function specication of the w eights b H (k, ): 
bH (k, )= Kf Kk 
, ,   , f (x, , )= x(1  x) 
j=0 f Kj , ,  
Weights b H (k, ) have 
exible shape . 
00.10.20.30.40.50.60.70.80.9100.0050.010.0150.020.0250.03
xf(x)
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 38 / 45</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Mixed Data Sampling 
Estimation 
The model 
K
VtH 
+H,t = aH + H bH (k, )Xtk,tk1 + Ht 
k=0 
Estimate using nonlinear least squares (NLS). 
Alternativ e specication: 
K
rt+H,t N , aH + H bH (k, )Xtk,tk1 
k=0 
Estimate the par ameters using QMLE. 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 37 / 45</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Other GARCH-T ype Models: EGARCH
Empir ically , conditional v olatility of asset retur ns often reacts asymmetr ically 
to the past realiz ed retur n shoc ks. 
Leverage eff ect: conditional stoc k mar ket volatility increases f ollowing a stoc k 
market decline . 
EGARCH(p ,q) model captures the asymmetr ic volatility response: 
p q xti  
ln t =a0 + aig + bj ln tj (EGARCH(p,q))tii=1 j=1 
g(z)=|z|  cz 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 34 / 45</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
GARCH: Non-Gaussian Errors
Student s t distribution has hea vier tails than the Gaussian distr ibution. 
The n umber of deg rees of freedom can be estimated together with other 
parameters , or it can be x ed. 
GARCH models gener ate hea vy tails in the unconditional distr ibution, 
Student s t adds hea vy tails to the conditional distr ibution. 
Daily S&amp;P 500 retur ns: capture unconditional distr ibution of shoc ks as 
Student s t with   3; GARCH(1,1) captures conditional distr ibution of 
shoc ks as Student s t with   6. 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 28 / 45</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Outline 
1 Heteroscedasticity 
2 GARCH 
3 GARCH Estimation: MLE 
4 GARCH: QMLE 
5 Alternativ e Models 
6 Multiv ariate Models 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 2 / 45</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Mixed Data Sampling 
Formulation 
We are interested in f orecasting an H -period v olatility measure , VtH 
+H,t e.g., 
sum of squared daily retur ns over a month (H = 22). 
Model e xpected monthly v olatility measure as a w eighted a verage of lagged 
daily obser vations (e .g., use squared daily retur ns) 
K
VtH 
+H,t = aH + H bH (k, )Xtk,tk1 + Ht 
k=0 
Signicant e xibility: 
X can contain squared retur n, absolute v alue of retur ns, intra-day high-lo w 
range, etc. 
Weights b H (k, ) can be e xibly specied. 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 36 / 45</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Outline 
1 Heteroscedasticity 
2 GARCH 
3 GARCH Estimation: MLE 
4 GARCH: QMLE 
5 Alternativ e Models 
6 Multiv ariate Models 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 39 / 45</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
MGARCH 
Example 
Multiv ariate GARCH analog 
t = C + a(xt1xt
1)+ bt1 
Estimate using QMLE, analogous to GARCH(1,1). 
Limitation: all co variances ha ve the same persistence . 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 41 / 45</text>
        </slide>
        <slide>
          <slideno>45</slideno>
          <text>MIT OpenCourseWare
http://ocw.mit.edu 
15.450 Analytics of Finance 
Fall 2010 
For information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms .</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>1
2
3Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Summar y Statistics 
Compute the f ollowing statistics: 
Root-mean-squared-error (RMSE) of each par ameter estimate 
RMSE ()= N1  
N n=1 (n  0)2 
Average v alue of each par ameter estimate 
N1n
N n=1 
Estimated co verage probability of the condence inter val for each par ameter 
estimate 
N1  
N 1[|n  0|1.96 s.e.()] 
n=1 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 31 / 45</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
MLE f or GARCH(1,1)
Focus on GARCH(1,1) as a representativ e example . 
Estimate par ameters b y maximizing conditional log-lik elihood). 
Form the log-lik elihood function: 
T
L() = ln p(xt |t ; ) 
t=1 
p(xt |t ; ) is the nor mal density 
2 
t 
t p(xt |t ; )=  1 e  2x
2 
22 
t 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 18 / 45</text>
        </slide>
        <slide>
          <slideno>43</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Summar y
Volatility models are impor tant f or risk management, asset allocation,
derivative pricing.
GARCH models are con venient f or extracting time-v arying v olatility and f or 
frecasting. 
GARCH models can be estimated using QMLE or MLE. 
Mixed-frequency data can be used in f orecasting. MIDAS. Straightf orward 
using NLS or QMLE. 
Multiple e xtensions of GARCH, m ultivariate models . 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 44 / 45</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
Example: S&amp;P GSCI Inde x
Daily changes from 02-J an-2004 to 23-Sep-2009. 
First, t an AR (p) model to the ser ies z t to extract shoc ks. 
De-mean the ser ies: xt = zt  E[zt ]. Set p = 13. 
BIC cr iterion sho ws that z t has no AR str ucture . AIC cr iterion is vir tually at. 
AR coefcients are v ery small. 
Treat x t as a ser ially uncorrelated shoc k ser ies. 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 6 / 45</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
MLE f or GARCH(1,1)
Likelihood function f or GARCH(1,1) 
L() = T 
t=1  ln 
2  x2 
t 
22 
t  1 
2 ln  
2 
t  
2 t = a0 + a1x2 
t1 + b12 t
1 
Need 2
1 to complete the denition of L() . 
The exact value of 2
1 does not matter in large samples , since 2 
t converges to its 
stationar y distr ibution f or large t . 
A reasonab le guess f or 2
1 impro ves accur acy in nite samples . 
Use unconditional sample v ariance: 2
1 = E[xt 2]. 
Impose constr aints on the par ameters to guar antee stationar ity. 
MLE-based estimates: 
= arg max L() 
(a0,a1,b1) 
subject to a 1  0, b1  0, a1 + b1 &lt; 1 
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 19 / 45</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
GARCH(1,1) Monte Car lo
MATLAB Code 
       
    
    
          
 
        
        
  
          
            
  
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 15 / 45</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>Heteroscedasticity GARCH GARCH Estimation: MLE GARCH: QMLE Alternativ e Models Multiv ariate Models 
GARCH(1,1) Dynamics
Let E t () denote the conditional e xpectation giv en time-t information. 
Et t2 
+1 = Eta0 + a1xt 2 + b1t 2 = a0 +(a1 + b1)t 2
Et t2 
+2 = Eta0 +(a1 + b1)t2 
+1 
= a0[1 +(a1 + b1)] + (a1 + b1)2t 2
Et t2 
+3 = Eta0 +(a1 + b1)t2 
+2 
= a0[1 +(a1 + b1)+(a1 + b1)2]+(a1 + b1)3t 2
. . . 
Et  
t2 
+n  
= a01 (a1 + b1)n 
+(a1 + b1)nt 2
1  a1  b1
c Leonid K ogan ( MIT , Sloan ) Volatility Models 15.450, F all 2010 12 / 45</text>
        </slide>
      </slides>
      <videos/>
    </lecture>
    <lecture>
      <lecture_title>Arbitrage-free pricing models</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/resources/mit15_450f10_lec01/</lecture_pdf_url>
      <lectureno>1</lectureno>
      <slides>
        <slide>
          <slideno>28</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Implied V olatility
The Blac k-Scholes model e xpresses the pr ice of the option as a function of 
the par ameters and the current stoc k price. 
European Call option pr ice 
C(St , K , r, , T ) 
Implied v olatility i of a Call option with str ike K i and time to matur ity T i is 
dened b y 
Ci = C(St , Ki , r, i , Ti ) 
Implied v olatility reconciles the obser ved option pr ice with the B-S f ormula. 
Option pr ices are typically quoted in ter ms of implied v olatilities . 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 34 / 48</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Arbitr age and Option Pr icing


STOCK
BOND
ARBITRAGE 
ARGUMENT 
OPTION
PRICE
PRICINGREDUNDANT OPTIONS 
ARBITRAGE 
FREEMODEL:
 STOCK
 BOND
 OPTION
EMPIRICAL 
ESTIMATION
PRICINGNONREDUNDANT OPTIONS 
OPTION
PRICE

c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 6 / 48</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Price of Risk
Under Q, 
QRt+1 = exp t  t 2/2  t t + t Q 
t+1 , t+1 N(0, 1) 
By denition of the r isk-neutr al probability measure , 
EQ 
t [Rt+1]= exp(rt ) t  t t = rt  
The r isk premium (measured using log e xpected g ross retur ns) equals 
t  rt = t t 
t is the quantity of r isk,
t is the pr ice of r isk.
Models with time-v arying pr ice of r isk, t , exhibit retur n predictability . 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 30 / 48</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Overview
As an example of how risk-neutr al pricing is used, we consider the problem of 
option pr icing when the under lying asset e xhibits stochastic v olatility . 
The benchmar k model is the Blac k-Scholes model. 
Stock (under lying) v olatility in the B-S model is constant. 
Empir ically , the B-S model is rejected: the implied volatility is not the same for 
options with diff erent str ikes. 
There are man y popular gener alizations of the B-S model. We explore the 
model with an EGARCH v olatility process . 
The EGARCH model addresses some of the empir ical limitations of the B-S 
model. 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 32 / 48</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Outline 
1 Introduction 
2 Arbitr age and SPD 
3 Factor Pr icing Models 
4 Risk-Neutr al Pricing 
5 Option Pr icing 
6 Futures 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 2 / 48</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
The Blac k-Scholes Model 
Consider a stoc k with pr ice S t , no dividends . Assume that 
St+1   
= exp   2/2 + P 
t+1 ,St 
where P 
t+1 N(0, 1), IID, under the ph ysical P-measure . 
Assume that the shor t-term interest r ate is constant. 
Assume that under the Q-measure , 
St+1   
= exp /2 + Q 
t+1 , t+1 N(0, 1), IID r  2Q 
St 
The time-t pr ice of an y European option on the stoc k, with a pa yoff 
CT = H(ST ), is giv en by 
= EQ er(T t)H(ST ) Ct t 
This is an arbitr age-free model. Prices of European call and put options are 
given by the Blac k-Scholes f ormula. 
c Arbitr age-F ree Pr icing Models 33 / 48  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Simulation 
Use one-w eek time steps . 
Calibr ate the par ameters using the estimates in Da y and Le wis (1992, T able 
3) 
a0 b1  
-3.620 0.529 -0.273 0.357 
Calibr ate the interest r ate 
exp(52  r)= exp(0.05) 
Start all N trajector ies with the same initial stoc k price and the same initial 
volatility , 0 = 15.5%/
52. 
Compute implied v olatilities f or Call/Put options with diff erent str ikes. 
Plot implied v olatilities against Blac k-Scholes deltas of Put options
(t = Pt /St ).
c Arbitr age-F ree Pr icing Models 38 / 48  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Absence of Arbitr age
Denition (Arbitr age) 
Arbitr age is a f easib le cash o w (gener ated b y a tr ading str ategy) which is 
non-negativ e in e very state and positiv e with non-z ero probability . 
We often descr ibe arbitr age as a str ategy with no initial in vestment, no r isk of 
a loss , and positiv e expected prot. Its a special case of the abo ve denition. 
Absence of arbitr age implies the La w of One Pr ice: two assets with the same 
payoff m ust ha ve the same mar ket price. 
Absence of arbitr age ma y be a v ery weak requirement in some settings and 
quite strong in others: 
Equities: few secur ities, man y states . Easy to a void arbitr age. 
Fixed income: many secur ities, few states . Not easy to a void arbitr age. 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 10 / 48</text>
        </slide>
        <slide>
          <slideno>42</slideno>
          <text>MIT OpenCourseWare
http://ocw.mit.edu 
15.450 Analytics of Finance 
Fall 2010 
For information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms .</text>
        </slide>
        <slide>
          <slideno>37</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
AR(1) Spot Pr ice
Under the r isk-neutr al measure , spot pr ice follows 
   
St = S   +  St1  S   + Q 
1   1   t 
Dene a ne w constant 
SQ  S   
1  
Then 
St  SQ =  St1  SQ+ Q 
t 
Under Q, spot pr ice is still AR(1), same mean-re version r ate, but diff erent 
long-r un mean. 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 44 / 48</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
AR(1) Spot Pr ice 
To compute the futures pr ice, iterate the AR(1) process f orward 
Q QQ 
t+1 St+1  S=  St  S+ 
Q Q + Q 
t+2 St+2  S=  St+1  S
= 2 St  SQ + t+2 + Q Q 
1t+ 
. . . 
Q Q + Q 
t+n + ... + n2Qt+2 + n1Q 
t+1 = nSt+n  S St  S
We conclude that 
[ST ]= SQ  
1  T tT 
t = EQ t + T tSt 
Futures pr ices of v arious matur ities giv en by the abo ve model do not admit 
arbitr age. 
c Arbitr age-F ree Pr icing Models 45 / 48  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Absence of Arbitr age
Consider a nite-hor izon discrete-time econom y, time = {0, ..., T }. 
Assume a nite n umber of possib le states of nature , s = 1, ..., N 
t = 0 t = 1 t = 2 
s1 
s2 
s3 
s4 
Denition (Arbitr age) 
Arbitr age is a f easib le cash o w (gener ated b y a tr ading str ategy) which is 
non-negativ e in e very state and positiv e with non-z ero probability . 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 9 / 48</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Arbitr age-F ree Pr icing Models 
Leonid K ogan 
MIT, Sloan 
15.450, F all 2010
 Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 1 / 48
 c</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
SPD and the Risk Premium
Let R t+1 be the g ross retur n on a r isky asset betw een t and t + 1: 
t+1Et Rt+1 = 1 t 
Et t+1 (1 + rt )= 1 t 
Using the denition of co variance , 
Conditional Risk Premium and SPD Beta 
Risk Premium t  Et [Rt+1]  (1 + rt ) = (1 + rt )Covt  
Rt+1, t+1 
t  
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 18 / 48</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Volatility Smile
0.20.25 0.30.35 0.40.45 0.50.55 0.61414.51515.51616.5
|Option Delta|Implied Volatility (%)
  
12 Weeks
24 Weeks
36 Weeks
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 39 / 48</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
AR(1) Spot Pr ice
Suppose that the spot pr ice follows an AR(1) process under the P-measure 
St  S = (St1  S)+ P 
t , P 
t N(0, 1), IID 
Assume that the r isk-neutr al Q-measure is related to the ph ysical P-measure 
by the state-pr ice density 

t+
t 1 = exp rt  
22 
 P 
t+1 
Market price of r isk  is constant. 
To compute futures pr ices, use Q 
t = P 
t + . 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 43 / 48</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Risk-Neutr al Measures
Q is a probability measure under which 
= EP Tu = EQ TBtPt t Du t Du , for an y asset with cash o w D t Bu u=t+1 u=t+1 
Under Q, the standard DCF f ormula holds . 
Under Q, e xpected retur ns on all assets are equal to the r isk-free r ate: 
EQ [Rt+1]= 1 + rt t 
If Q has positiv e density with respect to P, there is no arbitr age. 
There ma y exist m ultiple r isk-neutr al measures . 
Q is also called an equiv alent mar tingale measure (EMM). 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 24 / 48</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Absence of Arbitr age 
Fundamental Theorem of Asset Pr icing (FT AP) 
When there e xists a full set of state-contingent claims (mar kets are 
complete), there is a unique SPD consistent with absence of arbitr age: 
t (s) is the pr ice of a state-contingent claim pa ying $1 in state s at time t , 
normaliz ed by the probability of that state , pt . 
The re verse is also tr ue: if there e xists only one SPD , all options are
redundant.
When there are f ewer assets than states of nature , there can be man y SPDs 
consistent with no arbitr age. 
FTAP sa ys that if there is no arbitr age, there m ust be at least one w ay to
introduce a consistent system of positiv e state pr ices.
We drop e xplicit state-dependence and wr ite t instead of t (s). 
c Arbitr age-F ree Pr icing Models 14 / 48  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>41</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Readings
Back 2005, Chapter 1. 
E. Derman, I. Kani, 1994, The V olatility Smile and Its Implied T ree,
Quantitativ e Str ategies Research Notes, Goldman Sachs .
T. Day, C. Lewis, 1992, Stoc k Mar ket Volatility and the Inf ormation Content of 
Stock Inde x Options , Jour nal of Econometr ics 52, 267-287. 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 48 / 48</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Absence of Arbitr age 
From SPD to No Arbitr age 
Prove one direction (the easier one): if SPD e xists, there can be no arbitr age. 
Let W t denote the por tfolio v alue, (1 , ..., N ) are holdings of r isky assets 
1, ..., N. 
Manage the por tfolio betw een t = 0 and t = T . 
An arbitr age is a str ategy such that W 0  0 while W T  0, W T =0. 
The tr ading str ategy is self-nancing if it does not gener ate an y cash in- or 
out-o ws except f or time 0 and T . 
Formal self-nancing condition 
Wt+1 = ti 
+1Pti 
+1 = ti (Pti 
+1 + Dti 
+1) 
i i 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 12 / 48</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Price of Risk 
When P and Q are both Gaussian, w e can dene the pr ice of r isk (k ey notion 
in contin uous-time models). 
Consider an asset with g ross retur n 
Rt+1 = exp t  t 2/2 + t P 
t+1 , Et [Rt+1]= exp(t ) 
where P 
t+1 N(0, 1), IID, under the ph ysical P-measure . 
Let the shor t-term risk-free interest r ate be 
exp(rt ) 1 
Let the SPD be  
t+1 = t exp rt  t 2/2  t P 
t+1
Recall 
Q = P + t t t 
Under Q, the retur n distr ibution becomes 
Rt+1 = exp t  t 2/2  t t + t Q 
t+1 
where Q 
t+1 N(0, 1), IID, under the Q-measure . 
c Arbitr age-F ree Pr icing Models 29 / 48  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
SPDs and Risk-Neutr al Pricing
One can b uild models b y specifying the SPD and computing all asset pr ices. 
It is typically more con venient to use a related constr uction, called
risk-neutr al pricing.
Risk-neutr al pricing is a mathematical constr uction. It is often con venient and 
adds something to our intuition. 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 22 / 48</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Absence of Arbitr age 
From SPD to No Arbitr age 
Show that self-nancing implies that tWt = Et [t+1Wt+1]: 
self nancing Et [t+1Wt+1]= Et [t+1 ti 
+1Pti 
+1]= Et t+1 ti (Pti 
+1 + Dti 
+1) 
i i 
FTAP = ti tPti = tWt
i
Start at 0 and iter ate forward 
0W0 = E0[1W1]= E0[E1[2W2]] 
= E0[2W2]= ... 
= E0[T WT ] 
Given that the SPD is positiv e, it is impossib le to ha ve W 0  0 while W T  0, 
WT = 0. Thus , there can be no arbitr age. 
c Arbitr age-F ree Pr icing Models 13 / 48  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Futures
We want to b uild an arbitr age-free model of futures pr ices. 
In case of deter ministic interest r ates and costless stor age of the under lying 
asset, futures pr ice is the same as the f orward pr ice. 
In most pr actical situations , stor age is not costless , so simple replication 
arguments are not sufcient to der ive futures pr ices. 
Want to model futures pr ices f or multiple matur ities in an arbitr age-free
framework.
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 41 / 48</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Risk-Neutr al Pricing 
T
t is the time-t futures pr ice for a contr act matur ing at T . 
Futures are contin uously settled, so the holder of the long position collects 
T  T 
t t1 
each per iod. Contin uous settlement reduces the lik elihood of def ault. 
The mar ket value of the contr act is alw ays equal to z ero. 
In the r isk-neutr al pricing fr amework 
TBt QT
u  T
u1 E = 0 for all tt Bu u=t+1 
We conclude (using bac kwards induction and iter ated e xpectations) that the 
futures pr ices m ust satisfy 
EQ 
t T
t+1  T
t = 0 for all t 
and thus 
T 
t = EQT
T = EQ 
t [ST ]t 
where S T is the spot pr ice at T . 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 42 / 48</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
SPD and Change of Measure
q(t ) dene probabilities . Are these r isk-neutr al probabilities? 
For an y asset i , 
1  q(t+1) 1QRi 
t+1 Ri 
t+1 E = t 1 + rt q(t ) 1 + rt t+1C( t ) 
(1 + rt ) ( t+1)p(t+1) 1 Rti 
+1 = ( t )p(t ) 1 + rt t+1C( t ) 
=  p
p(
(t+
t ) 1) 
(
(t+
t ) 1) Rti 
+1 
t+1C( t ) 
t+1 Rti 
+1 = EP 
t = 1 t 
Conclude that q (t ) dene r isk-neutr al probabilities . 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 26 / 48</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
SPD and Change of Measure 
Constr uct risk-neutr al probabilities from the SPD . 
Consider our tree-model of the mar ket and let C( t ) denote the set of 
time-(t + 1) nodes which are children of node t . 
Dene n umbers q (t+1) for all nodes t+1  C( t ) by the f ormula 
q(t+1)=(1 + rt )q(t ) ( t+1)p(t+1) 
( t )p(t ) 
Recall that the r atio p (t+1)/p(t ) is the node-t conditional probability of 
t+1. 
q(t+1) &gt; 0 and 
  ( t+1)p(t+1)q(t+1)= q(t ) (1 + rt ) ( t )p(t )t+1C( t ) t+1C( t ) 
= q(t )EP 
t ( t+1)(1 + rt )= q(t )( t ) 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 25 / 48</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Option V aluation b y Monte Car lo
We use Monte Car lo sim ulation to compute option pr ices. 
Using the v aluation f ormula 
= EQ er(T t)H(ST ) Ct t 
Call option pr ice can be estimated b y sim ulating N trajector ies of the 
under lying asset Sun , n = 1, ..., N, under Q, and a veraging the discounted 
payoff 
Ct  N 1 N
er (T t) max(STn  K , 0) 
n=1 
Resulting option pr ices are arbitr age-free because the y satisfy the
risk-neutr al pricing relationship .
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 37 / 48</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Expected Gain on Futures P ositions 
What is the e xpected gain on a long position in a futures contr act? 
Under Q, the e xpected gain is z ero: 
EQ T
t+1  T = 0 for all tt t 
Futures contr acts pro vides e xposure to r isk, P. This r isk is compensated, 
with the mar ket price of r isk . 
T
t+1  T
t = T t1Q 
t+1 = T t1 + T t1P 
t+1 
(Use Q 
t+1 =  + P 
t+1) 
Under P, e xpected gain is non-z ero, because Q has non-z ero mean under P 
EP T
t+1  T = T t1 for all tt t 
Can estimate model par ameters , including , from histor ical futures pr ices. 
c Arbitr age-F ree Pr icing Models 46 / 48  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Option Pr icing b y Replication
The or iginal approach to option pr icing, going bac k to Blac k, Scholes , and 
Merton, is to use a replication argument together with the La w of One Pr ice. 
Consider a binomial model f or the stoc k price 
Payoff of an y option on the stoc k can be replicated b y dynamic tr ading in the 
stock and the bond, thus there is a unique arbitr age-free option v aluation. 
Prob lem solv ed? 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 4 / 48</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Normality-Preser ving Change of Measure 
Results 
Under P, P N(0, 1). Dene a ne w measure Q, such that under Q, 
P N(, 1). 
Let  = d
dQ
P . Then, 
(P)= exp (P + )2 
+(P)2 
= exp P  2 
2 2 2 
The change of measure is giv en by a log-nor mal r andom v ariable (P) 
serving as the density of the ne w measure . 
Normality-Preser ving Change of Measure 
dQ 
dP = eP2/2  Q = P +   N(0, 1) under Q 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 28 / 48</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Absence of Arbitr age 
Fundamental Theorem of Asset Pr icing (FT AP) 
Proposition (FT AP) 
Absence of arbitr age is equiv alent to e xistence of a positiv e stochastic process 
{t (s) &gt; 0} such that f or an y asset with pr ice P t (PT = 0) and cash o w D t , 
Pt (s) = Et  T 
u=t+1 u (s) 
t (s) Du(s)  
or, in retur n form, 
Et  t+1(s) 
t (s) Rt+1(s)  
= 1, Rt+1(s) = Pt+1(s) + Dt+1(s) 
Pt (s) 
Stochastic process t (s) is also called the state-pr ice density (SPD). 
FTAP implies the La w of One Pr ice. 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 11 / 48</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Arbitr age-F ree Models using SPD 
Discounted Cash Flo w Model (DCF) 
Algor ithm: A DCF Model 
1 Specify the process f or cash o ws, Dt . 
2 Specify the SPD , t . 
3 Derive the asset pr ice process as 
Pt = Et  T 
u=t+1 u 
t Du  
(DCF) 
To mak e this pr actical, need to lear n how to par ameter ize SPDs in step (2), 
so that step (3) can be perf ormed efciently . 
Can use discrete-time conditionally Gaussian processes . 
SPDs are closely related to r isk-neutr al pricing measures . Useful f or building 
intuition and f or computations . 
c Arbitr age-F ree Pr icing Models 16 / 48  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Drawbac ks of the Binomial Model
The binomial model (and its v ariants) has a f ew issues . 
If the binomial depiction of mar ket dynamics w as accur ate, all options w ould 
be redundant instr uments . Is that realistic? 
Empir ically , the model has prob lems: one should be ab le to replicate option 
payoffs perf ectly in theor y, that does not happen in reality . 
Why build models like the binomial model? Convenience . Unique option price 
by replication is a v ery appealing f eature . 
How can one mak e the model more realistic , taking into account lac k of
perfect replication?
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 5 / 48</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Implied V olatility Smile (Smir k)
If option pr ices satised the B-S assumptions , all implied v olatilities w ould be 
the same , equal to , the v olatility of the under lying pr ice process . 
Empir ically , implied v olatilities depend on the str ike and time to matur ity. 
2QUANTITATIVE STRATEGIES RESEARCH NOTESSachsGoldman
The binomial tree corresponding to the risk-neutral stock evolution is
the same for all options on that stock, irrespective of their strike levelor time to expiration. The stock tree cannot know about whichoption we are valuing on it.
Market options prices are not exactly consistent with theoretical
prices derived from the BS formula. Nevertheless, the success of theBS framework has led traders to quote a call options market price interms of whatever constant local volatility
imp makes the BS for-
mula value equal to the market price. We call  imp theBlack-Scholes-
equivalent orimplied volatility , to distinguish it from the theoreti-
cally constant local volatility assumed by the BS theory. In essence,
imp is a means of quoting prices.
How consistent are market option prices with the BS formula? Figure
2(a) shows the decrease of imp with the strike level of options on the
S&amp;P 500 index with a xed expiration of 44 days, as observed on May5, 1993. This asymmetry is commonly called the volatility skew.Figure 2(b) shows the increase of
 imp with the time to expiration of
at-the-money options. This variation is generally called the volatilityterm structure. In this paper we will refer to them collectively asthe volatility smile.
FIGURE 2. Implied Volatilities of S&amp;P 500 Options on May 5, 1993
In Figure 2(a) the data for strikes above (below) spot comes from call
(put) prices. In Figure 2(b) the average of at-the-money call and putimplied volatilities are used. You can see that
impfalls as the strike
level increases. Out-of-the-money puts trade at higher implied vola-tilities than out-of-the-money calls. Though the exact shape and mag-nitude vary from day-to-day, the asymmetry persists and belies theBS theory, which assumes constant local (and therefore, constantThe Smile
(a) (b)
O
O
O
O
O
OO
OOO
option strike (% of spot)90 92 94 96 98 100 102 10410 12 14 16 18OOOOO
option expiration (days)option implied volatility (%)
50 100 150 20010 11 12 13option implied volatility (%)
Source: E. Der man, I. Kani, 1994, The V olatility Smile and Its Implied T ree, Quantitativ e Str ategies Research Notes, Goldman Sachs 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 35 / 48</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
EGARCH Model
Consider a model of stoc k retur ns with EGARCH v olatility process . 
Assume the stoc k pays no dividends , and shor t-term interest r ate is constant. 
Stock retur ns are conditionally log-nor mally distr ibuted under the Q-measure 
ln SS
tt 
1 = r  t2
2 1 + t1Q 
t , Q 
t N(0, 1), IID 
Conditional e xpected g ross retur n on the under lying asset equals e xp(r). 
Conditional v olatility t follows an EGARCH process under Q 
 
2  
2  Q   2ln t = a0 + b1 ln t1 + Q 
t1 +  t1  
Option pr ices can be computed using the r isk-neutr al valuation f ormula. 
c Arbitr age-F ree Pr icing Models 36 / 48  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>1
2Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Arbitr age and Option Pr icing 
Take an alter nativ e approach to option pr icing. 
Even when options cannot be replicated (options are not redundant), there 
should be no arbitr age in the mar ket. 
The prob lem with non-redundant options is that there ma y be more than one 
value of the option pr ice toda y consistent with no arbitr age. 
Change the objectiv e: constr uct a tr actab le joint model of the pr imitiv e assets 
(stoc k, bond, etc.) and the options , which is
Free of arbitr age;
Conforms to empir ical obser vations .
When options are redundant, no need to look at option pr ice data: there is a 
unique option pr ice consistent with no arbitr age. 
When options are non-redundant, there ma y be man y arbitr age-free option 
prices at each point in time , so w e need to rely on histor ical option pr ice dat a 
to help select among them. 
We kno w ho w to estimate dynamic models (MLE, QMLE, etc.). Need to lear n 
how to b uild tr actab le arbitr age-free models . 
c Arbitr age-F ree Pr icing Models 7 / 48  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Risk-Neutr al Measures
The DCF f ormulation with an SPD is mathematically equiv alent to a change 
of measure from the ph ysical probability measure to the r isk-neutr al 
measure . The r isk-neutr al formulation off ers a useful and tr actab le alter nativ e 
to the DCF model. 
Let P denote the ph ysical probability measure (the one behind empir ical 
obser vations), and Q denote the r isk-neutr al measure . Q is a mathematical 
constr uction used f or pricing and only indirectly connected to empir ical data. 
Let B t denote the v alue of the r isk-free account: 
t1
Bt = (1 + ru ) 
u=0 
where r u is the r isk-free r ate dur ing the per iod [u, u + 1). 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 23 / 48</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Example: Binomial T ree 
Risk-Neutr al Measure 
FTAP implies that St+1 = uS , t+1(u) 
q
1 + r  d qu+(1q)d = 1+rt q = St , t  u  d 
Alternativ ely, compute tr ansition (1  q)
probability under Q using the SPD St+1 = dS , t+1(d)
:
q = p(1 + rt ) t+1(u)
t
1 1 + rt  d 1 + rt  d = p(1 + rt ) = p(1 + rt ) u  d u  d 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 27 / 48</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
SPD and Multi-F actor Models
Alternativ e theor ies (e .g., APT), imply that there are m ultiple pr iced f actors in 
returns, not just the mar ket factor . 
Multi-f actor models are commonly used to descr ibe the cross-section of stock 
returns (e .g., the F ama-F rench 3-f actor model). 
Assume that 
t+1/t = a + b1Ft1 
+1 + ...bK FtK 
+1 
where Fk , k = 1, ..., K are K factors . Factors ma y be por tfolio retur ns, or 
non-retur n variables (e .g., macro shoc ks). 
Then r isk premia on all stoc ks ha ve factor str ucture 
  K 
Et Rtj 
+1 (1 + rt )= k Covt Rtj 
+1, Ftk 
+1 
k=1 
Factor models are simply statements about the f actor str ucture of the SPD . 
c Arbitr age-F ree Pr icing Models 20 / 48  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
SPD and CAPM
CAPM says that risk premia on all stocks must be propor tional to their market 
betas . 
CAPM can be re-inter preted as a statement about the SPD pr icing all assets . 
Assume that 
t+1/t = a  bRtM 
+1 
where RM is the retur n on the mar ket por tfolio. (The abo ve formula ma y be 
viewed as appro ximation, if it implies negativ e values of ). 
Using the gener al formula for the r isk premium, f or an y stoc k j, 
Et Rtj 
+1 (1 + rt )= const  Covt (Rtj 
+1, RtM 
+1) 
The abo ve formula w orks for an y asset, including the mar ket retur n. Use this 
to nd the constant: 
   Covt (Rtj 
+1, RtM 
+1)Et Rtj 
+1 (1 + rt )= Et RtM 
+1 (1 + rt ) Vart (RtM 
+1) 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 19 / 48</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Summar y
Existence of SPD or r isk-neutr al probability measure guar antees absence of 
arbitr age. 
Factor pr icing models , e.g., CAPM, are models of the SPD . 
Can b uild consistent models of m ultiple options b y specifying the r isk-neutr al 
dynamics of the under lying asset. 
Black-Scholes model, v olatility smiles , and stochastic v olatility models . 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 47 / 48</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>Introduction Arbitr age and SPD Factor Pr icing Models Risk-Neutr al Pricing Option Pr icing Futures 
Example: Binomial T ree 
SPD 
Options are redundant: any payoff can 
be replicated b y dynamic tr ading. 
FTAP implies that 
p t+1(u)(1 + r)+(1  p) t+1(d)(1 + r)= 1 St+1 = uS , t+1(u) 
t tp 
t+1(u) t+1(d)p u +(1  p) d = 1 St , tt t 
(1  p) 
SPD is unique up to nor malization St+1 = dS , t+1(d) 
0 = 1: 
t+1(u) 1 1 + r  d = t p(1 + r) u  d 
t+1(d) = 1 u  (1 + r) 
t (1  p)(1 + r) u  d 
c Leonid K ogan ( MIT , Sloan ) Arbitr age-F ree Pr icing Models 15.450, F all 2010 15 / 48</text>
        </slide>
      </slides>
      <videos/>
    </lecture>
    <lecture>
      <lecture_title>Dynamic portfolio choice II: Dynamic programming</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/resources/mit15_450f10_lec05/</lecture_pdf_url>
      <lectureno>5</lectureno>
      <slides>
        <slide>
          <slideno>3</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
IID Retur ns 
Formulation 
Consider the discrete-time mar ket model. 
There is a r isk-free bond, pa ying g ross interest r ate R f = 1 + r . 
There is a r isky asset, stoc k, pa ying no dividends , with g ross retur n R t , IID 
over time . 
The objectiv e is to maximiz e the ter minal e xpected utility 
max E0 [U(WT )] 
where por tfolio v alue W t results from a self-nancing tr ading str ategy 
Wt = Wt1 [t1Rt +(1  t1)Rf ] 
t denotes the share of the stoc k in the por tfolio. 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 5 / 35</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Asset Allocation with Retur n Predictability 
Bellman equation 
We conjecture that the v alue function is of the f orm 
J(t, Wt , t )= A(t, t )Wt 1 
The Bellman equation tak es form 
A(t  1, t1)Wt1

1  = max Et1 A(t, t )(Wt1(t1(Rt  Rf )+ Rf ))1 
t1 
The initial condition f or the Bellman equation implies 
1A(T , T )= 1   
We verify that the conjectured v alue function satises the Bellman equation if 
A(t  1, t1)= max Et1 A(t, t )(t1(Rt  Rf )+ Rf )1 
t1 
Note that the RHS depends only on t1. 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 26 / 35</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
IID Retur ns 
Binomial tree 
Stock price 
St = St1  u, with probability p 
d, with probability 1  p 
Start at time T  1 and compute the v alue function
J(T  1, WT 1)= max ET 1 [U(WT )|T 1]=

 T 1 
pU [WT 1 (T 1u +(1  t1)Rf )] +  
max 
T 1(1  p)U [WT 1 (T 1d +(1  T 1)Rf )] 
Note that value function at T  1 depends on WT 1 only, due to the IID return 
distribution. 
c Dynamic P ortfolio Choice II 10 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
IID Retur ns 
Binomial tree 
Backward induction. Suppose that at t, t + 1, ..., T  1 the value function has 
been der ived, and is of the f orm J(s, Ws). 
Compute the v alue function at t  1 and v erify that it still depends only on 
portfolio v alue: 
J(t  1, Wt1)= max Et1 [J(t, Wt )|t1]= 

 t1 
pJ [t, Wt1 (t1u +(1  t1)Rf )] +  
max 
t1(1  p)J [t, Wt1 (t1d +(1  t1)Rf )] 
Optimal por tfolio policy  
t1 depends on time and the current por tfolio v alue: 
 = (t  1, Wt1)t1 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 11 / 35</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Asset Allocation with Retur n Predictability 
Optimal por tfolio policy 
The optimal por tfolio policy satises 
t1 = arg max Et1 A(t, t )(t1(Rt  Rf )+ Rf )1 
t1 
= arg max Et1 [A(t, t )] Et1 (t1(Rt  Rf )+ Rf )1 
t1 
because , conditionally on t1, t is independent of R t . 
Optimal por tfolio policy is m yopic, does not depend on the prob lem hor izon. 
This is due to the independence assumption. 
Can nd t numer ically . 
In the contin uous-time limit of t 0, 
t  r = t 2 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 27 / 35</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Black-Scholes Model, CRRA Utility 
Limit of binomial tree 
Parameter ize the binomial tree so the stoc k price process con verges to the 
Geometr ic Bro wnian motion with par ameters  and : p = 1/2, 
  
u = exp   2 
t + 
t , d = exp   2 
t  
t2 2 
Let R f = exp(r t). Time step is no w t instead of 1. 
Take a limit of the optimal por tfolio policy as t 0:

 p (tu +(1  t )Rf )1 + 
 = arg max A(t + t)t t  1(1  p)(td +(1  t )Rf ) 1 +(1  )(r + t (  r )) t 
 arg max A(t + t) 
t (1/2)(1  )2 
t 2 t 
Optimal por tfolio policy 
   r = t 2 
c Dynamic P ortfolio Choice II 14 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>MIT OpenCourseWare
http://ocw.mit.edu 
15.450 Analytics of Finance 
Fall 2010 
For information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms .</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Amer ican Option Pr icing 
Consider the prob lem of pr icing an Amer ican option on a binomial tree . 
Interest r ate is r and the option pa yoff at the e xercise date  is H(S). 
The objectiv e is to nd the optimal e xercise policy , which solv es 
Q 
0 (1 + r )H(S) max E
 
The e xercise decision at  can depend only on inf ormation a vailab le at . 
The objectiv e tak es form 
T 1
Q 
0 (1 + r )tH(St )Xt t max E
t {0,1} t=0 
If X t = 1, the option has not been e xercised y et. 
Option pr ice P(t, St , X = 0)= 0 and P (t, St , X = 1) satises 
P(t, St , X = 1)= max H(St ), (1 + r)1EQ 
t [P(t + 1, St+1, X = 1)] 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 24 / 35</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Bellman Equation
The v alue function and the optimal policy solv e the Bellman equation 
J(t  1, Yt1)= max Et1 [u(t  1, Yt1, t1)+ J(t, Yt )|t1] 
t1 
J(T , YT )= u(T , YT ) 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 22 / 35</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Formulation 
Optimal stopping 
Optimal stopping is a special case of dynamic optimization, and can be 
formulated using the abo ve framework. 
Consider the prob lem of pr icing an Amer ican option on a binomial tree . 
Interest r ate is r and the option pa yoff at the e xercise date  is H(S). 
The objectiv e is to nd the optimal e xercise policy , which solv es 
max EQ 
0 (1 + r )H(S)
 
The e xercise decision at  can depend only on inf ormation a vailab le at . 
Dene the state v ector 
(St , Xt ) 
where S t is the stoc k price and X t is the status of the option 
Xt  {0, 1} 
If X t = 1, the option has not been e xercised y et. 
c Dynamic P ortfolio Choice II 20 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
References
Bertsimas , D., A. Lo , 1998, Optimal control of e xecution costs , Jour nal of 
Financial Markets 1, 1-50. 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 34 / 35</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Key Points
Principle of Optimality f or Dynamic Prog ramming. 
Bellman equation. 
Formulate dynamic por tfolio choice using controlled Mar kov processes . 
Mertons solution. 
Myopic policy and hedging demand. 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 33 / 35</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Principle of Optimality
Suppose w e have solv ed the prob lem, and f ound the optimal policy  
t . 
Consider a tail subprob lem of maximizing E s [U(WT )] starting at some point 
in time s with w ealth W s. 
   time s , 
Wealth W s, 
policy (s) 
s 
Value f-n J (s, Ws) policy (s)    U(WT ) 
U(WT ) 
   U(WT ) 
U(WT ) s+1 
policy (s) 
s+1 
 
  
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 6 / 35</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Dynamic P ortfolio Choice II
Dynamic Prog ramming 
Leonid K ogan 
MIT, Sloan 
15.450, F all 2010
 Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 1 / 35
 c</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Optimal Control of Ex ecution Costs 
Formulation 
Assume that the stoc k price follows 
St = St1 + bt + t , &gt; 0 
Assume that t has z ero mean conditional on S t1 and b t :
E[t |bt , St1]= 0
Dene an additional state v ariable W t denoting the n umber of shares left to 
purchase: 
Wt = Wt1  bt1, W0 = b 
The constr aint that b shares m ust be bought at the end of per iod T can be 
formaliz ed as 
bT = WT 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 30 / 35</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Optimal Control of Ex ecution Costs 
Solution 
We can capture the dynamics of the prob lem using a state v ector 
Yt =(St1, Wt ) 
which clear ly is a controlled Mar kov process . 
Start with per iod T and compute the v alue function 
J(T , ST 1, WT )= ET [ST WT ]=(ST 1 + WT ) WT 
Apply the Bellman equation once to compute
J(T  1, ST 2, WT 1)= min ET 1 [ST 1bT 1 + J(T , ST 1, WT )]
bT 1 
(ST 2 + bT 1 + T 1)bT 1+ = min ET 1 bT 1 J(T , ST 2 + bT 1 + T 1, WT 1  bT 1) 
Find 
WT 1b = T 1 2 
3J(T  1, ST 2, WT 1)= WT 1 ST 2 + WT 14 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 31 / 35</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Optimal Control of Ex ecution Costs 
Formulation 
Suppose w e need to b uy b shares of the stoc k in no more than T periods. 
Our objectiv e is to minimiz e the e xpected cost of acquir ing the b shares . 
Let b t denote the n umber of shares bought at time t . 
Suppose the pr ice of the stoc k is S t . 
The objectiv e is T
min E0 Stbt b0,...,T 1 t=0 
What mak es this prob lem interesting is the assumption that tr ading aff ects 
the pr ice of the stoc k. This is called pr ice impact. 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 29 / 35</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
IID Retur ns, CRRA Utility 
Binomial tree 
Simplify the por tfolio policy under CRRA utility U (WT )= 11 
 WT 1 
J(T  1, WT 1)= max ET 11 W 1|T 1 = 
T 1 1   T 
 
  
1 W 1 1 p 1 T 1 (T 1u +(1  T 1)Rf )+ 
max 
T 1 1 W 1 1(1  p) 1 T 1 (T 1d +(1  T 1)Rf )
= A(T  1) W 1 
T 1 
where A (T  1) is a constant giv en by 

p (T 1u +(1  T 1)Rf )1 + 
1A(T  1)= max 
T 11  (1  p)(T 1d +(1  T 1)Rf )1 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 12 / 35</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Asset Allocation with Retur n Predictability 
Formulation 
Suppose stoc k retur ns ha ve a binomial distr ibution: p = 1/2, 
  
ut = exp t  2 
t + 
t , dt = exp t  2 
t  
t2 2 
where the conditional e xpected retur n t is stochastic and f ollows a Mar kov 
process with tr ansition density 
f (t |t1) 
Conditionally on t1, t is independent of R t . 
Let R f = exp(r t). 
The objectiv e is to maximiz e expected CRRA utility of ter minal por tfolio v alue 
maxE0 1 W 1 
1   T 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 25 / 35</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Gener al Formulation 
Consider a discrete-time stochastic process Y t =(Yt 1 , ..., YtN ). 
Assume that the time-t conditional distr ibution of Y t+1 depends on time , its 
own value and a control v ector t : 
pdft (Yt+1)= p(Yt+1, Yt , t , t) 
For example , vector Y t could include the stoc k price and the por tfolio v alue, 
Yt =(St , Wt ), and the tr ansition density of Y would depend on the por tfolio 
holdings t . 
The objectiv e is to maximiz e the e xpectation 
T 1
E0 u(t, Yt , t )+ u(T , YT ) 
t=0 
For example , in the IID+CRRA case abo ve, Yt = Wt , u(t, Yt , t )= 0, 
t = 0, ..., T  1 and u (T , YT )=(1  )1 (YT )1 . 
We call Y t a controlled Mar kov process. 
c Dynamic P ortfolio Choice II 17 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Overview
When all state-contingent claims are redundant, i.e ., can be replicated b y 
trading in a vailab le assets (e .g., stoc ks and bonds), dynamic por tfolio choice 
reduces to a static prob lem. 
There are man y practical prob lems in which der ivatives are not redundant, 
e.g., prob lems with constr aints , transaction costs , unspanned r isks 
(stochastic v olatility). 
Such prob lems can be tac kled using Dynamic Prog ramming (DP). 
DP applies m uch more gener ally than the static approach, b ut it has pr actical 
limitations: when the closed-f orm solution is not a vailab le, one m ust use 
numer ical methods which suff er from the curse of dimensionality . 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 4 / 35</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Principle of Optimality
Let 
(s) 
s , (s)s 
+1, ..., (s) 
T 1 
denote the optimal policy of the subprob lem. 
The Pr inciple of Optimality states that the optimal policy of the tail 
subprob lem coincides with the corresponding por tion of the solution of the 
original prob lem. 
The reason is simple: if policy ((s) ) could outperf orm the original policy on 
the tail subprob lem, the or iginal prob lem could be impro ved by replacing the 
corresponding por tion with ((s) ). 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 7 / 35</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
IID Retur ns 
DP 
DP is easy to apply . 
Compute the optimal policy one per iod at a time using bac kward induction. 
At each step , the optimal por tfolio policy maximiz es the conditional
expectation of the ne xt-per iod v alue function.
The v alue function can be computed recursiv ely. 
Optimal por tfolio policy is dynamically consistent: the state-contingent policy 
optimal at time 0 remains optimal at an y future date t . Principle of Optimality 
is a statement of dynamic consistency . 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 9 / 35</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
IID Retur ns 
DP 
Suppose that the time-t conditional e xpectation of ter minal utility under the 
optimal policy depends only on the por tfolio v alue W t at time t , and nothing 
else. This conjecture needs to be v eried later . 
EtU(WT )|(t) 
t,...,T 1 = J(t, Wt ) 
We call J (t, Wt ) the indirect utility of w ealth. 
Then we can comput e the optimal portfolio policy at t  1 and the time-(t  1) 
expected ter minal utility as 
J(t  1, Wt1)= max Et1 [J(t, Wt )] (Bellman equation) 
t1 
Wt = Wt1 [t1Rt +(1  t1)Rf ] 
J(t, Wt ) is called the v alue function of the dynamic prog ram. 
c Dynamic P ortfolio Choice II 8 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Asset Allocation with Retur n Predictability 
Hedging demand 
Assume no w that the dynamics of conditional e xpected retur ns is correlated 
with stoc k retur ns, i.e., the distr ibution of t given t1 is no longer 
independent of R t . 
The v alue function has the same functional f orm as bef ore, 
J(t, Wt , t )= A(t, t )Wt 1 
The optimal por tfolio policy satises 
 
t1 = arg max Et1 A(t, t )(t1(Rt  Rf )+ Rf )1 
t1 
Optimal por tfolio policy is no longer m yopic: dependence betw een t and R t 
affects the optimal policy . 
The deviation from the myopic policy is called hedging demand. It is non-z ero 
due to the f act that the in vestment oppor tunities (t ) change stochastically , 
and the stoc k can be used to hedge that r isk. 
c Dynamic P ortfolio Choice II 28 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
IID Retur ns, CRRA Utility 
Binomial tree 
Backward induction 
J(t  1, Wt1)= max Et1 A(t)Wt 1|t1 = 
t1 
 pA(t)Wt1

1  (t1u +(1  t1)Rf )1 + 
max 
t1  (1  p)A(t)W 1 (t1d +(1  t1)Rf )1 
t1 
= A(t  1) W 1 
t1 
where A (t  1) is a constant giv en by 

p (t1u +(1  t1)Rf )1 + 
 
A(t  1)= max A(t) 
t1 (1  p)(t1d +(1  t1)Rf )1 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 13 / 35</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Formulation 
Optimal stopping 
Let the control be of the f orm t  {0, 1}. If t = 1, the option is e xercised at 
time t , otherwise it is not. 
The stoc k price itself f ollows a Mar kov process: distribution of S t+1 depends 
only on S t . 
The option status X t follows a controlled Mar kov process: 
Xt+1 = Xt (1  t ) 
Note that once X t becomes z ero, it sta ys zero forever. Status of the option 
can s witch from X t = 1 to X t+1 = 0 pro vided t = 1. 
The objectiv e tak es form 
T 1
max EQ 
0 (1 + r )tH(St )Xt t t t=0 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 21 / 35</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Optimal Control of Ex ecution Costs 
Solution 
Contin ue with bac kward induction to nd 
WT kb = T k k + 1 
k + 2J(T  k, ST k1, WT k )= WT k ST k1 + WT k2(k + 1) 
Conclude that the optimal policy is deter ministic 
bb0 = b 
1 = = b= T T + 1 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 32 / 35</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Formulation 
State augmentation 
Many dynamic optimization prob lems of pr actical interest can be stated in the 
above form, using controlled Mar kov processes . Sometimes one needs to be 
creativ e with denitions . 
State augmentation is a common tr ick used to state prob lems as abo ve. 
Suppose , for example , that the ter minal objectiv e function depends on the 
average of por tfolio v alue betw een 1 and T . 
Even in the IID case , the prob lem does not immediately t the abo ve 
framework: if the state v ector is Y t =(Wt ), the ter minal objectiv e 
1T1 1  
Wt1   T t=1 
cannot be e xpressed as 
T 1
u(t, Yt , t )+ u(T , YT ) 
t=0 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 18 / 35</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Formulation 
State augmentation 
Contin ue with the pre vious e xample . Dene an additional state v ariable At : 
t1  
At = Wst s=1 
Now the state v ector becomes 
Yt =(Wt , At ) 
Is this a controlled Mar kov process? 
The distr ibution of W t+1 depends only on W t and t . 
Verify that the distr ibution of (Wt+1, At+1) depends only on (Wt , At ): 
t+11  1At+1 = Ws = (tAt + Wt+1)t + 1 t + 1 s=1 
Yt is indeed a controlled Mar kov process . 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 19 / 35</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Outline
1 
2 
3 Introduction to Dynamic Prog ramming 
Dynamic Prog ramming 
Applications 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice II 15.450, F all 2010 2 / 35</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>Introduction to Dynamic Prog ramming Dynamic Prog ramming Applications 
Black-Scholes Model, CRRA Utility 
Optimal por tfolio policy 
   r = t 2 
We have reco vered the Mer tons solution using DP . Mer tons original
derivation w as very similar , using DP in contin uous time .
The optimal por tfolio policy is m yopic, does not depend on the prob lem 
horizon. 
The v alue function has the same functional f orm as the utility function: 
indirect utility of w ealth is CRRA with the same coefcient of relativ e risk 
aversion as the or iginal utility . That is wh y the optimal por tfolio policy is 
myopic. 
If retur n distr ibution w as not IID , the por tfolio policy w ould be more comple x. 
The v alue function w ould depend on additional v ariables, thus the optimal 
portfolio policy w ould not be m yopic. 
c Dynamic P ortfolio Choice II 15 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
      </slides>
      <videos/>
    </lecture>
    <lecture>
      <lecture_title>Parameter estimation</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/resources/mit15_450f10_lec07/</lecture_pdf_url>
      <lectureno>7</lectureno>
      <slides>
        <slide>
          <slideno>37</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Discussion 
QMLE approach helps specify moments in GMM. 
Do not use b lindly , verify that the moment conditions are v alid. 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 38 / 40</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Example: QMLE f or AR(p) Time Ser ies 
AR(p) time ser ies model with IID non-Gaussian errors:
xt+1 = a0 + a1xt + ...apxt+1p + t+1, E[t+1|xt , ..., xt+1p]= 0
Pretend errors are Gaussian to constr uct L() : 
 (xt+1  a0  a1xt  ...apxt+1p)2 
L() = T 1
 ln 
22  22 
t=p 
Optimality conditions: 
(xti t+1)= 0, i = 0, ..., p  1, t+1 = 0 
t t 
Valid moment conditions (v erify). GMM justies QMLE.
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 34 / 40</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Example: Exponential Distr ibution
Suppose w e have T independent obser vations from the e xponential
distribution 
p(xt , ) =  exp(xt ) 
Likelihood function 
T 
L() = (xt + ln ) 
t=1 
First-order condition 
 
 T 
xt  
+ T = 0 
t=1 
implies T 1 
 = t=1 xt 
T 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 13 / 40</text>
        </slide>
        <slide>
          <slideno>40</slideno>
          <text>MIT OpenCourseWare
http://ocw.mit.edu 
15.450 Analytics of Finance 
Fall 2010 
For information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms .</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Example: AR(p) Model of GDP Gro wth 
Set p = 7. 
0 1 2 3 4 5 6 72.82.752.72.65LogLikelihood  penalty
pAIC
AIC dictates p = 5. 
AR coefcients a 1, ..., a5: 
0.3185 , 0.1409 , 0.0759 , 0.0600 , 0.0904 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 24 / 40</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
AIC and BIC 
Start by specifying the maxim um possib le order p. 
Make sure that p grows with the sample siz e, but not too f ast: 
lim p = , lim p = 0 
T  T  T  
For example , can choose p = 41 (ln T )2. 
Find the optimal V AR order p as
2
p = arg max L(; p) penalty (p)
0ppT 
where 
 AIC: T 2 pN2
penalty (p)=
 BIC: ln 
TT pN2
In larger samples , BIC selects lo wer-order models than AIC .
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 22 / 40</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
MLE and Model Selection
In practice , we often do not kno w the e xact model. 
In some situations , MLE can be adapted to perf orm model selection. 
Suppose w e are consider ing se veral alter nativ e models , one of them 
is the correct model. 
If the sample is large enough, w e can identify the correct model b y 
compar ing maximiz ed lik elihoods and penalizing them f or the n umber 
of par ameters the y use . 
Various f orms of penalties ha ve been proposed, dening v arious
information cr iteria.
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 20 / 40</text>
        </slide>
        <slide>
          <slideno>34</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Example: Interest Rate Model
Interest r ate model:
rt+1 = a0 + a1rt + t+1, E(t+1|rt )= 0, E(2 
t+1|rt )= b0 + b1rt
GMM using the moment conditions 
E (1, rt )(rt+1  a0  a1rt )= 0 
E (1, rt ) (rt+1  a0  a1rt )2  b0  b1rt = 0 
(a0, a1) can be estimated from the rst pair of moment conditions . 
Equiv alent to OLS , ignore inf ormation about second moment. 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 35 / 40</text>
        </slide>
        <slide>
          <slideno>38</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Key Points
Parameter estimators , consistency . 
Likelihood function, maxim um lik elihood par ameter estimation. 
Identication of par ameters b y GMM. 
QMLE. Verify the v alidity of QMLE b y inter preting the resulting 
moments in GMM fr amework. 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 39 / 40</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Example: Interest Rate Model
Interest r ate model:
rt+1 = a0 + a1rt + t+1, E(t+1|rt )= 0, E(t2 
+1|rt )= b0 + b1rt
Derive moment conditions f or GMM. 
Note that f or an y function g (rt ),
E[g(rt )t+1]= E [E[g(rt )t+1|rt ]] = E [g(rt )E[t+1|rt ]] = 0
Using g (rt )= 1 and g (rt )= rt , 
E (1, rt )(rt+1  a0  a1rt )= 0 
E (1, rt ) (rt+1  a0  a1rt )2  b0  b1rt = 0 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 30 / 40</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
MLE and QMLE
Maxim um lik elihood estimates are optimal: they have the smallest 
asymptotic v ariance . 
When w e kno w the distr ibution function p (X , ) precisely , MLE is the 
most efcient approach. 
MLE is often a con venient w ay to gure out which moment conditions 
to impose . 
Even if the model p (X , ) is misspecied, MLE approach ma y still be 
valid as long as the implied moment conditions are v alid. 
With an incorrect model q (X , ), MLE is a special case of GMM. 
GMM results apply . 
The approach of using an incorrect (typically Gaussian) lik elihood 
function f or estimation is called quasi-MLE (QMLE). 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 33 / 40</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Example: Interest Rate Model 
QMLE: treat t as Gaussian N(0, b0 + b1rt1). 
Constr uct L() : 
T 1  (rt+1  a0  a1rt )2 
L() =  ln 2(b0 + b1rt ) 2(b0 + b1rt )t=1 
(a0, a1) can no longer be estimated separ ately from (b0, b1). 
Optimality conditions f or (a0, a1): 
T1 (rt+1  a0  a1rt )(1, rt ) = 0b0 + b1rtt=1 
This is no longer OLS , but GLS . More precise estimates of (a0, a1). 
Down-w eight residuals with high v ariance . 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 36 / 40</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
VAR(p) Model Selection
To build a V AR(p) model, w e must decide on the order p . 
Without theoretical guidance , use an inf ormation cr iterion. 
Consider tw o most popular inf ormation cr iteria: Akaik e (AIC) and 
Bayesian. 
Each cr iterion chooses p to maximiz e the log lik elihood subject to a 
penalty f or model e xibility (free par ameters). Various cr iteria diff er in 
the form of penalty . 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 21 / 40</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Example: Mean-V ariance
Suppose w e have a sample from a distr ibution with mean 0 and 
variance 2
0. 
To estimate the par ameter v ector 0 =(0, 0), 0  0, choose the 
functions f j (x, ), j = 1, 2: 
f1(xt , )= xt   
f2(xt , )=(xt  )2  2 
Easy to see that E [f (x, 0)] = 0. 
If  =0, then E [f (x, )] =0 (verify). 
Parameter estimates: 
E(xt ) = 0 = E(xt ) 
  
 
E(xt  )2 2 = 0 2 = E(xt  )2 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 28 / 40</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Approaches to Estimation
If probability la w p(X, 0) is fully kno wn, can estimate 0 by Maxim um 
Likelihood (MLE). This is the pref erred method, it off ers the best 
asymptotic precision. 
If the la w p(X , 0) is not fully kno wn, b ut we kno w some f eatures of 
the distr ibution, e .g., the rst tw o moments , we can still estimate the 
parameters b y the quasi-MLE method. 
Alternativ ely, if we only kno w a few moments of the distr ibution, b ut 
not the entire pdf p (X , 0), we can estimate par ameters b y the 
Gener alized Method of Moments (GMM). 
QMLE and GMM methods are less precise (efcient) than MLE, b ut 
they are more rob ust since the y do not require the full kno wledge of 
the distr ibution. 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 7 / 40</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Outline
1 The Basics 
2 MLE 
3 AR and V AR 
4 Model Selection 
5 GMM 
6 QMLE 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 15 / 40</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
MLE f or VAR(p) Time Ser ies
VAR(p) (Vector AutoReg ressiv e) time ser ies model with IID Gaussian 
errors: 
xt+1 = a0 + A1xt + ...Apxt+1p + t+1, t+1 N(0, ) 
where xt and a0 are N-dim vectors , An are N  N matrices, and t are 
N-dim v ectors of shoc ks. 
Conditional on (xt , ..., xt+1p), xt+1 is Gaussian with mean 0 and 
var-co v matr ix . 
Constr uct lik elihood: 
T 1 
L() =  
 ln (2)N ||  1 t
+11t+12t=p 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 17 / 40</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
MLE f or AR(p) Time Ser ies
AR(p) (AutoReg ressiv e) time ser ies model with IID Gaussian errors: 
xt+1 = a0 + a1xt + ...apxt+1p + t+1, t+1 N(0, 2) 
Conditional on (xt , ..., xt+1p), xt+1 is Gaussian with mean 0 and 
variance 2. 
Constr uct lik elihood: 
 (xt+1  a0  a1xt  ...apxt+1p)2 
L() = T 1
 ln 
22  22 
t=p 
MLE estimates of (a 0, a1, ..., ap) are the same as OLS:
T1
max L() min (xt+1  a0  a1xt  ...apxt+1p)2 
a  
a t=p 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 16 / 40</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Outline
1 The Basics 
2 MLE 
3 AR and V AR 
4 Model Selection 
5 GMM 
6 QMLE 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 8 / 40</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
GMM and MLE 
First-order conditions f or MLE can be used as moments in GMM 
estimation. 
TOptimality conditions f or maximizing L() = t=1 ln p(xt , ) are 
T  ln p(xt , ) = 0  t=1 
If we set f =  ln p(x, )/ (the score v ector), then MLE reduces to 
GMM with the moment v ector f . 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 29 / 40</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Example: Interest Rate Model 
3-Month Treasur y Bill: secondar y mar ket rate, monthly . 
Scatter plot of interest r ate changes vs lagged interest r ate v alues . 
Higher v olatility of r ate changes at higher r ate le vels. 
-5-4-3-2-10123
0 5 10 15 20InterestRateChange(rt+1rt,%)
LaggedInterestRate(rt,%)
Source: Federal Reser ve Bank of St. Louis . 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 37 / 40</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Outline
1 The Basics 
2 MLE 
3 AR and V AR 
4 Model Selection 
5 GMM 
6 QMLE 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 32 / 40</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Outline
1 The Basics 
2 MLE 
3 AR and V AR 
4 Model Selection 
5 GMM 
6 QMLE 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 19 / 40</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Probability Re view: LLN and CL T
Law of Large Numbers (LLN) states that if xt are IID random variables 
and E [xt ]= , then 
T
plimT  t
T =1 xt = 
plim is limit in probability . plimn xn = y means that f or an y &gt; 0, 
Prob[|xn  y| &gt;] 0. 

Centr al Limit Theorem (CL T) states that if x t are IID r andom v ectors 
with mean v ector  and v ar-co v matr ix , then 
T 
t=1(xt  )
T  N(0, ) 
  denotes con vergence in distr ibution. xn  y means that the 
corresponding cum ulativ e distr ibution functions F xn () and F y () have 
the proper ty 
Fxn (z)  Fy (z) z  R, s.t., F y is contin uous at z 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 5 / 40</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Example: AR(p) Model of GDP Gro wth 
Set p = 7. 
0 1 2 3 4 5 6 72.842.822.82.782.762.742.722.7LogLikelihood  penalty
pBIC
BIC dictates p = 1. 
AR coefcient a 1 = 0.3611. 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 25 / 40</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Maxim um Lik elihood Estimator (MLE) 
IID obser vations x t , t = 1, ..., T with density p (x, 0). 
Maxim um lik elihood estimation is based on the f act that f or an y 
alternativ e distr ibution density p (x, ), 
E ln p(x, )  E [ln p(x, 0)] , E[]=  p(x, 0) dx 
To see this , use Jensen s inequality , and equality p(x, ) dx = 1: 
   
E ln p(xt , )  ln E p(xt , )= ln p(x, ) p(x, 0) dx = p(xt , 0) p(xt , 0) p(x, 0)
ln p(x, ) dx = 0 
Estimate par ameters using the sample analog of the abo ve inequality 
T1  1 = arg max ln p(xt , )= arg max ln p(X, )) 
 T  T t=1 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 10 / 40</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Example: MLE f or Gaussian Distr ibution 
IID Gaussian obser vations , mean , variance 2. 
The log lik elihood f or the sample x 1, ..., xT is 
T T T   1 (xt  )2 
L() = ln p(xt , )= ln p(xt , )= ln 
22 22 
t=1 t=1 t=1 
MLE: = arg max L() 
Optimality conditions: 
T 
=1(xt  ) T T 
=1(xt  )2 
t t= 0, + = 0 2 3 
These are identical to the GMM conditions w e have der ived abo ve! 
E(xt  )= 0, E(xt  )2 2 = 0 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 12 / 40</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Outline
1 The Basics 
2 MLE 
3 AR and V AR 
4 Model Selection 
5 GMM 
6 QMLE 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 26 / 40</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Outline
1 The Basics 
2 MLE 
3 AR and V AR 
4 Model Selection 
5 GMM 
6 QMLE 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 2 / 40</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Maxim um Lik elihood Estimator (MLE) 
Dene the Lik elihood function 
L()= ln p(X , ) 
Likelihood function treats model par ameters  variables. It treats 
obser vations X as x ed. 
We will w ork with the log of lik elihood, L() = ln L(). We will often 
drop the log and simply call L likelihood. 
For IID obser vations , 
T T1 1  1  
L() = ln p(xt , )= ln p(xt , )T T T t=1 t=1 
and theref ore  can be estimated b y maximizing (log-) lik elihood 
MLE 
 = arg max 
 L() 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 11 / 40</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Math Re view: Jensen s Inequality
Jensen s inequality states that if f (x) is a conca ve function, and
wn  0, n = 1, ..., N, and 
nN 
=1 wn = 1, then
N N
wnf (xn)  f wnxn 
n=1 n=1 
for an y xn, n = 1, ..., N. 
This result e xtends to the contin uous case: 
    
w(x)f (x) dx  f w(x)x dx , if w(x) dx = 1, w(x)  0 
Example: if x is a r andom v ariable (e.g., asset retur n), and f a
conca ve function (e .g., utility function), then
E[f (x)]  f (E[x]) (risk aversion) 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 9 / 40</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
MLE f or VAR(p) Time Ser ies 
Parameter estimation: 
T 1 
max L() min  
ln (2)N || + 1 t
+11t+1 a0,A1,...,Ap ,  
a0,A1,...,Ap , t=p 2
Optimality conditions f or a 0, A1, ..., Ap: 
xti t
+1 = 0, i = 0, 1, ..., p  1, t+1 = 0 
t t 
where 
t+1 = xt+1 (a0 + A1xt + ...Apxt+1p) 
VAR coefcients can be estimated b y OLS , equation b y equation. 
Standard errors can also be computed f or each equation separ ately. 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 18 / 40</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Outline
1 The Basics 
2 MLE 
3 AR and V AR 
4 Model Selection 
5 GMM 
6 QMLE 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 3 / 40</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Statistics Re view: Parameter Estimation
Sample of obser vations X =(x1, ..., xT ) with joint distr ibution 
p(X , 0). 
Estimator is a function of the sample: (X ). 
Estimator is consistent if 
plimT  = 0 
Estimator is unbiased if
E[]= 0
An  condence inter val for the i th coordinate of the par ameter 
vector , 0,i , is a stochastic inter val 
(iL , iR) such that Prob (iL , iR) covers 0,i =  
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 4 / 40</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
MLE f or Dependent Obser vations 
MLE approach w orks even if obser vations are dependent. 
Need dependence to die out quic kly enough. 
Consider a time ser ies x t , xt+1, ... and assume that the distr ibution of 
xt+1 depends only on L lags: xt , ..., xt+1L. 
Log lik elihood conditional on the rst L obser vations: 
T 1
L() = ln p(xt+1|xt , ..., xt+1L; ) 
t=L 
 maximiz es conditional e xpectation of ln p(xt+1|xt , ..., xtL+1; ) and 
thus maximiz es the (conditional) lik elihood if T is large and x t is 
stationar y. 
MLE 
 = arg max 
 L() 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 14 / 40</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Example
We obser ve a sample of IID obser vations x t , t = 1, ..., T from a
Normal distr ibution N(, 1).
We want to estimate the mean . 
A commonly used estimator is the sample mean: 
T1  
= E[xt ]  T xt 
t=1 
This estimator is consistent b y the LLN: plimT  = . 
How do w e der ive consistent estimators in more comple x situations? 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 6 / 40</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Example: Interest Rate Model
GMM using the moment conditions 
E (1, rt )(rt+1  a0  a1rt )= 0 
E (1, rt ) (rt+1  a0  a1rt )2  b0  b1rt = 0 
(a0, a1) can be estimated from the rst pair of moment conditions . 
Equiv alent to OLS , ignore inf ormation about second moment. 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 31 / 40</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
IID Obser vations
A sample of independent and identically distr ibuted (IID) obser vations 
drawn from the distr ibution f amily with density (x; 0): 
X =(x1,..., xt ,..., xT ) 
Want to estimate the N -dimensional par ameter v ector 0, . 
Consider a v ector of functions f j (x, ) (moments), dim (f )= N. 
Suppose w e kno w that f or an y j, 
E[f1(xt , 0)]= = E[fN (xt , 0)] = 0, if  = 0N  
2 (Identication) 
j=1 (E[fj (xt , )])&gt; 0, if  =0 
GMM estimator of the unkno wn par ameter 0 is dened b y 
GMM 
E[f (xt , )]  1 
T T 
t=1 f (xt , ) = 0 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 27 / 40</text>
        </slide>
        <slide>
          <slideno>39</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Readings
Tsay, 2005, Sections 1.2.4, 2.4.2, 8.2.4. 
Cochr ane, 2005, Sections 11.1, 14.1, 14.2. 
Campbell, Lo, MacKinla y, 1997, Section A.2, A.4. 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 40 / 40</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Example: AR(p) Model of Real GDP Gro wth
Model quar terly seasonally adjusted GDP g rowth (ann ualized rates).
Want to select and estimate an AR(p) model. 
-15-10-505101520
1945 1955 1965 1975 1985 1995 2005YearRealGDPgrowth,quarterly, 
annualized (%)
Source: U.S. Depar tment of Commerce , Bureau of Economic Analysis . National Inco me and Product Accounts . 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 23 / 40</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>The Basics MLE AR and V AR Model Selection GMM QMLE 
Parameter Estimation 
Leonid K ogan 
MIT, Sloan 
15.450, F all 2010 
c Leonid K ogan ( MIT , Sloan ) Parameter Estimation 15.450, F all 2010 1 / 40</text>
        </slide>
      </slides>
      <videos/>
    </lecture>
    <lecture>
      <lecture_title>Small-sample inference and bootstrap</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/resources/mit15_450f10_lec09/</lecture_pdf_url>
      <lectureno>9</lectureno>
      <slides>
        <slide>
          <slideno>2</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Overview
So far, our inf erence has been based on asymptotic results: LLN and 
CLT. 
Asymptotic inf erence is sometimes difcult to apply , too complicated 
analytically . 
In small samples , asymptotic inf erence ma y be unreliab le: 
Estimators ma y be consistent b ut biased. 
Standard errors ma y be imprecise , leading to incorrect condence 
intervals and statistical test siz e. 
We can use sim ulation methods to deal with some of these issues: 
Bootstr ap can be used instead of asymptotic inf erence to deal with 
analytically challenging prob lems . 
Bootstr ap can be used to adjust f or bias . 
Monte Car lo sim ulation can be used to gain insight into the proper ties 
of statistical procedures . 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 3 / 28</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Example: Predictiv e Reg ression
Use par ametr ic bootstr ap: 1,000 samples , 200 per iods as b urn-in, 
retain samples of same length as histor ical. 
Tabulate and standard errors f or each sample . Use Ne wey-West 
with 6 lags to compute standard errors . 
Average of is 0.0125.
Average bias in is 0.0036.
Average standard error is 0.005.
Average t -stat on  is 0.67.
-4 -3 -2 -1 0 1 2 3 4050100150Sample Distribution of T-stat
 

c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 26 / 28</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>/bracketleftBig/bracketrightBigSmall-Sample Inference Bootstrap
Bootstrap Bias Adjustment
Want to estimate small-sample bias of a statistic /hatwide:
E/hatwide0
Source: Efron and Tibshirani, 1994, Figure 10.4.
c/circlecopyrt Leonid Kogan ( MIT , Sloan ) Bootstrap 15.450, Fall 2010 24 / 28Unknown
probabilitymodel
Parameter of 
interest = (P)Estimate of 
 = s(x)Observed data
^P
BiasP(,)^x = (x1, x2, ... x n)REAL WORLD
Estimated
probabilitymodel
Estimated
parameterBootstrapreplicateof
 = s(x *)Bootstrap sample
^*
 = (P)^^P
BiasP(,)^^^x* = (x1, x2, ... x n)BOOTSTRAP WORLD
** *^
^
Image  by MIT OpenCourseWare.</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Example: Predictiv e Reg ression
Consider a predictiv e reg ression (e .g., forecasting stoc k retur ns using 
dividend yield) 
rt+1 =  + xt + ut+1 
xt+1 =  + xt + t+1 
(ut , t ) N(0, ) 
Stambaugh bias: 
E( )= Cov(ut , t )E( )   1 + 3 Cov(ut , t ) 
Var(t ) T Var(t ) 
In case of dividend yield f orecasting stoc k retur ns, the bias is positiv e, 
and can be substantial compared to the standard error of . 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 9 / 28</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Predictiv e Reg ression: Monte Car lo
Predictiv e reg ression of monthly S&amp;P 500 e xcess retur ns on log 
dividend yield: 
rt+1 =  + xt + ut+1 
xt+1 =  + xt + t+1 
Data: CRSP , From 1/31/1934 to 12/31/2008. 
Parameter estimates:
= 0.0089 , = 0.9936 ,
S.E.() = 0.005. 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 10 / 28</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Lognor mal Distr ibution 
Use bootstr ap instead of asymptotic inf erence . 
MATLAB Code 
   
   
  
        
     
 
    
        
          
          
Bootstr ap estimate of the condence inter val 
(0.7280 , 1.5615) 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 20 / 28</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Outline 
1 
2 Small-Sample Inf erence 
Bootstr ap 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 2 / 28</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Testing the Mean: Bootstr ap 
Lognor mal Example 
Consistent with Monte Car lo results: small-sample distr ibution of 
t-statistics e xhibits left-sk ewness . 
Variance of the bootstr apped t-statistic is 1 .18522. Normal 
appro ximation: Var(t)= 1. Monte Car lo estimate: Var(t)= 1.25422. 
A histog ram of t statistic 
Bootstr ap (10,000 samples) Monte Car lo (100,000 samples) 
8642 024050100150200250300350400450500
8642 0240500100015002000250030003500400045005000
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 21 / 28</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Bootstr ap for IID Obser vations
Suppose w e are giv en a sample of IID obser vations x t , t = 1, ..., T . 
We estimate the sample mean as = E(xt ). What is the 95%
condence inter val for this estimator?
Asymptotic theor y suggests computing the condence inter val based 
on the Nor mal appro ximation 
T 
T E(xt )  N(0, 1), 2 = t=1[xt  E(xt )]2 
 T 
Under the empir ical distr ibution, x is equally lik ely to tak e one of the 
values x 1, x2, ..., x T . 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 16 / 28</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Discussion
Asymptotic theor y is v ery con venient when a vailab le, but in small 
samples results ma y be inaccur ate. 
Use Monte Car lo sim ulations to gain intuition. 
Bootstr ap is a po werful tool. Use it when asymptotic theor y is
unavailab le or suspect.
Bootstr ap is not a silver bullet: 
Does not w ork well if r are e vents are missing from the empir ical 
sample; 
Does not account f or more subtle biases , e.g., sur vivorship , or sample 
selection. 
Does not cure model misspecication. 
No substitute f or common sense! 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 27 / 28</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Lognor mal Example: Monte Car lo 
Monte Car lo experiment: N = 100,000, 
T = 50. Document the distr ibution of the A histog ram of t across 
t-statistic 100,000 sim ulations 
t =	 1
/
T 
Asymptotic theor y dictates that
Var(t)= 1. We estimate
Var(t)= 1.25422 
Tails of the distr ibution of t are far from
the asymptotic v alues:
Prob(t &gt; 1.96)  0.0042 , Prob(t &lt; 1.96)  0.1053 
8642 0240500100015002000250030003500400045005000
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 13 / 28</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Small-Sample Inf erence and Bootstr ap 
Leonid K ogan 
MIT, Sloan 
15.450, F all 2010 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 1 / 28</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Outline 
1 
2 Small-Sample Inf erence 
Bootstr ap 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 4 / 28</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>MIT OpenCourseWare
http://ocw.mit.edu 
15.450 Analytics of Finance 
Fall 2010 
For information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms .</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Outline 
1 
2 Small-Sample Inf erence 
Bootstr ap 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 14 / 28</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Bootstr ap: Gener al Principle
Bootstr ap is a re-sampling method which can be used to e valuate 
proper ties of statistical estimators . 
Bootstr ap is eff ectively a Monte Car lo study which uses the empir ical 
distribution as if it w ere the tr ue distr ibution. 
Key applications of bootstr ap methodology: 
Evaluate distr ibutional proper ties of complicated estimators , perf orm 
bias adjustment; 
Impro ve the precision of asymptotic appro ximations in small samples 
(condence inter vals, test rejection regions , etc.) 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 15 / 28</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Example: Lognor mal Distr ibution
Fix a sample of 50 obser vations from a lognor mal distr ibution 
ln xt N(1/2, 1) and compute the estimates
= 1.1784 , = 1.5340
Population mean 
 = E(xt )= E(e 21 + t )= 1, t N(0, 1) 
Asymptotic appro ximation produces a condence inter val 
 ( 1.96
T , + 1.96
T )=(0.7532 , 1.6036) 
Compare this to the bootstr apped distr ibution.
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 19 / 28</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Bootstr ap Bias Adjustment
Bootstr ap pro vides an intuitiv e approach: 
E  0  ER   
where E R denotes the a verage across the R bootstr apped samples . 
Intuition: treat the empir ical distr ibution as e xact, compute the
average bias across bootstr apped samples .
Caution: by estimating the bias , we ma y be adding sampling error . 
Correct f or the bias if it is large compared to the standard error of . 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 25 / 28</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Example: Autocorrelation, Monte Car lo 
We use 100,000 sim ulations to estimate the a verage bias 
1 T Average Bias 
0.9 50 0.0826  0.0006 
0.0 50 0.0203  0.0009 
0.9 100 0.0402  0.0004 
0.0 100 0.0100  0.0006 
Bias seems increasing in 1, and decreasing with sample siz e. 
There is an analytical f ormula for the a verage bias due to K endall: 
1 + 31E(1) 1   T 
When e xplicit f ormulas are not kno wn, can use bootstr ap to estimate 
the bias . 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 8 / 28</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Example: Autocorrelation, Monte Car lo
Perform a Monte Car lo study to gain insight into the phenomenon. 
Simulate independently N r andom ser ies of length T . 
Each ser ies follows an AR(1) process with persistence 1 and 
Gaussian errors: 
xt = 1xt1 + t , t N(0, 1) 
Compute 1(n), n = 1, ..., N for each sim ulated sample . 
Estimate the bias: 
N1  
1(n) 1 E(1) 1 = N n=1 
Standard error of our sim ulation-based estimate is
1
N 2 
 = 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 6 / 28 N n=1 1(n) E(1)</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Key Idea of Bootstr ap
Source: Efron and Tibshirani, 1994, Figure 10.4. 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 17 / 28 Unknown 
probability model
Parameter of 
interest q = q(P)Estimate of q
q = s(x)Observed data
^P
BiasP(q, q)^x = (x1, x2, ... x n)REAL WORLD
Estimated 
probability model
Estimated 
parameterBootstrap replicate of  q
q = s(x *)Bootstrap sample
^*
q = q(P)^ ^P
BiasP(q*,q)^^^x* = (x1, x2, ... x n)BOOTSTRAP WORLD
* * *^
^
Image  by MIT OpenCourseWare.</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Readings
Campbell, Lo, MacKinla y, 1997, Section 7.2, pp . 273-274. 
B. Efron and R.J . Tibshir ani, An Introduction to the Bootstr ap,
Sections 4.2-4.3, 10.1-10.2, 12.1-12.5.
A. C. Davison and D . V. Hinkle y, Bootstr ap Methods and Their
Application, Ch. 2. Cambr idge Univ ersity Press , 1997.
R. Stambaugh, 1999, Predictiv e Reg ressions , Jour nal of Financial 
Economics 54, 375-421. 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 28 / 28</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Boostr ap Condence Inter vals
The basic bootstr ap condence inter val is v alid, and can be used in 
situations when asymptotic inf erence is too difcult to perf orm. 
Bootstr ap condence inter val is as accur ate asymptotically as the 
interval based on the nor mal appro ximation. 
For t-statistic , bootstr apped distr ibution is more accur ate than the 
large-sample nor mal appro ximation. 
Many gener alizations of basic bootstr ap ha ve been de veloped f or 
wider applicability and better inf erence quality . 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 22 / 28</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Example: Autocorrelation
We want to estimate rst-order autocorrelation of a time ser ies xt 
(e.g., ination), corr (xt , xt+1). 
Estimate b y OLS (GMM) 
xt = a0 + 1xt1 + t 
We kno w that this estimator is consistent:
plimT  1 = 1
 
We want to kno w if this estimator is biased, i.e ., we want to estimate 
E(1) 1 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 5 / 28</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Testing the Mean: Non-Gaussian Errors
We estimate the mean  of a distr ibution b y the sample mean. Tests 
are based on the asymptotic distr ibution 
  
/
T N(0, 1) 
How good is the nor mal appro ximation in nite samples if the sample 
comes from a Non-Gaussian distr ibution? 
Assume that the sample is gener ated b y a lognor mal distr ibution: 
xt = e 1
2 + t , t N(0, 1) 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 12 / 28</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Predictiv e Reg ression: Monte Car lo 
Gener ate 1,000 samples with par ameters equal to empir ical 
estimates . Use 200 per iods as b urn-in, retain samples of the same 
length as histor ical. 
Tabulate and standard errors f or each sample . Use Ne wey-West 
with 6 lags to compute standard errors . 
-4 -3 -2 -1 0 1 2 3 4050100150Sample Distribution of T-stat
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 11 / 28 Average of is 0.013.
Average bias in is 0.004.
Average standard error is 0.005.
Average t -stat on  is 0.75.</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>1
2
3:
Small-Sample Inf erence Bootstr ap 
Bootstr ap Condence Inter vals
Bootstr ap condence inter val star ts by drawing R samples from the
empir ical distr ibution.
For each bootstr apped sample , compute . denotes statistics
computed using bootstr apped samples .
Compute 2.5% and 97.5% percentiles of the resulting distr ibution of
2 
.5%, 97 
.5% 
Appro ximate the distribution of   with the simulated distr ibution of 
  . Estimate the condence inter val as 
((97 
.5%  ), (2 
.5%  )) 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 18 / 28</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>1
2
3Small-Sample Inf erence Bootstr ap 
Parametr ic Bootstr ap
Parametr ic bootstr ap can handle non-IID samples . 
Example: a sample from an AR(1) process: xt , t = 1, ..., T : 
xt = a0 + a1xt1 + t 
Want to estimate a condence inter val for a1. 
Estimate the par ameters a0, a1 and the residuals t .
Gener ate R bootstr ap samples f or x t .
For each sample: gener ate a long ser ies according to the AR(1) 
dynamics with a0, a1, drawing shoc ks with replacement from the sample 
1, ..., T ; 
Retain only the last T obser vations (drop the b urn-in sample). 
Compute the condence interval as we would with basic nonpar ametr ic 
bootstr ap using R samples . 
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 23 / 28</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>Small-Sample Inf erence Bootstr ap 
Example: Autocorrelation, Monte Car lo
MATLAB Code 
      
       
         
            
  
   
         
    
  
      
 
      
          
         
      
c Leonid K ogan ( MIT , Sloan ) Bootstr ap 15.450, F all 2010 7 / 28</text>
        </slide>
      </slides>
      <videos/>
    </lecture>
    <lecture>
      <lecture_title>Dynamic portfolio choice I: Static approach to dynamic portfolio choice</lecture_title>
      <lecture_pdf_url>https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/resources/mit15_450f10_lec04/</lecture_pdf_url>
      <lectureno>4</lectureno>
      <slides>
        <slide>
          <slideno>34</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Summar y
Need a coherent objectiv e to f ormulate an optimal dynamic tr ading str ategy: 
Expected Utility Theor y. 
In a setting in which all state-contingent claims can be replicated b y dynamic 
trading (e .g., binomial tree , Blac k-Scholes model) can connect optimal 
portfolio choice to option pr icing. 
In the Blac k-Scholes setting with CRRA pref erences , the optimal por tfolio 
strategy is m yopic, given by the Mer tons solution. 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 34 / 35</text>
        </slide>
        <slide>
          <slideno>3</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Constant P ortfolio W eights 
Consider a mar ket with N assets . 
Gross asset retur ns, Rtn , n = 1, 2, ..., N are IID o ver time . 
Consider self-nancing por tfolio r ules with constant w eights 
Portfolio Rule:  =(1, 2, ..., N ) 
Focus on constant w eights is natur al in an IID en vironment. 
Under r ule , portfolio v alue W t changes as 
N
Wt = Wt1 nRtn 
n=1 
Single out a par ticular r ule , such that 
N
 = argmaxE ln nRtn 
 
n=1 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 4 / 35</text>
        </slide>
        <slide>
          <slideno>16</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Examples of Utility Functions
Constant relativ e risk aversion (CRRA) utility e xhibits 
(W )=  
Using the denition (W )=U (W )W /U (W ), reco ver the utility function 
1 W 1 ,  = 11U(W )= 
ln W ,  = 1 
CRRA utility is a v ery popular choice because of its implications f or por tfolio 
strategies . 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 16 / 35</text>
        </slide>
        <slide>
          <slideno>28</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
CRRA Utility 
Static Prob lem 
We nd the m ultiplier from the static b udget constr aint: 
E0 [T WT ]= W0 E0 T (T )1/ = W0  
Find 
1/ =  W0  
E0 T 11/ 
We need to der ive the dynamic str ategy replicating the optimal
state-contingent claim WT  .
We rst derive the process for the optimal portfolio value, Wt , and then gure 
out ho w to delta-hedge it using the stoc k. 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 28 / 35</text>
        </slide>
        <slide>
          <slideno>5</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Constant P ortfolio W eights
We have estab lished that 
1 W  
ln T G() G &gt; 0T WT  
Conclusion: in the long r un, the por tfolio r ule  produces higher por tfolio 
value than an y other constant w eight r ule with probability one! 
Is the por tfolio r ule maximizing the e xpected log of retur n the best choice f or 
any long-hor izon in vestor? Is there role f or individual pref erences? 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 6 / 35</text>
        </slide>
        <slide>
          <slideno>10</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Risk A version
We commonly assume that people pref er more to less: 
 x x,   0 x +   for all 
This means that the utility U (x) is non-decreasing: 
U (x)  0 
We also assume a version to r isk: prefer x = E[x] to x, i.e., 
U(x)  E[U(x)] 
This means that U (x) is conca ve
U (x)  0
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 11 / 35</text>
        </slide>
        <slide>
          <slideno>19</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Main Idea
t = 0 t = 1 t = 2 
s1 
s2 
s3 
s4 
Imagine that an y possib le state-contingent claim with pa yoff at T = 2 can be 
traded. Then por tfolio choice is a simple static optimization prob lem: choose 
the claim WT (s) producing the highest e xpected utility subject to the b udget 
constr aint. 
Any state-contingent claim can be replicated b y trading dynamically in the 
stock and the bond, theref ore our optimal choice f or WT (s) can be gener ated 
by dynamic tr ading. 
c Dynamic P ortfolio Choice I 19 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>2</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Outline
1 
2 
3 Expected Utility 
Risk A version 
Derivatives and P ortfolio Choice 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 3 / 35</text>
        </slide>
        <slide>
          <slideno>30</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Dynamic Str ategy
To gure out the dynamic tr ading str ategy , we relate the SPD to the stoc k 
price, just lik e we did f or binomial tree . 
The SPD is giv en by 
t = ert e(2 /2) t Zt 
The stoc k price equals 
St = S0e(2/2) t+ Zt 
We conclude that 
t = G(t)St / 
for some function G (t). We can compute G (t) explicitly b ut do not need to . 
The optimal por tfolio follows 
W  = F (t)G(t)1/S/() 
t t 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 30 / 35</text>
        </slide>
        <slide>
          <slideno>12</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Risk A version 
11.21.41.61.822.22.42.62.839.69.659.79.759.89.859.99.951010.05
xUU(E[x])
E[U(x)]
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 12 / 35</text>
        </slide>
        <slide>
          <slideno>23</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
CRRA Utility 
Dynamic T rading Str ategy 
We were ab le to e xpress the optimal state-contingent por tfolio v alue at the 
terminal date , WT (s), as a function of the ter minal stoc k price, denoted as 
WT (s)= H(ST (s)) 
The optimal por tfolio m ust replicate the European der ivative secur ity with 
terminal pa yoff H(ST ). 
We kno w ho w to constr uct the optimal tr ading str ategy in the stoc k and the 
bond: it is the replicating str ategy f or the abo ve der ivative. Can compute it b y 
backward induction. 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 23 / 35</text>
        </slide>
        <slide>
          <slideno>4</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Constant P ortfolio W eights
Compare the long-r un perf ormance of the por tfolio following the r ule  to 
the one f ollowing an y other constant r ule . 
Denote the corresponding por tfolio v alues b y W  and W . Assume both star t 
at 1 at t = 0. 
T N T N T N 
T t=1 ntln W  
= ln T n
N =1 Rn 
=  
ln  
 
nRtn   
ln  
nRtn 
 nRnWT t=1 n=1 t t=1 n=1 t=1 n=1 
By LLN, 
  T N N1   
T ln nRtn  E ln nRtn  G() 
t=1 n=1 n=1 
By denition of  ,
G() G() &gt; 0
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 5 / 35</text>
        </slide>
        <slide>
          <slideno>9</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Outline
1 
2 
3 Expected Utility 
Risk A version 
Derivatives and P ortfolio Choice 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 10 / 35</text>
        </slide>
        <slide>
          <slideno>22</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
CRRA Utility 
Solution of the Static Prob lem 
We conclude that the optimal choice of time-T state-contingent cash o w is 
WT (s)=  W0 T (s)1/ 
Prob 0(s)T (s)11/ 
s 
The recombining binomial tree model has a special proper ty that the SPD is 
a function of the ter minal stoc k price. 
If the ter minal stoc k price equals 
ST = S0u(# Up mo ves)d(T # Up mo ves) 
then the SPD in the same state equals 
T = 1(u)(# Up mo ves)1(d)(T # Up mo ves) 
1 1 + r  d 1 u (1 + r)1(u)= , 1(d)= p(1 + r) u  d (1  p)(1 + r) u  d 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 22 / 35</text>
        </slide>
        <slide>
          <slideno>7</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Where is the Catch
It is hard to ha ve a meaningful discussion of which por tfolio r ules are
preferable without an e xplicitly specied objectiv e.
Both of the por tfolio r ules descr ibed abo ve ma y have nice asymptotic 
proper ties, but at an y nite time point T they ma y produce retur n distr ibutions 
with too m uch r isk. 
Consistent decision making under uncer tainty can be based on the concept 
of expected utility. 
Expected utility is not a dogma: it is based on beha vioral assumptions . 
Expected utility assumes r ational, consistent choices . 
Empir ically , people often violate e xpected utility axioms . 
No sur prise there , people often beha ve irrationally . 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 8 / 35</text>
        </slide>
        <slide>
          <slideno>18</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Binomial Setting
Consider a mar ket with constant interest r ate r and a stoc k paying no 
dividends , with pr ice following a binomial tree: 
u, with probability pSt = St1  d, with probability 1  p 
Recall that the state-pr ice density in this mar ket is giv en by 
t+1(u) 1 1 + r  d = t p(1 + r) u  d 
t+1(d) 1 u (1 + r) = t (1  p)(1 + r) u  d 
We want to nd the por tfolio maximizing e xpected utility 
E0 [U(WT )] 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 18 / 35</text>
        </slide>
        <slide>
          <slideno>35</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
References
T. Cover, 1991, Univ ersal P ortfolios, Mathematical Finance 1, 1-29. 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 35 / 35</text>
        </slide>
        <slide>
          <slideno>6</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
20-20 Hindsight 
This discussion is based on the univ ersal por tfolio of Thomas Co ver. 
Dene the geometr ic rate of retur n on a por tfolio betw een 0 and T as 
1 WTlnT W0 
Consider a mar ket with N stocks pa ying no dividends . 
Suppose that, after obser ving retur ns on N stocks betw een 0 and T , we 
select the stoc k with the highest geometr ic rate of retur n. 
Is it possib le for a por tfolio to match perf ormance of the best-perf orming 
stock? Yes, in the long r un. 
Consider an equal-w eighted, b uy-and-hold por tfolio. It has the same 
asymptotic geometr ic rate of retur n (as T ) as the best perf orming (e x 
post ) stoc k! 
Universal por tfolio is an equal-w eighted allocation to all possib le por tfolios 
with positiv e constant w eights . It can beat the best perf orming stoc k and 
matches the best (e x post ) constant-w eight r ule asymptotically . 
Should w e follow the equal-w eight, b uy-and-hold r ule, or the univ ersal 
portfolio? 
c Dynamic P ortfolio Choice I 7 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>33</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Mertons Solution 
Mertons solution easily gener alizes to a m ulti-v ariate case . 
If an in vestor has a CRRA utility function, interest r ate is constant, r, and 
returns on N risky assets f ollow 
NdSti 
= i dt +  
ij dZtj ,Si
tj=1
then the v ector of optimal por tfolio w eights on the N stocks is giv en by 
 = 1 ()1 (  r1)t  
where  =(1, ..., N ), 1 =(1, 1, ..., 1), and 
  
 11 12 ... 1N 
21 22 ... 2N = ... 
N1 N2 ... NN 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 33 / 35</text>
        </slide>
        <slide>
          <slideno>24</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
CRRA Utility 
State-Contingent Allocation 
Qualitativ ely, want to achie ve higher w ealth in states with lo wer SPD (higher 
stock price). 
Illustr ate b y plotting the analytical solution from B-S fr amework (belo w). 
STW*T = 1
STW*T = 4
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 24 / 35</text>
        </slide>
        <slide>
          <slideno>27</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
CRRA Utility 
Static Prob lem 
In analogy with the binomial-tree setting, w e replace the dynamic prob lem 
with a static prob lem 
maxE0 1 WT 1 subject to E0 [T WT ]= W0 {WT } 1   
Keep in mind that W T and T are both functions of the state , which is the 
entire tr ajector y of the Bro wnian motion betw een 0 and T . 
Relax the constr aint using a Lag range m ultiplier : 
maxE0 1 WT 1   (T WT  W0) 
{WT } 1   
First-order optimality conditions 
(WT ) = T WT  =(T )1/  
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 27 / 35</text>
        </slide>
        <slide>
          <slideno>0</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Dynamic P ortfolio Choice I
Static Approach to Dynamic P ortfolio Choice 
Leonid K ogan 
MIT, Sloan 
15.450, F all 2010
 Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 1 / 35
 c</text>
        </slide>
        <slide>
          <slideno>29</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
CRRA Utility 
Dynamic Str ategy 
If the optimal por tfolio v alue at T is giv en by Wt , by DCF f ormula, por tfolio 
value at ear lier times m ust be equal to 
Wt  = Et	T WT  , WT  =(T )1/ 
t 
Recall that in the Blac k-Scholes model, the pr ice of r isk is constant, 
 =(  r)/, and the SPD is giv en by 
t = ert e(2 /2) t Zt 
We can compute Wt : 
  11/  
W  1/1/ T 1/ T 1/ 
t = Et T = Et	 tt	 t 
= F (t)
t 1/ 
for some function of time F (t), which w e could compute e xplicitly . 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I	 15.450, F all 2010 29 / 35</text>
        </slide>
        <slide>
          <slideno>26</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Black-Scholes F ramework
Black-Scholes framework is a contin uous-time limit of a recombining binomial 
tree, and dynamic por tfolio choice is equally simple . 
The adv antage of contin uous time is that w e can obtain tr ansparent
closed-f orm solution.
We use the B-S fr amework to reco ver the f amous Mer tons solution to the 
dynamic por tfolio choice prob lem. 
Assume interest r ate r and the stoc k price process 
dSt =  dt +  dZtSt 
We are perf orming calculations under the ph ysical probability measure , so 
Zt = Zt P . 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 26 / 35</text>
        </slide>
        <slide>
          <slideno>15</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Examples of Utility Functions 
Linear utility 
U(W )= a + bW , b &gt; 0 
implies that (W )= 0. 
Payoffs are compared b y their e xpected v alue, linear utility implies r isk 
neutr ality. 
Exponential utility 
U(W ) =  exp(aW ), a &gt; 0 
Assume W  N(, 2). Then 
 22aE [U(W )] =  exp a + 2 
Payoffs are compared b y 
2 
  a 2 
Increasing relativ e risk aversion 
(W )= aW 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 15 / 35</text>
        </slide>
        <slide>
          <slideno>1</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Outline
1 
2 
3 Expected Utility 
Risk A version 
Derivatives and P ortfolio Choice 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 2 / 35</text>
        </slide>
        <slide>
          <slideno>8</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
The F ramework 
Dene pref erence o ver random pa yoffs (gamb les, lotter ies), e .g., 
[$1000(0.5),$0(0.5)] vs. [$2000(0.3),$200(0.7)] 
    
prob . prob . prob . prob . 
Preferences are o ver outcomes only, e .g., do not depend on the mechanism 
by which cash o ws are gener ated. Can apply to por tfolio choice . 
y (prefer x to y), x y (indiff erent betw een xand y) x  
Expected Utility Theor y is a mathematical representation of pref erences 
y E[U(x)] &gt; E[U(y)] x   
When w e evaluate a r andom pa yoff x, we care only about the n umer ical
distribution of cash o ws: E[U(x)].
Proper ties of pref erences are captured b y the shape of the utility function 
U(x). 
c Dynamic P ortfolio Choice I 9 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>17</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Outline
1 
2 
3 Expected Utility 
Risk A version 
Derivatives and P ortfolio Choice 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 17 / 35</text>
        </slide>
        <slide>
          <slideno>14</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Coefcient of Relativ e Risk A version (W )
Certainty-Equiv alent Retur n 
xCE  x  1 
2 (W (1 + x)) Var(x), where (W ) =  U (W )W 
U (W ) 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 14 / 35</text>
        </slide>
        <slide>
          <slideno>20</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
CRRA Utility 
Formulation 
Suppose our objectiv e is to maximiz e 
E0 1  1 
 WT 1 
starting with W 0. 
We look f or the best state-contingent w ealth allocation W T (s) that costs W 0 
at t = 0. 
Recall that the time-0 value of an y cash o w can be computed using the SPD 
as  
W0 = Prob 0(s)T (s)WT (s) 
s 
Solve the static prob lem 
max  
Prob 0(s) 1 
1   WT (s)1 s.t.  
Prob 0(s)T (s)WT (s) = W0 
s s 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 20 / 35</text>
        </slide>
        <slide>
          <slideno>21</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
CRRA Utility 
Solution of the Static Prob lem 
Solve the static prob lem 
max  
Prob 0(s) 1 WT (s)1 s.t.  
Prob 0(s)T (s)WT (s)= W0 {WT (s)} 1   s s 
Relax the constr aint with a Lag range m ultiplier  
 1  
max Prob 0(s) WT (s)1   Prob 0(s)T (s)WT (s) W0 {WT (s)} 1   s s 
First-order optimality conditions 
WT (s) = T (s) WT (s)= (T (s))1/  
Find the m ultiplier from 
Prob 0(s)(T (s))1/ T (s)= W0 
s 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 21 / 35</text>
        </slide>
        <slide>
          <slideno>13</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Coefcient of Relativ e Risk A version (W ) 
Start with initial w ealth W . Compare tw o gamb les, with pa yoffs
W (1 + x) and W (1 + xCE ), xCE is a constant
What v alue of x CE makes the agent indiff erent? 
Small gamb le x. Use T aylor e xpansion around W (1 + x): 
U(W (1 + x))  U(W (1 + x)) + U(W (1 + x))W (x  x)+ 
1 U(W (1 + x))W 2(x  x)2 +2  
U(W (1 + xCE ))  U(W (1 + x)) + U(W (1 + x))W (xCE  x) 
Indiff erence implies 
E [U(W (1 + x))] = U(W (1 + xCE )) 
1U(W (1 + x))Wx + U(W (1 + x))W 2Var(x)  U(W (1 + x))WxCE2 
c Dynamic P ortfolio Choice I 13 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>11</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Risk A version 
11.21.41.61.822.22.42.62.839.69.659.79.759.89.859.99.951010.05
xUU(E[x])
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 12 / 35</text>
        </slide>
        <slide>
          <slideno>32</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Dynamic Str ategy
Mertons Solution 
In the Blac k-Scholes setting with CRRA utility function, the w eight of the stock in 
the optimal por tfolio is 
 
t =   r 
2 
Mertons solution sa ys that the optimal por tfolio w eights are constant,
independent of the prob lem hor izon T .
We call such solution m yopic. It is optimal to beha ve as if the hor izon of the 
problem is v ery shor t. 
The optimal w eight of the stoc k is increasing in the r isk premium, and
decreasing in relativ e risk aversion and stoc k retur n volatility .
For a gener al utility function, U (WT ), we would not obtain the same solution, 
optimal por tfolio str ategy w ould not be m yopic. 
CRRA utility is special: constant relativ e risk aversion. This, combined with 
the fact that retur ns on all assets in the B-S model are IID , leads to a m yopic 
optimal por tfolio. 
c Dynamic P ortfolio Choice I 32 / 35  Leonid K ogan ( MIT , Sloan ) 15.450, F all 2010</text>
        </slide>
        <slide>
          <slideno>25</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Discussion
In the binomial setting, nding an optimal dynamic por tfolio str ategy reduces 
to gur ing out which der ivative secur ity we would lik e to b uy with initial w ealth 
W0. 
The static prob lem is easy to solv e using a Lag range m ultiplier . 
Since an y der ivative can be replicated b y dynamic tr ading in the stoc k and 
the bond, w e kno w ho w to constr uct the optimal dynamic str ategy f or an y 
utility function (e .g., proceeding bac kwards on the tree). 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 25 / 35</text>
        </slide>
        <slide>
          <slideno>36</slideno>
          <text>MIT OpenCourseWare
http://ocw.mit.edu 
15.450 Analytics of Finance 
Fall 2010 
For information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms .</text>
        </slide>
        <slide>
          <slideno>31</slideno>
          <text>Expected Utility Risk A version Derivatives and P ortfolio Choice 
Dynamic Str ategy
Let t denote the optimal n umber of stoc k shares in the dynamic por tfolio. 
t
 Dene to be the w eight of the stoc k in the optimal por tfolio: 
t St 
W= t 
t 
Delta-hedging rule tells us ho w man y stoc k shares to include in the 
replicating por tfolio 
Using Wt= t St 
= F (t)G(t)1/S/() 
t Wt 
we conclude that 
  r = = t  2 
c Leonid K ogan ( MIT , Sloan ) Dynamic P ortfolio Choice I 15.450, F all 2010 31 / 35</text>
        </slide>
      </slides>
      <videos/>
    </lecture>
  </lectures>
</doc>
